<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 8.0.1" />
    <title>tanjun API documentation</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2264%22%20height%3D%2264%22%20viewBox%3D%2244.5%202.5%2015%2015%22%3E%3Cpath%20d%3D%22M49.351%2021.041c-.233-.721-.546-2.408-.772-4.076-.042-.09-.067-.187-.046-.288-.166-1.347-.277-2.625-.241-3.351-1.378-1.008-2.271-2.586-2.271-4.362%200-.976.272-1.935.788-2.774.057-.094.122-.18.184-.268-.033-.167-.052-.339-.052-.516%200-1.477%201.202-2.679%202.679-2.679.791%200%201.496.352%201.987.9a6.3%206.3%200%200%201%201.001.029c.492-.564%201.207-.929%202.012-.929%201.477%200%202.679%201.202%202.679%202.679a2.65%202.65%200%200%201-.269%201.148c.383.747.595%201.572.595%202.41%200%202.311-1.507%204.29-3.635%205.107.037.699.147%202.27.423%203.294l.137.461c.156%202.136-4.612%205.166-5.199%203.215zm.127-4.919a4.78%204.78%200%200%200%20.775-.584c-.172-.115-.505-.254-.88-.378zm.331%202.302l.828-.502c-.202-.143-.576-.328-.984-.49zm.45%202.157l.701-.403c-.214-.115-.536-.249-.891-.376l.19.779zM49.13%204.141c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm.735-.389a1.15%201.15%200%200%201%20.314.783%201.16%201.16%200%200%201-1.162%201.162c-.457%200-.842-.27-1.032-.653-.026.117-.042.238-.042.362a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.843-.626-1.535-1.436-1.654zm3.076%201.654a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.037-.009-.072-.011-.109-.21.3-.541.508-.935.508a1.16%201.16%200%200%201-1.162-1.162%201.14%201.14%200%200%201%20.474-.912c-.015%200-.03-.005-.045-.005-.926.001-1.679.754-1.679%201.68zm1.861-1.265c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm1.823%204.823c0-.52-.103-1.035-.288-1.52-.466.394-1.06.64-1.717.64-1.144%200-2.116-.725-2.499-1.738-.383%201.012-1.355%201.738-2.499%201.738-.867%200-1.631-.421-2.121-1.062-.307.605-.478%201.267-.478%201.942%200%202.486%202.153%204.51%204.801%204.51s4.801-2.023%204.801-4.51zm-3.032%209.156l-.146-.492c-.276-1.02-.395-2.457-.444-3.268a6.11%206.11%200%200%201-1.18.115%206.01%206.01%200%200%201-2.536-.562l.006.175c.802.215%201.848.612%202.021%201.25.079.295-.021.601-.274.837l-.598.501c.667.304%201.243.698%201.311%201.179.02.144.022.507-.393.787l-.564.365c1.285.521%201.361.96%201.381%201.126.018.142.011.496-.427.746l-.854.489c.064-1.19%201.985-2.585%202.697-3.248zM49.34%209.925c0-.667%201-.667%201%200%200%20.653.818%201.205%201.787%201.205s1.787-.552%201.787-1.205c0-.667%201-.667%201%200%200%201.216-1.25%202.205-2.787%202.205s-2.787-.989-2.787-2.205zm-.887-7.633c-.093.077-.205.114-.317.114a.5.5%200%200%201-.318-.886L49.183.397a.5.5%200%200%201%20.703.068.5.5%200%200%201-.069.703zm7.661-.065c-.086%200-.173-.022-.253-.068l-1.523-.893c-.575-.337-.069-1.2.506-.863l1.523.892a.5.5%200%200%201%20.179.685c-.094.158-.261.247-.432.247z%22%20fill%3D%22%233bb300%22/%3E%3C/svg%3E"/>


<style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
<style>pre{line-height:125%;}td.linenos pre{color:#ff5555;background-color:#282a36;padding-left:5px;padding-right:5px;}span.linenos{color:#ff5555;background-color:#282a36;padding-left:5px;padding-right:5px;}td.linenos pre.special{color:#ff5555;background-color:#ffffc0;padding-left:5px;padding-right:5px;}span.linenos.special{color:#ff5555;background-color:#ffffc0;padding-left:5px;padding-right:5px;}.pdoc .hll{background-color:#282a36;}.pdoc{background:#282a36;color:#ff5555;}.pdoc .c{color:#6a7aaa;}.pdoc .err{color:#ff5555;background-color:#1e0010;}.pdoc .k{color:#ff79c6;}.pdoc .l{color:#ae81ff;}.pdoc .n{color:#f8f8f2;}.pdoc .o{color:#ff79c6;}.pdoc .p{color:#f8f8f2;}.pdoc .ch{color:#6a7aaa;}.pdoc .cm{color:#6a7aaa;}.pdoc .cp{color:#6a7aaa;}.pdoc .cpf{color:#6a7aaa;}.pdoc .c1{color:#6a7aaa;}.pdoc .cs{color:#6a7aaa;}.pdoc .gd{color:#6a7aaa;}.pdoc .ge{font-style:italic;}.pdoc .gi{color:#a6e22e;}.pdoc .go{color:#ff79c6;}.pdoc .gp{color:#f92672;font-weight:bold;}.pdoc .gs{font-weight:bold;}.pdoc .gu{color:#75715e;}.pdoc .kc{color:#ff79c6;}.pdoc .kd{color:#bd93f9;}.pdoc .kn{color:#ff79c6;}.pdoc .kp{color:#bd93f9;}.pdoc .kr{color:#ff79c6;}.pdoc .kt{color:#ff79c6;}.pdoc .ld{color:#e6db74;}.pdoc .m{color:#ae81ff;}.pdoc .s{color:#e6db74;}.pdoc .na{color:#a6e22e;}.pdoc .nb{color:#8be9fd;}.pdoc .nc{color:#8be9fd;}.pdoc .no{color:#ff79c6;}.pdoc .nd{color:#8be9fd;}.pdoc .ni{color:#ff79c6;}.pdoc .ne{color:#8be9fd;}.pdoc .nf{color:#50fa7b;}.pdoc .nl{color:#f8f8f2;}.pdoc .nn{color:#f8f8f2;}.pdoc .nx{color:#a6e22e;}.pdoc .py{color:#f8f8f2;}.pdoc .nt{color:#f92672;}.pdoc .nv{color:#f8f8f2;}.pdoc .ow{color:#ff79c6;}.pdoc .w{color:#f8f8f2;}.pdoc .mb{color:#ae81ff;}.pdoc .mf{color:#ae81ff;}.pdoc .mh{color:#ae81ff;}.pdoc .mi{color:#ae81ff;}.pdoc .mo{color:#ae81ff;}.pdoc .sa{color:#ff79c6;}.pdoc .sb{color:#e6db74;}.pdoc .sc{color:#e6db74;}.pdoc .dl{color:#e6db74;}.pdoc .sd{color:#6272a4;}.pdoc .s2{color:#e6db74;}.pdoc .se{color:#ae81ff;}.pdoc .sh{color:#e6db74;}.pdoc .si{color:#bd93f9;}.pdoc .sx{color:#e6db74;}.pdoc .sr{color:#e6db74;}.pdoc .s1{color:#e6db74;}.pdoc .ss{color:#e6db74;}.pdoc .bp{color:#bd93f9;}.pdoc .fm{color:#bd93f9;}.pdoc .vc{color:#bd93f9;}.pdoc .vg{color:#f8f8f2;}.pdoc .vi{color:#ffffff;}.pdoc .vm{color:#bd93f9;}.pdoc .il{color:#ae81ff;}.pdoc .nd{color:#50fa7b;}*{font-family:SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}.pdoc .classattr{color:#fff;}.pdoc p{color:#fff;font-weight:300;}.pdoc .modulename{color:#fff;font-weight:0;margin:0.3em 0;padding:0.2em 0;}.pdoc h5{color:white;font-style:italic;}nav.pdoc a.function{color:#4dec75;}nav.pdoc a.variable{color:white;}nav.pdoc a.class{color:#8be9fd;}nav.pdoc a.class:hover{color:#fff;}nav.pdoc li a{color:#bd93f9;}.pdoc span.default_value{color:#e6db74;}.pdoc .attr{color:white;}.pdoc h6#attributes{color:#fff;font-size:23px;}.pdoc h6#example{color:#fff;font-size:29px;}.pdoc h6#examples{color:#fff;font-size:29px;}.pdoc h6#notes{font-size:23px;color:orange;}.pdoc h6#warnings{font-size:23px;color:orange;}.pdoc h6#returns{font-size:23px;color:white;}.pdoc h6#parameters{font-size:23px;color:white;}.pdoc h6#other-parameters{font-size:23px;color:white;}.pdoc h6#raises{font-size:23px;color:#ff6666;}.pdoc .kc{color:#bd93f9;}.pdoc li{color:white;}.pdoc div.decorator{color:#50fa7b;}.pdoc strong,b{color:rgb(244, 90, 177);font-weight:normal;}.pdoc em{color:orange;}.pdoc span.name{color:#8be9fd;}.pdoc span.base{color:#8be9fd;}.pdoc span.def{font-weight:normal;}.pdoc .inherited dt,.pdoc .inherited dt::before{color:#8be9fd;}.pdoc .inherited dd,.pdoc .inherited dd{color:#fff;}.pdoc .inherited dd:not(:last-child)::after{color:#fff;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;margin-bottom:1rem;color:white;border-color:white;}nav.pdoc .module-list-button:hover{border-color:white;color:white;}.pdoc h1,.pdoc h2,.pdoc h3{font-weight:300;margin:0.3em 0;padding:0.2em 0;color:white;}</style>
<style>/*! pdoc */:root{--pdoc-background:#272935;}.pdoc{--text:white;--muted:#9d9d9d;--link:#bd93f9;--link-hover:white;--active:#555;--code:#232627;--accent:#232627;--accent2:#FFF;--nav-hover:rgba(0, 0, 0, 0.1);--name:#50fa7b;--def:rgb(244, 90, 177);--annotation:white;}body{background-color:var(--pdoc-background);}html, body{width:100%;height:100%;}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}.git-button{display:none !important;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}#navtoggle{display:none;}}#togglestate{display:none;}nav.pdoc{--pad:1.75rem;--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc li{display:block;margin:0;padding:.2rem 0 .2rem var(--indent);transition:all 100ms;}nav.pdoc > div > ul > li{padding-left:0;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}html, main{scroll-behavior:smooth;}.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{background-color:var(--code);border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.pdoc details{--shift:-40px;text-align:right;margin-top:var(--shift);margin-bottom:calc(0px - var(--shift));clear:both;filter:opacity(1);}.pdoc details:not([open]){height:0;overflow:visible;}.pdoc details > summary{font-size:.75rem;cursor:pointer;color:var(--muted);border-width:0;padding:0 .7em;display:inline-block;display:inline list-item;user-select:none;}.pdoc details > summary:focus{outline:0;}.pdoc details > div{margin-top:calc(0px - var(--shift) / 2);text-align:left;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc > section:first-of-type > .docstring{margin-bottom:3rem;}.pdoc .docstring pre{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc .headerlink{position:absolute;width:0;margin-left:-1.5rem;line-height:1.4rem;font-size:1.5rem;font-weight:normal;transition:all 100ms ease-in-out;opacity:0;}.pdoc .attr > .headerlink{margin-left:-2.5rem;}.pdoc *:hover > .headerlink,.pdoc *:target > .attr > .headerlink{opacity:1;}.pdoc .attr{display:block;color:var(--text);margin:1rem 0 .5rem;padding:.4rem 5rem .4rem 1rem;background-color:var(--accent);}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{white-space:pre-wrap;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}</style>
</head>
<body>        <nav class="pdoc">
            <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
            <input id="togglestate" type="checkbox">
            <div>
                        <a class="pdoc-button module-list-button" href="index.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                            &nbsp;
                            Module Index
                        </a>


                        <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                               pattern=".+" required>

                    <h2>Contents</h2>
                    <ul>
  <li><a href="#examples">Examples</a></li>
</ul>


                    <h2>Submodules</h2>
                    <ul>
                            <li><a href="tanjun/abc.html">tanjun.abc</a></li>
                            <li><a href="tanjun/checks.html">tanjun.checks</a></li>
                            <li><a href="tanjun/clients.html">tanjun.clients</a></li>
                            <li><a href="tanjun/commands.html">tanjun.commands</a></li>
                            <li><a href="tanjun/components.html">tanjun.components</a></li>
                            <li><a href="tanjun/context.html">tanjun.context</a></li>
                            <li><a href="tanjun/conversion.html">tanjun.conversion</a></li>
                            <li><a href="tanjun/dependencies.html">tanjun.dependencies</a></li>
                            <li><a href="tanjun/errors.html">tanjun.errors</a></li>
                            <li><a href="tanjun/hooks.html">tanjun.hooks</a></li>
                            <li><a href="tanjun/injecting.html">tanjun.injecting</a></li>
                            <li><a href="tanjun/parsing.html">tanjun.parsing</a></li>
                            <li><a href="tanjun/utilities.html">tanjun.utilities</a></li>
                    </ul>

                    <h2>API Documentation</h2>
                        <ul class="memberlist">
            <li>
                    <a class="variable" href="#__author__">__author__</a>
            </li>
            <li>
                    <a class="variable" href="#__ci__">__ci__</a>
            </li>
            <li>
                    <a class="variable" href="#__copyright__">__copyright__</a>
            </li>
            <li>
                    <a class="variable" href="#__coverage__">__coverage__</a>
            </li>
            <li>
                    <a class="variable" href="#__docs__">__docs__</a>
            </li>
            <li>
                    <a class="variable" href="#__email__">__email__</a>
            </li>
            <li>
                    <a class="variable" href="#__issue_tracker__">__issue_tracker__</a>
            </li>
            <li>
                    <a class="variable" href="#__license__">__license__</a>
            </li>
            <li>
                    <a class="variable" href="#__url__">__url__</a>
            </li>
            <li>
                    <a class="variable" href="#__version__">__version__</a>
            </li>
            <li>
                    <a class="module" href="#abc">abc</a>
            </li>
            <li>
                    <a class="module" href="#checks">checks</a>
            </li>
            <li>
                    <a class="function" href="#with_check">with_check</a>
            </li>
            <li>
                    <a class="function" href="#with_dm_check">with_dm_check</a>
            </li>
            <li>
                    <a class="function" href="#with_guild_check">with_guild_check</a>
            </li>
            <li>
                    <a class="function" href="#with_nsfw_check">with_nsfw_check</a>
            </li>
            <li>
                    <a class="function" href="#with_sfw_check">with_sfw_check</a>
            </li>
            <li>
                    <a class="function" href="#with_owner_check">with_owner_check</a>
            </li>
            <li>
                    <a class="function" href="#with_author_permission_check">with_author_permission_check</a>
            </li>
            <li>
                    <a class="function" href="#with_own_permission_check">with_own_permission_check</a>
            </li>
            <li>
                    <a class="module" href="#clients">clients</a>
            </li>
            <li>
                    <a class="function" href="#as_loader">as_loader</a>
            </li>
            <li>
                    <a class="function" href="#as_unloader">as_unloader</a>
            </li>
            <li>
                    <a class="class" href="#Client">Client</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Client.__init__">Client</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.from_gateway_bot">from_gateway_bot</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.from_rest_bot">from_rest_bot</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.defaults_to_ephemeral">defaults_to_ephemeral</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.message_accepts">message_accepts</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.is_human_only">is_human_only</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.cache">cache</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.checks">checks</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.components">components</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.events">events</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.listeners">listeners</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.hooks">hooks</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.slash_hooks">slash_hooks</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.is_alive">is_alive</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.message_hooks">message_hooks</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.metadata">metadata</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.prefix_getter">prefix_getter</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.prefixes">prefixes</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.rest">rest</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.server">server</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.shards">shards</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.voice">voice</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.clear_slash_commands">clear_slash_commands</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_global_commands">set_global_commands</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.declare_global_commands">declare_global_commands</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.declare_slash_command">declare_slash_command</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.declare_slash_commands">declare_slash_commands</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_auto_defer_after">set_auto_defer_after</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_ephemeral_default">set_ephemeral_default</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_hikari_trait_injectors">set_hikari_trait_injectors</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_interaction_not_found">set_interaction_not_found</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_message_accepts">set_message_accepts</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_message_ctx_maker">set_message_ctx_maker</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_slash_ctx_maker">set_slash_ctx_maker</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_human_only">set_human_only</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.add_check">add_check</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.remove_check">remove_check</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.with_check">with_check</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.check">check</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.add_component">add_component</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.get_component_by_name">get_component_by_name</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.remove_component">remove_component</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.remove_component_by_name">remove_component_by_name</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.add_client_callback">add_client_callback</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.dispatch_client_callback">dispatch_client_callback</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.get_client_callbacks">get_client_callbacks</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.remove_client_callback">remove_client_callback</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.with_client_callback">with_client_callback</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.add_listener">add_listener</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.remove_listener">remove_listener</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.with_listener">with_listener</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.add_prefix">add_prefix</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.remove_prefix">remove_prefix</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_prefix_getter">set_prefix_getter</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.with_prefix_getter">with_prefix_getter</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.iter_commands">iter_commands</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.iter_message_commands">iter_message_commands</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.iter_slash_commands">iter_slash_commands</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.check_message_name">check_message_name</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.check_slash_name">check_slash_name</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.close">close</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.open">open</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.fetch_rest_application_id">fetch_rest_application_id</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_hooks">set_hooks</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_slash_hooks">set_slash_hooks</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_message_hooks">set_message_hooks</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.load_modules">load_modules</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.unload_modules">unload_modules</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.reload_modules">reload_modules</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.on_message_create_event">on_message_create_event</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.on_interaction_create_event">on_interaction_create_event</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.on_interaction_create_request">on_interaction_create_request</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ClientCallbackNames">ClientCallbackNames</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#ClientCallbackNames.CLOSED">CLOSED</a>
                        </li>
                        <li>
                                <a class="variable" href="#ClientCallbackNames.CLOSING">CLOSING</a>
                        </li>
                        <li>
                                <a class="variable" href="#ClientCallbackNames.COMPONENT_ADDED">COMPONENT_ADDED</a>
                        </li>
                        <li>
                                <a class="variable" href="#ClientCallbackNames.COMPONENT_REMOVED">COMPONENT_REMOVED</a>
                        </li>
                        <li>
                                <a class="variable" href="#ClientCallbackNames.MESSAGE_COMMAND_NOT_FOUND">MESSAGE_COMMAND_NOT_FOUND</a>
                        </li>
                        <li>
                                <a class="variable" href="#ClientCallbackNames.SLASH_COMMAND_NOT_FOUND">SLASH_COMMAND_NOT_FOUND</a>
                        </li>
                        <li>
                                <a class="variable" href="#ClientCallbackNames.STARTED">STARTED</a>
                        </li>
                        <li>
                                <a class="variable" href="#ClientCallbackNames.STARTING">STARTING</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MessageAcceptsEnum">MessageAcceptsEnum</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#MessageAcceptsEnum.ALL">ALL</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageAcceptsEnum.DM_ONLY">DM_ONLY</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageAcceptsEnum.GUILD_ONLY">GUILD_ONLY</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageAcceptsEnum.NONE">NONE</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageAcceptsEnum.get_event_type">get_event_type</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="module" href="#commands">commands</a>
            </li>
            <li>
                    <a class="function" href="#as_message_command">as_message_command</a>
            </li>
            <li>
                    <a class="function" href="#as_message_command_group">as_message_command_group</a>
            </li>
            <li>
                    <a class="function" href="#as_slash_command">as_slash_command</a>
            </li>
            <li>
                    <a class="function" href="#slash_command_group">slash_command_group</a>
            </li>
            <li>
                    <a class="class" href="#MessageCommand">MessageCommand</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MessageCommand.__init__">MessageCommand</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageCommand.callback">callback</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageCommand.names">names</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageCommand.needs_injector">needs_injector</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageCommand.parent">parent</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageCommand.parser">parser</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageCommand.bind_client">bind_client</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageCommand.bind_component">bind_component</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageCommand.copy">copy</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageCommand.set_parent">set_parent</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageCommand.set_parser">set_parser</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageCommand.check_context">check_context</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageCommand.execute">execute</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageCommand.load_into_component">load_into_component</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MessageCommandGroup">MessageCommandGroup</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MessageCommandGroup.__init__">MessageCommandGroup</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageCommandGroup.commands">commands</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageCommandGroup.is_strict">is_strict</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageCommandGroup.copy">copy</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageCommandGroup.add_command">add_command</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageCommandGroup.remove_command">remove_command</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageCommandGroup.with_command">with_command</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageCommandGroup.bind_client">bind_client</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageCommandGroup.bind_component">bind_component</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageCommandGroup.find_command">find_command</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageCommandGroup.execute">execute</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageCommandGroup.load_into_component">load_into_component</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SlashCommand">SlashCommand</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SlashCommand.__init__">SlashCommand</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashCommand.callback">callback</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashCommand.needs_injector">needs_injector</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommand.bind_client">bind_client</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommand.build">build</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommand.add_str_option">add_str_option</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommand.add_int_option">add_int_option</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommand.add_float_option">add_float_option</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommand.add_bool_option">add_bool_option</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommand.add_user_option">add_user_option</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommand.add_member_option">add_member_option</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommand.add_channel_option">add_channel_option</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommand.add_role_option">add_role_option</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommand.add_mentionable_option">add_mentionable_option</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommand.execute">execute</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommand.copy">copy</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommand.load_into_component">load_into_component</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SlashCommandGroup">SlashCommandGroup</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SlashCommandGroup.__init__">SlashCommandGroup</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashCommandGroup.commands">commands</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommandGroup.build">build</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommandGroup.copy">copy</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommandGroup.add_command">add_command</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommandGroup.remove_command">remove_command</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommandGroup.with_command">with_command</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommandGroup.execute">execute</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashCommandGroup.load_into_component">load_into_component</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#with_str_slash_option">with_str_slash_option</a>
            </li>
            <li>
                    <a class="function" href="#with_int_slash_option">with_int_slash_option</a>
            </li>
            <li>
                    <a class="function" href="#with_float_slash_option">with_float_slash_option</a>
            </li>
            <li>
                    <a class="function" href="#with_bool_slash_option">with_bool_slash_option</a>
            </li>
            <li>
                    <a class="function" href="#with_role_slash_option">with_role_slash_option</a>
            </li>
            <li>
                    <a class="function" href="#with_user_slash_option">with_user_slash_option</a>
            </li>
            <li>
                    <a class="function" href="#with_member_slash_option">with_member_slash_option</a>
            </li>
            <li>
                    <a class="function" href="#with_channel_slash_option">with_channel_slash_option</a>
            </li>
            <li>
                    <a class="function" href="#with_mentionable_slash_option">with_mentionable_slash_option</a>
            </li>
            <li>
                    <a class="module" href="#components">components</a>
            </li>
            <li>
                    <a class="class" href="#Component">Component</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Component.__init__">Component</a>
                        </li>
                        <li>
                                <a class="variable" href="#Component.checks">checks</a>
                        </li>
                        <li>
                                <a class="variable" href="#Component.client">client</a>
                        </li>
                        <li>
                                <a class="variable" href="#Component.defaults_to_ephemeral">defaults_to_ephemeral</a>
                        </li>
                        <li>
                                <a class="variable" href="#Component.hooks">hooks</a>
                        </li>
                        <li>
                                <a class="variable" href="#Component.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#Component.slash_commands">slash_commands</a>
                        </li>
                        <li>
                                <a class="variable" href="#Component.slash_hooks">slash_hooks</a>
                        </li>
                        <li>
                                <a class="variable" href="#Component.message_commands">message_commands</a>
                        </li>
                        <li>
                                <a class="variable" href="#Component.message_hooks">message_hooks</a>
                        </li>
                        <li>
                                <a class="variable" href="#Component.needs_injector">needs_injector</a>
                        </li>
                        <li>
                                <a class="variable" href="#Component.listeners">listeners</a>
                        </li>
                        <li>
                                <a class="variable" href="#Component.metadata">metadata</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.copy">copy</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.detect_commands">detect_commands</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.set_ephemeral_default">set_ephemeral_default</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.set_slash_hooks">set_slash_hooks</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.set_message_hooks">set_message_hooks</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.set_hooks">set_hooks</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.add_check">add_check</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.remove_check">remove_check</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.with_check">with_check</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.add_client_callback">add_client_callback</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.get_client_callbacks">get_client_callbacks</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.remove_client_callback">remove_client_callback</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.with_client_callback">with_client_callback</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.add_command">add_command</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.remove_command">remove_command</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.with_command">with_command</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.add_slash_command">add_slash_command</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.remove_slash_command">remove_slash_command</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.with_slash_command">with_slash_command</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.add_message_command">add_message_command</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.remove_message_command">remove_message_command</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.with_message_command">with_message_command</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.add_listener">add_listener</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.remove_listener">remove_listener</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.with_listener">with_listener</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.bind_client">bind_client</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.unbind_client">unbind_client</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.check_message_name">check_message_name</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.check_slash_name">check_slash_name</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.execute_interaction">execute_interaction</a>
                        </li>
                        <li>
                                <a class="function" href="#Component.execute_message">execute_message</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="module" href="#context">context</a>
            </li>
            <li>
                    <a class="class" href="#MessageContext">MessageContext</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MessageContext.__init__">MessageContext</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageContext.author">author</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageContext.channel_id">channel_id</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageContext.command">command</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageContext.content">content</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageContext.created_at">created_at</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageContext.guild_id">guild_id</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageContext.has_responded">has_responded</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageContext.is_human">is_human</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageContext.member">member</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageContext.message">message</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageContext.triggering_name">triggering_name</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageContext.triggering_prefix">triggering_prefix</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageContext.shard">shard</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageContext.set_command">set_command</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageContext.set_content">set_content</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageContext.set_triggering_name">set_triggering_name</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageContext.set_triggering_prefix">set_triggering_prefix</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageContext.delete_initial_response">delete_initial_response</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageContext.delete_last_response">delete_last_response</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageContext.edit_initial_response">edit_initial_response</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageContext.edit_last_response">edit_last_response</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageContext.fetch_initial_response">fetch_initial_response</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageContext.fetch_last_response">fetch_last_response</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageContext.respond">respond</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SlashContext">SlashContext</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SlashContext.__init__">SlashContext</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashContext.author">author</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashContext.channel_id">channel_id</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashContext.client">client</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashContext.command">command</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashContext.created_at">created_at</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashContext.defaults_to_ephemeral">defaults_to_ephemeral</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashContext.expires_at">expires_at</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashContext.guild_id">guild_id</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashContext.has_been_deferred">has_been_deferred</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashContext.has_responded">has_responded</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashContext.is_human">is_human</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashContext.member">member</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashContext.triggering_name">triggering_name</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashContext.interaction">interaction</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashContext.options">options</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashContext.cancel_defer">cancel_defer</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashContext.get_response_future">get_response_future</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashContext.mark_not_found">mark_not_found</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashContext.start_defer_timer">start_defer_timer</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashContext.set_command">set_command</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashContext.set_ephemeral_default">set_ephemeral_default</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashContext.defer">defer</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashContext.create_followup">create_followup</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashContext.create_initial_response">create_initial_response</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashContext.delete_initial_response">delete_initial_response</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashContext.delete_last_response">delete_last_response</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashContext.edit_initial_response">edit_initial_response</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashContext.edit_last_response">edit_last_response</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashContext.fetch_initial_response">fetch_initial_response</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashContext.fetch_last_response">fetch_last_response</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashContext.respond">respond</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SlashOption">SlashOption</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SlashOption.__init__">SlashOption</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashOption.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashOption.type">type</a>
                        </li>
                        <li>
                                <a class="variable" href="#SlashOption.value">value</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashOption.resolve_value">resolve_value</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashOption.resolve_to_channel">resolve_to_channel</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashOption.resolve_to_member">resolve_to_member</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashOption.resolve_to_mentionable">resolve_to_mentionable</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashOption.resolve_to_role">resolve_to_role</a>
                        </li>
                        <li>
                                <a class="function" href="#SlashOption.resolve_to_user">resolve_to_user</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="module" href="#conversion">conversion</a>
            </li>
            <li>
                    <a class="function" href="#to_bool">to_bool</a>
            </li>
            <li>
                    <a class="variable" href="#to_channel">to_channel</a>
            </li>
            <li>
                    <a class="function" href="#to_color">to_color</a>
            </li>
            <li>
                    <a class="function" href="#to_colour">to_colour</a>
            </li>
            <li>
                    <a class="function" href="#to_datetime">to_datetime</a>
            </li>
            <li>
                    <a class="variable" href="#to_emoji">to_emoji</a>
            </li>
            <li>
                    <a class="variable" href="#to_guild">to_guild</a>
            </li>
            <li>
                    <a class="variable" href="#to_invite">to_invite</a>
            </li>
            <li>
                    <a class="variable" href="#to_invite_with_metadata">to_invite_with_metadata</a>
            </li>
            <li>
                    <a class="variable" href="#to_member">to_member</a>
            </li>
            <li>
                    <a class="variable" href="#to_presence">to_presence</a>
            </li>
            <li>
                    <a class="variable" href="#to_role">to_role</a>
            </li>
            <li>
                    <a class="function" href="#to_snowflake">to_snowflake</a>
            </li>
            <li>
                    <a class="variable" href="#to_user">to_user</a>
            </li>
            <li>
                    <a class="variable" href="#to_voice_state">to_voice_state</a>
            </li>
            <li>
                    <a class="module" href="#dependencies">dependencies</a>
            </li>
            <li>
                    <a class="function" href="#cached_inject">cached_inject</a>
            </li>
            <li>
                    <a class="function" href="#inject_lc">inject_lc</a>
            </li>
            <li>
                    <a class="class" href="#LazyConstant">LazyConstant</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#LazyConstant.__init__">LazyConstant</a>
                        </li>
                        <li>
                                <a class="variable" href="#LazyConstant.callback">callback</a>
                        </li>
                        <li>
                                <a class="function" href="#LazyConstant.get_value">get_value</a>
                        </li>
                        <li>
                                <a class="function" href="#LazyConstant.reset">reset</a>
                        </li>
                        <li>
                                <a class="function" href="#LazyConstant.set_value">set_value</a>
                        </li>
                        <li>
                                <a class="function" href="#LazyConstant.acquire">acquire</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="module" href="#errors">errors</a>
            </li>
            <li>
                    <a class="class" href="#CommandError">CommandError</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CommandError.__init__">CommandError</a>
                        </li>
                        <li>
                                <a class="variable" href="#CommandError.message">message</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ConversionError">ConversionError</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ConversionError.__init__">ConversionError</a>
                        </li>
                        <li>
                                <a class="variable" href="#ConversionError.errors">errors</a>
                        </li>
                        <li>
                                <a class="variable" href="#ConversionError.parameter">parameter</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#HaltExecution">HaltExecution</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#FailedCheck">FailedCheck</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#MissingDependencyError">MissingDependencyError</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MissingDependencyError.__init__">MissingDependencyError</a>
                        </li>
                        <li>
                                <a class="variable" href="#MissingDependencyError.message">message</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#NotEnoughArgumentsError">NotEnoughArgumentsError</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#NotEnoughArgumentsError.__init__">NotEnoughArgumentsError</a>
                        </li>
                        <li>
                                <a class="variable" href="#NotEnoughArgumentsError.parameter">parameter</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TooManyArgumentsError">TooManyArgumentsError</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TooManyArgumentsError.__init__">TooManyArgumentsError</a>
                        </li>
                        <li>
                                <a class="variable" href="#TooManyArgumentsError.parameter">parameter</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ParserError">ParserError</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ParserError.__init__">ParserError</a>
                        </li>
                        <li>
                                <a class="variable" href="#ParserError.message">message</a>
                        </li>
                        <li>
                                <a class="variable" href="#ParserError.parameter">parameter</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TanjunError">TanjunError</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#TanjunWarning">TanjunWarning</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#StateWarning">StateWarning</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="module" href="#hooks">hooks</a>
            </li>
            <li>
                    <a class="variable" href="#AnyHooks">AnyHooks</a>
            </li>
            <li>
                    <a class="class" href="#Hooks">Hooks</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Hooks.__init__">Hooks</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.add_to_command">add_to_command</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.copy">copy</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.add_on_error">add_on_error</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.set_on_error">set_on_error</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.with_on_error">with_on_error</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.add_on_parser_error">add_on_parser_error</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.set_on_parser_error">set_on_parser_error</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.with_on_parser_error">with_on_parser_error</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.add_post_execution">add_post_execution</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.set_post_execution">set_post_execution</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.with_post_execution">with_post_execution</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.add_pre_execution">add_pre_execution</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.set_pre_execution">set_pre_execution</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.with_pre_execution">with_pre_execution</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.add_on_success">add_on_success</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.set_on_success">set_on_success</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.with_on_success">with_on_success</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.trigger_error">trigger_error</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.trigger_post_execution">trigger_post_execution</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.trigger_pre_execution">trigger_pre_execution</a>
                        </li>
                        <li>
                                <a class="function" href="#Hooks.trigger_success">trigger_success</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#MessageHooks">MessageHooks</a>
            </li>
            <li>
                    <a class="variable" href="#SlashHooks">SlashHooks</a>
            </li>
            <li>
                    <a class="module" href="#injecting">injecting</a>
            </li>
            <li>
                    <a class="function" href="#as_self_injecting">as_self_injecting</a>
            </li>
            <li>
                    <a class="function" href="#inject">inject</a>
            </li>
            <li>
                    <a class="module" href="#parsing">parsing</a>
            </li>
            <li>
                    <a class="class" href="#ShlexParser">ShlexParser</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ShlexParser.__init__">ShlexParser</a>
                        </li>
                        <li>
                                <a class="variable" href="#ShlexParser.needs_injector">needs_injector</a>
                        </li>
                        <li>
                                <a class="variable" href="#ShlexParser.parameters">parameters</a>
                        </li>
                        <li>
                                <a class="function" href="#ShlexParser.copy">copy</a>
                        </li>
                        <li>
                                <a class="function" href="#ShlexParser.add_parameter">add_parameter</a>
                        </li>
                        <li>
                                <a class="function" href="#ShlexParser.remove_parameter">remove_parameter</a>
                        </li>
                        <li>
                                <a class="function" href="#ShlexParser.add_argument">add_argument</a>
                        </li>
                        <li>
                                <a class="function" href="#ShlexParser.add_option">add_option</a>
                        </li>
                        <li>
                                <a class="function" href="#ShlexParser.set_parameters">set_parameters</a>
                        </li>
                        <li>
                                <a class="function" href="#ShlexParser.bind_client">bind_client</a>
                        </li>
                        <li>
                                <a class="function" href="#ShlexParser.bind_component">bind_component</a>
                        </li>
                        <li>
                                <a class="function" href="#ShlexParser.parse">parse</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#with_argument">with_argument</a>
            </li>
            <li>
                    <a class="function" href="#with_greedy_argument">with_greedy_argument</a>
            </li>
            <li>
                    <a class="function" href="#with_multi_argument">with_multi_argument</a>
            </li>
            <li>
                    <a class="function" href="#with_option">with_option</a>
            </li>
            <li>
                    <a class="function" href="#with_multi_option">with_multi_option</a>
            </li>
            <li>
                    <a class="function" href="#with_parser">with_parser</a>
            </li>
            <li>
                    <a class="module" href="#utilities">utilities</a>
            </li>
    </ul>



                    <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev">
                        built with <span class="visually-hidden">pdoc</span><img
                            alt="pdoc logo"
                            src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
                    </a>
            </div>
        </nav>
    <main class="pdoc">
            <section>
                    <h1 class="modulename">
tanjun    </h1>

                        <div class="docstring"><p>A flexible command framework designed to extend Hikari.</p>

<h6 id="examples">Examples</h6>

<p>A Tanjun client can be quickly initialised from a Hikari gateway bot through
<code><a href="#Client.from_gateway_bot">tanjun.Client.from_gateway_bot</a></code>, this enables both slash (interaction) and message
command execution:</p>

<div class="codehilite"><pre><span></span><code><span class="n">bot</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">GatewayBot</span><span class="p">(</span><span class="s2">&quot;BOT_TOKEN&quot;</span><span class="p">)</span>

<span class="c1"># As a note, unless event_managed=False is passed here then this client</span>
<span class="c1"># will be managed based on gateway startup and stopping events.</span>
<span class="c1"># mention_prefix=True instructs the client to also set mention prefixes on the</span>
<span class="c1"># first startup.</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">from_gateway_bot</span><span class="p">(</span><span class="n">bot</span><span class="p">,</span> <span class="n">declare_global_commands</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mention_prefix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">component</span> <span class="o">=</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">Component</span><span class="p">()</span>
<span class="n">client</span><span class="o">.</span><span class="n">add_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

<span class="c1"># Declare a message command with some basic parser logic.</span>
<span class="nd">@component</span><span class="o">.</span><span class="n">with_command</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">with_greedy_argument</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;World&quot;</span><span class="p">)</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">with_parser</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">as_message_command</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">test_command</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hello, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>

<span class="c1"># Declare a ping slash command</span>
<span class="nd">@component</span><span class="o">.</span><span class="n">with_command</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">with_user_slash_option</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;The user facing command option&#39;s description&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">as_slash_command</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;The command&#39;s user facing description&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">user</span> <span class="ow">or</span> <span class="n">ctx</span><span class="o">.</span><span class="n">author</span>
    <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hello, </span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Alternatively, the client can also be built from a RESTBot but this will only
enable slash (interaction) command execution:</p>

<div class="codehilite"><pre><span></span><code><span class="n">bot</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">RESTBot</span><span class="p">(</span><span class="s2">&quot;BOT_TOKEN&quot;</span><span class="p">,</span> <span class="s2">&quot;Bot&quot;</span><span class="p">)</span>

<span class="c1"># declare_global_commands=True instructs the client to set the global commands</span>
<span class="c1"># for the relevant bot on first startup (this will replace any previously</span>
<span class="c1"># declared commands).</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">from_rest_bot</span><span class="p">(</span><span class="n">bot</span><span class="p">,</span> <span class="n">declare_global_commands</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># This will load components from modules based on loader functions.</span>
<span class="c1"># For more information on this see `<a href="#as_loader">tanjun.as_loader</a>`.</span>
<span class="n">client</span><span class="o">.</span><span class="n">load_modules</span><span class="p">(</span><span class="s2">&quot;module.paths&quot;</span><span class="p">)</span>

<span class="c1"># Note, unlike a gateway bound bot, the rest bot will not automatically start</span>
<span class="c1"># itself due to the lack of Hikari lifetime events in this environment and</span>
<span class="c1"># will have to be started after the Hikari client.</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">bot</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">async</span> <span class="k">with</span> <span class="n">client</span><span class="o">.</span><span class="n">open</span><span class="p">():</span>
        <span class="k">await</span> <span class="n">bot</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</code></pre></div>

<p>For more extensive examples see the
<a href="https://github.com/FasterSpeeding/Tanjun/tree/master/examples">repository's examples</a>.</p>
</div>

                        <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;A flexible command framework designed to extend Hikari.</span>

<span class="sd">Examples</span>
<span class="sd">--------</span>
<span class="sd">A Tanjun client can be quickly initialised from a Hikari gateway bot through</span>
<span class="sd">`tanjun.Client.from_gateway_bot`, this enables both slash (interaction) and message</span>
<span class="sd">command execution:</span>

<span class="sd">```py</span>
<span class="sd">bot = hikari.GatewayBot(&quot;BOT_TOKEN&quot;)</span>

<span class="sd"># As a note, unless event_managed=False is passed here then this client</span>
<span class="sd"># will be managed based on gateway startup and stopping events.</span>
<span class="sd"># mention_prefix=True instructs the client to also set mention prefixes on the</span>
<span class="sd"># first startup.</span>
<span class="sd">client = tanjun.Client.from_gateway_bot(bot, declare_global_commands=True, mention_prefix=True)</span>

<span class="sd">component = tanjun.Component()</span>
<span class="sd">client.add_component(component)</span>

<span class="sd"># Declare a message command with some basic parser logic.</span>
<span class="sd">@component.with_command</span>
<span class="sd">@tanjun.with_greedy_argument(&quot;name&quot;, default=&quot;World&quot;)</span>
<span class="sd">@tanjun.with_parser</span>
<span class="sd">@tanjun.as_message_command(&quot;test&quot;)</span>
<span class="sd">async def test_command(ctx: tanjun.abc.Context, name: str) -&gt; None:</span>
<span class="sd">    await ctx.respond(f&quot;Hello, {name}!&quot;)</span>

<span class="sd"># Declare a ping slash command</span>
<span class="sd">@component.with_command</span>
<span class="sd">@tanjun.with_user_slash_option(&quot;user&quot;, &quot;The user facing command option&#39;s description&quot;, default=None)</span>
<span class="sd">@tanjun.as_slash_command(&quot;hello&quot;, &quot;The command&#39;s user facing description&quot;)</span>
<span class="sd">async def hello(ctx: tanjun.abc.Context, user: typing.Optional[hikari.User]) -&gt; None:</span>
<span class="sd">    user = user or ctx.author</span>
<span class="sd">    await ctx.respond(f&quot;Hello, {user}!&quot;)</span>
<span class="sd">```</span>

<span class="sd">Alternatively, the client can also be built from a RESTBot but this will only</span>
<span class="sd">enable slash (interaction) command execution:</span>

<span class="sd">```py</span>
<span class="sd">bot = hikari.RESTBot(&quot;BOT_TOKEN&quot;, &quot;Bot&quot;)</span>

<span class="sd"># declare_global_commands=True instructs the client to set the global commands</span>
<span class="sd"># for the relevant bot on first startup (this will replace any previously</span>
<span class="sd"># declared commands).</span>
<span class="sd">client = tanjun.Client.from_rest_bot(bot, declare_global_commands=True)</span>

<span class="sd"># This will load components from modules based on loader functions.</span>
<span class="sd"># For more information on this see `tanjun.as_loader`.</span>
<span class="sd">client.load_modules(&quot;module.paths&quot;)</span>

<span class="sd"># Note, unlike a gateway bound bot, the rest bot will not automatically start</span>
<span class="sd"># itself due to the lack of Hikari lifetime events in this environment and</span>
<span class="sd"># will have to be started after the Hikari client.</span>
<span class="sd">async def main() -&gt; None:</span>
<span class="sd">    await bot.start()</span>
<span class="sd">    async with client.open():</span>
<span class="sd">        await bot.join()</span>
<span class="sd">```</span>

<span class="sd">For more extensive examples see the</span>
<span class="sd">[repository&#39;s examples](https://github.com/FasterSpeeding/Tanjun/tree/master/examples).</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># __init__.py</span>
    <span class="s2">&quot;__author__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__ci__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__copyright__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__coverage__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__docs__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__email__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__issue_tracker__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__license__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__url__&quot;</span><span class="p">,</span>
    <span class="s2">&quot;__version__&quot;</span><span class="p">,</span>
    <span class="c1"># abc.py</span>
    <span class="s2">&quot;abc&quot;</span><span class="p">,</span>
    <span class="c1"># checks.py</span>
    <span class="s2">&quot;checks&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_check&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_dm_check&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_guild_check&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_nsfw_check&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_sfw_check&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_owner_check&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_author_permission_check&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_own_permission_check&quot;</span><span class="p">,</span>
    <span class="c1"># clients.py</span>
    <span class="s2">&quot;clients&quot;</span><span class="p">,</span>
    <span class="s2">&quot;as_loader&quot;</span><span class="p">,</span>
    <span class="s2">&quot;as_unloader&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Client&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ClientCallbackNames&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MessageAcceptsEnum&quot;</span><span class="p">,</span>
    <span class="c1"># commands.py</span>
    <span class="s2">&quot;commands&quot;</span><span class="p">,</span>
    <span class="s2">&quot;as_message_command&quot;</span><span class="p">,</span>
    <span class="s2">&quot;as_message_command_group&quot;</span><span class="p">,</span>
    <span class="s2">&quot;as_slash_command&quot;</span><span class="p">,</span>
    <span class="s2">&quot;slash_command_group&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MessageCommand&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MessageCommandGroup&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SlashCommand&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SlashCommandGroup&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_str_slash_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_int_slash_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_float_slash_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_bool_slash_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_role_slash_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_user_slash_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_member_slash_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_channel_slash_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_mentionable_slash_option&quot;</span><span class="p">,</span>
    <span class="c1"># components.py</span>
    <span class="s2">&quot;components&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Component&quot;</span><span class="p">,</span>
    <span class="c1"># context.py</span>
    <span class="s2">&quot;context&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MessageContext&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SlashContext&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SlashOption&quot;</span><span class="p">,</span>
    <span class="c1"># conversion.py</span>
    <span class="s2">&quot;conversion&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_bool&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_channel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_color&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_colour&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_datetime&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_emoji&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_guild&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_invite&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_invite_with_metadata&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_member&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_presence&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_role&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_snowflake&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_user&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_voice_state&quot;</span><span class="p">,</span>
    <span class="c1"># dependencies.py</span>
    <span class="s2">&quot;dependencies&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cached_inject&quot;</span><span class="p">,</span>
    <span class="s2">&quot;inject_lc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LazyConstant&quot;</span><span class="p">,</span>
    <span class="c1"># errors.py</span>
    <span class="s2">&quot;errors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CommandError&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ConversionError&quot;</span><span class="p">,</span>
    <span class="s2">&quot;HaltExecution&quot;</span><span class="p">,</span>
    <span class="s2">&quot;FailedCheck&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MissingDependencyError&quot;</span><span class="p">,</span>
    <span class="s2">&quot;NotEnoughArgumentsError&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TooManyArgumentsError&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ParserError&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TanjunError&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TanjunWarning&quot;</span><span class="p">,</span>
    <span class="s2">&quot;StateWarning&quot;</span><span class="p">,</span>
    <span class="c1"># hooks.py</span>
    <span class="s2">&quot;hooks&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AnyHooks&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Hooks&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MessageHooks&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SlashHooks&quot;</span><span class="p">,</span>
    <span class="c1"># injecting.py</span>
    <span class="s2">&quot;injecting&quot;</span><span class="p">,</span>
    <span class="s2">&quot;as_self_injecting&quot;</span><span class="p">,</span>
    <span class="s2">&quot;inject&quot;</span><span class="p">,</span>
    <span class="c1"># parsing.py</span>
    <span class="s2">&quot;parsing&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ShlexParser&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_argument&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_greedy_argument&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_multi_argument&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_multi_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_parser&quot;</span><span class="p">,</span>
    <span class="c1"># utilities.py</span>
    <span class="s2">&quot;utilities&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">abc</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">utilities</span>
<span class="kn">from</span> <span class="nn">.checks</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.clients</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.commands</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.components</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.context</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.conversion</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.dependencies</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.errors</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.hooks</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.injecting</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.parsing</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">__author__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Faster Speeding&quot;</span>
<span class="n">__ci__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/FasterSpeeding/Tanjun/actions&quot;</span>
<span class="n">__copyright__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; 2020-2021 Faster Speeding&quot;</span>
<span class="n">__coverage__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;https://codeclimate.com/github/FasterSpeeding/Tanjun&quot;</span>
<span class="n">__docs__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;https://tanjun.cursed.solutions/&quot;</span>
<span class="n">__email__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;lucina@lmbyrne.dev&quot;</span>
<span class="n">__issue_tracker__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/FasterSpeeding/Tanjun/issues&quot;</span>
<span class="n">__license__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;BSD&quot;</span>
<span class="n">__url__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/FasterSpeeding/Tanjun&quot;</span>
<span class="n">__version__</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;2.1.5a1&quot;</span>
</pre></div>

        </details>

            </section>
                <section id="__author__">
                                <div class="attr variable"><a class="headerlink" href="#__author__">#&nbsp;&nbsp</a>

        <span class="name">__author__</span><span class="annotation">: Final[str]</span><span class="default_value"> = &#39;Faster Speeding&#39;</span>
    </div>

    

                </section>
                <section id="__ci__">
                                <div class="attr variable"><a class="headerlink" href="#__ci__">#&nbsp;&nbsp</a>

        <span class="name">__ci__</span><span class="annotation">: Final[str]</span><span class="default_value"> = &#39;https://github.com/FasterSpeeding/Tanjun/actions&#39;</span>
    </div>

    

                </section>
                <section id="__copyright__">
                                <div class="attr variable"><a class="headerlink" href="#__copyright__">#&nbsp;&nbsp</a>

        <span class="name">__copyright__</span><span class="annotation">: Final[str]</span><span class="default_value"> = &#39; 2020-2021 Faster Speeding&#39;</span>
    </div>

    

                </section>
                <section id="__coverage__">
                                <div class="attr variable"><a class="headerlink" href="#__coverage__">#&nbsp;&nbsp</a>

        <span class="name">__coverage__</span><span class="annotation">: Final[str]</span><span class="default_value"> = &#39;https://codeclimate.com/github/FasterSpeeding/Tanjun&#39;</span>
    </div>

    

                </section>
                <section id="__docs__">
                                <div class="attr variable"><a class="headerlink" href="#__docs__">#&nbsp;&nbsp</a>

        <span class="name">__docs__</span><span class="annotation">: Final[str]</span><span class="default_value"> = &#39;https://tanjun.cursed.solutions/&#39;</span>
    </div>

    

                </section>
                <section id="__email__">
                                <div class="attr variable"><a class="headerlink" href="#__email__">#&nbsp;&nbsp</a>

        <span class="name">__email__</span><span class="annotation">: Final[str]</span><span class="default_value"> = &#39;lucina@lmbyrne.dev&#39;</span>
    </div>

    

                </section>
                <section id="__issue_tracker__">
                                <div class="attr variable"><a class="headerlink" href="#__issue_tracker__">#&nbsp;&nbsp</a>

        <span class="name">__issue_tracker__</span><span class="annotation">: Final[str]</span><span class="default_value"> = &#39;https://github.com/FasterSpeeding/Tanjun/issues&#39;</span>
    </div>

    

                </section>
                <section id="__license__">
                                <div class="attr variable"><a class="headerlink" href="#__license__">#&nbsp;&nbsp</a>

        <span class="name">__license__</span><span class="annotation">: Final[str]</span><span class="default_value"> = &#39;BSD&#39;</span>
    </div>

    

                </section>
                <section id="__url__">
                                <div class="attr variable"><a class="headerlink" href="#__url__">#&nbsp;&nbsp</a>

        <span class="name">__url__</span><span class="annotation">: Final[str]</span><span class="default_value"> = &#39;https://github.com/FasterSpeeding/Tanjun&#39;</span>
    </div>

    

                </section>
                <section id="__version__">
                                <div class="attr variable"><a class="headerlink" href="#__version__">#&nbsp;&nbsp</a>

        <span class="name">__version__</span><span class="annotation">: Final[str]</span><span class="default_value"> = &#39;2.1.5a1&#39;</span>
    </div>

    

                </section>
                <section id="abc">
                                <div class="attr module"><a class="headerlink" href="#abc">#&nbsp;&nbsp</a>
<span class="name"><a href="tanjun/abc.html">tanjun.abc</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;Interfaces of the objects and clients used within Tanjun.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;BaseSlashCommandT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CheckSig&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CheckSigT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Context&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Hooks&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MetaEventSig&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MetaEventSigT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AnyHooks&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MessageHooks&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SlashHooks&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ExecutableCommand&quot;</span><span class="p">,</span>
    <span class="s2">&quot;HookSig&quot;</span><span class="p">,</span>
    <span class="s2">&quot;HookSigT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ErrorHookSig&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ErrorHookSigT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ListenerCallbackSig&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ListenerCallbackSigT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MaybeAwaitableT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MessageCommand&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MessageCommandT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MessageCommandGroup&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MessageContext&quot;</span><span class="p">,</span>
    <span class="s2">&quot;BaseSlashCommand&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SlashCommand&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SlashCommandGroup&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SlashContext&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SlashOption&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Component&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Client&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">collections</span>

<span class="kn">import</span> <span class="nn">hikari</span>

<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">datetime</span>

    <span class="kn">from</span> <span class="nn">hikari</span> <span class="kn">import</span> <span class="n">traits</span> <span class="k">as</span> <span class="n">hikari_traits</span>


<span class="n">_T</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_T&quot;</span><span class="p">)</span>


<span class="n">MaybeAwaitableT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">_T</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="n">_T</span><span class="p">]]</span>
<span class="sd">&quot;&quot;&quot;Type hint for a value which may need to be awaited to be resolved.&quot;&quot;&quot;</span>

<span class="n">ContextT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;ContextT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;Context&quot;</span><span class="p">)</span>
<span class="n">ContextT_co</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;ContextT_co&quot;</span><span class="p">,</span> <span class="n">covariant</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;Context&quot;</span><span class="p">)</span>
<span class="n">ContextT_contra</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;ContextT_contra&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;Context&quot;</span><span class="p">,</span> <span class="n">contravariant</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">MetaEventSig</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">MaybeAwaitableT</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span>
<span class="n">MetaEventSigT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;MetaEventSigT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;MetaEventSig&quot;</span><span class="p">)</span>
<span class="n">BaseSlashCommandT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;BaseSlashCommandT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;BaseSlashCommand&quot;</span><span class="p">)</span>
<span class="n">MessageCommandT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;MessageCommandT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;MessageCommand&quot;</span><span class="p">)</span>


<span class="n">CommandCallbackSig</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span>
<span class="sd">&quot;&quot;&quot;Type hint of the callback a `Command` instance will operate on.</span>

<span class="sd">This will be called when executing a command and will need to take at least one</span>
<span class="sd">positional argument of type `Context` where any other required or optional</span>
<span class="sd">keyword or positional arguments will be based on the parser instance for the</span>
<span class="sd">command if applicable.</span>

<span class="sd">.. note::</span>
<span class="sd">    This will have to be asynchronous.</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="n">CheckSig</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">MaybeAwaitableT</span><span class="p">[</span><span class="nb">bool</span><span class="p">]]</span>
<span class="sd">&quot;&quot;&quot;Type hint of a general context check used with Tanjun `ExecutableCommand` classes.</span>

<span class="sd">This may be registered with a `ExecutableCommand` to add a rule which decides whether</span>
<span class="sd">it should execute for each context passed to it. This should take one positional</span>
<span class="sd">argument of type `Context` and may either be a synchronous or asynchronous</span>
<span class="sd">callback which returns `bool` where returning `False` or</span>
<span class="sd">raising `tanjun.errors.FailedCheck` will indicate that the current context</span>
<span class="sd">shouldn&#39;t lead to an execution.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">CheckSigT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;CheckSigT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">CheckSig</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Generic equivalent of `CheckSig`&quot;&quot;&quot;</span>

<span class="n">HookSig</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">MaybeAwaitableT</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span>
<span class="sd">&quot;&quot;&quot;Type hint of the callback used as a general command hook.</span>

<span class="sd">.. note::</span>
<span class="sd">    This may be asynchronous or synchronous, dependency injection is supported</span>
<span class="sd">    for this callback&#39;s keyword arguments and the positional arguments which</span>
<span class="sd">    are passed dependent on the type of hook this is being registered as.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">HookSigT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;HookSigT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">HookSig</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Generic equivalent of `HookSig`.&quot;&quot;&quot;</span>

<span class="n">ErrorHookSig</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">MaybeAwaitableT</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]]]</span>
<span class="sd">&quot;&quot;&quot;Type hint of the callback used as a unexpected command error hook.</span>

<span class="sd">This will be called whenever an unexpected `Exception` is raised during the</span>
<span class="sd">execution stage of a command (not including expected `tanjun.errors.TanjunError`).</span>

<span class="sd">This should take two positional arguments - of type `tanjun.abc.Context` and</span>
<span class="sd">`Exception` - and may be either a synchronous or asynchronous callback which</span>
<span class="sd">returns `bool` or `None` and may take advantage of dependency injection.</span>

<span class="sd">`True` is returned to indicate that the exception should be suppressed and</span>
<span class="sd">`False` is returned to indicate that the exception should be re-raised.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">ErrorHookSigT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;ErrorHookSigT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">ErrorHookSig</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Generic equivalent of `ErrorHookSig`.&quot;&quot;&quot;</span>

<span class="n">ListenerCallbackSig</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Coroutine</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]</span>
<span class="sd">&quot;&quot;&quot;Type hint of a hikari event manager callback.</span>

<span class="sd">This is guaranteed one positional arg of type `hikari.Event` regardless</span>
<span class="sd">of implementation and must be a coruotine function which returns `None`.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">ListenerCallbackSigT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;ListenerCallbackSigT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">ListenerCallbackSig</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Generic equivalent of `ListenerCallbackSig`.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">Context</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Interface for the context of a command execution.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">author</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Object of the user who triggered this command.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">channel_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;ID of the channel this command was triggered in.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Hikari cache instance this context&#39;s command client was initialised with.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Tanjun `Client` implementation this context was spawned by.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">Component</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Object of the `Component` this context is bound to.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will only be `None` before this has been bound to a</span>
<span class="sd">            specific command but never during command execution nor checks.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>  <span class="c1"># TODO: can we somehow have this always be present on the command execution facing interface</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">ContextT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">ContextT</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Object of the command this context is bound to.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will only be `None` before this has been bound to a</span>
<span class="sd">            specific command but never during command execution.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">created_at</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;When this context was created.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will either refer to a message or integration&#39;s creation date.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">events</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Object of the event manager this context&#39;s client was initialised with.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">guild_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;ID of the guild this command was executed in.</span>

<span class="sd">        Will be `None` for all DM command executions.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">has_responded</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether an initial response has been made for this context.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">is_human</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether this command execution was triggered by a human.</span>

<span class="sd">        Will be `False` for bot and webhook triggered commands.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Member</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Guild member object of this command&#39;s author.</span>

<span class="sd">        Will be `None` for DM command executions.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">server</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Object of the Hikari interaction server provided for this context&#39;s client.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">rest</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Object of the Hikari REST client this context&#39;s client was initialised with.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">shards</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Object of the Hikari shard manager this context&#39;s client was initialised with.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">voice</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">VoiceComponent</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Object of the Hikari voice component this context&#39;s client was initialised with.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">triggering_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Command name this execution was triggered with.&quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">set_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">Component</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">TextableChannel</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Fetch the channel the context was invoked in.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This performs an API call. Consider using `Context.get_channel`</span>
<span class="sd">            if you have `hikari.config.CacheComponents.GUILD_CHANNELS` cache component enabled.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.TextableChannel</span>
<span class="sd">            The textable DM or guild channel the context was invoked in.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        hikari.UnauthorizedError</span>
<span class="sd">            If you are unauthorized to make the request (invalid/missing token).</span>
<span class="sd">        hikari.ForbiddenError</span>
<span class="sd">            If you are missing the `READ_MESSAGES` permission in the channel.</span>
<span class="sd">        hikari.NotFoundError</span>
<span class="sd">            If the channel is not found.</span>
<span class="sd">        hikari.RateLimitTooLongError</span>
<span class="sd">            Raised in the event that a rate limit occurs that is</span>
<span class="sd">            longer than `max_rate_limit` when making a request.</span>
<span class="sd">        hikari.RateLimitTooLongError</span>
<span class="sd">            Raised in the event that a rate limit occurs that is</span>
<span class="sd">            longer than `max_rate_limit` when making a request.</span>
<span class="sd">        hikari.RateLimitedError</span>
<span class="sd">            Usually, Hikari will handle and retry on hitting</span>
<span class="sd">            rate-limits automatically. This includes most bucket-specific</span>
<span class="sd">            rate-limits and global rate-limits. In some rare edge cases,</span>
<span class="sd">            however, Discord implements other undocumented rules for</span>
<span class="sd">            rate-limiting, such as limits per attribute. These cannot be</span>
<span class="sd">            detected or handled normally by Hikari due to their undocumented</span>
<span class="sd">            nature, and will trigger this exception if they occur.</span>
<span class="sd">        hikari.InternalServerError</span>
<span class="sd">            If an internal error occurs on Discord while handling the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_guild</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Guild</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Fetch the guild the context was invoked in.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This performs an API call. Consider using `Context.get_guild`</span>
<span class="sd">            if you have `hikari.config.CacheComponents.GUILDS` cache component enabled.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[hikari.Guild]</span>
<span class="sd">            An optional guild the context was invoked in.</span>
<span class="sd">            `None` will be returned if the guild was not found or the context was invoked in a DM channel .</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        hikari.ForbiddenError</span>
<span class="sd">            If you are not part of the guild.</span>
<span class="sd">        hikari.NotFoundError</span>
<span class="sd">            If the guild is not found.</span>
<span class="sd">        hikari.UnauthorizedError</span>
<span class="sd">            If you are unauthorized to make the request (invalid/missing token).</span>
<span class="sd">        hikari.RateLimitTooLongError</span>
<span class="sd">            Raised in the event that a rate limit occurs that is</span>
<span class="sd">            longer than `max_rate_limit` when making a request.</span>
<span class="sd">        hikari.RateLimitedError</span>
<span class="sd">            Usually, Hikari will handle and retry on hitting</span>
<span class="sd">            rate-limits automatically. This includes most bucket-specific</span>
<span class="sd">            rate-limits and global rate-limits. In some rare edge cases,</span>
<span class="sd">            however, Discord implements other undocumented rules for</span>
<span class="sd">            rate-limiting, such as limits per attribute. These cannot be</span>
<span class="sd">            detected or handled normally by Hikari due to their undocumented</span>
<span class="sd">            nature, and will trigger this exception if they occur.</span>
<span class="sd">        hikari.InternalServerError</span>
<span class="sd">            If an internal error occurs on Discord while handling the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">TextableGuildChannel</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Retrieve the channel the context was invoked in from the cache.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This method requires the `hikari.config.CacheComponents.GUILD_CHANNELS` cache component.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[hikari.TextableGuildChannel]</span>
<span class="sd">            An optional guild channel the context was invoked in.</span>
<span class="sd">            `None` will be returned if the channel was not found or if it</span>
<span class="sd">            is DM channel.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_guild</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Guild</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Fetch the guild that the context was invoked in.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This method requires `hikari.config.CacheComponents.GUILDS` cache component enabled.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[hikari.Guild]</span>
<span class="sd">            An optional guild the context was invoked in.</span>
<span class="sd">            `None` will be returned if the guild was not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Delete the initial response after invoking this context.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        LookupError, hikari.NotFoundError</span>
<span class="sd">            The last context has no initial response.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Delete the last response after invoking this context.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        LookupError, hikari.NotFoundError</span>
<span class="sd">            The last context has no responses.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Edit the initial response for this context.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content : hikari.UndefinedOr[typing.Any]</span>
<span class="sd">            The content to edit the initial response with.</span>

<span class="sd">            If provided, the message contents. If</span>
<span class="sd">            `hikari.UNDEFINED`, then nothing will be sent</span>
<span class="sd">            in the content. Any other value here will be cast to a</span>
<span class="sd">            `str`.</span>

<span class="sd">            If this is a `hikari.Embed` and no `embed` nor `embeds` kwarg</span>
<span class="sd">            is provided, then this will instead update the embed. This allows</span>
<span class="sd">            for simpler syntax when sending an embed alone.</span>

<span class="sd">            Likewise, if this is a `hikari.Resource`, then the</span>
<span class="sd">            content is instead treated as an attachment if no `attachment` and</span>
<span class="sd">            no `attachments` kwargs are provided.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        delete_after : typing.Union[datetime.timedelta, float, int, None]</span>
<span class="sd">            If provided, the seconds after which the response message should be delete.</span>

<span class="sd">            .. note::</span>
<span class="sd">                As of writing, this does not support ephemeral slash command responses.</span>
<span class="sd">        attachment : hikari.UndefinedOr[hikari.Resourceish]</span>
<span class="sd">            A singular attachment to edit the initial response with.</span>
<span class="sd">        attachments : hikari.UndefinedOr[collections.abc.Sequence[hikari.Resourceish]]</span>
<span class="sd">            A sequence of attachments to edit the initial response with.</span>
<span class="sd">        component : hikari.UndefinedNoneOr[hikari.api.ComponentBuilder]</span>
<span class="sd">            If provided, builder object of the component to set for this message.</span>
<span class="sd">            This component will replace any previously set components and passing</span>
<span class="sd">            `None` will remove all components.</span>
<span class="sd">        components : hikari.UndefinedNoneOr[collections.abc.Sequence[hikari.api.ComponentBuilder]]</span>
<span class="sd">            If provided, a sequence of the component builder objects set for</span>
<span class="sd">            this message. These components will replace any previously set</span>
<span class="sd">            components and passing `None` or an empty sequence will</span>
<span class="sd">            remove all components.</span>
<span class="sd">        embed : hikari.UndefinedOr[hikari.Embed]</span>
<span class="sd">            An embed to replace the initial response with.</span>
<span class="sd">        embeds : hikari.UndefinedOr[collections.abc.Sequence[hikari.Embed]]</span>
<span class="sd">            A sequence of embeds to replace the initial response with.</span>
<span class="sd">        replace_attachments : bool</span>
<span class="sd">            Whether to replace the attachments of the response or not. Default to `False`.</span>
<span class="sd">        mentions_everyone : hikari.UndefinedOr[bool]</span>
<span class="sd">            If provided, whether the message should parse @everyone/@here</span>
<span class="sd">            mentions.</span>
<span class="sd">        user_mentions : hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialUser], bool]]</span>
<span class="sd">            If provided, and `True`, all mentions will be parsed.</span>
<span class="sd">            If provided, and `False`, no mentions will be parsed.</span>
<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.Snowflake`, or `hikari.PartialUser`</span>
<span class="sd">            derivatives to enforce mentioning specific users.</span>
<span class="sd">        role_mentions : hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialRole], bool]]</span>
<span class="sd">            If provided, and `True`, all mentions will be parsed.</span>
<span class="sd">            If provided, and `False`, no mentions will be parsed.</span>
<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.Snowflake`, or</span>
<span class="sd">            `hikari.PartialRole` derivatives to enforce mentioning</span>
<span class="sd">            specific roles.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Attachments can be passed as many different things, to aid in</span>
<span class="sd">        convenience.</span>
<span class="sd">        * If a `pathlib.PurePath` or `str` to a valid URL, the</span>
<span class="sd">            resource at the given URL will be streamed to Discord when</span>
<span class="sd">            sending the message. Subclasses of</span>
<span class="sd">            `hikari.WebResource` such as</span>
<span class="sd">            `hikari.URL`,</span>
<span class="sd">            `hikari.Attachment`,</span>
<span class="sd">            `hikari.Emoji`,</span>
<span class="sd">            `EmbedResource`, etc will also be uploaded this way.</span>
<span class="sd">            This will use bit-inception, so only a small percentage of the</span>
<span class="sd">            resource will remain in memory at any one time, thus aiding in</span>
<span class="sd">            scalability.</span>
<span class="sd">        * If a `hikari.Bytes` is passed, or a `str`</span>
<span class="sd">            that contains a valid data URI is passed, then this is uploaded</span>
<span class="sd">            with a randomized file name if not provided.</span>
<span class="sd">        * If a `hikari.File`, `pathlib.PurePath` or</span>
<span class="sd">            `str` that is an absolute or relative path to a file</span>
<span class="sd">            on your file system is passed, then this resource is uploaded</span>
<span class="sd">            as an attachment using non-blocking code internally and streamed</span>
<span class="sd">            using bit-inception where possible. This depends on the</span>
<span class="sd">            type of `concurrent.futures.Executor` that is being used for</span>
<span class="sd">            the application (default is a thread pool which supports this</span>
<span class="sd">            behaviour).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.Message</span>
<span class="sd">            The message that has been edited.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If more than 100 unique objects/entities are passed for</span>
<span class="sd">            `role_mentions` or `user_mentions`.</span>
<span class="sd">        TypeError</span>
<span class="sd">            If both `attachment` and `attachments` are specified.</span>
<span class="sd">        hikari.BadRequestError</span>
<span class="sd">            This may be raised in several discrete situations, such as messages</span>
<span class="sd">            being empty with no attachments or embeds; messages with more than</span>
<span class="sd">            2000 characters in them, embeds that exceed one of the many embed</span>
<span class="sd">            limits; too many attachments; attachments that are too large;</span>
<span class="sd">            invalid image URLs in embeds; if `reply` is not found or not in the</span>
<span class="sd">            same channel as `channel`; too many components.</span>
<span class="sd">        hikari.UnauthorizedError</span>
<span class="sd">            If you are unauthorized to make the request (invalid/missing token).</span>
<span class="sd">        hikari.ForbiddenError</span>
<span class="sd">            If you are missing the `SEND_MESSAGES` in the channel or the</span>
<span class="sd">            person you are trying to message has the DM&#39;s disabled.</span>
<span class="sd">        hikari.NotFoundError</span>
<span class="sd">            If the channel is not found.</span>
<span class="sd">        hikari.RateLimitTooLongError</span>
<span class="sd">            Raised in the event that a rate limit occurs that is</span>
<span class="sd">            longer than `max_rate_limit` when making a request.</span>
<span class="sd">        hikari.RateLimitedError</span>
<span class="sd">            Usually, Hikari will handle and retry on hitting</span>
<span class="sd">            rate-limits automatically. This includes most bucket-specific</span>
<span class="sd">            rate-limits and global rate-limits. In some rare edge cases,</span>
<span class="sd">            however, Discord implements other undocumented rules for</span>
<span class="sd">            rate-limiting, such as limits per attribute. These cannot be</span>
<span class="sd">            detected or handled normally by Hikari due to their undocumented</span>
<span class="sd">            nature, and will trigger this exception if they occur.</span>
<span class="sd">        hikari.InternalServerError</span>
<span class="sd">            If an internal error occurs on Discord while handling the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_last_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Edit the last response for this context.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content : hikari.UndefinedOr[typing.Any]</span>
<span class="sd">            The content to edit the last response with.</span>

<span class="sd">            If provided, the message contents. If</span>
<span class="sd">            `hikari.UNDEFINED`, then nothing will be sent</span>
<span class="sd">            in the content. Any other value here will be cast to a</span>
<span class="sd">            `str`.</span>

<span class="sd">            If this is a `hikari.Embed` and no `embed` nor `embeds` kwarg</span>
<span class="sd">            is provided, then this will instead update the embed. This allows</span>
<span class="sd">            for simpler syntax when sending an embed alone.</span>

<span class="sd">            Likewise, if this is a `hikari.Resource`, then the</span>
<span class="sd">            content is instead treated as an attachment if no `attachment` and</span>
<span class="sd">            no `attachments` kwargs are provided.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        delete_after : typing.Union[datetime.timedelta, float, int, None]</span>
<span class="sd">            If provided, the seconds after which the response message should be delete.</span>

<span class="sd">            .. note::</span>
<span class="sd">                As of writing, this does not support ephemeral slash command responses.</span>
<span class="sd">        attachment : hikari.UndefinedOr[hikari.Resourceish]</span>
<span class="sd">            A singular attachment to edit the last response with.</span>
<span class="sd">        attachments : hikari.UndefinedOr[collections.abc.Sequence[hikari.Resourceish]]</span>
<span class="sd">            A sequence of attachments to edit the last response with.</span>
<span class="sd">        component : hikari.UndefinedNoneOr[hikari.api.ComponentBuilder]</span>
<span class="sd">            If provided, builder object of the component to set for this message.</span>
<span class="sd">            This component will replace any previously set components and passing</span>
<span class="sd">            `None` will remove all components.</span>
<span class="sd">        components : hikari.UndefinedNoneOr[collections.abc.Sequence[hikari.api.ComponentBuilder]]</span>
<span class="sd">            If provided, a sequence of the component builder objects set for</span>
<span class="sd">            this message. These components will replace any previously set</span>
<span class="sd">            components and passing `None` or an empty sequence will</span>
<span class="sd">            remove all components.</span>
<span class="sd">        embed : hikari.UndefinedOr[hikari.Embed]</span>
<span class="sd">            An embed to replace the last response with.</span>
<span class="sd">        embeds : hikari.UndefinedOr[collections.abc.Sequence[hikari.Embed]]</span>
<span class="sd">            A sequence of embeds to replace the last response with.</span>
<span class="sd">        replace_attachments : bool</span>
<span class="sd">            Whether to replace the attachments of the response or not. Default to `False`.</span>
<span class="sd">        mentions_everyone : hikari.UndefinedOr[bool]</span>
<span class="sd">            If provided, whether the message should parse @everyone/@here</span>
<span class="sd">            mentions.</span>
<span class="sd">        user_mentions : hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialUser], bool]]</span>
<span class="sd">            If provided, and `True`, all mentions will be parsed.</span>
<span class="sd">            If provided, and `False`, no mentions will be parsed.</span>

<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.Snowflake`, or `hikari.PartialUser`</span>
<span class="sd">            derivatives to enforce mentioning specific users.</span>
<span class="sd">        role_mentions : hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialRole], bool]]</span>
<span class="sd">            If provided, and `True`, all mentions will be parsed.</span>
<span class="sd">            If provided, and `False`, no mentions will be parsed.</span>

<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.Snowflake`, or</span>
<span class="sd">            `hikari.PartialRole` derivatives to enforce mentioning</span>
<span class="sd">            specific roles.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Attachments can be passed as many different things, to aid in</span>
<span class="sd">        convenience.</span>
<span class="sd">        * If a `pathlib.PurePath` or `str` to a valid URL, the</span>
<span class="sd">            resource at the given URL will be streamed to Discord when</span>
<span class="sd">            sending the message. Subclasses of</span>
<span class="sd">            `hikari.WebResource` such as</span>
<span class="sd">            `hikari.URL`,</span>
<span class="sd">            `hikari.Attachment`,</span>
<span class="sd">            `hikari.Emoji`,</span>
<span class="sd">            `EmbedResource`, etc will also be uploaded this way.</span>
<span class="sd">            This will use bit-inception, so only a small percentage of the</span>
<span class="sd">            resource will remain in memory at any one time, thus aiding in</span>
<span class="sd">            scalability.</span>
<span class="sd">        * If a `hikari.Bytes` is passed, or a `str`</span>
<span class="sd">            that contains a valid data URI is passed, then this is uploaded</span>
<span class="sd">            with a randomized file name if not provided.</span>
<span class="sd">        * If a `hikari.File`, `pathlib.PurePath` or</span>
<span class="sd">            `str` that is an absolute or relative path to a file</span>
<span class="sd">            on your file system is passed, then this resource is uploaded</span>
<span class="sd">            as an attachment using non-blocking code internally and streamed</span>
<span class="sd">            using bit-inception where possible. This depends on the</span>
<span class="sd">            type of `concurrent.futures.Executor` that is being used for</span>
<span class="sd">            the application (default is a thread pool which supports this</span>
<span class="sd">            behaviour).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.Message</span>
<span class="sd">            The message that has been edited.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If more than 100 unique objects/entities are passed for</span>
<span class="sd">            `role_mentions` or `user_mentions`.</span>
<span class="sd">        TypeError</span>
<span class="sd">            If both `attachment` and `attachments` are specified.</span>
<span class="sd">        hikari.BadRequestError</span>
<span class="sd">            This may be raised in several discrete situations, such as messages</span>
<span class="sd">            being empty with no attachments or embeds; messages with more than</span>
<span class="sd">            2000 characters in them, embeds that exceed one of the many embed</span>
<span class="sd">            limits; too many attachments; attachments that are too large;</span>
<span class="sd">            invalid image URLs in embeds; if `reply` is not found or not in the</span>
<span class="sd">            same channel as `channel`; too many components.</span>
<span class="sd">        hikari.UnauthorizedError</span>
<span class="sd">            If you are unauthorized to make the request (invalid/missing token).</span>
<span class="sd">        hikari.ForbiddenError</span>
<span class="sd">            If you are missing the `SEND_MESSAGES` in the channel or the</span>
<span class="sd">            person you are trying to message has the DM&#39;s disabled.</span>
<span class="sd">        hikari.NotFoundError</span>
<span class="sd">            If the channel is not found.</span>
<span class="sd">        hikari.RateLimitTooLongError</span>
<span class="sd">            Raised in the event that a rate limit occurs that is</span>
<span class="sd">            longer than `max_rate_limit` when making a request.</span>
<span class="sd">        hikari.RateLimitedError</span>
<span class="sd">            Usually, Hikari will handle and retry on hitting</span>
<span class="sd">            rate-limits automatically. This includes most bucket-specific</span>
<span class="sd">            rate-limits and global rate-limits. In some rare edge cases,</span>
<span class="sd">            however, Discord implements other undocumented rules for</span>
<span class="sd">            rate-limiting, such as limits per attribute. These cannot be</span>
<span class="sd">            detected or handled normally by Hikari due to their undocumented</span>
<span class="sd">            nature, and will trigger this exception if they occur.</span>
<span class="sd">        hikari.InternalServerError</span>
<span class="sd">            If an internal error occurs on Discord while handling the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Fetch the initial response for this context.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        LookupError, hikari.NotFoundError</span>
<span class="sd">            The response was not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Fetch the last response for this context.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        LookupError, hikari.NotFoundError</span>
<span class="sd">            The response was not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Respond to this context.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content : hikari.UndefinedOr[typing.Any]</span>
<span class="sd">            The content to respond with.</span>

<span class="sd">            If provided, the message contents. If</span>
<span class="sd">            `hikari.UNDEFINED`, then nothing will be sent</span>
<span class="sd">            in the content. Any other value here will be cast to a</span>
<span class="sd">            `str`.</span>

<span class="sd">            If this is a `hikari.Embed` and no `embed` nor `embeds` kwarg</span>
<span class="sd">            is provided, then this will instead update the embed. This allows</span>
<span class="sd">            for simpler syntax when sending an embed alone.</span>

<span class="sd">            Likewise, if this is a `hikari.Resource`, then the</span>
<span class="sd">            content is instead treated as an attachment if no `attachment` and</span>
<span class="sd">            no `attachments` kwargs are provided.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        ensure_result : bool</span>
<span class="sd">            If provided and set to `True` then this will always return `hikari.Message`,</span>
<span class="sd">            otherwise this will return `Optional[hikari.Message]`.</span>

<span class="sd">            It&#39;s worth noting that, under certain scenarios within the slash</span>
<span class="sd">            command flow, this may lead to an extre request being made.</span>
<span class="sd">        delete_after : typing.Union[datetime.timedelta, float, int, None]</span>
<span class="sd">            If provided, the seconds after which the response message should be delete.</span>

<span class="sd">            .. note::</span>
<span class="sd">                As of writing, this does not support ephemeral slash command responses.</span>
<span class="sd">        component : hikari.UndefinedOr[hikari.api.ComponentBuilder]</span>
<span class="sd">            If provided, builder object of the component to include in this response.</span>
<span class="sd">        components : hikari.UndefinedOr[collections.abc.Sequence[hikari.api.ComponentBuilder]]</span>
<span class="sd">            If provided, a sequence of the component builder objects to include</span>
<span class="sd">            in this response.</span>
<span class="sd">        embed : hikari.UndefinedOr[hikari.Embed]</span>
<span class="sd">            An embed to respond with.</span>
<span class="sd">        embeds : hikari.UndefinedOr[collections.abc.Sequence[hikari.Embed]]</span>
<span class="sd">            A sequence of embeds to respond with.</span>
<span class="sd">        mentions_everyone : hikari.UndefinedOr[bool]</span>
<span class="sd">            If provided, whether the message should parse @everyone/@here</span>
<span class="sd">            mentions.</span>
<span class="sd">        user_mentions : hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialUser], bool]]</span>
<span class="sd">            If provided, and `True`, all mentions will be parsed.</span>
<span class="sd">            If provided, and `False`, no mentions will be parsed.</span>

<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.Snowflake`, or `hikari.PartialUser`</span>
<span class="sd">            derivatives to enforce mentioning specific users.</span>
<span class="sd">        role_mentions : hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialRole], bool]]</span>
<span class="sd">            If provided, and `True`, all mentions will be parsed.</span>
<span class="sd">            If provided, and `False`, no mentions will be parsed.</span>

<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.Snowflake`, or</span>
<span class="sd">            `hikari.PartialRole` derivatives to enforce mentioning</span>
<span class="sd">            specific roles.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[hikari.Message]</span>
<span class="sd">            The message that has been created if it was immedieatly available or</span>
<span class="sd">            `ensure_result` was set to `True`, else `None`.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If more than 100 unique objects/entities are passed for</span>
<span class="sd">            `role_mentions` or `user_mentions`.</span>
<span class="sd">        TypeError</span>
<span class="sd">            If both `attachment` and `attachments` are specified.</span>
<span class="sd">        hikari.BadRequestError</span>
<span class="sd">            This may be raised in several discrete situations, such as messages</span>
<span class="sd">            being empty with no attachments or embeds; messages with more than</span>
<span class="sd">            2000 characters in them, embeds that exceed one of the many embed</span>
<span class="sd">            limits; too many attachments; attachments that are too large;</span>
<span class="sd">            invalid image URLs in embeds; if `reply` is not found or not in the</span>
<span class="sd">            same channel as `channel`; too many components.</span>
<span class="sd">        hikari.UnauthorizedError</span>
<span class="sd">            If you are unauthorized to make the request (invalid/missing token).</span>
<span class="sd">        hikari.ForbiddenError</span>
<span class="sd">            If you are missing the `SEND_MESSAGES` in the channel or the</span>
<span class="sd">            person you are trying to message has the DM&#39;s disabled.</span>
<span class="sd">        hikari.NotFoundError</span>
<span class="sd">            If the channel is not found.</span>
<span class="sd">        hikari.RateLimitTooLongError</span>
<span class="sd">            Raised in the event that a rate limit occurs that is</span>
<span class="sd">            longer than `max_rate_limit` when making a request.</span>
<span class="sd">        hikari.RateLimitedError</span>
<span class="sd">            Usually, Hikari will handle and retry on hitting</span>
<span class="sd">            rate-limits automatically. This includes most bucket-specific</span>
<span class="sd">            rate-limits and global rate-limits. In some rare edge cases,</span>
<span class="sd">            however, Discord implements other undocumented rules for</span>
<span class="sd">            rate-limiting, such as limits per attribute. These cannot be</span>
<span class="sd">            detected or handled normally by Hikari due to their undocumented</span>
<span class="sd">            nature, and will trigger this exception if they occur.</span>
<span class="sd">        hikari.InternalServerError</span>
<span class="sd">            If an internal error occurs on Discord while handling the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">MessageContext</span><span class="p">(</span><span class="n">Context</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">MessageCommand</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Command that was invoked.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This is always set during command, command check and parser</span>
<span class="sd">            converter execution but isn&#39;t guaranteed during client callback</span>
<span class="sd">            nor client/component check execution.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">content</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Content of the context&#39;s message minus the triggering name and prefix.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">message</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Message that triggered the context.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">shard</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">GatewayShard</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Shard that triggered the context.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will be `None` if `ctx.shards` is also `None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">triggering_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Prefix that triggered the context.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">triggering_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Command name that triggered the context.&quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">MessageCommand</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">set_content</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">set_triggering_name</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">nonce</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">reply</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialMessage</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_reply</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Respond to this context.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content : hikari.UndefinedOr[typing.Any]</span>
<span class="sd">            The content to respond with.</span>

<span class="sd">            If provided, the message contents. If</span>
<span class="sd">            `hikari.UNDEFINED`, then nothing will be sent</span>
<span class="sd">            in the content. Any other value here will be cast to a</span>
<span class="sd">            `str`.</span>

<span class="sd">            If this is a `hikari.Embed` and no `embed` nor `embeds` kwarg</span>
<span class="sd">            is provided, then this will instead update the embed. This allows</span>
<span class="sd">            for simpler syntax when sending an embed alone.</span>

<span class="sd">            Likewise, if this is a `hikari.Resource`, then the</span>
<span class="sd">            content is instead treated as an attachment if no `attachment` and</span>
<span class="sd">            no `attachments` kwargs are provided.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        ensure_result : bool</span>
<span class="sd">            This parameter does nothing in the message command flow, as the result</span>
<span class="sd">            will always be available, but is present to keep the signature</span>
<span class="sd">            compatible with `Context.respond`.</span>
<span class="sd">        delete_after : typing.Union[datetime.timedelta, float, int, None]</span>
<span class="sd">            If provided, the seconds after which the response message should be delete.</span>

<span class="sd">            .. note::</span>
<span class="sd">                As of writing, this does not support ephemeral slash command responses.</span>
<span class="sd">        tts : hikari.UndefinedOr[bool]</span>
<span class="sd">            Whether to respond with tts/text to speech or no.</span>
<span class="sd">        reply : hikari.Undefinedor[hikari.SnowflakeishOr[hikari.PartialMessage]]</span>
<span class="sd">            Whether to reply instead of sending the content to the context.</span>
<span class="sd">        nonce : hikari.UndefinedOr[str]</span>
<span class="sd">            The nonce that validates that the message was sent.</span>
<span class="sd">        attachment : hikari.UndefinedOr[hikari.Resourceish]</span>
<span class="sd">            A singular attachment to respond with.</span>
<span class="sd">        attachments : hikari.UndefinedOr[collections.abc.Sequence[hikari.Resourceish]]</span>
<span class="sd">            A sequence of attachments to respond with.</span>
<span class="sd">        component : hikari.UndefinedOr[hikari.api.ComponentBuilder]</span>
<span class="sd">            If provided, builder object of the component to include in this message.</span>
<span class="sd">        components : hikari.UndefinedOr[collections.abc.Sequence[hikari.api.ComponentBuilder]]</span>
<span class="sd">            If provided, a sequence of the component builder objects to include</span>
<span class="sd">            in this message.</span>
<span class="sd">        embed : hikari.UndefinedOr[hikari.Embed]</span>
<span class="sd">            An embed to respond with.</span>
<span class="sd">        embeds : hikari.UndefinedOr[collections.abc.Sequence[hikari.Embed]]</span>
<span class="sd">            A sequence of embeds to respond with.</span>
<span class="sd">        mentions_everyone : hikari.UndefinedOr[bool]</span>
<span class="sd">            If provided, whether the message should parse @everyone/@here</span>
<span class="sd">            mentions.</span>
<span class="sd">        user_mentions : hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialUser], bool]]</span>
<span class="sd">            If provided, and `True`, all mentions will be parsed.</span>
<span class="sd">            If provided, and `False`, no mentions will be parsed.</span>

<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.Snowflake`, or `hikari.PartialUser`</span>
<span class="sd">            derivatives to enforce mentioning specific users.</span>
<span class="sd">        role_mentions : hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialRole], bool]]</span>
<span class="sd">            If provided, and `True`, all mentions will be parsed.</span>
<span class="sd">            If provided, and `False`, no mentions will be parsed.</span>
<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.Snowflake`, or</span>
<span class="sd">            `hikari.PartialRole` derivatives to enforce mentioning</span>
<span class="sd">            specific roles.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Attachments can be passed as many different things, to aid in</span>
<span class="sd">        convenience.</span>
<span class="sd">        * If a `pathlib.PurePath` or `str` to a valid URL, the</span>
<span class="sd">            resource at the given URL will be streamed to Discord when</span>
<span class="sd">            sending the message. Subclasses of</span>
<span class="sd">            `hikari.WebResource` such as</span>
<span class="sd">            `hikari.URL`,</span>
<span class="sd">            `hikari.Attachment`,</span>
<span class="sd">            `hikari.Emoji`,</span>
<span class="sd">            `EmbedResource`, etc will also be uploaded this way.</span>
<span class="sd">            This will use bit-inception, so only a small percentage of the</span>
<span class="sd">            resource will remain in memory at any one time, thus aiding in</span>
<span class="sd">            scalability.</span>
<span class="sd">        * If a `hikari.Bytes` is passed, or a `str`</span>
<span class="sd">            that contains a valid data URI is passed, then this is uploaded</span>
<span class="sd">            with a randomized file name if not provided.</span>
<span class="sd">        * If a `hikari.File`, `pathlib.PurePath` or</span>
<span class="sd">            `str` that is an absolute or relative path to a file</span>
<span class="sd">            on your file system is passed, then this resource is uploaded</span>
<span class="sd">            as an attachment using non-blocking code internally and streamed</span>
<span class="sd">            using bit-inception where possible. This depends on the</span>
<span class="sd">            type of `concurrent.futures.Executor` that is being used for</span>
<span class="sd">            the application (default is a thread pool which supports this</span>
<span class="sd">            behaviour).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.Message</span>
<span class="sd">            The message that has been created.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If more than 100 unique objects/entities are passed for</span>
<span class="sd">            `role_mentions` or `user_mentions`.</span>

<span class="sd">            If the interaction will have expired before `delete_after` is reached.</span>
<span class="sd">        TypeError</span>
<span class="sd">            If both `attachment` and `attachments` are specified.</span>
<span class="sd">        hikari.BadRequestError</span>
<span class="sd">            This may be raised in several discrete situations, such as messages</span>
<span class="sd">            being empty with no attachments or embeds; messages with more than</span>
<span class="sd">            2000 characters in them, embeds that exceed one of the many embed</span>
<span class="sd">            limits; too many attachments; attachments that are too large;</span>
<span class="sd">            invalid image URLs in embeds; if `reply` is not found or not in the</span>
<span class="sd">            same channel as `channel`; too many components.</span>
<span class="sd">        hikari.UnauthorizedError</span>
<span class="sd">            If you are unauthorized to make the request (invalid/missing token).</span>
<span class="sd">        hikari.ForbiddenError</span>
<span class="sd">            If you are missing the `SEND_MESSAGES` in the channel or the</span>
<span class="sd">            person you are trying to message has the DM&#39;s disabled.</span>
<span class="sd">        hikari.NotFoundError</span>
<span class="sd">            If the channel is not found.</span>
<span class="sd">        hikari.RateLimitTooLongError</span>
<span class="sd">            Raised in the event that a rate limit occurs that is</span>
<span class="sd">            longer than `max_rate_limit` when making a request.</span>
<span class="sd">        hikari.RateLimitedError</span>
<span class="sd">            Usually, Hikari will handle and retry on hitting</span>
<span class="sd">            rate-limits automatically. This includes most bucket-specific</span>
<span class="sd">            rate-limits and global rate-limits. In some rare edge cases,</span>
<span class="sd">            however, Discord implements other undocumented rules for</span>
<span class="sd">            rate-limiting, such as limits per attribute. These cannot be</span>
<span class="sd">            detected or handled normally by Hikari due to their undocumented</span>
<span class="sd">            nature, and will trigger this exception if they occur.</span>
<span class="sd">        hikari.InternalServerError</span>
<span class="sd">            If an internal error occurs on Discord while handling the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">SlashOption</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Interface of slash command option with extra logic to help resolve it.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Name of this option.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Type of this option.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Value provided for this option.</span>

<span class="sd">        .. note::</span>
<span class="sd">            For discord entity option types (e.g. user, member, channel and</span>
<span class="sd">            role) this will be the entity&#39;s ID.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">resolve_value</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionChannel</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Resolve this option to an object value.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Union[hikari.InteractionChannel, hikari.InteractionMember, hikari.Role, hikari.User]</span>
<span class="sd">            The object value of this option.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        TypeError</span>
<span class="sd">            If the option isn&#39;t resolvable.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">resolve_to_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionChannel</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Resolve this option to a channel object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.InteractionChannel</span>
<span class="sd">            The channel object.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        TypeError</span>
<span class="sd">            If the option is not a channel and a `default` wasn&#39;t provided.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">resolve_to_member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">resolve_to_member</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">_T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">,</span> <span class="n">_T</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">resolve_to_member</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">_T</span> <span class="o">=</span> <span class="o">...</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">,</span> <span class="n">_T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Resolve this option to a member object.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        default:</span>
<span class="sd">            The default value to return if this option cannot be resolved.</span>

<span class="sd">            If this is not provided, this method will raise a `TypeError` if</span>
<span class="sd">            this option cannot be resolved.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Union[hikari.InteractionMember, _T]</span>
<span class="sd">            The member object or `default` if it was provided and this option</span>
<span class="sd">            was a user type but had no member.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        LookupError</span>
<span class="sd">            If no member was found for this option and a `default` wasn&#39;t provided.</span>

<span class="sd">            This includes if the option is a mentionable type which targets a</span>
<span class="sd">            member-less user.</span>

<span class="sd">            This could happen if the user isn&#39;t in the current guild or if this</span>
<span class="sd">            command was executed in a DM and this option should still be resolvable</span>
<span class="sd">            to a user.</span>
<span class="sd">        TypeError</span>
<span class="sd">            If the option is not a user option and a `default` wasn&#39;t provided.</span>

<span class="sd">            This includes if the option is a mentionable type but doesn&#39;t</span>
<span class="sd">            target a user.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">resolve_to_mentionable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Member</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Resolve this option to a mentionable object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Union[hikari.Role, hikari.User, hikari.Member]</span>
<span class="sd">            The mentionable object.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        TypeError</span>
<span class="sd">            If the option is not a mentionable, user or role type.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">resolve_to_role</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Resolve this option to a role object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.Role</span>
<span class="sd">            The role object.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        TypeError</span>
<span class="sd">            If the option is not a role.</span>

<span class="sd">            This includes mentionable options which point towards a user.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">resolve_to_user</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Member</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Resolve this option to a user object.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will resolve to a `hikari.Member` first if the relevant</span>
<span class="sd">            command was executed within a guild and the option targeted one of</span>
<span class="sd">            the guild&#39;s members, otherwise it will resolve to `hikari.User`.</span>

<span class="sd">            It&#39;s also worth noting that hikari.Member inherits from hikari.User</span>
<span class="sd">            meaning that the return value of this can always be treated as a</span>
<span class="sd">            user.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Union[hikari.User, hikari.Member]</span>
<span class="sd">            The user object.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        TypeError</span>
<span class="sd">            If the option is not a user.</span>

<span class="sd">            This includes mentionable options which point towards a role.</span>
<span class="sd">        &quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">SlashContext</span><span class="p">(</span><span class="n">Context</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Interface of a slash command specific context.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Command that was invoked.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This should always be set during command, command check execution</span>
<span class="sd">            and command hook execution but isn&#39;t guaranteed for client callbacks</span>
<span class="sd">            nor component/client checks.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">defaults_to_ephemeral</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether the context is marked as defaulting to ephemeral response.</span>

<span class="sd">        This effects calls to `SlashContext.create_followup`,</span>
<span class="sd">        `SlashContext.create_initial_response`, `SlashContext.defer` and</span>
<span class="sd">        `SlashContext.respond` unless the `flags` field is provided for the</span>
<span class="sd">        methods which support it.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">expires_at</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;When this application command context expires.</span>

<span class="sd">        After this time is reached, the message/response methods on this</span>
<span class="sd">        context will always raise `hikari.errors.NotFoundError`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">has_been_deferred</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether the initial response for this context has been deferred.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            If this is `True` when `SlashContext.has_responded` is `False`</span>
<span class="sd">            then `SlashContext.edit_initial_response` will need to be used</span>
<span class="sd">            to create the initial response rather than</span>
<span class="sd">            `SlashContext.create_initial_response`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">interaction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Interaction this context is for.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Object of the member that triggered this command if this is in a guild.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">SlashOption</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Mapping of option names to the values provided for them.&quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">BaseSlashCommand</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the command for this context.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : typing.Optional[BaseSlashCommand]</span>
<span class="sd">            The command this context is for.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">set_ephemeral_default</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the ephemeral default state for this context.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        state : bool</span>
<span class="sd">            The new ephemeral default state.</span>

<span class="sd">            If this is `True` then all calls to the response creating methods</span>
<span class="sd">            on this context will default to being ephemeral.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">defer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Defer the initial response for this context.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        flags : typing.Union[hikari.UndefinedType, int, hikari.MessageFlag]</span>
<span class="sd">            The flags to use for the initial response.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">mark_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Mark this context as not found.</span>

<span class="sd">        Dependent on how the client is configured this may lead to a not found</span>
<span class="sd">        response message being sent.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_followup</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a followup response for this context.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            Calling this on a context which hasn&#39;t had an initial response yet</span>
<span class="sd">            will lead to a `hikari.NotFoundError` being raised.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        content : hikari.UndefinedOr[typing.Any]</span>
<span class="sd">            If provided, the message contents. If</span>
<span class="sd">            `hikari.UNDEFINED`, then nothing will be sent</span>
<span class="sd">            in the content. Any other value here will be cast to a</span>
<span class="sd">            `str`.</span>

<span class="sd">            If this is a `hikari.Embed` and no `embed` kwarg is</span>
<span class="sd">            provided, then this will instead update the embed. This allows for</span>
<span class="sd">            simpler syntax when sending an embed alone.</span>

<span class="sd">            Likewise, if this is a `hikari.Resource`, then the</span>
<span class="sd">            content is instead treated as an attachment if no `attachment` and</span>
<span class="sd">            no `attachments` kwargs are provided.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        delete_after : typing.Union[datetime.timedelta, float, int, None]</span>
<span class="sd">            If provided, the seconds after which the response message should be delete.</span>

<span class="sd">            .. note::</span>
<span class="sd">                As of writing, this does not support ephemeral slash command responses.</span>
<span class="sd">        attachment : hikari.UndefinedOr[hikari.Resourceish]</span>
<span class="sd">            If provided, the message attachment. This can be a resource,</span>
<span class="sd">            or string of a path on your computer or a URL.</span>
<span class="sd">        attachments : hikari.UndefinedOr[collections.abc.Sequence[hikari.Resourceish]]</span>
<span class="sd">            If provided, the message attachments. These can be resources, or</span>
<span class="sd">            strings consisting of paths on your computer or URLs.</span>
<span class="sd">        component : hikari.UndefinedOr[hikari.api.ComponentBuilder]</span>
<span class="sd">            If provided, builder object of the component to include in this message.</span>
<span class="sd">        components : hikari.UndefinedOr[collections.abc.Sequence[hikari.api.ComponentBuilder]]</span>
<span class="sd">            If provided, a sequence of the component builder objects to include</span>
<span class="sd">            in this message.</span>
<span class="sd">        embed : hikari.UndefinedOr[hikari.Embed]</span>
<span class="sd">            If provided, the message embed.</span>
<span class="sd">        embeds : hikari.UndefinedOr[collections.abc.Sequence[hikari.Embed]]</span>
<span class="sd">            If provided, the message embeds.</span>
<span class="sd">        mentions_everyone : hikari.UndefinedOr[bool]</span>
<span class="sd">            If provided, whether the message should parse @everyone/@here</span>
<span class="sd">            mentions.</span>
<span class="sd">        user_mentions : hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialUser], bool]]</span>
<span class="sd">            If provided, and `True`, all mentions will be parsed.</span>
<span class="sd">            If provided, and `False`, no mentions will be parsed.</span>

<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.Snowflake`, or</span>
<span class="sd">            `hikari.PartialUser` derivatives to enforce mentioning</span>
<span class="sd">            specific users.</span>
<span class="sd">        role_mentions : hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialRole], bool]]</span>
<span class="sd">            If provided, and `True`, all mentions will be parsed.</span>
<span class="sd">            If provided, and `False`, no mentions will be parsed.</span>
<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.Snowflake`, or</span>
<span class="sd">            `hikari.PartialRole` derivatives to enforce mentioning</span>
<span class="sd">            specific roles.</span>
<span class="sd">        tts : hikari.UndefinedOr[bool]</span>
<span class="sd">            If provided, whether the message will be sent as a TTS message.</span>
<span class="sd">        flags : typing.Union[hikari.UndefinedType, int, hikari.MessageFlag]</span>
<span class="sd">            The flags to set for this response.</span>

<span class="sd">            As of writing this can only flag which can be provided is EPHEMERAL,</span>
<span class="sd">            other flags are just ignored.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.Message</span>
<span class="sd">            The created message object.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        hikari.NotFoundError</span>
<span class="sd">            If the current interaction is not found or it hasn&#39;t had an initial</span>
<span class="sd">            response yet.</span>
<span class="sd">        hikari.BadRequestError</span>
<span class="sd">            This can be raised if the file is too large; if the embed exceeds</span>
<span class="sd">            the defined limits; if the message content is specified only and</span>
<span class="sd">            empty or greater than `2000` characters; if neither content, file</span>
<span class="sd">            or embeds are specified.</span>
<span class="sd">            If any invalid snowflake IDs are passed; a snowflake may be invalid</span>
<span class="sd">            due to it being outside of the range of a 64 bit integer.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If more than 100 unique objects/entities are passed for</span>
<span class="sd">            `role_mentions` or `user_mentions.</span>

<span class="sd">            If the interaction will have expired before `delete_after` is reached.</span>
<span class="sd">        TypeError</span>
<span class="sd">            If both `attachment` and `attachments` are specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create the initial response for this context.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            Calling this on a context which already has an initial</span>
<span class="sd">            response will result in this raising a `hikari.NotFoundError`.</span>
<span class="sd">            This includes if the REST interaction server has already responded</span>
<span class="sd">            to the request and deferrals.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        delete_after : typing.Union[datetime.timedelta, float, int, None]</span>
<span class="sd">            If provided, the seconds after which the response message should be delete.</span>

<span class="sd">            .. note::</span>
<span class="sd">                As of writing, this does not support ephemeral slash command responses.</span>
<span class="sd">        content : hikari.UndefinedOr[typing.Any]</span>
<span class="sd">            If provided, the message contents. If</span>
<span class="sd">            `hikari.UNDEFINED`, then nothing will be sent</span>
<span class="sd">            in the content. Any other value here will be cast to a</span>
<span class="sd">            `str`.</span>

<span class="sd">            If this is a `hikari.Embed` and no `embed` nor `embeds` kwarg</span>
<span class="sd">            is provided, then this will instead update the embed. This allows</span>
<span class="sd">            for simpler syntax when sending an embed alone.</span>
<span class="sd">        component : hikari.UndefinedOr[hikari.api.ComponentBuilder]</span>
<span class="sd">            If provided, builder object of the component to include in this message.</span>
<span class="sd">        components : hikari.UndefinedOr[collections.abc.Sequence[hikari.api.ComponentBuilder]]</span>
<span class="sd">            If provided, a sequence of the component builder objects to include</span>
<span class="sd">            in this message.</span>
<span class="sd">        embed : hikari.UndefinedOr[hikari.Embed]</span>
<span class="sd">            If provided, the message embed.</span>
<span class="sd">        embeds : hikari.UndefinedOr[collections.abc.Sequence[hikari.Embed]]</span>
<span class="sd">            If provided, the message embeds.</span>
<span class="sd">        flags : typing.Union[int, hikari.MessageFlag, hikari.UndefinedType]</span>
<span class="sd">            If provided, the message flags this response should have.</span>

<span class="sd">            As of writing the only message flag which can be set here is</span>
<span class="sd">            `hikari.MessageFlag.EPHEMERAL`.</span>
<span class="sd">        tts : hikari.UndefinedOr[bool]</span>
<span class="sd">            If provided, whether the message will be read out by a screen</span>
<span class="sd">            reader using Discord&#39;s TTS (text-to-speech) system.</span>
<span class="sd">        mentions_everyone : hikari.UndefinedOr[bool]</span>
<span class="sd">            If provided, whether the message should parse @everyone/@here</span>
<span class="sd">            mentions.</span>
<span class="sd">        user_mentions : hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialUser], bool]]</span>
<span class="sd">            If provided, and `True`, all user mentions will be detected.</span>
<span class="sd">            If provided, and `False`, all user mentions will be ignored</span>
<span class="sd">            if appearing in the message body.</span>

<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.Snowflake`, or</span>
<span class="sd">            `hikari.PartialUser` derivatives to enforce mentioning</span>
<span class="sd">            specific users.</span>
<span class="sd">        role_mentions : hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialRole], bool]]</span>
<span class="sd">            If provided, and `True`, all role mentions will be detected.</span>
<span class="sd">            If provided, and `False`, all role mentions will be ignored</span>
<span class="sd">            if appearing in the message body.</span>

<span class="sd">            Alternatively this may be a collection of</span>
<span class="sd">            `hikari.Snowflake`, or</span>
<span class="sd">            `hikari.PartialRole` derivatives to enforce mentioning</span>
<span class="sd">            specific roles.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If more than 100 unique objects/entities are passed for</span>
<span class="sd">            `role_mentions` or `user_mentions`.</span>

<span class="sd">            If the interaction will have expired before `delete_after` is reached.</span>
<span class="sd">        TypeError</span>
<span class="sd">            If both `embed` and `embeds` are specified.</span>
<span class="sd">        hikari.BadRequestError</span>
<span class="sd">            This may be raised in several discrete situations, such as messages</span>
<span class="sd">            being empty with no embeds; messages with more than</span>
<span class="sd">            2000 characters in them, embeds that exceed one of the many embed</span>
<span class="sd">            limits; invalid image URLs in embeds.</span>
<span class="sd">        hikari.UnauthorizedError</span>
<span class="sd">            If you are unauthorized to make the request (invalid/missing token).</span>
<span class="sd">        hikari.NotFoundError</span>
<span class="sd">            If the interaction is not found or if the interaction&#39;s initial</span>
<span class="sd">            response has already been created.</span>
<span class="sd">        hikari.RateLimitTooLongError</span>
<span class="sd">            Raised in the event that a rate limit occurs that is</span>
<span class="sd">            longer than `max_rate_limit` when making a request.</span>
<span class="sd">        hikari.RateLimitedError</span>
<span class="sd">            Usually, Hikari will handle and retry on hitting</span>
<span class="sd">            rate-limits automatically. This includes most bucket-specific</span>
<span class="sd">            rate-limits and global rate-limits. In some rare edge cases,</span>
<span class="sd">            however, Discord implements other undocumented rules for</span>
<span class="sd">            rate-limiting, such as limits per attribute. These cannot be</span>
<span class="sd">            detected or handled normally by Hikari due to their undocumented</span>
<span class="sd">            nature, and will trigger this exception if they occur.</span>
<span class="sd">        hikari.InternalServerError</span>
<span class="sd">            If an internal error occurs on Discord while handling the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">Hooks</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">ContextT_contra</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Interface of a collection of callbacks called during set stage of command execution.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">add_on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">ErrorHookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add an error callback to this hook object.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This won&#39;t be called for expected `tanjun.TanjunError` derived errors.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : ErrorHookSig</span>
<span class="sd">            The callback to add to this hook.</span>

<span class="sd">            This callback should take two positional arguments (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra` and `Exception`) and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">            Returning `True` indicates that the error should be suppressed,</span>
<span class="sd">            `False` that it should be re-raised and `None` that no decision has</span>
<span class="sd">            been made. This will be accounted for along with the decisions</span>
<span class="sd">            other error hooks make by majority rule.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">with_on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">ErrorHookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ErrorHookSigT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add an error callback to this hook object through a decorator call.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This won&#39;t be called for expected `tanjun.TanjunError` derived errors.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ```py</span>
<span class="sd">        hooks = AnyHooks()</span>

<span class="sd">        @hooks.with_on_error</span>
<span class="sd">        async def on_error(ctx: tanjun.abc.Context, error: Exception) -&gt; bool:</span>
<span class="sd">            if isinstance(error, SomeExpectedType):</span>
<span class="sd">                await ctx.respond(&quot;You dun goofed&quot;)</span>
<span class="sd">                return True  # Indicating that it should be suppressed.</span>

<span class="sd">            await ctx.respond(f&quot;An error occurred: {error}&quot;)</span>
<span class="sd">            return False  # Indicating that it should be re-raised</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : ErrorHookSigT</span>
<span class="sd">            The callback to add to this hook.</span>

<span class="sd">            This callback should take two positional arguments (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra` and `Exception`) and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">            Returning `True` indicates that the error shoul be suppressed,</span>
<span class="sd">            `False` that it should be re-raised and `None` that no decision</span>
<span class="sd">            has been made. This will be accounted for along with the decisions</span>
<span class="sd">            other error hooks make by majority rule.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ErrorHookSigT</span>
<span class="sd">            The hook callback which was added.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">add_on_parser_error</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">HookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a parser error callback to this hook object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : HookSig</span>
<span class="sd">            The callback to add to this hook.</span>

<span class="sd">            This callback should take two positional arguments (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra` and `tanjun.errors.ParserError`),</span>
<span class="sd">            return `None` and may be either synchronous or asynchronous.</span>

<span class="sd">            It&#39;s worth noting that this unlike general error handlers, this will</span>
<span class="sd">            always suppress the error.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">with_on_parser_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">HookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HookSigT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a parser error callback to this hook object through a decorator call.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ```py</span>
<span class="sd">        hooks = AnyHooks()</span>

<span class="sd">        @hooks.with_on_parser_error</span>
<span class="sd">        async def on_parser_error(ctx: tanjun.abc.Context, error: tanjun.errors.ParserError) -&gt; None:</span>
<span class="sd">            await ctx.respond(f&quot;You gave invalid input: {error}&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : HookSigT</span>
<span class="sd">            The parser error callback to add to this hook.</span>

<span class="sd">            This callback should take two positional arguments (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra` and `tanjun.errors.ParserError`),</span>
<span class="sd">            return `None` and may be either synchronous or asynchronous.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        HookSigT</span>
<span class="sd">            The callback which was added.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">add_post_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">HookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a post-execution callback to this hook object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : HookSig</span>
<span class="sd">            The callback to add to this hook.</span>

<span class="sd">            This callback should take one positional argument (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra`), return `None` and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">with_post_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">HookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HookSigT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a post-execution callback to this hook object through a decorator call.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ```py</span>
<span class="sd">        hooks = AnyHooks()</span>

<span class="sd">        @hooks.with_post_execution</span>
<span class="sd">        async def post_execution(ctx: tanjun.abc.Context) -&gt; None:</span>
<span class="sd">            await ctx.respond(&quot;You did something&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : HookSigT</span>
<span class="sd">            The post-execution callback to add to this hook.</span>

<span class="sd">            This callback should take one positional argument (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra`), return `None` and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        HookSigT</span>
<span class="sd">            The post-execution callback which was seaddedt.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">add_pre_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">HookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a pre-execution callback for this hook object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : HookSig</span>
<span class="sd">            The callback to add to this hook.</span>

<span class="sd">            This callback should take one positional argument (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra`), return `None` and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">with_pre_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">HookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HookSigT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a pre-execution callback to this hook object through a decorator call.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ```py</span>
<span class="sd">        hooks = AnyHooks()</span>

<span class="sd">        @hooks.with_pre_execution</span>
<span class="sd">        async def pre_execution(ctx: tanjun.abc.Context) -&gt; None:</span>
<span class="sd">            await ctx.respond(&quot;You did something&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : HookSigT</span>
<span class="sd">            The pre-execution callback to add to this hook.</span>

<span class="sd">            This callback should take one positional argument (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra`), return `None` and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        HookSigT</span>
<span class="sd">            The pre-execution callback which was added.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">add_on_success</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">HookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a success callback to this hook object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : HookSig</span>
<span class="sd">            The callback to add to this hook.</span>

<span class="sd">            This callback should take one positional argument (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra`), return `None` and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">with_on_success</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">HookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HookSigT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a success callback to this hook object through a decorator call.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ```py</span>
<span class="sd">        hooks = AnyHooks()</span>

<span class="sd">        @hooks.with_on_success</span>
<span class="sd">        async def on_success(ctx: tanjun.abc.Context) -&gt; None:</span>
<span class="sd">            await ctx.respond(&quot;You did something&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : HookSigT</span>
<span class="sd">            The success callback to add to this hook.</span>

<span class="sd">            This callback should take one positional argument (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra`), return `None` and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        HookSigT</span>
<span class="sd">            The success callback which was added.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">trigger_error</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">ContextT_contra</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">exception</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">Hooks</span><span class="p">[</span><span class="n">ContextT_contra</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">trigger_post_execution</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">ContextT_contra</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">Hooks</span><span class="p">[</span><span class="n">ContextT_contra</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">trigger_pre_execution</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">ContextT_contra</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">Hooks</span><span class="p">[</span><span class="n">ContextT_contra</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">trigger_success</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">ContextT_contra</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">Hooks</span><span class="p">[</span><span class="n">ContextT_contra</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>


<span class="n">AnyHooks</span> <span class="o">=</span> <span class="n">Hooks</span><span class="p">[</span><span class="n">Context</span><span class="p">]</span>
<span class="sd">&quot;&quot;&quot;Execution hooks for any context.&quot;&quot;&quot;</span>

<span class="n">MessageHooks</span> <span class="o">=</span> <span class="n">Hooks</span><span class="p">[</span><span class="n">MessageContext</span><span class="p">]</span>
<span class="sd">&quot;&quot;&quot;Execution hooks for messages commands.&quot;&quot;&quot;</span>

<span class="n">SlashHooks</span> <span class="o">=</span> <span class="n">Hooks</span><span class="p">[</span><span class="n">SlashContext</span><span class="p">]</span>
<span class="sd">&quot;&quot;&quot;Execution hooks for slash commands.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">ExecutableCommand</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">ContextT_co</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Base class for all commands that can be executed.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">checks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">CheckSig</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Collection of checks that must be met before the command can be executed.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">Component</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Component that the command is registered with.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">Hooks</span><span class="p">[</span><span class="n">ContextT_co</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Hooks that are triggered when the command is executed.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Mutable mapping of metadata set for this command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Any modifications made to this mutable mapping will be preserved by</span>
<span class="sd">            the command.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a copy of this command.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            A copy of this command.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">set_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">Hooks</span><span class="p">[</span><span class="n">ContextT_co</span><span class="p">]],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the hooks that are triggered when the command is executed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[Hooks[ContextT_co]]</span>
<span class="sd">            The hooks that are triggered when the command is executed.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This command to enable chained calls</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">add_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>  <span class="c1"># TODO: remove or add with_check?</span>
        <span class="sd">&quot;&quot;&quot;Add a check to the command.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : CheckSig</span>
<span class="sd">            The check to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This command to enable chained calls</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">remove_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a check from the command.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : CheckSig</span>
<span class="sd">            The check to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the provided check isn&#39;t found.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This command to enable chained calls</span>
<span class="sd">        &quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">BaseSlashCommand</span><span class="p">(</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">SlashContext</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for all slash command classes.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">defaults_to_ephemeral</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Whether contexts executed by this command should default to ephemeral responses.</span>

<span class="sd">        This effects calls to `SlashContext.create_followup`,</span>
<span class="sd">        `SlashContext.create_initial_response`, `SlashContext.defer` and</span>
<span class="sd">        `SlashContext.respond` unless the `flags` field is provided for the</span>
<span class="sd">        methods which support it.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether calls to this command should default to ephemeral mode.</span>

<span class="sd">            If this is `None` then the default from the parent command(s),</span>
<span class="sd">            component or client is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">is_global</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether the command should be declared globally or not.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            For commands within command groups the state of this flag</span>
<span class="sd">            is inherited regardless of what it&#39;s set as on the child command.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Name of the command.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">SlashCommandGroup</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Object of the group this command is in.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">tracked_command_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;ID of the actual command this object tracks if set.</span>

<span class="sd">        This will be used when this command is used in bulk declarations.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">CommandBuilder</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get a builder object for this command.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.api.CommandBuilder</span>
<span class="sd">            A builder object for this command. Use to declare this command on</span>
<span class="sd">            globally or for a specific guild.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">check_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">SlashContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">SlashContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">option</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteractionOption</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">SlashHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">SlashCommandGroup</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">set_tracked_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the global command this tracks.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : hikari.Command</span>
<span class="sd">            Object of the global command this tracks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">SlashCommand</span><span class="p">(</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A command that can be executed in a slash context.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandCallbackSig</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Callback which is called during execution.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">SlashCommandGroup</span><span class="p">(</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Standard interface of a slash command group.</span>

<span class="sd">    .. note::</span>
<span class="sd">        Unlike `MessageCommandGroup`, slash command groups do not have</span>
<span class="sd">        their own callback.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Collection of the commands in this group.&quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">add_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a command to this group.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : BaseSlashCommand</span>
<span class="sd">            The command to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command group instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">remove_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a command from this group.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : BaseSlashCommand</span>
<span class="sd">            The command to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the provided command isn&#39;t found.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command group instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">with_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">BaseSlashCommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseSlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a command to this group through a decorator call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : BaseSlashCommand</span>
<span class="sd">            The command to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        BaseSlashCommand</span>
<span class="sd">            The added command.</span>
<span class="sd">        &quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">MessageCommand</span><span class="p">(</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">MessageContext</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Standard interface of a message command.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandCallbackSig</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Callback which is called during execution.</span>

<span class="sd">        .. note::</span>
<span class="sd">            For command groups, this is called when none of the inner-commands</span>
<span class="sd">            matches the message.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Collection of this command&#39;s names.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">MessageCommandGroup</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Parent group of this command if it&#39;s onwned by a group.&quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">MessageCommandGroup</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the parent of this command.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parent : typing.Optional[MessageCommandGroup]</span>
<span class="sd">            The parent of this command.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">MessageCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a copy of this command.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        parent : typing.Optional[MessageCommandGroup]</span>
<span class="sd">            The parent of the copy.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The copy.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">check_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">Hooks</span><span class="p">[</span><span class="n">MessageContext</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>


<span class="k">class</span> <span class="nc">MessageCommandGroup</span><span class="p">(</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Standard interface of a message command group.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">MessageCommand</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Collection of the commands in this group.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This may include command groups.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">add_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">MessageCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a command to this group.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : MessageCommand</span>
<span class="sd">            The command to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The group instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">remove_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">MessageCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a command from this group.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : MessageCommand</span>
<span class="sd">            The command to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the provided command isn&#39;t found.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The group instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">with_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">MessageCommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MessageCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a command to this group through a decorator call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : MessageCommand</span>
<span class="sd">            The command to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MessageCommand</span>
<span class="sd">            The added command.</span>
<span class="sd">        &quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">Component</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Standard interface of a Tanjun component.</span>

<span class="sd">    This is a collection of message and slash commands, and listeners</span>
<span class="sd">    with logic for command search + execution and loading the listeners</span>
<span class="sd">    into a tanjun client.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">Client</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Tanjun client this component is bound to.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">defaults_to_ephemeral</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Whether slash contexts executed in this component should default to ephemeral responses.</span>

<span class="sd">        This effects calls to `SlashContext.create_followup`,</span>
<span class="sd">        `SlashContext.create_initial_response`, `SlashContext.defer` and</span>
<span class="sd">        `SlashContext.respond` unless the `flags` field is provided for the</span>
<span class="sd">        methods which support it.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This may be overridden by `BaseSlashCommand.defaults_to_ephemeral`.</span>
<span class="sd">        * This only effects slash command execution.</span>
<span class="sd">        * If this is `None` then the default from the parent client is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Component&#39;s unique identifier.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will be preserved between copies of a component.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">slash_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Collection of the slash commands in this component.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">message_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">MessageCommand</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Collection of the message commands in this component.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">listeners</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">ListenerCallbackSig</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Mapping of event types to the listeners registered for them in this component.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Mutable mapping of the metadata set for this component.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Any modifications made to this mutable mapping will be preserved by</span>
<span class="sd">            the component.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">add_slash_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a slash command to this component.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : BaseSlashCommand</span>
<span class="sd">            The command to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The component to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">remove_slash_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a slash command from this component.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : BaseSlashCommand</span>
<span class="sd">            The command to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the provided command isn&#39;t found.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The component to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">with_slash_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">BaseSlashCommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseSlashCommandT</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">with_slash_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">BaseSlashCommandT</span><span class="p">],</span> <span class="n">BaseSlashCommandT</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">with_slash_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">BaseSlashCommandT</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">BaseSlashCommandT</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">BaseSlashCommandT</span><span class="p">],</span> <span class="n">BaseSlashCommandT</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Add a slash command to this component through a decorator call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : BaseSlashCommandT</span>
<span class="sd">            The command to add.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        copy : bool</span>
<span class="sd">            Whether to copy the command before adding it.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        BaseSlashCommandT</span>
<span class="sd">            The added command.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">add_message_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">MessageCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a message command to this component.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : MessageCommand</span>
<span class="sd">            The command to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The component to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">remove_message_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">MessageCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a message command from this component.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : MessageCommand</span>
<span class="sd">            The command to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the provided command isn&#39;t found.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The component to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">with_message_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">MessageCommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MessageCommandT</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">with_message_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">MessageCommandT</span><span class="p">],</span> <span class="n">MessageCommandT</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">with_message_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">MessageCommandT</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">MessageCommandT</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">MessageCommandT</span><span class="p">],</span> <span class="n">MessageCommandT</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Add a message command to this component through a decorator call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : MessageCommandT</span>
<span class="sd">            The command to add.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        copy : bool</span>
<span class="sd">            Whether to copy the command before adding it.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MessageCommandT</span>
<span class="sd">            The added command.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">add_listener</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">listener</span><span class="p">:</span> <span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a listener to this component.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : type[hikari.Event]</span>
<span class="sd">            The event to listen for.</span>
<span class="sd">        listener : ListenerCallbackSig</span>
<span class="sd">            The listener to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The component to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">remove_listener</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">listener</span><span class="p">:</span> <span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a listener from this component.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : type[hikari.Event]</span>
<span class="sd">            The event to listen for.</span>
<span class="sd">        listener : ListenerCallbackSig</span>
<span class="sd">            The listener to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the listener is not registered for the provided event.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The component to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="c1"># TODO: make event optional?</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">with_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ListenerCallbackSigT</span><span class="p">],</span> <span class="n">ListenerCallbackSigT</span><span class="p">,]:</span>
        <span class="sd">&quot;&quot;&quot;Add a listener to this component through a decorator call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event_type : type[hikari.Event]</span>
<span class="sd">            The event to listen for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Callable[[ListenerCallbackSigT], ListenerCallbackSigT]</span>
<span class="sd">            Decorator callback which takes listener to add.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">unbind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">check_message_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MessageCommand</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Check whether a name matches any of this component&#39;s registered message commands.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This only checks for name matches against the top level command and</span>
<span class="sd">          will not account for sub-commands.</span>
<span class="sd">        * Dependent on implementation detail this may partial check name against</span>
<span class="sd">          command names using name.startswith(command_name), hence why it</span>
<span class="sd">          also returns the name a command was matched by.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The name to check for command matches.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Iterator[tuple[str, MessageCommand]]</span>
<span class="sd">            Iterator of tuples of command name matches to the relevant message</span>
<span class="sd">            command objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">check_slash_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Check whether a name matches any of this component&#39;s registered slash commands.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This won&#39;t check for sub-commands and will expect `name` to simply be</span>
<span class="sd">            the top level command name.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The name to check for command matches.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Iterator[BaseSlashCommand]</span>
<span class="sd">            An iterator of the matching slash commands.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute_interaction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">SlashContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">SlashHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Execute a slash context.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Unlike `Component.execute_message`, this shouldn&#39;t be expected to</span>
<span class="sd">            raise `tanjun.errors.HaltExecution` nor `tanjun.errors.CommandError`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ctx : SlashContext</span>
<span class="sd">            The context to execute.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        hooks : typing.Optional[collections.abc.MutableSet[SlashHooks]] = None</span>
<span class="sd">            Set of hooks to include in this command execution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[collections.abc.Awaitable[None]]</span>
<span class="sd">            Awaitable used to wait for the command execution to finish.</span>

<span class="sd">            This may be awaited or left to run as a background task.</span>

<span class="sd">            If this is `None` then the client should carry on its search for a</span>
<span class="sd">            component with a matching command.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute_message</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">MessageHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a message context.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ctx : MessageContext</span>
<span class="sd">            The context to execute.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        hooks : typing.Optional[collections.abc.MutableSet[MessageHooks]] = None</span>
<span class="sd">            Set of hooks to include in this command execution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether a message command was executed in this component with the</span>
<span class="sd">            provided context.</span>

<span class="sd">            If `False` then the client should carry on its search for a</span>
<span class="sd">            component with a matching command.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        tanjun.errors.CommandError</span>
<span class="sd">            To end the command&#39;s execution with an error response message.</span>
<span class="sd">        tanjun.errors.HaltExecution</span>
<span class="sd">            To indicate that the client should stop searching for commands to</span>
<span class="sd">            execute with the current context.</span>
<span class="sd">        &quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">Client</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Abstract interface of a Tanjun client.</span>

<span class="sd">    This should manage both message and slash command execution based on the</span>
<span class="sd">    provided hikari clients.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Hikari cache instance this command client was initialised with.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">Component</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Collection of the components this command client is using.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">defaults_to_ephemeral</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether slash contexts spawned by this client should default to ephemeral responses.</span>

<span class="sd">        This effects calls to `SlashContext.create_followup`,</span>
<span class="sd">        `SlashContext.create_initial_response`, `SlashContext.defer` and</span>
<span class="sd">        `SlashContext.respond` unless the `flags` field is provided for the</span>
<span class="sd">        methods which support it.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This may be overridden by `BaseSlashCommand.defaults_to_ephemeral`</span>
<span class="sd">          and `Component.defaults_to_ephemeral`.</span>
<span class="sd">        * This defaults to `False`.</span>
<span class="sd">        * This only effects slash command execution.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">events</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Object of the event manager this client was initialised with.</span>

<span class="sd">        This is used for executing message commands if set.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">is_alive</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether this client is alive.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>  <span class="c1"># TODO: switch over to a mapping of event to collection cause convenience</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">listeners</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">ListenerCallbackSig</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Mapping of event types to the listeners registered in this client.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Mutable mapping of the metadata set for this client.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Any modifications made to this mutable mapping will be preserved by</span>
<span class="sd">            the client.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">prefixes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Collection of the prefixes set for this client.</span>

<span class="sd">        These are only use during message command execution to match commands</span>
<span class="sd">        to this command client.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">rest</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Object of the Hikari REST client this client was initialised with.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">server</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Object of the Hikari interaction server provided for this client.</span>

<span class="sd">        This is used for executing slash commands if set.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">shards</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Object of the Hikari shard manager this client was initialised with.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">voice</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">VoiceComponent</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Object of the Hikari voice component this client was initialised with.&quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">clear_slash_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clear the commands declared either globally or for a specific guild.</span>

<span class="sd">        .. note::</span>
<span class="sd">            The endpoint this uses has a strict ratelimit which, as of writing,</span>
<span class="sd">            only allows for 2 requests per minute (with that ratelimit either</span>
<span class="sd">            being per-guild if targeting a specific guild otherwise globally).</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        application : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]</span>
<span class="sd">            The application to clear commands for.</span>

<span class="sd">            If left as `None` then this will be inferred from the authorization</span>
<span class="sd">            being used by `Client.rest`.</span>
<span class="sd">        guild : hikari.UndefinedOr[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]</span>
<span class="sd">            Object or ID of the guild to clear commands for.</span>

<span class="sd">            If left as `None` global commands will be cleared.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_global_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Set the global application commands for a bot based on the loaded components.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            This will overwrite any previously set application commands and</span>
<span class="sd">            only targets commands marked as global.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * The endpoint this uses has a strict ratelimit which, as of writing,</span>
<span class="sd">          only allows for 2 requests per minute (with that ratelimit either</span>
<span class="sd">          being per-guild if targeting a specific guild otherwise globally).</span>
<span class="sd">        * Setting a specific `guild` can be useful for testing/debug purposes</span>
<span class="sd">          as slash commands may take up to an hour to propagate globally but</span>
<span class="sd">          will immediately propagate when set on a specific guild.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">            If provided, a mapping of top level command names to IDs of the existing commands to update.</span>
<span class="sd">        application : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]</span>
<span class="sd">            Object or ID of the application to set the global commands for.</span>

<span class="sd">            If left as `None` then this will be inferred from the authorization</span>
<span class="sd">            being used by `Client.rest`.</span>
<span class="sd">        guild : hikari.UndefinedOr[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]</span>
<span class="sd">            Object or ID of the guild to set the global commands to.</span>

<span class="sd">            If left as `None` global commands will be set.</span>
<span class="sd">        force : bool</span>
<span class="sd">            Force this to declare the commands regardless of whether or not</span>
<span class="sd">            they match the current state of the declared commands.</span>

<span class="sd">            Defaults to `False`. This default behaviour helps avoid issues with the</span>
<span class="sd">            2 request per minute (per-guild or globally) ratelimit and the other limit</span>
<span class="sd">            of only 200 application command creates per day (per guild or globally).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Sequence[hikari..Command]</span>
<span class="sd">            API representations of the set commands.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_slash_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">BaseSlashCommand</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflakeish</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Declare a single slash command for a bot.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            Providing `command_id` when updating a command helps avoid any</span>
<span class="sd">            permissions set for the command being lose (e.g. when changing the</span>
<span class="sd">            command&#39;s name).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : BaseSlashCommand</span>
<span class="sd">            The command to register.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        application : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]</span>
<span class="sd">            The application to register the command with.</span>

<span class="sd">            If left as `None` then this will be inferred from the authorization</span>
<span class="sd">            being used by `Client.rest`.</span>
<span class="sd">        command_id : typing.Optional[hikari.snowflakes.Snowflakeish]</span>
<span class="sd">            ID of the command to update.</span>
<span class="sd">        guild : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]</span>
<span class="sd">            Object or ID of the guild to register the command with.</span>

<span class="sd">            If left as `None` then the command will be registered globally.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.Command</span>
<span class="sd">            API representation of the command that was registered.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_slash_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">commands</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">BaseSlashCommand</span><span class="p">],</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Declare a collection of slash commands for a bot.</span>

<span class="sd">        .. note::</span>
<span class="sd">            The endpoint this uses has a strict ratelimit which, as of writing,</span>
<span class="sd">            only allows for 2 requests per minute (with that ratelimit either</span>
<span class="sd">            being per-guild if targeting a specific guild otherwise globally).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        commands : collections.abc.Iterable[BaseSlashCommand]</span>
<span class="sd">            Iterable of the commands to register.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">            If provided, a mapping of top level command names to IDs of the existing commands to update.</span>

<span class="sd">            While optional, this can be helpful when updating commands as</span>
<span class="sd">            providing the current IDs will prevent changes such as renames from</span>
<span class="sd">            leading to other state set for commands (e.g. permissions) from</span>
<span class="sd">            being lost.</span>
<span class="sd">        application : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]</span>
<span class="sd">            The application to register the commands with.</span>

<span class="sd">            If left as `None` then this will be inferred from the authorization</span>
<span class="sd">            being used by `Client.rest`.</span>
<span class="sd">        guild : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]</span>
<span class="sd">            Object or ID of the guild to register the commands with.</span>

<span class="sd">            If left as `None` then the commands will be registered globally.</span>
<span class="sd">        force : bool</span>
<span class="sd">            Force this to declare the commands regardless of whether or not</span>
<span class="sd">            they match the current state of the declared commands.</span>

<span class="sd">            Defaults to `False`. This default behaviour helps avoid issues with the</span>
<span class="sd">            2 request per minute (per-guild or globally) ratelimit and the other limit</span>
<span class="sd">            of only 200 application command creates per day (per guild or globally).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Sequence[hikari.Command]</span>
<span class="sd">            API representations of the commands which were registered.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If conflicting command names are found (multiple commanbds have the same top-level name).</span>
<span class="sd">            * If more than 100 top-level commands are passed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">add_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a component to this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        component: Component</span>
<span class="sd">            The component to move to this client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to allow chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_component_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">Component</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get a component from this client by name.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Name to get a component by.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[Component]</span>
<span class="sd">            The component instance if found, else `None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">remove_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a component from this client.</span>

<span class="sd">        This will unsubscribe any client callbacks, commands and listeners</span>
<span class="sd">        registered in the provided component.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        component: Component</span>
<span class="sd">            The component to remove from this client.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the provided component isn&#39;t found.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to allow chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">remove_component_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a component from this client by name.</span>

<span class="sd">        This will unsubscribe any client callbacks, commands and listeners</span>
<span class="sd">        registered in the provided component.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name: str</span>
<span class="sd">            Name of the component to remove from this client.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        KeyError</span>
<span class="sd">            If the provided component name isn&#39;t found.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">add_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a client callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        _name : str</span>
<span class="sd">            The name this callback is being registered to.</span>

<span class="sd">            This is case-insensitive.</span>
<span class="sd">        callback : MetaEventSigT</span>
<span class="sd">            The callback to register.</span>

<span class="sd">            This may be sync or async and must return None. The positional and</span>
<span class="sd">            keyword arguments a callback should expect depend on implementation</span>
<span class="sd">            detail around the `name` being subscribed to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_client_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">MetaEventSig</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get a collection of the callbacks registered for a specific name.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The name to get the callbacks registered for.</span>

<span class="sd">            This is case-insensitive.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Collection[MetaEventSig]</span>
<span class="sd">            Collection of the callbacks for the provided name.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">remove_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a client callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The name this callback is being registered to.</span>

<span class="sd">            This is case-insensitive.</span>
<span class="sd">        callback : MetaEventSigT</span>
<span class="sd">            The callback to remove from the client&#39;s callbacks.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        KeyError</span>
<span class="sd">            If the provided name isn&#39;t found.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the provided callback isn&#39;t found.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">with_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">MetaEventSigT</span><span class="p">],</span> <span class="n">MetaEventSigT</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Add a client callback through a decorator call.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ```py</span>
<span class="sd">        client = tanjun.Client.from_rest_bot(bot)</span>

<span class="sd">        @client.with_client_callback(&quot;closed&quot;)</span>
<span class="sd">        async def on_close() -&gt; None:</span>
<span class="sd">            raise NotImplementedError</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The name this callback is being registered to.</span>

<span class="sd">            This is case-insensitive.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Callable[[MetaEventSigT], MetaEventSigT]</span>
<span class="sd">            Decorator callback used to register the client callback.</span>

<span class="sd">            This may be sync or async and must return None. The positional and</span>
<span class="sd">            keyword arguments a callback should expect depend on implementation</span>
<span class="sd">            detail around the `name` being subscribed to.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">add_listener</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">callback</span><span class="p">:</span> <span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a listener to the client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event_type : type[hikari.Event]</span>
<span class="sd">            The event type to add a listener for.</span>
<span class="sd">        callback: ListenerCallbackSig</span>
<span class="sd">            The callback to register as a listener.</span>

<span class="sd">            This callback must be a coroutine function which returns `None` and</span>
<span class="sd">            always takes at least one positional arg of type `hikari.Event`</span>
<span class="sd">            regardless of client implementation detail.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">remove_listener</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">callback</span><span class="p">:</span> <span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a listener from the client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event_type : type[hikari.Event]</span>
<span class="sd">            The event type to remove a listener for.</span>
<span class="sd">        callback: ListenerCallbackSig</span>
<span class="sd">            The callback to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        KeyError</span>
<span class="sd">            If the provided event type isn&#39;t found.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the provided callback isn&#39;t found.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">with_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ListenerCallbackSigT</span><span class="p">],</span> <span class="n">ListenerCallbackSigT</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Add an event listener to this client through a decorator call.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ```py</span>
<span class="sd">        client = tanjun.Client.from_gateway_bot(bot)</span>

<span class="sd">        @client.with_listener(hikari.MessageCreateEvent)</span>
<span class="sd">        async def on_message_create(event: hikari.MessageCreateEvent) -&gt; None:</span>
<span class="sd">            raise NotImplementedError</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event_type : type[hikari.Event]</span>
<span class="sd">            The event type to listener for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Callable[[ListenerCallbackSigT], ListenerCallbackSigT]</span>
<span class="sd">            Decorator callback used to register the event callback.</span>

<span class="sd">            The callback must be a coroutine function which returns `None` and</span>
<span class="sd">            always takes at least one positional arg of type `hikari.Event`</span>
<span class="sd">            regardless of client implementation detail.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">iter_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">Context</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Iterate over all the commands (both message and slash) registered to this client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Iterator[ExecutableCommand[Context]]</span>
<span class="sd">            Iterator of all the commands registered to this client.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">iter_message_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">MessageCommand</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Iterate over all the message commands registered to this client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Iterator[MessageCommand]</span>
<span class="sd">            Iterator of all the message commands registered to this client.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">iter_slash_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">global_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Iterate over all the slash commands registered to this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        global_only : bool</span>
<span class="sd">            Whether to only iterate over global slash commands.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Iterator[BaseSlashCommand]</span>
<span class="sd">            Iterator of all the slash commands registered to this client.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">check_message_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MessageCommand</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Check whether a message command name is present in the current client.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Dependent on implementation this may partial check name against the</span>
<span class="sd">            message command&#39;s name based on command_name.startswith(name).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The name to match commands against.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Iterator[tuple[str, MessageCommand]]</span>
<span class="sd">            Iterator of the matched command names to the matched message command objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">check_slash_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Check whether a slash command name is present in the current client.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This won&#39;t check the commands within command groups.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Name to check against.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Iterator[BaseSlashCommand]</span>
<span class="sd">            Iterator of the matched slash command objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</pre></div>

        </details>

            <div class="docstring"><p>Interfaces of the objects and clients used within Tanjun.</p>
</div>


                </section>
                <section id="checks">
                                <div class="attr module"><a class="headerlink" href="#checks">#&nbsp;&nbsp</a>
<span class="name"><a href="tanjun/checks.html">tanjun.checks</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;A collection of common standard checks designed for Tanjun commands.&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;CallbackReturnT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CommandT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;OwnerCheck&quot;</span><span class="p">,</span>
    <span class="s2">&quot;NsfwCheck&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SfwCheck&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DmCheck&quot;</span><span class="p">,</span>
    <span class="s2">&quot;GuildCheck&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AuthorPermissionCheck&quot;</span><span class="p">,</span>
    <span class="s2">&quot;OwnPermissionCheck&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_check&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_dm_check&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_guild_check&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_nsfw_check&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_sfw_check&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_owner_check&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_author_permission_check&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_own_permission_check&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">collections</span>

<span class="kn">import</span> <span class="nn">hikari</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">dependencies</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">errors</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">injecting</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">utilities</span>

<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">tanjun_abc</span>


<span class="n">CommandT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;CommandT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;tanjun_abc.ExecutableCommand[typing.Any]&quot;</span><span class="p">)</span>
<span class="c1"># This errors on earlier 3.9 releases when not quotes cause dumb handling of the [CommandT] list</span>
<span class="n">CallbackReturnT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">CommandT</span><span class="p">,</span> <span class="s2">&quot;collections.Callable[[CommandT], CommandT]&quot;</span><span class="p">]</span>
<span class="sd">&quot;&quot;&quot;Type hint for the return value of decorators which optionally take keyword arguments.</span>

<span class="sd">Examples</span>
<span class="sd">--------</span>
<span class="sd">Decorator functions with this as their return type may either be used as a</span>
<span class="sd">decorator directly without being explicitly called:</span>

<span class="sd">```python</span>
<span class="sd">@with_dm_check</span>
<span class="sd">@as_command(&quot;foo&quot;)</span>
<span class="sd">def foo_command(self, ctx: Context) -&gt; None:</span>
<span class="sd">    raise NotImplemented</span>
<span class="sd">```</span>

<span class="sd">Or may be called with the listed other parameters as keyword arguments</span>
<span class="sd">while decorating a function.</span>

<span class="sd">```python</span>
<span class="sd">@with_dm_check(halt_execution=True)</span>
<span class="sd">@as_command(&quot;foo&quot;)</span>
<span class="sd">def foo_command(self, ctx: Context) -&gt; None:</span>
<span class="sd">    raise NotImplemented</span>
<span class="sd">```</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">InjectableCheck</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="nb">bool</span><span class="p">]):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">:=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">FailedCheck</span>


<span class="k">def</span> <span class="nf">_optional_kwargs</span><span class="p">(</span>
    <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CommandT</span><span class="p">],</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">CommandT</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandT</span><span class="p">],</span> <span class="n">CommandT</span><span class="p">]]:</span>
    <span class="k">if</span> <span class="n">command</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">command</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>

    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_Check</span><span class="p">:</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_error_message&quot;</span><span class="p">,</span> <span class="s2">&quot;_halt_execution&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_error_message</span> <span class="o">=</span> <span class="n">error_message</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_halt_execution</span> <span class="o">=</span> <span class="n">halt_execution</span>

    <span class="k">def</span> <span class="nf">_handle_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_error_message</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_error_message</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_halt_execution</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span> <span class="kn">from</span> <span class="bp">None</span>

        <span class="k">return</span> <span class="n">result</span>


<span class="k">class</span> <span class="nc">OwnerCheck</span><span class="p">(</span><span class="n">_Check</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Only bot owners can use this command&quot;</span><span class="p">,</span>
        <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">error_message</span><span class="p">,</span> <span class="n">halt_execution</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
        <span class="n">dependency</span><span class="p">:</span> <span class="n">dependencies</span><span class="o">.</span><span class="n">AbstractOwnerCheck</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">dependencies</span><span class="o">.</span><span class="n">AbstractOwnerCheck</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_result</span><span class="p">(</span><span class="k">await</span> <span class="n">dependency</span><span class="o">.</span><span class="n">check_ownership</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">ctx</span><span class="o">.</span><span class="n">author</span><span class="p">))</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">_get_is_nsfw</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">dm_default</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="n">channel</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialChannel</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span> <span class="ow">and</span> <span class="p">(</span><span class="n">channel</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_guild_channel</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">channel_id</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">channel</span><span class="o">.</span><span class="n">is_nsfw</span> <span class="ow">or</span> <span class="kc">False</span>

    <span class="n">channel</span> <span class="o">=</span> <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_channel</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">channel_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">channel</span><span class="o">.</span><span class="n">is_nsfw</span> <span class="ow">or</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">GuildChannel</span><span class="p">)</span> <span class="k">else</span> <span class="n">dm_default</span>


<span class="k">class</span> <span class="nc">NsfwCheck</span><span class="p">(</span><span class="n">_Check</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command can only be used in NSFW channels&quot;</span><span class="p">,</span>
        <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">error_message</span><span class="p">,</span> <span class="n">halt_execution</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_result</span><span class="p">(</span><span class="k">await</span> <span class="n">_get_is_nsfw</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">dm_default</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">SfwCheck</span><span class="p">(</span><span class="n">_Check</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command can only be used in SFW channels&quot;</span><span class="p">,</span>
        <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">error_message</span><span class="p">,</span> <span class="n">halt_execution</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_result</span><span class="p">(</span><span class="ow">not</span> <span class="k">await</span> <span class="n">_get_is_nsfw</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">dm_default</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">DmCheck</span><span class="p">(</span><span class="n">_Check</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command can only be used in DMs&quot;</span><span class="p">,</span>
        <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">error_message</span><span class="p">,</span> <span class="n">halt_execution</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_result</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">GuildCheck</span><span class="p">(</span><span class="n">_Check</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command can only be used in guild channels&quot;</span><span class="p">,</span>
        <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">error_message</span><span class="p">,</span> <span class="n">halt_execution</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_result</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">AuthorPermissionCheck</span><span class="p">(</span><span class="n">_Check</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;permissions&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">permissions</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;You don&#39;t have the permissions required to use this command&quot;</span><span class="p">,</span>
        <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">error_message</span><span class="o">=</span><span class="n">error_message</span><span class="p">,</span> <span class="n">halt_execution</span><span class="o">=</span><span class="n">halt_execution</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span> <span class="o">=</span> <span class="n">permissions</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ctx</span><span class="o">.</span><span class="n">member</span><span class="p">:</span>
            <span class="c1"># If there&#39;s no member when this is within a guild then it&#39;s likely</span>
            <span class="c1"># something like a webhook or guild visitor with no real permissions</span>
            <span class="c1"># outside of some basic set of send messages</span>
            <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span><span class="p">:</span>
                <span class="n">permissions</span> <span class="o">=</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">fetch_everyone_permissions</span><span class="p">(</span>
                    <span class="n">ctx</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">ctx</span><span class="o">.</span><span class="n">channel_id</span>
                <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">permissions</span> <span class="o">=</span> <span class="n">utilities</span><span class="o">.</span><span class="n">DM_PERMISSIONS</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">member</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">):</span>
            <span class="n">permissions</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">member</span><span class="o">.</span><span class="n">permissions</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">permissions</span> <span class="o">=</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">fetch_permissions</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">ctx</span><span class="o">.</span><span class="n">member</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">ctx</span><span class="o">.</span><span class="n">channel_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_result</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">permissions</span> <span class="o">&amp;</span> <span class="n">permissions</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">OwnPermissionCheck</span><span class="p">(</span><span class="n">_Check</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;permissions&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">permissions</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Bot doesn&#39;t have the permissions required to run this command&quot;</span><span class="p">,</span>
        <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">error_message</span><span class="o">=</span><span class="n">error_message</span><span class="p">,</span> <span class="n">halt_execution</span><span class="o">=</span><span class="n">halt_execution</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span> <span class="o">=</span> <span class="n">permissions</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">my_user</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OwnUser</span> <span class="o">=</span> <span class="n">dependencies</span><span class="o">.</span><span class="n">inject_lc</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">OwnUser</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">permissions</span> <span class="o">=</span> <span class="n">utilities</span><span class="o">.</span><span class="n">DM_PERMISSIONS</span>

        <span class="k">elif</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span> <span class="ow">and</span> <span class="p">(</span><span class="n">member</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_member</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span><span class="p">,</span> <span class="n">my_user</span><span class="p">)):</span>
            <span class="n">permissions</span> <span class="o">=</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">fetch_permissions</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">member</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">ctx</span><span class="o">.</span><span class="n">channel_id</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">member</span> <span class="o">=</span> <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_member</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span><span class="p">,</span> <span class="n">my_user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

            <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">:</span>
                <span class="c1"># If we&#39;re not in the Guild then we have to assume the application</span>
                <span class="c1"># if still in there and that we likely won&#39;t be able to do anything.</span>
                <span class="c1"># TODO: re-visit this later.</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_result</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

            <span class="n">permissions</span> <span class="o">=</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">fetch_permissions</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">member</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">ctx</span><span class="o">.</span><span class="n">channel_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_result</span><span class="p">((</span><span class="n">permissions</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span><span class="p">)</span>


<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<span class="k">def</span> <span class="nf">with_dm_check</span><span class="p">(</span><span class="n">command</span><span class="p">:</span> <span class="n">CommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandT</span><span class="p">:</span>
    <span class="o">...</span>


<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<span class="k">def</span> <span class="nf">with_dm_check</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span> <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command can only be used in DMs&quot;</span><span class="p">,</span> <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandT</span><span class="p">],</span> <span class="n">CommandT</span><span class="p">]:</span>
    <span class="o">...</span>


<span class="k">def</span> <span class="nf">with_dm_check</span><span class="p">(</span>
    <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command can only be used in DMs&quot;</span><span class="p">,</span>
    <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackReturnT</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Only let a command run in a DM channel.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    command : typing.Optional[CommandT]</span>
<span class="sd">        The command to add this check to.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    error_message : typing.Optional[str]</span>
<span class="sd">        The error message to send in response as a command error if the check fails.</span>

<span class="sd">        Defaults to &quot;Command can only be used in DMs&quot; and setting this to `None`</span>
<span class="sd">        will disable the error message allowing the command search to continue.</span>
<span class="sd">    halt_execution : bool</span>
<span class="sd">        Whether this check should raise `tanjun.errors.HaltExecution` to</span>
<span class="sd">        end the execution search when it fails instead of returning `False`.</span>

<span class="sd">        Defaults to `False`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * error_message takes priority over halt_execution.</span>
<span class="sd">    * For more information on how this is used with other parameters see</span>
<span class="sd">      `CallbackReturnT`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CallbackReturnT[CommandT]</span>
<span class="sd">        The command this check was added to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_optional_kwargs</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">DmCheck</span><span class="p">(</span><span class="n">halt_execution</span><span class="o">=</span><span class="n">halt_execution</span><span class="p">,</span> <span class="n">error_message</span><span class="o">=</span><span class="n">error_message</span><span class="p">))</span>


<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<span class="k">def</span> <span class="nf">with_guild_check</span><span class="p">(</span><span class="n">command</span><span class="p">:</span> <span class="n">CommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandT</span><span class="p">:</span>
    <span class="o">...</span>


<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<span class="k">def</span> <span class="nf">with_guild_check</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span> <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command can only be used in guild channels&quot;</span><span class="p">,</span> <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandT</span><span class="p">],</span> <span class="n">CommandT</span><span class="p">]:</span>
    <span class="o">...</span>


<span class="k">def</span> <span class="nf">with_guild_check</span><span class="p">(</span>
    <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command can only be used in guild channels&quot;</span><span class="p">,</span>
    <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackReturnT</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Only let a command run in a guild channel.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    command : typing.Optional[CommandT]</span>
<span class="sd">        The command to add this check to.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    error_message : typing.Optional[str]</span>
<span class="sd">        The error message to send in response as a command error if the check fails.</span>

<span class="sd">        Defaults to &quot;Command can only be used in guild channels&quot; and setting this to `None`</span>
<span class="sd">        will disable the error message allowing the command search to continue.</span>
<span class="sd">    halt_execution : bool</span>
<span class="sd">        Whether this check should raise `tanjun.errors.HaltExecution` to</span>
<span class="sd">        end the execution search when it fails instead of returning `False`.</span>

<span class="sd">        Defaults to `False`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * error_message takes priority over halt_execution.</span>
<span class="sd">    * For more information on how this is used with other parameters see</span>
<span class="sd">      `CallbackReturnT`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CallbackReturnT[CommandT]</span>
<span class="sd">        The command this check was added to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_optional_kwargs</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">GuildCheck</span><span class="p">(</span><span class="n">halt_execution</span><span class="o">=</span><span class="n">halt_execution</span><span class="p">,</span> <span class="n">error_message</span><span class="o">=</span><span class="n">error_message</span><span class="p">))</span>


<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<span class="k">def</span> <span class="nf">with_nsfw_check</span><span class="p">(</span><span class="n">command</span><span class="p">:</span> <span class="n">CommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandT</span><span class="p">:</span>
    <span class="o">...</span>


<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<span class="k">def</span> <span class="nf">with_nsfw_check</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span> <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command can only be used in NSFW channels&quot;</span><span class="p">,</span> <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandT</span><span class="p">],</span> <span class="n">CommandT</span><span class="p">]:</span>
    <span class="o">...</span>


<span class="k">def</span> <span class="nf">with_nsfw_check</span><span class="p">(</span>
    <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command can only be used in NSFW channels&quot;</span><span class="p">,</span>
    <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackReturnT</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Only let a command run in a channel that&#39;s marked as nsfw.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    command : typing.Optional[CommandT]</span>
<span class="sd">        The command to add this check to.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    error_message : typing.Optional[str]</span>
<span class="sd">        The error message to send in response as a command error if the check fails.</span>

<span class="sd">        Defaults to &quot;Command can only be used in NSFW channels&quot; and setting this to `None`</span>
<span class="sd">        will disable the error message allowing the command search to continue.</span>
<span class="sd">    halt_execution : bool</span>
<span class="sd">        Whether this check should raise `tanjun.errors.HaltExecution` to</span>
<span class="sd">        end the execution search when it fails instead of returning `False`.</span>

<span class="sd">        Defaults to `False`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * error_message takes priority over halt_execution.</span>
<span class="sd">    * For more information on how this is used with other parameters see</span>
<span class="sd">      `CallbackReturnT`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CallbackReturnT[CommandT]</span>
<span class="sd">        The command this check was added to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_optional_kwargs</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">NsfwCheck</span><span class="p">(</span><span class="n">halt_execution</span><span class="o">=</span><span class="n">halt_execution</span><span class="p">,</span> <span class="n">error_message</span><span class="o">=</span><span class="n">error_message</span><span class="p">))</span>


<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<span class="k">def</span> <span class="nf">with_sfw_check</span><span class="p">(</span><span class="n">command</span><span class="p">:</span> <span class="n">CommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandT</span><span class="p">:</span>
    <span class="o">...</span>


<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<span class="k">def</span> <span class="nf">with_sfw_check</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command can only be used in SFW channels&quot;</span><span class="p">,</span>
    <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandT</span><span class="p">],</span> <span class="n">CommandT</span><span class="p">]:</span>
    <span class="o">...</span>


<span class="k">def</span> <span class="nf">with_sfw_check</span><span class="p">(</span>
    <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command can only be used in SFW channels&quot;</span><span class="p">,</span>
    <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackReturnT</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Only let a command run in a channel that&#39;s marked as sfw.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    command : typing.Optional[CommandT]</span>
<span class="sd">        The command to add this check to.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    error_message : typing.Optional[str]</span>
<span class="sd">        The error message to send in response as a command error if the check fails.</span>

<span class="sd">        Defaults to &quot;Command can only be used in SFW channels&quot; and setting this to `None`</span>
<span class="sd">        will disable the error message allowing the command search to continue.</span>
<span class="sd">    halt_execution : bool</span>
<span class="sd">        Whether this check should raise `tanjun.errors.HaltExecution` to</span>
<span class="sd">        end the execution search when it fails instead of returning `False`.</span>

<span class="sd">        Defaults to `False`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * error_message takes priority over halt_execution.</span>
<span class="sd">    * For more information on how this is used with other parameters see</span>
<span class="sd">      `CallbackReturnT`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CallbackReturnT[CommandT]</span>
<span class="sd">        The command this check was added to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_optional_kwargs</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">SfwCheck</span><span class="p">(</span><span class="n">halt_execution</span><span class="o">=</span><span class="n">halt_execution</span><span class="p">,</span> <span class="n">error_message</span><span class="o">=</span><span class="n">error_message</span><span class="p">))</span>


<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<span class="k">def</span> <span class="nf">with_owner_check</span><span class="p">(</span><span class="n">command</span><span class="p">:</span> <span class="n">CommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandT</span><span class="p">:</span>
    <span class="o">...</span>


<span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
<span class="k">def</span> <span class="nf">with_owner_check</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Only bot owners can use this command&quot;</span><span class="p">,</span>
    <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandT</span><span class="p">],</span> <span class="n">CommandT</span><span class="p">]:</span>
    <span class="o">...</span>


<span class="k">def</span> <span class="nf">with_owner_check</span><span class="p">(</span>
    <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Only bot owners can use this command&quot;</span><span class="p">,</span>
    <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackReturnT</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Only let a command run if it&#39;s being triggered by one of the bot&#39;s owners.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    command : typing.Optional[CommandT]</span>
<span class="sd">        The command to add this check to.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    error_message : typing.Optional[str]</span>
<span class="sd">        The error message to send in response as a command error if the check fails.</span>

<span class="sd">        Defaults to &quot;Only bot owners can use this command&quot; and setting this to `None`</span>
<span class="sd">        will disable the error message allowing the command search to continue.</span>
<span class="sd">    halt_execution : bool</span>
<span class="sd">        Whether this check should raise `tanjun.errors.HaltExecution` to</span>
<span class="sd">        end the execution search when it fails instead of returning `False`.</span>

<span class="sd">        Defaults to `False`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * error_message takes priority over halt_execution.</span>
<span class="sd">    * For more information on how this is used with other parameters see</span>
<span class="sd">      `CallbackReturnT`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CallbackReturnT[CommandT]</span>
<span class="sd">        The command this check was added to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_optional_kwargs</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">OwnerCheck</span><span class="p">(</span><span class="n">halt_execution</span><span class="o">=</span><span class="n">halt_execution</span><span class="p">,</span> <span class="n">error_message</span><span class="o">=</span><span class="n">error_message</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">with_author_permission_check</span><span class="p">(</span>
    <span class="n">permissions</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;You don&#39;t have the permissions required to use this command&quot;</span><span class="p">,</span>
    <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandT</span><span class="p">],</span> <span class="n">CommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Only let a command run if the author has certain permissions in the current channel.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    permissions: typing.Union[hikari.permissions.Permissions, int]</span>
<span class="sd">        The permission(s) required for this command to run.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    error_message : typing.Optional[str]</span>
<span class="sd">        The error message to send in response as a command error if the check fails.</span>

<span class="sd">        Defaults to &quot;You don&#39;t have the permissions required to use this command&quot; and setting this to `None`</span>
<span class="sd">        will disable the error message allowing the command search to continue.</span>
<span class="sd">    halt_execution : bool</span>
<span class="sd">        Whether this check should raise `tanjun.errors.HaltExecution` to</span>
<span class="sd">        end the execution search when it fails instead of returning `False`.</span>

<span class="sd">        Defaults to `False`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * error_message takes priority over halt_execution.</span>
<span class="sd">    * This will only pass for commands in DMs if `permissions` is valid for</span>
<span class="sd">      a DM context (e.g. can&#39;t have any moderation permissions)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[CommandT], CommandT]</span>
<span class="sd">        A command decorator callback which adds the check.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">command</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span>
        <span class="n">AuthorPermissionCheck</span><span class="p">(</span><span class="n">permissions</span><span class="p">,</span> <span class="n">halt_execution</span><span class="o">=</span><span class="n">halt_execution</span><span class="p">,</span> <span class="n">error_message</span><span class="o">=</span><span class="n">error_message</span><span class="p">)</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">with_own_permission_check</span><span class="p">(</span>
    <span class="n">permissions</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Bot doesn&#39;t have the permissions required to run this command&quot;</span><span class="p">,</span>
    <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandT</span><span class="p">],</span> <span class="n">CommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Only let a command run if we have certain permissions in the current channel.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    permissions: typing.Union[hikari.permissions.Permissions, int]</span>
<span class="sd">        The permission(s) required for this command to run.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    error_message : typing.Optional[str]</span>
<span class="sd">        The error message to send in response as a command error if the check fails.</span>

<span class="sd">        Defaults to &quot;Bot doesn&#39;t have the permissions required to run this command&quot; and setting this to `None`</span>
<span class="sd">        will disable the error message allowing the command search to continue.</span>
<span class="sd">    halt_execution : bool</span>
<span class="sd">        Whether this check should raise `tanjun.errors.HaltExecution` to</span>
<span class="sd">        end the execution search when it fails instead of returning `False`.</span>

<span class="sd">        Defaults to `False`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * error_message takes priority over halt_execution.</span>
<span class="sd">    * This will only pass for commands in DMs if `permissions` is valid for</span>
<span class="sd">      a DM context (e.g. can&#39;t have any moderation permissions)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[CommandT], CommandT]</span>
<span class="sd">        A command decorator callback which adds the check.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">command</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span>
        <span class="n">OwnPermissionCheck</span><span class="p">(</span><span class="n">permissions</span><span class="p">,</span> <span class="n">halt_execution</span><span class="o">=</span><span class="n">halt_execution</span><span class="p">,</span> <span class="n">error_message</span><span class="o">=</span><span class="n">error_message</span><span class="p">)</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">with_check</span><span class="p">(</span><span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandT</span><span class="p">],</span> <span class="n">CommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a generic check to a command.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    check : tanjun.abc.CheckSig</span>
<span class="sd">        The check to add to this command.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[CommandT], CommandT]</span>
<span class="sd">        A command decorator callback which adds the check.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">command</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>A collection of common standard checks designed for Tanjun commands.</p>
</div>


                </section>
                <section id="with_check">
                            <div class="attr function"><a class="headerlink" href="#with_check">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_check</span><span class="signature">(
    check: collections.abc.Callable[..., typing.Union[bool, collections.abc.Awaitable[bool]]],
    /
) -&gt; collections.abc.Callable[[~CommandT], ~CommandT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_check</span><span class="p">(</span><span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandT</span><span class="p">],</span> <span class="n">CommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a generic check to a command.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    check : tanjun.abc.CheckSig</span>
<span class="sd">        The check to add to this command.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[CommandT], CommandT]</span>
<span class="sd">        A command decorator callback which adds the check.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">command</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a generic check to a command.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>check</strong> (<a href="tanjun/abc.html#CheckSig">tanjun.abc.CheckSig</a>):
The check to add to this command.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[CommandT], CommandT]</strong>: A command decorator callback which adds the check.</li>
</ul>
</div>


                </section>
                <section id="with_dm_check">
                            <div class="attr function"><a class="headerlink" href="#with_dm_check">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_dm_check</span><span class="signature">(
    command: Optional[~CommandT] = None,
    /,
    *,
    error_message: Optional[str] = &#39;Command can only be used in DMs&#39;,
    halt_execution: bool = False
) -&gt; Union[~CommandT, collections.abc.Callable[[~CommandT], ~CommandT]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_dm_check</span><span class="p">(</span>
    <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command can only be used in DMs&quot;</span><span class="p">,</span>
    <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackReturnT</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Only let a command run in a DM channel.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    command : typing.Optional[CommandT]</span>
<span class="sd">        The command to add this check to.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    error_message : typing.Optional[str]</span>
<span class="sd">        The error message to send in response as a command error if the check fails.</span>

<span class="sd">        Defaults to &quot;Command can only be used in DMs&quot; and setting this to `None`</span>
<span class="sd">        will disable the error message allowing the command search to continue.</span>
<span class="sd">    halt_execution : bool</span>
<span class="sd">        Whether this check should raise `tanjun.errors.HaltExecution` to</span>
<span class="sd">        end the execution search when it fails instead of returning `False`.</span>

<span class="sd">        Defaults to `False`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * error_message takes priority over halt_execution.</span>
<span class="sd">    * For more information on how this is used with other parameters see</span>
<span class="sd">      `CallbackReturnT`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CallbackReturnT[CommandT]</span>
<span class="sd">        The command this check was added to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_optional_kwargs</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">DmCheck</span><span class="p">(</span><span class="n">halt_execution</span><span class="o">=</span><span class="n">halt_execution</span><span class="p">,</span> <span class="n">error_message</span><span class="o">=</span><span class="n">error_message</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Only let a command run in a DM channel.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (typing.Optional[CommandT]):
The command to add this check to.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>error_message</strong> (typing.Optional[str]):
The error message to send in response as a command error if the check fails.</p>

<p>Defaults to "Command can only be used in DMs" and setting this to <code>None</code>
will disable the error message allowing the command search to continue.</p></li>
<li><p><strong>halt_execution</strong> (bool):
Whether this check should raise <code><a href="tanjun/errors.html#HaltExecution">tanjun.errors.HaltExecution</a></code> to
end the execution search when it fails instead of returning <code>False</code>.</p>

<p>Defaults to <code>False</code>.</p></li>
</ul>

<h6 id="notes">Notes</h6>

<ul>
<li>error_message takes priority over halt_execution.</li>
<li>For more information on how this is used with other parameters see
<code>CallbackReturnT</code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>CallbackReturnT[CommandT]</strong>: The command this check was added to.</li>
</ul>
</div>


                </section>
                <section id="with_guild_check">
                            <div class="attr function"><a class="headerlink" href="#with_guild_check">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_guild_check</span><span class="signature">(
    command: Optional[~CommandT] = None,
    /,
    *,
    error_message: Optional[str] = &#39;Command can only be used in guild channels&#39;,
    halt_execution: bool = False
) -&gt; Union[~CommandT, collections.abc.Callable[[~CommandT], ~CommandT]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_guild_check</span><span class="p">(</span>
    <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command can only be used in guild channels&quot;</span><span class="p">,</span>
    <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackReturnT</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Only let a command run in a guild channel.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    command : typing.Optional[CommandT]</span>
<span class="sd">        The command to add this check to.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    error_message : typing.Optional[str]</span>
<span class="sd">        The error message to send in response as a command error if the check fails.</span>

<span class="sd">        Defaults to &quot;Command can only be used in guild channels&quot; and setting this to `None`</span>
<span class="sd">        will disable the error message allowing the command search to continue.</span>
<span class="sd">    halt_execution : bool</span>
<span class="sd">        Whether this check should raise `tanjun.errors.HaltExecution` to</span>
<span class="sd">        end the execution search when it fails instead of returning `False`.</span>

<span class="sd">        Defaults to `False`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * error_message takes priority over halt_execution.</span>
<span class="sd">    * For more information on how this is used with other parameters see</span>
<span class="sd">      `CallbackReturnT`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CallbackReturnT[CommandT]</span>
<span class="sd">        The command this check was added to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_optional_kwargs</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">GuildCheck</span><span class="p">(</span><span class="n">halt_execution</span><span class="o">=</span><span class="n">halt_execution</span><span class="p">,</span> <span class="n">error_message</span><span class="o">=</span><span class="n">error_message</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Only let a command run in a guild channel.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (typing.Optional[CommandT]):
The command to add this check to.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>error_message</strong> (typing.Optional[str]):
The error message to send in response as a command error if the check fails.</p>

<p>Defaults to "Command can only be used in guild channels" and setting this to <code>None</code>
will disable the error message allowing the command search to continue.</p></li>
<li><p><strong>halt_execution</strong> (bool):
Whether this check should raise <code><a href="tanjun/errors.html#HaltExecution">tanjun.errors.HaltExecution</a></code> to
end the execution search when it fails instead of returning <code>False</code>.</p>

<p>Defaults to <code>False</code>.</p></li>
</ul>

<h6 id="notes">Notes</h6>

<ul>
<li>error_message takes priority over halt_execution.</li>
<li>For more information on how this is used with other parameters see
<code>CallbackReturnT</code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>CallbackReturnT[CommandT]</strong>: The command this check was added to.</li>
</ul>
</div>


                </section>
                <section id="with_nsfw_check">
                            <div class="attr function"><a class="headerlink" href="#with_nsfw_check">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_nsfw_check</span><span class="signature">(
    command: Optional[~CommandT] = None,
    /,
    *,
    error_message: Optional[str] = &#39;Command can only be used in NSFW channels&#39;,
    halt_execution: bool = False
) -&gt; Union[~CommandT, collections.abc.Callable[[~CommandT], ~CommandT]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_nsfw_check</span><span class="p">(</span>
    <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command can only be used in NSFW channels&quot;</span><span class="p">,</span>
    <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackReturnT</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Only let a command run in a channel that&#39;s marked as nsfw.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    command : typing.Optional[CommandT]</span>
<span class="sd">        The command to add this check to.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    error_message : typing.Optional[str]</span>
<span class="sd">        The error message to send in response as a command error if the check fails.</span>

<span class="sd">        Defaults to &quot;Command can only be used in NSFW channels&quot; and setting this to `None`</span>
<span class="sd">        will disable the error message allowing the command search to continue.</span>
<span class="sd">    halt_execution : bool</span>
<span class="sd">        Whether this check should raise `tanjun.errors.HaltExecution` to</span>
<span class="sd">        end the execution search when it fails instead of returning `False`.</span>

<span class="sd">        Defaults to `False`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * error_message takes priority over halt_execution.</span>
<span class="sd">    * For more information on how this is used with other parameters see</span>
<span class="sd">      `CallbackReturnT`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CallbackReturnT[CommandT]</span>
<span class="sd">        The command this check was added to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_optional_kwargs</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">NsfwCheck</span><span class="p">(</span><span class="n">halt_execution</span><span class="o">=</span><span class="n">halt_execution</span><span class="p">,</span> <span class="n">error_message</span><span class="o">=</span><span class="n">error_message</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Only let a command run in a channel that's marked as nsfw.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (typing.Optional[CommandT]):
The command to add this check to.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>error_message</strong> (typing.Optional[str]):
The error message to send in response as a command error if the check fails.</p>

<p>Defaults to "Command can only be used in NSFW channels" and setting this to <code>None</code>
will disable the error message allowing the command search to continue.</p></li>
<li><p><strong>halt_execution</strong> (bool):
Whether this check should raise <code><a href="tanjun/errors.html#HaltExecution">tanjun.errors.HaltExecution</a></code> to
end the execution search when it fails instead of returning <code>False</code>.</p>

<p>Defaults to <code>False</code>.</p></li>
</ul>

<h6 id="notes">Notes</h6>

<ul>
<li>error_message takes priority over halt_execution.</li>
<li>For more information on how this is used with other parameters see
<code>CallbackReturnT</code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>CallbackReturnT[CommandT]</strong>: The command this check was added to.</li>
</ul>
</div>


                </section>
                <section id="with_sfw_check">
                            <div class="attr function"><a class="headerlink" href="#with_sfw_check">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_sfw_check</span><span class="signature">(
    command: Optional[~CommandT] = None,
    /,
    *,
    error_message: Optional[str] = &#39;Command can only be used in SFW channels&#39;,
    halt_execution: bool = False
) -&gt; Union[~CommandT, collections.abc.Callable[[~CommandT], ~CommandT]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_sfw_check</span><span class="p">(</span>
    <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command can only be used in SFW channels&quot;</span><span class="p">,</span>
    <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackReturnT</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Only let a command run in a channel that&#39;s marked as sfw.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    command : typing.Optional[CommandT]</span>
<span class="sd">        The command to add this check to.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    error_message : typing.Optional[str]</span>
<span class="sd">        The error message to send in response as a command error if the check fails.</span>

<span class="sd">        Defaults to &quot;Command can only be used in SFW channels&quot; and setting this to `None`</span>
<span class="sd">        will disable the error message allowing the command search to continue.</span>
<span class="sd">    halt_execution : bool</span>
<span class="sd">        Whether this check should raise `tanjun.errors.HaltExecution` to</span>
<span class="sd">        end the execution search when it fails instead of returning `False`.</span>

<span class="sd">        Defaults to `False`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * error_message takes priority over halt_execution.</span>
<span class="sd">    * For more information on how this is used with other parameters see</span>
<span class="sd">      `CallbackReturnT`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CallbackReturnT[CommandT]</span>
<span class="sd">        The command this check was added to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_optional_kwargs</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">SfwCheck</span><span class="p">(</span><span class="n">halt_execution</span><span class="o">=</span><span class="n">halt_execution</span><span class="p">,</span> <span class="n">error_message</span><span class="o">=</span><span class="n">error_message</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Only let a command run in a channel that's marked as sfw.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (typing.Optional[CommandT]):
The command to add this check to.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>error_message</strong> (typing.Optional[str]):
The error message to send in response as a command error if the check fails.</p>

<p>Defaults to "Command can only be used in SFW channels" and setting this to <code>None</code>
will disable the error message allowing the command search to continue.</p></li>
<li><p><strong>halt_execution</strong> (bool):
Whether this check should raise <code><a href="tanjun/errors.html#HaltExecution">tanjun.errors.HaltExecution</a></code> to
end the execution search when it fails instead of returning <code>False</code>.</p>

<p>Defaults to <code>False</code>.</p></li>
</ul>

<h6 id="notes">Notes</h6>

<ul>
<li>error_message takes priority over halt_execution.</li>
<li>For more information on how this is used with other parameters see
<code>CallbackReturnT</code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>CallbackReturnT[CommandT]</strong>: The command this check was added to.</li>
</ul>
</div>


                </section>
                <section id="with_owner_check">
                            <div class="attr function"><a class="headerlink" href="#with_owner_check">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_owner_check</span><span class="signature">(
    command: Optional[~CommandT] = None,
    /,
    *,
    error_message: Optional[str] = &#39;Only bot owners can use this command&#39;,
    halt_execution: bool = False
) -&gt; Union[~CommandT, collections.abc.Callable[[~CommandT], ~CommandT]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_owner_check</span><span class="p">(</span>
    <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Only bot owners can use this command&quot;</span><span class="p">,</span>
    <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackReturnT</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Only let a command run if it&#39;s being triggered by one of the bot&#39;s owners.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    command : typing.Optional[CommandT]</span>
<span class="sd">        The command to add this check to.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    error_message : typing.Optional[str]</span>
<span class="sd">        The error message to send in response as a command error if the check fails.</span>

<span class="sd">        Defaults to &quot;Only bot owners can use this command&quot; and setting this to `None`</span>
<span class="sd">        will disable the error message allowing the command search to continue.</span>
<span class="sd">    halt_execution : bool</span>
<span class="sd">        Whether this check should raise `tanjun.errors.HaltExecution` to</span>
<span class="sd">        end the execution search when it fails instead of returning `False`.</span>

<span class="sd">        Defaults to `False`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * error_message takes priority over halt_execution.</span>
<span class="sd">    * For more information on how this is used with other parameters see</span>
<span class="sd">      `CallbackReturnT`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    CallbackReturnT[CommandT]</span>
<span class="sd">        The command this check was added to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_optional_kwargs</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">OwnerCheck</span><span class="p">(</span><span class="n">halt_execution</span><span class="o">=</span><span class="n">halt_execution</span><span class="p">,</span> <span class="n">error_message</span><span class="o">=</span><span class="n">error_message</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Only let a command run if it's being triggered by one of the bot's owners.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (typing.Optional[CommandT]):
The command to add this check to.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>error_message</strong> (typing.Optional[str]):
The error message to send in response as a command error if the check fails.</p>

<p>Defaults to "Only bot owners can use this command" and setting this to <code>None</code>
will disable the error message allowing the command search to continue.</p></li>
<li><p><strong>halt_execution</strong> (bool):
Whether this check should raise <code><a href="tanjun/errors.html#HaltExecution">tanjun.errors.HaltExecution</a></code> to
end the execution search when it fails instead of returning <code>False</code>.</p>

<p>Defaults to <code>False</code>.</p></li>
</ul>

<h6 id="notes">Notes</h6>

<ul>
<li>error_message takes priority over halt_execution.</li>
<li>For more information on how this is used with other parameters see
<code>CallbackReturnT</code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>CallbackReturnT[CommandT]</strong>: The command this check was added to.</li>
</ul>
</div>


                </section>
                <section id="with_author_permission_check">
                            <div class="attr function"><a class="headerlink" href="#with_author_permission_check">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_author_permission_check</span><span class="signature">(
    permissions: Union[hikari.permissions.Permissions, int],
    *,
    error_message: Optional[str] = &#34;You don&#39;t have the permissions required to use this command&#34;,
    halt_execution: bool = False
) -&gt; collections.abc.Callable[[~CommandT], ~CommandT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_author_permission_check</span><span class="p">(</span>
    <span class="n">permissions</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;You don&#39;t have the permissions required to use this command&quot;</span><span class="p">,</span>
    <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandT</span><span class="p">],</span> <span class="n">CommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Only let a command run if the author has certain permissions in the current channel.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    permissions: typing.Union[hikari.permissions.Permissions, int]</span>
<span class="sd">        The permission(s) required for this command to run.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    error_message : typing.Optional[str]</span>
<span class="sd">        The error message to send in response as a command error if the check fails.</span>

<span class="sd">        Defaults to &quot;You don&#39;t have the permissions required to use this command&quot; and setting this to `None`</span>
<span class="sd">        will disable the error message allowing the command search to continue.</span>
<span class="sd">    halt_execution : bool</span>
<span class="sd">        Whether this check should raise `tanjun.errors.HaltExecution` to</span>
<span class="sd">        end the execution search when it fails instead of returning `False`.</span>

<span class="sd">        Defaults to `False`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * error_message takes priority over halt_execution.</span>
<span class="sd">    * This will only pass for commands in DMs if `permissions` is valid for</span>
<span class="sd">      a DM context (e.g. can&#39;t have any moderation permissions)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[CommandT], CommandT]</span>
<span class="sd">        A command decorator callback which adds the check.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">command</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span>
        <span class="n">AuthorPermissionCheck</span><span class="p">(</span><span class="n">permissions</span><span class="p">,</span> <span class="n">halt_execution</span><span class="o">=</span><span class="n">halt_execution</span><span class="p">,</span> <span class="n">error_message</span><span class="o">=</span><span class="n">error_message</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Only let a command run if the author has certain permissions in the current channel.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>permissions</strong> (typing.Union[hikari.permissions.Permissions, int]):
The permission(s) required for this command to run.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>error_message</strong> (typing.Optional[str]):
The error message to send in response as a command error if the check fails.</p>

<p>Defaults to "You don't have the permissions required to use this command" and setting this to <code>None</code>
will disable the error message allowing the command search to continue.</p></li>
<li><p><strong>halt_execution</strong> (bool):
Whether this check should raise <code><a href="tanjun/errors.html#HaltExecution">tanjun.errors.HaltExecution</a></code> to
end the execution search when it fails instead of returning <code>False</code>.</p>

<p>Defaults to <code>False</code>.</p></li>
</ul>

<h6 id="notes">Notes</h6>

<ul>
<li>error_message takes priority over halt_execution.</li>
<li>This will only pass for commands in DMs if <code>permissions</code> is valid for
a DM context (e.g. can't have any moderation permissions)</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[CommandT], CommandT]</strong>: A command decorator callback which adds the check.</li>
</ul>
</div>


                </section>
                <section id="with_own_permission_check">
                            <div class="attr function"><a class="headerlink" href="#with_own_permission_check">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_own_permission_check</span><span class="signature">(
    permissions: Union[hikari.permissions.Permissions, int],
    *,
    error_message: Optional[str] = &#34;Bot doesn&#39;t have the permissions required to run this command&#34;,
    halt_execution: bool = False
) -&gt; collections.abc.Callable[[~CommandT], ~CommandT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_own_permission_check</span><span class="p">(</span>
    <span class="n">permissions</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Bot doesn&#39;t have the permissions required to run this command&quot;</span><span class="p">,</span>
    <span class="n">halt_execution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandT</span><span class="p">],</span> <span class="n">CommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Only let a command run if we have certain permissions in the current channel.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    permissions: typing.Union[hikari.permissions.Permissions, int]</span>
<span class="sd">        The permission(s) required for this command to run.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    error_message : typing.Optional[str]</span>
<span class="sd">        The error message to send in response as a command error if the check fails.</span>

<span class="sd">        Defaults to &quot;Bot doesn&#39;t have the permissions required to run this command&quot; and setting this to `None`</span>
<span class="sd">        will disable the error message allowing the command search to continue.</span>
<span class="sd">    halt_execution : bool</span>
<span class="sd">        Whether this check should raise `tanjun.errors.HaltExecution` to</span>
<span class="sd">        end the execution search when it fails instead of returning `False`.</span>

<span class="sd">        Defaults to `False`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * error_message takes priority over halt_execution.</span>
<span class="sd">    * This will only pass for commands in DMs if `permissions` is valid for</span>
<span class="sd">      a DM context (e.g. can&#39;t have any moderation permissions)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[CommandT], CommandT]</span>
<span class="sd">        A command decorator callback which adds the check.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">command</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span>
        <span class="n">OwnPermissionCheck</span><span class="p">(</span><span class="n">permissions</span><span class="p">,</span> <span class="n">halt_execution</span><span class="o">=</span><span class="n">halt_execution</span><span class="p">,</span> <span class="n">error_message</span><span class="o">=</span><span class="n">error_message</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Only let a command run if we have certain permissions in the current channel.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>permissions</strong> (typing.Union[hikari.permissions.Permissions, int]):
The permission(s) required for this command to run.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>error_message</strong> (typing.Optional[str]):
The error message to send in response as a command error if the check fails.</p>

<p>Defaults to "Bot doesn't have the permissions required to run this command" and setting this to <code>None</code>
will disable the error message allowing the command search to continue.</p></li>
<li><p><strong>halt_execution</strong> (bool):
Whether this check should raise <code><a href="tanjun/errors.html#HaltExecution">tanjun.errors.HaltExecution</a></code> to
end the execution search when it fails instead of returning <code>False</code>.</p>

<p>Defaults to <code>False</code>.</p></li>
</ul>

<h6 id="notes">Notes</h6>

<ul>
<li>error_message takes priority over halt_execution.</li>
<li>This will only pass for commands in DMs if <code>permissions</code> is valid for
a DM context (e.g. can't have any moderation permissions)</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[CommandT], CommandT]</strong>: A command decorator callback which adds the check.</li>
</ul>
</div>


                </section>
                <section id="clients">
                                <div class="attr module"><a class="headerlink" href="#clients">#&nbsp;&nbsp</a>
<span class="name"><a href="tanjun/clients.html">tanjun.clients</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;Standard Tanjun client.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;as_loader&quot;</span><span class="p">,</span>
    <span class="s2">&quot;as_unloader&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Client&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ClientCallbackNames&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LoaderSig&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MessageAcceptsEnum&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PrefixGetterSig&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PrefixGetterSigT&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">enum</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">importlib</span>
<span class="kn">import</span> <span class="nn">importlib.abc</span> <span class="k">as</span> <span class="nn">importlib_abc</span>
<span class="kn">import</span> <span class="nn">importlib.util</span> <span class="k">as</span> <span class="nn">importlib_util</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">collections</span>

<span class="kn">import</span> <span class="nn">hikari</span>
<span class="kn">from</span> <span class="nn">hikari</span> <span class="kn">import</span> <span class="n">traits</span> <span class="k">as</span> <span class="n">hikari_traits</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">tanjun_abc</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">checks</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">context</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">dependencies</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">errors</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">hooks</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">injecting</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">utilities</span>

<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pathlib</span>
    <span class="kn">import</span> <span class="nn">types</span>

    <span class="n">_ClientT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_ClientT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;Client&quot;</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">_MessageContextMakerProto</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Protocol</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span>
            <span class="n">injection_client</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">InjectorClient</span><span class="p">,</span>
            <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span>
            <span class="o">*</span><span class="p">,</span>
            <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">triggering_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">triggering_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">class</span> <span class="nc">_SlashContextMakerProto</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Protocol</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span>
            <span class="n">injection_client</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">InjectorClient</span><span class="p">,</span>
            <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span>
            <span class="o">*</span><span class="p">,</span>
            <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">default_to_ephemeral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">on_not_found</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span>
                <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">context</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span>
            <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span>


<span class="n">LoaderSig</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="s2">&quot;Client&quot;</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span>
<span class="sd">&quot;&quot;&quot;Type hint of the callback used to load resources into a Tanjun client.</span>

<span class="sd">This should take one positional argument of type `Client` and return nothing.</span>
<span class="sd">This will be expected to initiate and resources like components to the client</span>
<span class="sd">through the use of it&#39;s protocol methods.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">PrefixGetterSig</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span>
<span class="sd">&quot;&quot;&quot;Type hint of a callable used to get the prefix(es) for a specific guild.</span>

<span class="sd">This should be an asynchronous callable which returns an iterable of strings.</span>

<span class="sd">.. note::</span>
<span class="sd">    While dependency injection is supported for this, the first positional</span>
<span class="sd">    argument will always be a `tanjun.abc.MessageContext`.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">PrefixGetterSigT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;PrefixGetterSigT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;PrefixGetterSig&quot;</span><span class="p">)</span>

<span class="n">_LOGGER</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">]</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;hikari.tanjun.clients&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_LoaderDescriptor</span><span class="p">:</span>  <span class="c1"># Slots mess with functools.update_wrapper</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">LoaderSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">update_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_UnloaderDescriptor</span><span class="p">:</span>  <span class="c1"># Slots mess with functools.update_wrapper</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">LoaderSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">update_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">as_loader</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">LoaderSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoaderSig</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Mark a callback as being used to load Tanjun components from a module.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This is only necessary if you wish to use `tanjun.Client.load_modules`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    callback : LoaderSig</span>
<span class="sd">        The callback used to load Tanjun components from a module. This</span>
<span class="sd">        should take one argument of type `tanjun.Client`, return nothing</span>
<span class="sd">        and will be expected to initiate and add utilities such as components</span>
<span class="sd">        to the provided client using it&#39;s abstract methods.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    LoaderSig</span>
<span class="sd">        The decorated load callback.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_LoaderDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">as_unloader</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">LoaderSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoaderSig</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Mark a callback as being used to unload a module&#39;s utilities from a client.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This is the inverse of `as_loader` and is only necessary if you wish</span>
<span class="sd">        to use the `tanjun.Client.unload_module` or</span>
<span class="sd">        `tanjun.Client.reload_module`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    callback : LoaderSig</span>
<span class="sd">        The callback used to unload Tanjun utilities from a module. This</span>
<span class="sd">        should take one argument of type `tanjun.Client`, return nothing</span>
<span class="sd">        and will be expected to remove utilities such as components</span>
<span class="sd">        from the provided client using it&#39;s abstract methods.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    LoaderSig</span>
<span class="sd">        The decorated unload callback.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_UnloaderDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ClientCallbackNames</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Enum of the client callback names dispatched by the standard `Client`.&quot;&quot;&quot;</span>

    <span class="n">CLOSED</span> <span class="o">=</span> <span class="s2">&quot;closed&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when the client has finished closing.</span>

<span class="sd">    No positional arguments are provided for this event.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CLOSING</span> <span class="o">=</span> <span class="s2">&quot;closing&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when the client is initially instructed to close.</span>

<span class="sd">    No positional arguments are provided for this event.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">COMPONENT_ADDED</span> <span class="o">=</span> <span class="s2">&quot;component_added&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when a component is added to an active client.</span>

<span class="sd">    .. warning::</span>
<span class="sd">        This event isn&#39;t dispatched for components which were registered while</span>
<span class="sd">        the client is inactive.</span>

<span class="sd">    The first positional argument is the `tanjun.abc.Component` being added.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">COMPONENT_REMOVED</span> <span class="o">=</span> <span class="s2">&quot;component_removed&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when a component is added to an active client.</span>

<span class="sd">    .. warning::</span>
<span class="sd">        This event isn&#39;t dispatched for components which were removed while</span>
<span class="sd">        the client is inactive.</span>

<span class="sd">    The first positional argument is the `tanjun.abc.Component` being removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">MESSAGE_COMMAND_NOT_FOUND</span> <span class="o">=</span> <span class="s2">&quot;message_command_not_found&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when a message command is not found.</span>

<span class="sd">    `tanjun.abc.MessageContext` is provided as the first positional argument.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SLASH_COMMAND_NOT_FOUND</span> <span class="o">=</span> <span class="s2">&quot;slash_command_not_found&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when a slash command is not found.</span>

<span class="sd">    `tanjun.abc.MessageContext` is provided as the first positional argument.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">STARTED</span> <span class="o">=</span> <span class="s2">&quot;started&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when the client has finished starting.</span>

<span class="sd">    No positional arguments are provided for this event.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">STARTING</span> <span class="o">=</span> <span class="s2">&quot;starting&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when the client is initially instructed to start.</span>

<span class="sd">    No positional arguments are provided for this event.</span>
<span class="sd">    &quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">MessageAcceptsEnum</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The possible configurations for which events `Client` should execute commands based on.&quot;&quot;&quot;</span>

    <span class="n">ALL</span> <span class="o">=</span> <span class="s2">&quot;ALL&quot;</span>
    <span class="sd">&quot;&quot;&quot;Set the client to execute commands based on both DM and guild message create events.&quot;&quot;&quot;</span>

    <span class="n">DM_ONLY</span> <span class="o">=</span> <span class="s2">&quot;DM_ONLY&quot;</span>
    <span class="sd">&quot;&quot;&quot;Set the client to execute commands based only DM message create events.&quot;&quot;&quot;</span>

    <span class="n">GUILD_ONLY</span> <span class="o">=</span> <span class="s2">&quot;GUILD_ONLY&quot;</span>
    <span class="sd">&quot;&quot;&quot;Set the client to execute commands based only guild message create events.&quot;&quot;&quot;</span>

    <span class="n">NONE</span> <span class="o">=</span> <span class="s2">&quot;NONE&quot;</span>
    <span class="sd">&quot;&quot;&quot;Set the client to not execute commands based on message create events.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_event_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Get the base event type this mode listens to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[type[hikari.message_events.MessageCreateEvent]]</span>
<span class="sd">            The type object of the MessageCreateEvent class this mode will</span>
<span class="sd">            register a listener for.</span>

<span class="sd">            This will be `None` if this mode disables listening to</span>
<span class="sd">            message create events.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_ACCEPTS_EVENT_TYPE_MAPPING</span><span class="p">[</span><span class="bp">self</span><span class="p">]</span>


<span class="n">_ACCEPTS_EVENT_TYPE_MAPPING</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">MessageAcceptsEnum</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">ALL</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">,</span>
    <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">DM_ONLY</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">DMMessageCreateEvent</span><span class="p">,</span>
    <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">GUILD_ONLY</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">GuildMessageCreateEvent</span><span class="p">,</span>
    <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">NONE</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">_check_human</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">ctx</span><span class="o">.</span><span class="n">is_human</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">_wrap_client_callback</span><span class="p">(</span>
    <span class="n">callback</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">],</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">AbstractInjectionContext</span><span class="p">,</span>
    <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
    <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">callback</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Client callback raised exception&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="n">exc</span><span class="p">)</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">on_parser_error</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="n">errors</span><span class="o">.</span><span class="n">ParserError</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Handle message parser errors.</span>

<span class="sd">    This is the default message parser error hook included by `Client`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_cmp_command</span><span class="p">(</span><span class="n">builder</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">CommandBuilder</span><span class="p">],</span> <span class="n">command</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">builder</span> <span class="ow">or</span> <span class="n">builder</span><span class="o">.</span><span class="n">id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="ow">and</span> <span class="n">builder</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">command</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">builder</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="n">command</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="n">builder</span><span class="o">.</span><span class="n">description</span> <span class="o">!=</span> <span class="n">command</span><span class="o">.</span><span class="n">description</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">default_perm</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">default_permission</span> <span class="k">if</span> <span class="n">builder</span><span class="o">.</span><span class="n">default_permission</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="k">else</span> <span class="kc">True</span>
    <span class="n">command_options</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">options</span> <span class="ow">or</span> <span class="p">()</span>
    <span class="k">if</span> <span class="n">default_perm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">command</span><span class="o">.</span><span class="n">default_permission</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">builder</span><span class="o">.</span><span class="n">options</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">command_options</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">builder_option</span> <span class="o">==</span> <span class="n">option</span> <span class="k">for</span> <span class="n">builder_option</span><span class="p">,</span> <span class="n">option</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">builder</span><span class="o">.</span><span class="n">options</span><span class="p">,</span> <span class="n">command_options</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">_StartDeclarer</span><span class="p">:</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;client&quot;</span><span class="p">,</span> <span class="s2">&quot;command_ids&quot;</span><span class="p">,</span> <span class="s2">&quot;guild_id&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">client</span><span class="p">:</span> <span class="n">Client</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]],</span>
        <span class="n">guild_id</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command_ids</span> <span class="o">=</span> <span class="n">command_ids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">guild_id</span> <span class="o">=</span> <span class="n">guild_id</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">declare_global_commands</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">command_ids</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">guild_id</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">remove_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Client</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">InjectorClient</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tanjun&#39;s standard `tanjun.abc.Client` implementation.</span>

<span class="sd">    This implementation supports dependency injection for checks, command</span>
<span class="sd">    callbacks, prefix getters and event listeners. For more information on how</span>
<span class="sd">    this works see `tanjun.injecting`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * For a quicker way to initiate this client around a standard bot aware</span>
<span class="sd">      client, see `Client.from_gateway_bot` and `Client.from_rest_bot`.</span>
<span class="sd">    * The endpoint used by `declare_global_commands` has a strict ratelimit which,</span>
<span class="sd">      as of writing, only allows for 2 requests per minute (with that ratelimit</span>
<span class="sd">      either being per-guild if targeting a specific guild otherwise globally).</span>
<span class="sd">    * `event_manager` is necessary for message command dispatch and will also</span>
<span class="sd">      be necessary for interaction command dispatch if `server` isn&#39;t</span>
<span class="sd">      provided.</span>
<span class="sd">    * `server` is used for interaction command dispatch if interaction</span>
<span class="sd">      events aren&#39;t being received from the event manager.</span>
<span class="sd">    * By default this client includes a parser error handling hook which will</span>
<span class="sd">      by overwritten if you call `Client.set_hooks`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rest : hikari.api.rest.RestClient</span>
<span class="sd">        The Hikari REST client this will use.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    cache : hikari.api.cache.CacheClient</span>
<span class="sd">        The Hikari cache client this will use if applicable.</span>
<span class="sd">    event_manager : hikari.api.event_manager.EventManagerClient</span>
<span class="sd">        The Hikari event manager client this will use if applicable.</span>
<span class="sd">    server : hikari.api.interaction_server.InteractionServer</span>
<span class="sd">        The Hikari interaction server client this will use if applicable.</span>
<span class="sd">    shards : hikari.traits.ShardAware</span>
<span class="sd">        The Hikari shard aware client this will use if applicable.</span>
<span class="sd">    voice : hikari.api.voice.VoiceComponent</span>
<span class="sd">        The Hikari voice component this will use if applicable.</span>
<span class="sd">    event_managed : bool</span>
<span class="sd">        Whether or not this client is managed by the event manager.</span>

<span class="sd">        An event managed client will be automatically started and closed based</span>
<span class="sd">        on Hikari&#39;s lifetime events.</span>

<span class="sd">        Defaults to `False` and can only be passed as `True` if `event_manager`</span>
<span class="sd">        is also provided.</span>
<span class="sd">    mention_prefix : bool</span>
<span class="sd">        Whether or not mention prefixes should be automatically set when this</span>
<span class="sd">        client is first started.</span>

<span class="sd">        Defaults to `False` and it should be noted that this only applies to</span>
<span class="sd">        message commands.</span>
<span class="sd">    declare_global_commands : typing.Union[hikari.SnowflakeishSequenceOr[hikari.PartialGuild], hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">        Whether or not to automatically set global slash commands when this</span>
<span class="sd">        client is first started. Defaults to `False`.</span>

<span class="sd">        If one or more guild objects/IDs are passed here then the registered</span>
<span class="sd">        global commands will be set on the specified guild(s) at startup rather</span>
<span class="sd">        than globally. This can be useful for testing/debug purposes as slash</span>
<span class="sd">        commands may take up to an hour to propagate globally but will</span>
<span class="sd">        immediately propagate when set on a specific guild.</span>
<span class="sd">    set_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">        Deprecated as of v2.1.1a1 alias of `declare_global_commands`.</span>
<span class="sd">    command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">        If provided, a mapping of top level command names to IDs of the commands to update.</span>

<span class="sd">        This field is complementary to `declare_global_commands` and, while it</span>
<span class="sd">        isn&#39;t necessarily required, this will in some situations help avoid</span>
<span class="sd">        permissions which were previously set for a command from being lost</span>
<span class="sd">        after a rename.</span>

<span class="sd">        This currently isn&#39;t supported when multiple guild IDs are passed for</span>
<span class="sd">        `declare_global_commands`.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raises for the following reasons:</span>
<span class="sd">        * If `event_managed` is `True` when `event_manager` is `None`.</span>
<span class="sd">        * If `command_ids` is passed when multiple guild ids are provided for `declare_global_commands`.</span>
<span class="sd">        * If `command_ids` is passed when `declare_global_commands` is `False`.</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501 - line too long</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_accepts&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_auto_defer_after&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_cache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_cached_application_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_checks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_client_callbacks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_components&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_defaults_to_ephemeral&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_make_message_context&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_make_slash_context&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_events&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_grab_mention_prefix&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_hooks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_interaction_not_found&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_slash_hooks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_is_alive&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_is_closing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_listeners&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_message_hooks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_metadata&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_modules&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_path_modules&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_prefix_getter&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_prefixes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_rest&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_server&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_shards&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_voice&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rest</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">cache</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">events</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">server</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">shards</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">voice</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">VoiceComponent</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mention_prefix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># InjectorClient.__init__</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">dependencies</span><span class="o">.</span><span class="n">set_standard_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># TODO: logging or something to indicate this is running statelessly rather than statefully.</span>
        <span class="c1"># TODO: warn if server and dispatch both None but don&#39;t error</span>

        <span class="c1"># TODO: separate slash and gateway checks?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span> <span class="o">=</span> <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">ALL</span> <span class="k">if</span> <span class="n">events</span> <span class="k">else</span> <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">NONE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="n">cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">checks</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span><span class="p">:</span> <span class="n">_MessageContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">MessageContext</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">:</span> <span class="n">_SlashContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">SlashContext</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_events</span> <span class="o">=</span> <span class="n">events</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span> <span class="o">=</span> <span class="n">mention_prefix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">]</span> <span class="o">=</span> <span class="n">hooks</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">()</span><span class="o">.</span><span class="n">set_on_parser_error</span><span class="p">(</span><span class="n">on_parser_error</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command not found&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">SelfInjectingCallback</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span> <span class="o">=</span> <span class="n">rest</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_server</span> <span class="o">=</span> <span class="n">server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shards</span> <span class="o">=</span> <span class="n">shards</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_voice</span> <span class="o">=</span> <span class="n">voice</span>

        <span class="k">if</span> <span class="n">event_managed</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Client cannot be event managed without an event manager&quot;</span><span class="p">)</span>

            <span class="n">events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_starting_event</span><span class="p">)</span>
            <span class="n">events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_stopping_event</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">set_global_commands</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;The `set_global_commands` argument is deprecated since v2.1.1a1. &quot;</span>
                <span class="s2">&quot;Use `declare_global_commands` instead.&quot;</span><span class="p">,</span>
                <span class="ne">DeprecationWarning</span><span class="p">,</span>
                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">_stack_level</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">declare_global_commands</span> <span class="o">=</span> <span class="n">declare_global_commands</span> <span class="ow">or</span> <span class="n">set_global_commands</span>
        <span class="n">command_ids</span> <span class="o">=</span> <span class="n">command_ids</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">declare_global_commands</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">command_ids</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">command_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot declare global guilds in multiple-guilds and pass command IDs&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">guild</span> <span class="ow">in</span> <span class="n">declare_global_commands</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">guild</span><span class="p">))</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">declare_global_commands</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">declare_global_commands</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span>
                    <span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="n">command_ids</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot pass command IDs when not declaring global commands&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span>
                <span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">declare_global_commands</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">Client</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span> <span class="n">rest</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">rest</span><span class="p">),</span> <span class="n">rest</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">cache</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">cache</span><span class="p">),</span> <span class="n">cache</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">,</span> <span class="n">events</span><span class="p">)</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">events</span><span class="p">),</span> <span class="n">events</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">,</span> <span class="n">server</span><span class="p">)</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">server</span><span class="p">),</span> <span class="n">server</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">shards</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">,</span> <span class="n">shards</span><span class="p">)</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">shards</span><span class="p">),</span> <span class="n">shards</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">voice</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">VoiceComponent</span><span class="p">,</span> <span class="n">voice</span><span class="p">)</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">voice</span><span class="p">),</span> <span class="n">voice</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_gateway_bot</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">GatewayBotAware</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">mention_prefix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a `Client` from a `hikari.traits.GatewayBotAware` instance.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This implicitly defaults the client to human only mode.</span>
<span class="sd">        * This sets type dependency injectors for the hikari traits present in</span>
<span class="sd">          `bot` (including `hikari.traits.GatewayBotaWARE`).</span>
<span class="sd">        * The endpoint used by `declare_global_commands` has a strict ratelimit</span>
<span class="sd">          which, as of writing, only allows for 2 requests per minute (with that</span>
<span class="sd">          ratelimit either being per-guild if targeting a specific guild</span>
<span class="sd">          otherwise globally).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.GatewayBotAware</span>
<span class="sd">            The bot client to build from.</span>

<span class="sd">            This will be used to infer the relevant Hikari clients to use.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        event_managed : bool</span>
<span class="sd">            Whether or not this client is managed by the event manager.</span>

<span class="sd">            An event managed client will be automatically started and closed</span>
<span class="sd">            based on Hikari&#39;s lifetime events.</span>

<span class="sd">            Defaults to `True`.</span>
<span class="sd">        mention_prefix : bool</span>
<span class="sd">            Whether or not mention prefixes should be automatically set when this</span>
<span class="sd">            client is first started.</span>

<span class="sd">            Defaults to `False` and it should be noted that this only applies to</span>
<span class="sd">            message commands.</span>
<span class="sd">        declare_global_commands : typing.Union[hikari.SnowflakeishSequenceOr[hikari.PartialGuild], hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Whether or not to automatically set global slash commands when this</span>
<span class="sd">            client is first started. Defaults to `False`.</span>

<span class="sd">            If one or more guild objects/IDs are passed here then the registered</span>
<span class="sd">            global commands will be set on the specified guild(s) at startup rather</span>
<span class="sd">            than globally. This can be useful for testing/debug purposes as slash</span>
<span class="sd">            commands may take up to an hour to propagate globally but will</span>
<span class="sd">            immediately propagate when set on a specific guild.</span>
<span class="sd">        set_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Deprecated as of v2.1.1a1 alias of `declare_global_commands`.</span>
<span class="sd">        command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">            If provided, a mapping of top level command names to IDs of the commands to update.</span>

<span class="sd">            This field is complementary to `declare_global_commands` and, while it</span>
<span class="sd">            isn&#39;t necessarily required, this will in some situations help avoid</span>
<span class="sd">            permissions which were previously set for a command from being lost</span>
<span class="sd">            after a rename.</span>

<span class="sd">            This currently isn&#39;t supported when multiple guild IDs are passed for</span>
<span class="sd">            `declare_global_commands`.</span>
<span class="sd">        &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501 - line too long</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">cls</span><span class="p">(</span>
                <span class="n">rest</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span>
                <span class="n">cache</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span>
                <span class="n">events</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">event_manager</span><span class="p">,</span>
                <span class="n">shards</span><span class="o">=</span><span class="n">bot</span><span class="p">,</span>
                <span class="n">voice</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">voice</span><span class="p">,</span>
                <span class="n">event_managed</span><span class="o">=</span><span class="n">event_managed</span><span class="p">,</span>
                <span class="n">mention_prefix</span><span class="o">=</span><span class="n">mention_prefix</span><span class="p">,</span>
                <span class="n">declare_global_commands</span><span class="o">=</span><span class="n">declare_global_commands</span><span class="p">,</span>
                <span class="n">set_global_commands</span><span class="o">=</span><span class="n">set_global_commands</span><span class="p">,</span>
                <span class="n">command_ids</span><span class="o">=</span><span class="n">command_ids</span><span class="p">,</span>
                <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">set_human_only</span><span class="p">()</span>
            <span class="o">.</span><span class="n">set_hikari_trait_injectors</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_rest_bot</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">RESTBotAware</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a `Client` from a `hikari.traits.RESTBotAware` instance.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This sets type dependency injectors for the hikari traits present in</span>
<span class="sd">          `bot` (including `hikari.traits.RESTBotAware`).</span>
<span class="sd">        * The endpoint used by `declare_global_commands` has a strict ratelimit</span>
<span class="sd">          which, as of writing, only allows for 2 requests per minute (with that</span>
<span class="sd">          ratelimit either being per-guild if targeting a specific guild</span>
<span class="sd">          otherwise globally).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.RESTBotAware</span>
<span class="sd">            The bot client to build from.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        declare_global_commands : typing.Union[hikari.SnowflakeishSequenceOr[hikari.PartialGuild], hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Whether or not to automatically set global slash commands when this</span>
<span class="sd">            client is first started. Defaults to `False`.</span>

<span class="sd">            If one or more guild objects/IDs are passed here then the registered</span>
<span class="sd">            global commands will be set on the specified guild(s) at startup rather</span>
<span class="sd">            than globally. This can be useful for testing/debug purposes as slash</span>
<span class="sd">            commands may take up to an hour to propagate globally but will</span>
<span class="sd">            immediately propagate when set on a specific guild.</span>
<span class="sd">        set_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Deprecated as of v2.1.1a1 alias of `declare_global_commands`.</span>
<span class="sd">        command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">            If provided, a mapping of top level command names to IDs of the commands to update.</span>

<span class="sd">            This field is complementary to `declare_global_commands` and, while it</span>
<span class="sd">            isn&#39;t necessarily required, this will in some situations help avoid</span>
<span class="sd">            permissions which were previously set for a command from being lost</span>
<span class="sd">            after a rename.</span>

<span class="sd">            This currently isn&#39;t supported when multiple guild IDs are passed for</span>
<span class="sd">            `declare_global_commands`.</span>
<span class="sd">        &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501 - line too long</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">rest</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span>
            <span class="n">server</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">interaction_server</span><span class="p">,</span>
            <span class="n">declare_global_commands</span><span class="o">=</span><span class="n">declare_global_commands</span><span class="p">,</span>
            <span class="n">set_global_commands</span><span class="o">=</span><span class="n">set_global_commands</span><span class="p">,</span>
            <span class="n">command_ids</span><span class="o">=</span><span class="n">command_ids</span><span class="p">,</span>
            <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">set_hikari_trait_injectors</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__aenter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__aexit__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">exception_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span>
        <span class="n">exception</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span>
        <span class="n">exception_traceback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">types</span><span class="o">.</span><span class="n">TracebackType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;CommandClient &lt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">!r}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">)</span><span class="si">}</span><span class="s2"> components, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="si">}</span><span class="s2">&gt;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">defaults_to_ephemeral</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">message_accepts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MessageAcceptsEnum</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Type of message create events this command client accepts for execution.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_human_only</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether this client is only executing for non-bot/webhook users messages.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_check_human</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">checks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Collection of the level `tanjun.abc.Context` checks registered to this client.</span>

<span class="sd">        .. note::</span>
<span class="sd">            These may be taking advantage of the standard dependency injection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">check</span><span class="o">.</span><span class="n">callback</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">events</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">listeners</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">]]:</span>
        <span class="k">return</span> <span class="n">utilities</span><span class="o">.</span><span class="n">CastedView</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="n">callback</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span> <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">x</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Top level `tanjun.abc.AnyHooks` set for this client.</span>

<span class="sd">        These are called during both message and interaction command execution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[tanjun.abc.AnyHooks]</span>
<span class="sd">            The top level `tanjun.abc.Context` based hooks set for this</span>
<span class="sd">            client if applicable, else `None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Top level `tanjun.abc.SlashHooks` set for this client.</span>

<span class="sd">        These are only called during interaction command execution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_alive</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">message_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Top level `tanjun.abc.MessageHooks` set for this client.</span>

<span class="sd">        These are only called during both message command execution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">prefix_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">PrefixGetterSig</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Prefix getter method set for this client.</span>

<span class="sd">        For more information on this callback&#39;s signature see `PrefixGetter`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">PrefixGetterSig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">prefixes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Collection of the standard prefixes set for this client.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rest</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">server</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shards</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shards</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">voice</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">VoiceComponent</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_voice</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_starting_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_stopping_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">clear_slash_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">if</span> <span class="n">application</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">()</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">set_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="p">(),</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">set_global_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Alias of `Client.declare_global_commands`.</span>

<span class="sd">        .. deprecated:: v2.1.1a1</span>
<span class="sd">            Use `Client.declare_global_commands` instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;The `Client.set_global_commands` method has been deprecated since v2.1.1a1. &quot;</span>
            <span class="s2">&quot;Use `Client.declare_global_commands` instead.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">declare_global_commands</span><span class="p">(</span><span class="n">application</span><span class="o">=</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_global_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">commands</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">command</span>
            <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
                <span class="n">component</span><span class="o">.</span><span class="n">slash_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">is_global</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">declare_slash_commands</span><span class="p">(</span>
            <span class="n">commands</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">application</span><span class="o">=</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_slash_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflakeish</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">builder</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">command_id</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">edit_application_command</span><span class="p">(</span>
                <span class="n">application</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">(),</span>
                <span class="n">command_id</span><span class="p">,</span>
                <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">create_application_command</span><span class="p">(</span>
                <span class="n">application</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">(),</span>
                <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">guild</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">set_tracked_command</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>  <span class="c1"># TODO: is this fine?</span>

        <span class="k">return</span> <span class="n">response</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_slash_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">commands</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">],</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">command_ids</span> <span class="o">=</span> <span class="n">command_ids</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">names_to_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">conflicts</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">builders</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">CommandBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">commands</span><span class="p">:</span>
            <span class="n">names_to_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">command</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">builders</span><span class="p">:</span>
                <span class="n">conflicts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

            <span class="n">builder</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">command_id</span> <span class="o">:=</span> <span class="n">command_ids</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                <span class="n">builder</span><span class="o">.</span><span class="n">set_id</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">command_id</span><span class="p">))</span>

            <span class="n">builders</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">builder</span>

        <span class="k">if</span> <span class="n">conflicts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Couldn&#39;t declare commands due to conflicts. The following command names have more than one command &quot;</span>
                <span class="s2">&quot;registered for them &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conflicts</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You can only declare up to 100 top level commands in a guild or globally&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">application</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">()</span>

        <span class="n">target_type</span> <span class="o">=</span> <span class="s2">&quot;global&quot;</span> <span class="k">if</span> <span class="n">guild</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;guild </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">guild</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
            <span class="n">registered_commands</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">registered_commands</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span>
                <span class="n">_cmp_command</span><span class="p">(</span><span class="n">builders</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">command</span><span class="p">)</span> <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">registered_commands</span>
            <span class="p">):</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Skipping bulk declare for </span><span class="si">%s</span><span class="s2"> slash commands due to them already being set&quot;</span><span class="p">,</span> <span class="n">target_type</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">registered_commands</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Bulk declaring </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> slash commands&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">),</span> <span class="n">target_type</span><span class="p">)</span>
        <span class="n">responses</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">set_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">builders</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">responses</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">guild</span><span class="p">:</span>
                <span class="n">names_to_commands</span><span class="p">[</span><span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">set_tracked_command</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>  <span class="c1"># TODO: is this fine?</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">expected_id</span> <span class="o">:=</span> <span class="n">command_ids</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="ow">and</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">expected_id</span><span class="p">)</span> <span class="o">!=</span> <span class="n">response</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;ID mismatch found for </span><span class="si">%s</span><span class="s2"> command </span><span class="si">%r</span><span class="s2">, expected </span><span class="si">%s</span><span class="s2"> but got </span><span class="si">%s</span><span class="s2">. &quot;</span>
                    <span class="s2">&quot;This suggests that any previous permissions set for this command will have been lost.&quot;</span><span class="p">,</span>
                    <span class="n">target_type</span><span class="p">,</span>
                    <span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">expected_id</span><span class="p">,</span>
                    <span class="n">response</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Successfully declared </span><span class="si">%s</span><span class="s2"> (top-level) </span><span class="si">%s</span><span class="s2"> commands&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">responses</span><span class="p">),</span> <span class="n">target_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_LOGGER</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;declared </span><span class="si">%s</span><span class="s2"> command ids: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">target_type</span><span class="p">,</span> <span class="p">{</span><span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">responses</span><span class="p">}</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">responses</span>

    <span class="k">def</span> <span class="nf">set_auto_defer_after</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set when this client should automatically defer execution of commands.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            If `time` is set to `None` then automatic deferrals will be disabled.</span>
<span class="sd">            This may lead to unexpected behaviour.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        time : typing.Optional[float]</span>
<span class="sd">            The time in seconds to defer interaction command responses after.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="k">if</span> <span class="n">time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_ephemeral_default</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set whether slash contexts spawned by this client should default to ephemeral responses.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether slash command contexts executed in this component should</span>
<span class="sd">            should default to ephemeral.</span>

<span class="sd">            This will be overridden by any response calls which specify flags</span>
<span class="sd">            and defaults to `False`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This component to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_hikari_trait_injectors</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">RESTAware</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set type based dependency injection based on the hikari traits found in `bot`.</span>

<span class="sd">        This is a short hand for calling `Client.add_type_dependency` for all</span>
<span class="sd">        the hikari trait types `bot` is valid for with bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari_traits.RESTAware</span>
<span class="sd">            The hikari client to set dependency injectors for.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">hikari_traits</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">member</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bot</span><span class="p">,</span> <span class="n">member</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">bot</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_interaction_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the response message for when an interaction command is not found.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            Setting this to `None` may lead to unexpected behaviour (especially</span>
<span class="sd">            when the client is still set to auto-defer interactions) and should</span>
<span class="sd">            only be done if you know what you&#39;re doing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : typing.Optional[str]</span>
<span class="sd">            The message to respond with when an interaction command isn&#39;t found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span> <span class="o">=</span> <span class="n">message</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_message_accepts</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">accepts</span><span class="p">:</span> <span class="n">MessageAcceptsEnum</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the kind of messages commands should be executed based on.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        accepts : MessageAcceptsEnum</span>
<span class="sd">            The type of messages commands should be executed based on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot set accepts level on a client with no event manager&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span> <span class="o">=</span> <span class="n">accepts</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_message_ctx_maker</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">maker</span><span class="p">:</span> <span class="n">_MessageContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the message context maker to use when creating context for a message.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            The caller must return an instance of `tanjun.context.MessageContext`</span>
<span class="sd">            rather than just any implementation of the MessageContext abc due to</span>
<span class="sd">            this client relying on implementation detail of</span>
<span class="sd">            `tanjun.context.MessageContext`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        maker : _MessageContextMakerProto</span>
<span class="sd">            The message context maker to use.</span>

<span class="sd">            This is a callback which should match the signature of</span>
<span class="sd">            `tanjun.context.MessageContext.__init__` and return an instance</span>
<span class="sd">            of `tanjun.context.MessageContext`.</span>

<span class="sd">            This defaults to `tanjun.context.MessageContext`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span> <span class="o">=</span> <span class="n">maker</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_slash_ctx_maker</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">maker</span><span class="p">:</span> <span class="n">_SlashContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the slash context maker to use when creating context for a slash command.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            The caller must return an instance of `tanjun.context.SlashContext`</span>
<span class="sd">            rather than just any implementation of the SlashContext abc due to</span>
<span class="sd">            this client relying on implementation detail of</span>
<span class="sd">            `tanjun.context.SlashContext`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        maker : _SlashContextMakerProto</span>
<span class="sd">            The slash context maker to use.</span>

<span class="sd">            This is a callback which should match the signature of</span>
<span class="sd">            `tanjun.context.SlashContext.__init__` and return an instance</span>
<span class="sd">            of `tanjun.context.SlashContext`.</span>

<span class="sd">            This defaults to `tanjun.context.SlashContext`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span> <span class="o">=</span> <span class="n">maker</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_human_only</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set whether or not message commands execution should be limited to &quot;human&quot; users.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This doesn&#39;t apply to interaction commands as these can only be</span>
<span class="sd">            triggered by a &quot;human&quot; (normal user account).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether or not message commands execution should be limited to &quot;human&quot; users.</span>

<span class="sd">            Passing `True` here will prevent message commands from being executed</span>
<span class="sd">            based on webhook and bot messages.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">_check_human</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_check</span><span class="p">(</span><span class="n">_check_human</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a generic check to this client.</span>

<span class="sd">        This will be applied to both message and slash command execution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to add. This may be either synchronous or asynchronous</span>
<span class="sd">            and must take one positional argument of type `tanjun.abc.Context`</span>
<span class="sd">            with dependency injection being supported for its keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">check</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checks</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">(</span><span class="n">check</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a check from the client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the check was not previously added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;checks.InjectableCheck&quot;</span><span class="p">,</span> <span class="n">check</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a check to this client through a decorator call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to add. This may be either synchronous or asynchronous</span>
<span class="sd">            and must take one positional argument of type `tanjun.abc.Context`</span>
<span class="sd">            with dependency injection being supported for its keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun_abc.CheckSig</span>
<span class="sd">            The added check.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">check</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">gather_checks</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">add_injector</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a component to this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        component: Component</span>
<span class="sd">            The component to move to this client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to allow chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the component&#39;s name is already registered.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">component</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A component named </span><span class="si">{</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="si">!r}</span><span class="s2"> is already registered.&quot;</span><span class="p">)</span>

        <span class="n">component</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">component</span>

        <span class="k">if</span> <span class="n">add_injector</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">component</span><span class="p">),</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">component</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">COMPONENT_ADDED</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">get_component_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">stored_component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">stored_component</span> <span class="ow">or</span> <span class="n">stored_component</span> <span class="o">!=</span> <span class="n">component</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The component </span><span class="si">{</span><span class="n">component</span><span class="si">!r}</span><span class="s2"> is not registered.&quot;</span><span class="p">)</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="n">stored_component</span><span class="o">.</span><span class="n">unbind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">COMPONENT_REMOVED</span><span class="p">,</span> <span class="n">stored_component</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_component_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">add_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">descriptor</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">descriptor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">descriptor</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">descriptor</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">dispatch_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Dispatch a client callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The name of the callback to dispatch.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        *args : typing.Any</span>
<span class="sd">            Positional arguments to pass to the callback(s).</span>
<span class="sd">        **kwargs : typing.Any</span>
<span class="sd">            Keyword arguments to pass to the callback(s).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        KeyError</span>
<span class="sd">            If no callbacks are registered for the given name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">callbacks</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="n">calls</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">_wrap_client_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">injecting</span><span class="o">.</span><span class="n">BasicInjectionContext</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">calls</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_client_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">callback</span><span class="o">.</span><span class="n">callback</span> <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">()</span>

    <span class="k">def</span> <span class="nf">remove_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;injecting.CallbackDescriptor[None]&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_client_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">],</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="k">def</span> <span class="nf">add_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">injected</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">SelfInjectingCallback</span><span class="p">[</span><span class="kc">None</span><span class="p">](</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injected</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">injected</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">injected</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;injecting.SelfInjectingCallback[None]&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="p">))</span>
        <span class="n">registered_callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">registered_callback</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">],</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_listener</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="k">def</span> <span class="nf">add_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">prefixes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a prefix used to filter message command calls.</span>

<span class="sd">        This will be matched against the first character(s) in a message&#39;s</span>
<span class="sd">        content to determine whether the message command search stage of</span>
<span class="sd">        execution should be initiated.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        prefixes : typing.Union[collections.abc.Iterable[str], str]</span>
<span class="sd">            Either a single string or an iterable of strings to be used as</span>
<span class="sd">            prefixes.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prefixes</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">prefixes</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefixes</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">prefix</span> <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">prefixes</span> <span class="k">if</span> <span class="n">prefix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a message content prefix from the client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        prefix : str</span>
<span class="sd">            The prefix to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the prefix is not registered with the client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_prefix_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">getter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">PrefixGetterSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the callback used to retrieve message prefixes set for the relevant guild.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        getter : typing.Optional[PrefixGetterSig]</span>
<span class="sd">            The callback which&#39;ll be used to retrieve prefixes for the guild a</span>
<span class="sd">            message context is from. If `None` is passed here then the callback</span>
<span class="sd">            will be unset.</span>

<span class="sd">            This should be an async callback which one argument of type</span>
<span class="sd">            `tanjun.abc.MessageContext` and returns an iterable of string prefixes.</span>
<span class="sd">            Dependency injection is supported for this callback&#39;s keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">getter</span><span class="p">)</span> <span class="k">if</span> <span class="n">getter</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_prefix_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">getter</span><span class="p">:</span> <span class="n">PrefixGetterSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PrefixGetterSigT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the prefix getter callback for this client through decorator call.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ```py</span>
<span class="sd">        client = tanjun.Client.from_rest_bot(bot)</span>

<span class="sd">        @client.with_prefix_getter</span>
<span class="sd">        async def prefix_getter(ctx: tanjun.abc.MessageContext) -&gt; collections.abc.Iterable[str]:</span>
<span class="sd">            raise NotImplementedError</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        getter : PrefixGetterSig</span>
<span class="sd">            The callback which&#39;ll be  to retrieve prefixes for the guild a</span>
<span class="sd">            message event is from.</span>

<span class="sd">            This should be an async callback which one argument of type</span>
<span class="sd">            `tanjun.abc.MessageContext` and returns an iterable of string prefixes.</span>
<span class="sd">            Dependency injection is supported for this callback&#39;s keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PrefixGetterSigT</span>
<span class="sd">            The registered callback.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_prefix_getter</span><span class="p">(</span><span class="n">getter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">getter</span>

    <span class="k">def</span> <span class="nf">iter_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">]]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">slash_commands</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_slash_commands</span><span class="p">(</span><span class="n">global_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_message_commands</span><span class="p">()</span>
        <span class="k">yield from</span> <span class="n">slash_commands</span>

    <span class="k">def</span> <span class="nf">iter_message_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">message_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">iter_slash_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">global_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">if</span> <span class="n">global_only</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">is_global</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_slash_commands</span><span class="p">(</span><span class="n">global_only</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">slash_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_message_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="n">component</span><span class="o">.</span><span class="n">check_message_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_slash_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="n">component</span><span class="o">.</span><span class="n">check_slash_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_check_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">prefix</span>

        <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">prefix</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_try_unsubscribe</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event_manager</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">,</span>
        <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">event_manager</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">LookupError</span><span class="p">):</span>
            <span class="c1"># TODO: add logging here</span>
            <span class="k">pass</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">deregister_listeners</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close the client.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the client isn&#39;t running.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Client isn&#39;t active&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span><span class="p">:</span>
            <span class="n">event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSING</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deregister_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event_type</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">event_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_message_create_event</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_event</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listener</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">deregister_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">register_listeners</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Start the client.</span>

<span class="sd">        If `mention_prefix` was passed to `Client.__init__` or</span>
<span class="sd">        `Client.from_gateway_bot` then this function may make a fetch request</span>
<span class="sd">        to Discord if it cannot get the current user from the cache.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the client is already active.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Client is already alive&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">:</span>
                <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">get_me</span><span class="p">()</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_my_user</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_my_user</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="sa">f</span><span class="s2">&quot;&lt;@</span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&gt;&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;&lt;@!</span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&gt;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">prefix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">register_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event_type</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_message_create_event</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_event</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">listener</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">register_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_request</span><span class="p">)</span>

        <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTED</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_rest_application_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Fetch the application ID of the application this client is linked to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.Snowflake</span>
<span class="sd">            The application ID of the application this client is linked to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">token_type</span> <span class="o">==</span> <span class="n">hikari</span><span class="o">.</span><span class="n">TokenType</span><span class="o">.</span><span class="n">BOT</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_application</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_authorization</span><span class="p">())</span><span class="o">.</span><span class="n">application</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">application</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span>

    <span class="k">def</span> <span class="nf">set_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the general command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every slash and message</span>
<span class="sd">        command execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.AnyHooks]</span>
<span class="sd">            The general command execution hooks to set for this client.</span>

<span class="sd">            Passing `None` will remove all hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the slash command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every slash command</span>
<span class="sd">        execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.SlashHooks]</span>
<span class="sd">            The slash context specific command execution hooks to set for this</span>
<span class="sd">            client.</span>

<span class="sd">            Passing `None` will remove the hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_message_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the message command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every message command</span>
<span class="sd">        execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.MessageHooks]</span>
<span class="sd">            The message context specific command execution hooks to set for this</span>
<span class="sd">            client.</span>

<span class="sd">            Passing `None` will remove all hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_iter_module_members</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="n">exported</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;__all__&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">exported</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exported</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">):</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Scanning </span><span class="si">%s</span><span class="s2"> module based on its declared __all__)&quot;</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">exported</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">))</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Scanning all public members on </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">member</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_load_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iter_module_members</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">_LoaderDescriptor</span><span class="p">):</span>
                <span class="n">member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Didn&#39;t find any loader descriptors in </span><span class="si">{</span><span class="n">module_repr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">_log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load entities into this client from modules based on loader descriptors.</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find loaders.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_loader`</span>
<span class="sd">        decorated top level function which takes one positional argument</span>
<span class="sd">        of type `Client`.</span>

<span class="sd">        ```py</span>
<span class="sd">        @tanjun.as_loader</span>
<span class="sd">        def load_module(client: tanjun.Client) -&gt; None:</span>
<span class="sd">            client.add_component(component.copy())</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules : typing.Union[str, pathlib.Path]</span>
<span class="sd">            Path(s) of the modules to load from.</span>

<span class="sd">            When `str` this will be treated as a normal import path which is</span>
<span class="sd">            absolute (`&quot;foo.bar.baz&quot;`). It&#39;s worth noting that absolute module</span>
<span class="sd">            paths may be imported from the current location if the top level</span>
<span class="sd">            module is a valid module file or module directory in the current</span>
<span class="sd">            working directory.</span>

<span class="sd">            When `pathlib.Path` the module will be imported directly from</span>
<span class="sd">            the given path. In this mode any relative imports in the target</span>
<span class="sd">            module will fail to resolve.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module is already loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no loader descriptors are found in the module.</span>
<span class="sd">        ModuleNotFoundError</span>
<span class="sd">            If the module is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> already loaded&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                    <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">[</span><span class="n">module_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">module_path_abs</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">module_path_abs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module at </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> already loaded&quot;</span><span class="p">)</span>

                <span class="n">module_name</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="n">importlib_util</span><span class="o">.</span><span class="n">spec_from_file_location</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">module_path_abs</span><span class="p">)</span>

                <span class="c1"># https://github.com/python/typeshed/issues/2793</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">spec</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="p">,</span> <span class="n">importlib_abc</span><span class="o">.</span><span class="n">Loader</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ModuleNotFoundError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Module not found at </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">module_name</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                    <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib_util</span><span class="o">.</span><span class="n">module_from_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
                <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">exec_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">[</span><span class="n">module_path_abs</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">_unload_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iter_module_members</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">_UnloaderDescriptor</span><span class="p">):</span>
                <span class="n">member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Didn&#39;t find any unloaders in </span><span class="si">{</span><span class="n">module_repr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">unload_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">_log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Unload entities from this client based on unloader descriptors in one or more modules.</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find unloaders.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_unloader`</span>
<span class="sd">        decorated top level function which takes one positional argument</span>
<span class="sd">        of type `Client`.</span>

<span class="sd">        ```py</span>
<span class="sd">        @tanjun.as_unloader</span>
<span class="sd">        def unload_component(client: tanjun.Client) -&gt; None:</span>
<span class="sd">            client.remove_component_by_name(component.name)</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules: typing.Union[str, pathlib.Path]</span>
<span class="sd">            Path of one or more modules to unload.</span>

<span class="sd">            These should be the same path(s) which were passed to `load_module`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module hasn&#39;t been loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no unloader descriptors are found in the module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">module_path</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module </span><span class="si">{</span><span class="n">module_path</span><span class="si">!s}</span><span class="s2"> not loaded&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Unloading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_unload_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">reload_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Reload entities in this client based on the descriptors in loaded module(s).</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find descriptors.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_loader` and</span>
<span class="sd">        one `as_unloader` decorated top level function which each take one</span>
<span class="sd">        positional argument of type `Client`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules: typing.Union[str, pathlib.Path]</span>
<span class="sd">            Paths of one or more module to unload.</span>

<span class="sd">            These should be the same paths which were passed to `load_module`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module hasn&#39;t been loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no unloader descriptors are found in the current state of the module.</span>
<span class="sd">            If no loader descriptors are found in the new state of the module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> not loaded&quot;</span><span class="p">)</span>

                <span class="n">module_repr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Reloading </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unload_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">[</span><span class="n">module_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Reloading </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unload_modules</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="n">_log</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">load_modules</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="n">_log</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_message_create_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a message command based on a gateway event.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hikari.events.message_events.MessageCreateEvent</span>
<span class="sd">            The event to handle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">message</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">prefix</span> <span class="o">:=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_prefix</span><span class="p">(</span><span class="n">ctx</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">ctx</span><span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="p">:]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span><span class="o">.</span><span class="n">set_triggering_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_message</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">return</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">MESSAGE_COMMAND_NOT_FOUND</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]:</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">}</span>

        <span class="k">return</span> <span class="n">hooks</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_slash_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">context</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">SLASH_COMMAND_NOT_FOUND</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ctx</span><span class="o">.</span><span class="n">has_responded</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_interaction_create_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a slash command based on Gateway events.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Any event where `event.interaction` is not</span>
<span class="sd">            `hikari.CommandInteraction` will be ignored.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : hikari.events.interaction_events.InteractionCreateEvent</span>
<span class="sd">            The event to execute commands based on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">interaction</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">,</span>
            <span class="n">on_not_found</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_slash_not_found</span><span class="p">,</span>
            <span class="n">default_to_ephemeral</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slash_hooks</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">start_defer_timer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="c1"># This is set on each iteration to ensure that any component</span>
                    <span class="c1"># state which was set to this isn&#39;t propagated to other components.</span>
                    <span class="n">ctx</span><span class="o">.</span><span class="n">set_ephemeral_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">future</span> <span class="o">:=</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_interaction</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">await</span> <span class="n">future</span>
                        <span class="k">return</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_interaction_create_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">ResponseTypeT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a slash command based on received REST requests.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        interaction : hikari.CommandInteraction</span>
<span class="sd">            The interaction to execute a command based on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun.context.ResponseType</span>
<span class="sd">            The initial response to send back to Discord.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">interaction</span><span class="o">=</span><span class="n">interaction</span><span class="p">,</span>
            <span class="n">on_not_found</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_slash_not_found</span><span class="p">,</span>
            <span class="n">default_to_ephemeral</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">start_defer_timer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">)</span>

        <span class="n">hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slash_hooks</span><span class="p">()</span>
        <span class="n">future</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_response_future</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_interaction</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="c1"># Under very specific timing there may be another future which could set a result while we await</span>
            <span class="c1"># ctx.respond therefore we create a task to avoid any erroneous behaviour from this trying to create</span>
            <span class="c1"># another response before it&#39;s returned the initial response.</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interaction</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> command error responder&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>

        <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interaction</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>
</pre></div>

        </details>

            <div class="docstring"><p>Standard Tanjun client.</p>
</div>


                </section>
                <section id="as_loader">
                            <div class="attr function"><a class="headerlink" href="#as_loader">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">as_loader</span><span class="signature">(
    callback: collections.abc.Callable[<a href="tanjun/clients.html#Client">tanjun.clients.Client</a>, None],
    /
) -&gt; collections.abc.Callable[<a href="tanjun/clients.html#Client">tanjun.clients.Client</a>, None]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">as_loader</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">LoaderSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoaderSig</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Mark a callback as being used to load Tanjun components from a module.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This is only necessary if you wish to use `tanjun.Client.load_modules`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    callback : LoaderSig</span>
<span class="sd">        The callback used to load Tanjun components from a module. This</span>
<span class="sd">        should take one argument of type `tanjun.Client`, return nothing</span>
<span class="sd">        and will be expected to initiate and add utilities such as components</span>
<span class="sd">        to the provided client using it&#39;s abstract methods.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    LoaderSig</span>
<span class="sd">        The decorated load callback.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_LoaderDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Mark a callback as being used to load Tanjun components from a module.</p>

<p><em>Note:</em>
This is only necessary if you wish to use <code><a href="#Client.load_modules">tanjun.Client.load_modules</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>callback</strong> (LoaderSig):
The callback used to load Tanjun components from a module. This
should take one argument of type <code><a href="#Client">tanjun.Client</a></code>, return nothing
and will be expected to initiate and add utilities such as components
to the provided client using it's abstract methods.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>LoaderSig</strong>: The decorated load callback.</li>
</ul>
</div>


                </section>
                <section id="as_unloader">
                            <div class="attr function"><a class="headerlink" href="#as_unloader">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">as_unloader</span><span class="signature">(
    callback: collections.abc.Callable[<a href="tanjun/clients.html#Client">tanjun.clients.Client</a>, None],
    /
) -&gt; collections.abc.Callable[<a href="tanjun/clients.html#Client">tanjun.clients.Client</a>, None]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">as_unloader</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">LoaderSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoaderSig</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Mark a callback as being used to unload a module&#39;s utilities from a client.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This is the inverse of `as_loader` and is only necessary if you wish</span>
<span class="sd">        to use the `tanjun.Client.unload_module` or</span>
<span class="sd">        `tanjun.Client.reload_module`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    callback : LoaderSig</span>
<span class="sd">        The callback used to unload Tanjun utilities from a module. This</span>
<span class="sd">        should take one argument of type `tanjun.Client`, return nothing</span>
<span class="sd">        and will be expected to remove utilities such as components</span>
<span class="sd">        from the provided client using it&#39;s abstract methods.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    LoaderSig</span>
<span class="sd">        The decorated unload callback.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_UnloaderDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Mark a callback as being used to unload a module's utilities from a client.</p>

<p><em>Note:</em>
This is the inverse of <code><a href="#as_loader">as_loader</a></code> and is only necessary if you wish
to use the <code><a href="#Client.unload_module">tanjun.Client.unload_module</a></code> or
<code><a href="#Client.reload_module">tanjun.Client.reload_module</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>callback</strong> (LoaderSig):
The callback used to unload Tanjun utilities from a module. This
should take one argument of type <code><a href="#Client">tanjun.Client</a></code>, return nothing
and will be expected to remove utilities such as components
from the provided client using it's abstract methods.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>LoaderSig</strong>: The decorated unload callback.</li>
</ul>
</div>


                </section>
                <section id="Client">
                                <div class="attr class">
        <a class="headerlink" href="#Client">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">Client</span><wbr>(<span class="base"><a href="tanjun/injecting.html#InjectorClient">tanjun.injecting.InjectorClient</a></span>, <span class="base"><a href="tanjun/abc.html#Client">tanjun.abc.Client</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Client</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">InjectorClient</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tanjun&#39;s standard `tanjun.abc.Client` implementation.</span>

<span class="sd">    This implementation supports dependency injection for checks, command</span>
<span class="sd">    callbacks, prefix getters and event listeners. For more information on how</span>
<span class="sd">    this works see `tanjun.injecting`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * For a quicker way to initiate this client around a standard bot aware</span>
<span class="sd">      client, see `Client.from_gateway_bot` and `Client.from_rest_bot`.</span>
<span class="sd">    * The endpoint used by `declare_global_commands` has a strict ratelimit which,</span>
<span class="sd">      as of writing, only allows for 2 requests per minute (with that ratelimit</span>
<span class="sd">      either being per-guild if targeting a specific guild otherwise globally).</span>
<span class="sd">    * `event_manager` is necessary for message command dispatch and will also</span>
<span class="sd">      be necessary for interaction command dispatch if `server` isn&#39;t</span>
<span class="sd">      provided.</span>
<span class="sd">    * `server` is used for interaction command dispatch if interaction</span>
<span class="sd">      events aren&#39;t being received from the event manager.</span>
<span class="sd">    * By default this client includes a parser error handling hook which will</span>
<span class="sd">      by overwritten if you call `Client.set_hooks`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rest : hikari.api.rest.RestClient</span>
<span class="sd">        The Hikari REST client this will use.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    cache : hikari.api.cache.CacheClient</span>
<span class="sd">        The Hikari cache client this will use if applicable.</span>
<span class="sd">    event_manager : hikari.api.event_manager.EventManagerClient</span>
<span class="sd">        The Hikari event manager client this will use if applicable.</span>
<span class="sd">    server : hikari.api.interaction_server.InteractionServer</span>
<span class="sd">        The Hikari interaction server client this will use if applicable.</span>
<span class="sd">    shards : hikari.traits.ShardAware</span>
<span class="sd">        The Hikari shard aware client this will use if applicable.</span>
<span class="sd">    voice : hikari.api.voice.VoiceComponent</span>
<span class="sd">        The Hikari voice component this will use if applicable.</span>
<span class="sd">    event_managed : bool</span>
<span class="sd">        Whether or not this client is managed by the event manager.</span>

<span class="sd">        An event managed client will be automatically started and closed based</span>
<span class="sd">        on Hikari&#39;s lifetime events.</span>

<span class="sd">        Defaults to `False` and can only be passed as `True` if `event_manager`</span>
<span class="sd">        is also provided.</span>
<span class="sd">    mention_prefix : bool</span>
<span class="sd">        Whether or not mention prefixes should be automatically set when this</span>
<span class="sd">        client is first started.</span>

<span class="sd">        Defaults to `False` and it should be noted that this only applies to</span>
<span class="sd">        message commands.</span>
<span class="sd">    declare_global_commands : typing.Union[hikari.SnowflakeishSequenceOr[hikari.PartialGuild], hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">        Whether or not to automatically set global slash commands when this</span>
<span class="sd">        client is first started. Defaults to `False`.</span>

<span class="sd">        If one or more guild objects/IDs are passed here then the registered</span>
<span class="sd">        global commands will be set on the specified guild(s) at startup rather</span>
<span class="sd">        than globally. This can be useful for testing/debug purposes as slash</span>
<span class="sd">        commands may take up to an hour to propagate globally but will</span>
<span class="sd">        immediately propagate when set on a specific guild.</span>
<span class="sd">    set_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">        Deprecated as of v2.1.1a1 alias of `declare_global_commands`.</span>
<span class="sd">    command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">        If provided, a mapping of top level command names to IDs of the commands to update.</span>

<span class="sd">        This field is complementary to `declare_global_commands` and, while it</span>
<span class="sd">        isn&#39;t necessarily required, this will in some situations help avoid</span>
<span class="sd">        permissions which were previously set for a command from being lost</span>
<span class="sd">        after a rename.</span>

<span class="sd">        This currently isn&#39;t supported when multiple guild IDs are passed for</span>
<span class="sd">        `declare_global_commands`.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raises for the following reasons:</span>
<span class="sd">        * If `event_managed` is `True` when `event_manager` is `None`.</span>
<span class="sd">        * If `command_ids` is passed when multiple guild ids are provided for `declare_global_commands`.</span>
<span class="sd">        * If `command_ids` is passed when `declare_global_commands` is `False`.</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501 - line too long</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_accepts&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_auto_defer_after&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_cache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_cached_application_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_checks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_client_callbacks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_components&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_defaults_to_ephemeral&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_make_message_context&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_make_slash_context&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_events&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_grab_mention_prefix&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_hooks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_interaction_not_found&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_slash_hooks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_is_alive&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_is_closing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_listeners&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_message_hooks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_metadata&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_modules&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_path_modules&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_prefix_getter&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_prefixes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_rest&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_server&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_shards&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_voice&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rest</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">cache</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">events</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">server</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">shards</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">voice</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">VoiceComponent</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mention_prefix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># InjectorClient.__init__</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">dependencies</span><span class="o">.</span><span class="n">set_standard_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># TODO: logging or something to indicate this is running statelessly rather than statefully.</span>
        <span class="c1"># TODO: warn if server and dispatch both None but don&#39;t error</span>

        <span class="c1"># TODO: separate slash and gateway checks?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span> <span class="o">=</span> <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">ALL</span> <span class="k">if</span> <span class="n">events</span> <span class="k">else</span> <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">NONE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="n">cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">checks</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span><span class="p">:</span> <span class="n">_MessageContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">MessageContext</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">:</span> <span class="n">_SlashContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">SlashContext</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_events</span> <span class="o">=</span> <span class="n">events</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span> <span class="o">=</span> <span class="n">mention_prefix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">]</span> <span class="o">=</span> <span class="n">hooks</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">()</span><span class="o">.</span><span class="n">set_on_parser_error</span><span class="p">(</span><span class="n">on_parser_error</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command not found&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">SelfInjectingCallback</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span> <span class="o">=</span> <span class="n">rest</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_server</span> <span class="o">=</span> <span class="n">server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shards</span> <span class="o">=</span> <span class="n">shards</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_voice</span> <span class="o">=</span> <span class="n">voice</span>

        <span class="k">if</span> <span class="n">event_managed</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Client cannot be event managed without an event manager&quot;</span><span class="p">)</span>

            <span class="n">events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_starting_event</span><span class="p">)</span>
            <span class="n">events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_stopping_event</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">set_global_commands</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;The `set_global_commands` argument is deprecated since v2.1.1a1. &quot;</span>
                <span class="s2">&quot;Use `declare_global_commands` instead.&quot;</span><span class="p">,</span>
                <span class="ne">DeprecationWarning</span><span class="p">,</span>
                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">_stack_level</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">declare_global_commands</span> <span class="o">=</span> <span class="n">declare_global_commands</span> <span class="ow">or</span> <span class="n">set_global_commands</span>
        <span class="n">command_ids</span> <span class="o">=</span> <span class="n">command_ids</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">declare_global_commands</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">command_ids</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">command_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot declare global guilds in multiple-guilds and pass command IDs&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">guild</span> <span class="ow">in</span> <span class="n">declare_global_commands</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">guild</span><span class="p">))</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">declare_global_commands</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">declare_global_commands</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span>
                    <span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="n">command_ids</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot pass command IDs when not declaring global commands&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span>
                <span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">declare_global_commands</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">Client</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span> <span class="n">rest</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">rest</span><span class="p">),</span> <span class="n">rest</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">cache</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">cache</span><span class="p">),</span> <span class="n">cache</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">,</span> <span class="n">events</span><span class="p">)</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">events</span><span class="p">),</span> <span class="n">events</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">,</span> <span class="n">server</span><span class="p">)</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">server</span><span class="p">),</span> <span class="n">server</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">shards</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">,</span> <span class="n">shards</span><span class="p">)</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">shards</span><span class="p">),</span> <span class="n">shards</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">voice</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">VoiceComponent</span><span class="p">,</span> <span class="n">voice</span><span class="p">)</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">voice</span><span class="p">),</span> <span class="n">voice</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_gateway_bot</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">GatewayBotAware</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">mention_prefix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a `Client` from a `hikari.traits.GatewayBotAware` instance.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This implicitly defaults the client to human only mode.</span>
<span class="sd">        * This sets type dependency injectors for the hikari traits present in</span>
<span class="sd">          `bot` (including `hikari.traits.GatewayBotaWARE`).</span>
<span class="sd">        * The endpoint used by `declare_global_commands` has a strict ratelimit</span>
<span class="sd">          which, as of writing, only allows for 2 requests per minute (with that</span>
<span class="sd">          ratelimit either being per-guild if targeting a specific guild</span>
<span class="sd">          otherwise globally).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.GatewayBotAware</span>
<span class="sd">            The bot client to build from.</span>

<span class="sd">            This will be used to infer the relevant Hikari clients to use.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        event_managed : bool</span>
<span class="sd">            Whether or not this client is managed by the event manager.</span>

<span class="sd">            An event managed client will be automatically started and closed</span>
<span class="sd">            based on Hikari&#39;s lifetime events.</span>

<span class="sd">            Defaults to `True`.</span>
<span class="sd">        mention_prefix : bool</span>
<span class="sd">            Whether or not mention prefixes should be automatically set when this</span>
<span class="sd">            client is first started.</span>

<span class="sd">            Defaults to `False` and it should be noted that this only applies to</span>
<span class="sd">            message commands.</span>
<span class="sd">        declare_global_commands : typing.Union[hikari.SnowflakeishSequenceOr[hikari.PartialGuild], hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Whether or not to automatically set global slash commands when this</span>
<span class="sd">            client is first started. Defaults to `False`.</span>

<span class="sd">            If one or more guild objects/IDs are passed here then the registered</span>
<span class="sd">            global commands will be set on the specified guild(s) at startup rather</span>
<span class="sd">            than globally. This can be useful for testing/debug purposes as slash</span>
<span class="sd">            commands may take up to an hour to propagate globally but will</span>
<span class="sd">            immediately propagate when set on a specific guild.</span>
<span class="sd">        set_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Deprecated as of v2.1.1a1 alias of `declare_global_commands`.</span>
<span class="sd">        command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">            If provided, a mapping of top level command names to IDs of the commands to update.</span>

<span class="sd">            This field is complementary to `declare_global_commands` and, while it</span>
<span class="sd">            isn&#39;t necessarily required, this will in some situations help avoid</span>
<span class="sd">            permissions which were previously set for a command from being lost</span>
<span class="sd">            after a rename.</span>

<span class="sd">            This currently isn&#39;t supported when multiple guild IDs are passed for</span>
<span class="sd">            `declare_global_commands`.</span>
<span class="sd">        &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501 - line too long</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">cls</span><span class="p">(</span>
                <span class="n">rest</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span>
                <span class="n">cache</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span>
                <span class="n">events</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">event_manager</span><span class="p">,</span>
                <span class="n">shards</span><span class="o">=</span><span class="n">bot</span><span class="p">,</span>
                <span class="n">voice</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">voice</span><span class="p">,</span>
                <span class="n">event_managed</span><span class="o">=</span><span class="n">event_managed</span><span class="p">,</span>
                <span class="n">mention_prefix</span><span class="o">=</span><span class="n">mention_prefix</span><span class="p">,</span>
                <span class="n">declare_global_commands</span><span class="o">=</span><span class="n">declare_global_commands</span><span class="p">,</span>
                <span class="n">set_global_commands</span><span class="o">=</span><span class="n">set_global_commands</span><span class="p">,</span>
                <span class="n">command_ids</span><span class="o">=</span><span class="n">command_ids</span><span class="p">,</span>
                <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">set_human_only</span><span class="p">()</span>
            <span class="o">.</span><span class="n">set_hikari_trait_injectors</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_rest_bot</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">RESTBotAware</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a `Client` from a `hikari.traits.RESTBotAware` instance.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This sets type dependency injectors for the hikari traits present in</span>
<span class="sd">          `bot` (including `hikari.traits.RESTBotAware`).</span>
<span class="sd">        * The endpoint used by `declare_global_commands` has a strict ratelimit</span>
<span class="sd">          which, as of writing, only allows for 2 requests per minute (with that</span>
<span class="sd">          ratelimit either being per-guild if targeting a specific guild</span>
<span class="sd">          otherwise globally).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.RESTBotAware</span>
<span class="sd">            The bot client to build from.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        declare_global_commands : typing.Union[hikari.SnowflakeishSequenceOr[hikari.PartialGuild], hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Whether or not to automatically set global slash commands when this</span>
<span class="sd">            client is first started. Defaults to `False`.</span>

<span class="sd">            If one or more guild objects/IDs are passed here then the registered</span>
<span class="sd">            global commands will be set on the specified guild(s) at startup rather</span>
<span class="sd">            than globally. This can be useful for testing/debug purposes as slash</span>
<span class="sd">            commands may take up to an hour to propagate globally but will</span>
<span class="sd">            immediately propagate when set on a specific guild.</span>
<span class="sd">        set_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Deprecated as of v2.1.1a1 alias of `declare_global_commands`.</span>
<span class="sd">        command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">            If provided, a mapping of top level command names to IDs of the commands to update.</span>

<span class="sd">            This field is complementary to `declare_global_commands` and, while it</span>
<span class="sd">            isn&#39;t necessarily required, this will in some situations help avoid</span>
<span class="sd">            permissions which were previously set for a command from being lost</span>
<span class="sd">            after a rename.</span>

<span class="sd">            This currently isn&#39;t supported when multiple guild IDs are passed for</span>
<span class="sd">            `declare_global_commands`.</span>
<span class="sd">        &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501 - line too long</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">rest</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span>
            <span class="n">server</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">interaction_server</span><span class="p">,</span>
            <span class="n">declare_global_commands</span><span class="o">=</span><span class="n">declare_global_commands</span><span class="p">,</span>
            <span class="n">set_global_commands</span><span class="o">=</span><span class="n">set_global_commands</span><span class="p">,</span>
            <span class="n">command_ids</span><span class="o">=</span><span class="n">command_ids</span><span class="p">,</span>
            <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">set_hikari_trait_injectors</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__aenter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__aexit__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">exception_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span>
        <span class="n">exception</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span>
        <span class="n">exception_traceback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">types</span><span class="o">.</span><span class="n">TracebackType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;CommandClient &lt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">!r}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">)</span><span class="si">}</span><span class="s2"> components, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="si">}</span><span class="s2">&gt;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">defaults_to_ephemeral</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">message_accepts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MessageAcceptsEnum</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Type of message create events this command client accepts for execution.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_human_only</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether this client is only executing for non-bot/webhook users messages.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_check_human</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">checks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Collection of the level `tanjun.abc.Context` checks registered to this client.</span>

<span class="sd">        .. note::</span>
<span class="sd">            These may be taking advantage of the standard dependency injection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">check</span><span class="o">.</span><span class="n">callback</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">events</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">listeners</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">]]:</span>
        <span class="k">return</span> <span class="n">utilities</span><span class="o">.</span><span class="n">CastedView</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="n">callback</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span> <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">x</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Top level `tanjun.abc.AnyHooks` set for this client.</span>

<span class="sd">        These are called during both message and interaction command execution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[tanjun.abc.AnyHooks]</span>
<span class="sd">            The top level `tanjun.abc.Context` based hooks set for this</span>
<span class="sd">            client if applicable, else `None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Top level `tanjun.abc.SlashHooks` set for this client.</span>

<span class="sd">        These are only called during interaction command execution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_alive</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">message_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Top level `tanjun.abc.MessageHooks` set for this client.</span>

<span class="sd">        These are only called during both message command execution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">prefix_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">PrefixGetterSig</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Prefix getter method set for this client.</span>

<span class="sd">        For more information on this callback&#39;s signature see `PrefixGetter`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">PrefixGetterSig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">prefixes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Collection of the standard prefixes set for this client.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rest</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">server</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shards</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shards</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">voice</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">VoiceComponent</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_voice</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_starting_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_stopping_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">clear_slash_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">if</span> <span class="n">application</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">()</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">set_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="p">(),</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">set_global_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Alias of `Client.declare_global_commands`.</span>

<span class="sd">        .. deprecated:: v2.1.1a1</span>
<span class="sd">            Use `Client.declare_global_commands` instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;The `Client.set_global_commands` method has been deprecated since v2.1.1a1. &quot;</span>
            <span class="s2">&quot;Use `Client.declare_global_commands` instead.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">declare_global_commands</span><span class="p">(</span><span class="n">application</span><span class="o">=</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_global_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">commands</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">command</span>
            <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
                <span class="n">component</span><span class="o">.</span><span class="n">slash_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">is_global</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">declare_slash_commands</span><span class="p">(</span>
            <span class="n">commands</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">application</span><span class="o">=</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_slash_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflakeish</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">builder</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">command_id</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">edit_application_command</span><span class="p">(</span>
                <span class="n">application</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">(),</span>
                <span class="n">command_id</span><span class="p">,</span>
                <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">create_application_command</span><span class="p">(</span>
                <span class="n">application</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">(),</span>
                <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">guild</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">set_tracked_command</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>  <span class="c1"># TODO: is this fine?</span>

        <span class="k">return</span> <span class="n">response</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_slash_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">commands</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">],</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">command_ids</span> <span class="o">=</span> <span class="n">command_ids</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">names_to_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">conflicts</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">builders</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">CommandBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">commands</span><span class="p">:</span>
            <span class="n">names_to_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">command</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">builders</span><span class="p">:</span>
                <span class="n">conflicts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

            <span class="n">builder</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">command_id</span> <span class="o">:=</span> <span class="n">command_ids</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                <span class="n">builder</span><span class="o">.</span><span class="n">set_id</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">command_id</span><span class="p">))</span>

            <span class="n">builders</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">builder</span>

        <span class="k">if</span> <span class="n">conflicts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Couldn&#39;t declare commands due to conflicts. The following command names have more than one command &quot;</span>
                <span class="s2">&quot;registered for them &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conflicts</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You can only declare up to 100 top level commands in a guild or globally&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">application</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">()</span>

        <span class="n">target_type</span> <span class="o">=</span> <span class="s2">&quot;global&quot;</span> <span class="k">if</span> <span class="n">guild</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;guild </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">guild</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
            <span class="n">registered_commands</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">registered_commands</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span>
                <span class="n">_cmp_command</span><span class="p">(</span><span class="n">builders</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">command</span><span class="p">)</span> <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">registered_commands</span>
            <span class="p">):</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Skipping bulk declare for </span><span class="si">%s</span><span class="s2"> slash commands due to them already being set&quot;</span><span class="p">,</span> <span class="n">target_type</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">registered_commands</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Bulk declaring </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> slash commands&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">),</span> <span class="n">target_type</span><span class="p">)</span>
        <span class="n">responses</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">set_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">builders</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">responses</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">guild</span><span class="p">:</span>
                <span class="n">names_to_commands</span><span class="p">[</span><span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">set_tracked_command</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>  <span class="c1"># TODO: is this fine?</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">expected_id</span> <span class="o">:=</span> <span class="n">command_ids</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="ow">and</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">expected_id</span><span class="p">)</span> <span class="o">!=</span> <span class="n">response</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;ID mismatch found for </span><span class="si">%s</span><span class="s2"> command </span><span class="si">%r</span><span class="s2">, expected </span><span class="si">%s</span><span class="s2"> but got </span><span class="si">%s</span><span class="s2">. &quot;</span>
                    <span class="s2">&quot;This suggests that any previous permissions set for this command will have been lost.&quot;</span><span class="p">,</span>
                    <span class="n">target_type</span><span class="p">,</span>
                    <span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">expected_id</span><span class="p">,</span>
                    <span class="n">response</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Successfully declared </span><span class="si">%s</span><span class="s2"> (top-level) </span><span class="si">%s</span><span class="s2"> commands&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">responses</span><span class="p">),</span> <span class="n">target_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_LOGGER</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;declared </span><span class="si">%s</span><span class="s2"> command ids: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">target_type</span><span class="p">,</span> <span class="p">{</span><span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">responses</span><span class="p">}</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">responses</span>

    <span class="k">def</span> <span class="nf">set_auto_defer_after</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set when this client should automatically defer execution of commands.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            If `time` is set to `None` then automatic deferrals will be disabled.</span>
<span class="sd">            This may lead to unexpected behaviour.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        time : typing.Optional[float]</span>
<span class="sd">            The time in seconds to defer interaction command responses after.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="k">if</span> <span class="n">time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_ephemeral_default</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set whether slash contexts spawned by this client should default to ephemeral responses.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether slash command contexts executed in this component should</span>
<span class="sd">            should default to ephemeral.</span>

<span class="sd">            This will be overridden by any response calls which specify flags</span>
<span class="sd">            and defaults to `False`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This component to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_hikari_trait_injectors</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">RESTAware</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set type based dependency injection based on the hikari traits found in `bot`.</span>

<span class="sd">        This is a short hand for calling `Client.add_type_dependency` for all</span>
<span class="sd">        the hikari trait types `bot` is valid for with bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari_traits.RESTAware</span>
<span class="sd">            The hikari client to set dependency injectors for.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">hikari_traits</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">member</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bot</span><span class="p">,</span> <span class="n">member</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">bot</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_interaction_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the response message for when an interaction command is not found.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            Setting this to `None` may lead to unexpected behaviour (especially</span>
<span class="sd">            when the client is still set to auto-defer interactions) and should</span>
<span class="sd">            only be done if you know what you&#39;re doing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : typing.Optional[str]</span>
<span class="sd">            The message to respond with when an interaction command isn&#39;t found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span> <span class="o">=</span> <span class="n">message</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_message_accepts</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">accepts</span><span class="p">:</span> <span class="n">MessageAcceptsEnum</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the kind of messages commands should be executed based on.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        accepts : MessageAcceptsEnum</span>
<span class="sd">            The type of messages commands should be executed based on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot set accepts level on a client with no event manager&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span> <span class="o">=</span> <span class="n">accepts</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_message_ctx_maker</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">maker</span><span class="p">:</span> <span class="n">_MessageContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the message context maker to use when creating context for a message.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            The caller must return an instance of `tanjun.context.MessageContext`</span>
<span class="sd">            rather than just any implementation of the MessageContext abc due to</span>
<span class="sd">            this client relying on implementation detail of</span>
<span class="sd">            `tanjun.context.MessageContext`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        maker : _MessageContextMakerProto</span>
<span class="sd">            The message context maker to use.</span>

<span class="sd">            This is a callback which should match the signature of</span>
<span class="sd">            `tanjun.context.MessageContext.__init__` and return an instance</span>
<span class="sd">            of `tanjun.context.MessageContext`.</span>

<span class="sd">            This defaults to `tanjun.context.MessageContext`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span> <span class="o">=</span> <span class="n">maker</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_slash_ctx_maker</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">maker</span><span class="p">:</span> <span class="n">_SlashContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the slash context maker to use when creating context for a slash command.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            The caller must return an instance of `tanjun.context.SlashContext`</span>
<span class="sd">            rather than just any implementation of the SlashContext abc due to</span>
<span class="sd">            this client relying on implementation detail of</span>
<span class="sd">            `tanjun.context.SlashContext`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        maker : _SlashContextMakerProto</span>
<span class="sd">            The slash context maker to use.</span>

<span class="sd">            This is a callback which should match the signature of</span>
<span class="sd">            `tanjun.context.SlashContext.__init__` and return an instance</span>
<span class="sd">            of `tanjun.context.SlashContext`.</span>

<span class="sd">            This defaults to `tanjun.context.SlashContext`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span> <span class="o">=</span> <span class="n">maker</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_human_only</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set whether or not message commands execution should be limited to &quot;human&quot; users.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This doesn&#39;t apply to interaction commands as these can only be</span>
<span class="sd">            triggered by a &quot;human&quot; (normal user account).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether or not message commands execution should be limited to &quot;human&quot; users.</span>

<span class="sd">            Passing `True` here will prevent message commands from being executed</span>
<span class="sd">            based on webhook and bot messages.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">_check_human</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_check</span><span class="p">(</span><span class="n">_check_human</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a generic check to this client.</span>

<span class="sd">        This will be applied to both message and slash command execution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to add. This may be either synchronous or asynchronous</span>
<span class="sd">            and must take one positional argument of type `tanjun.abc.Context`</span>
<span class="sd">            with dependency injection being supported for its keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">check</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checks</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">(</span><span class="n">check</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a check from the client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the check was not previously added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;checks.InjectableCheck&quot;</span><span class="p">,</span> <span class="n">check</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a check to this client through a decorator call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to add. This may be either synchronous or asynchronous</span>
<span class="sd">            and must take one positional argument of type `tanjun.abc.Context`</span>
<span class="sd">            with dependency injection being supported for its keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun_abc.CheckSig</span>
<span class="sd">            The added check.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">check</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">gather_checks</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">add_injector</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a component to this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        component: Component</span>
<span class="sd">            The component to move to this client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to allow chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the component&#39;s name is already registered.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">component</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A component named </span><span class="si">{</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="si">!r}</span><span class="s2"> is already registered.&quot;</span><span class="p">)</span>

        <span class="n">component</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">component</span>

        <span class="k">if</span> <span class="n">add_injector</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">component</span><span class="p">),</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">component</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">COMPONENT_ADDED</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">get_component_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">stored_component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">stored_component</span> <span class="ow">or</span> <span class="n">stored_component</span> <span class="o">!=</span> <span class="n">component</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The component </span><span class="si">{</span><span class="n">component</span><span class="si">!r}</span><span class="s2"> is not registered.&quot;</span><span class="p">)</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="n">stored_component</span><span class="o">.</span><span class="n">unbind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">COMPONENT_REMOVED</span><span class="p">,</span> <span class="n">stored_component</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_component_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">add_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">descriptor</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">descriptor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">descriptor</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">descriptor</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">dispatch_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Dispatch a client callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The name of the callback to dispatch.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        *args : typing.Any</span>
<span class="sd">            Positional arguments to pass to the callback(s).</span>
<span class="sd">        **kwargs : typing.Any</span>
<span class="sd">            Keyword arguments to pass to the callback(s).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        KeyError</span>
<span class="sd">            If no callbacks are registered for the given name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">callbacks</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="n">calls</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">_wrap_client_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">injecting</span><span class="o">.</span><span class="n">BasicInjectionContext</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">calls</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_client_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">callback</span><span class="o">.</span><span class="n">callback</span> <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">()</span>

    <span class="k">def</span> <span class="nf">remove_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;injecting.CallbackDescriptor[None]&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_client_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">],</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="k">def</span> <span class="nf">add_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">injected</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">SelfInjectingCallback</span><span class="p">[</span><span class="kc">None</span><span class="p">](</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injected</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">injected</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">injected</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;injecting.SelfInjectingCallback[None]&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="p">))</span>
        <span class="n">registered_callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">registered_callback</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">],</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_listener</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="k">def</span> <span class="nf">add_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">prefixes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a prefix used to filter message command calls.</span>

<span class="sd">        This will be matched against the first character(s) in a message&#39;s</span>
<span class="sd">        content to determine whether the message command search stage of</span>
<span class="sd">        execution should be initiated.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        prefixes : typing.Union[collections.abc.Iterable[str], str]</span>
<span class="sd">            Either a single string or an iterable of strings to be used as</span>
<span class="sd">            prefixes.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prefixes</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">prefixes</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefixes</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">prefix</span> <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">prefixes</span> <span class="k">if</span> <span class="n">prefix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a message content prefix from the client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        prefix : str</span>
<span class="sd">            The prefix to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the prefix is not registered with the client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_prefix_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">getter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">PrefixGetterSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the callback used to retrieve message prefixes set for the relevant guild.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        getter : typing.Optional[PrefixGetterSig]</span>
<span class="sd">            The callback which&#39;ll be used to retrieve prefixes for the guild a</span>
<span class="sd">            message context is from. If `None` is passed here then the callback</span>
<span class="sd">            will be unset.</span>

<span class="sd">            This should be an async callback which one argument of type</span>
<span class="sd">            `tanjun.abc.MessageContext` and returns an iterable of string prefixes.</span>
<span class="sd">            Dependency injection is supported for this callback&#39;s keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">getter</span><span class="p">)</span> <span class="k">if</span> <span class="n">getter</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_prefix_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">getter</span><span class="p">:</span> <span class="n">PrefixGetterSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PrefixGetterSigT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the prefix getter callback for this client through decorator call.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ```py</span>
<span class="sd">        client = tanjun.Client.from_rest_bot(bot)</span>

<span class="sd">        @client.with_prefix_getter</span>
<span class="sd">        async def prefix_getter(ctx: tanjun.abc.MessageContext) -&gt; collections.abc.Iterable[str]:</span>
<span class="sd">            raise NotImplementedError</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        getter : PrefixGetterSig</span>
<span class="sd">            The callback which&#39;ll be  to retrieve prefixes for the guild a</span>
<span class="sd">            message event is from.</span>

<span class="sd">            This should be an async callback which one argument of type</span>
<span class="sd">            `tanjun.abc.MessageContext` and returns an iterable of string prefixes.</span>
<span class="sd">            Dependency injection is supported for this callback&#39;s keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PrefixGetterSigT</span>
<span class="sd">            The registered callback.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_prefix_getter</span><span class="p">(</span><span class="n">getter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">getter</span>

    <span class="k">def</span> <span class="nf">iter_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">]]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">slash_commands</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_slash_commands</span><span class="p">(</span><span class="n">global_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_message_commands</span><span class="p">()</span>
        <span class="k">yield from</span> <span class="n">slash_commands</span>

    <span class="k">def</span> <span class="nf">iter_message_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">message_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">iter_slash_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">global_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">if</span> <span class="n">global_only</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">is_global</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_slash_commands</span><span class="p">(</span><span class="n">global_only</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">slash_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_message_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="n">component</span><span class="o">.</span><span class="n">check_message_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_slash_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="n">component</span><span class="o">.</span><span class="n">check_slash_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_check_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">prefix</span>

        <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">prefix</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_try_unsubscribe</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event_manager</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">,</span>
        <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">event_manager</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">LookupError</span><span class="p">):</span>
            <span class="c1"># TODO: add logging here</span>
            <span class="k">pass</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">deregister_listeners</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close the client.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the client isn&#39;t running.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Client isn&#39;t active&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span><span class="p">:</span>
            <span class="n">event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSING</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deregister_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event_type</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">event_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_message_create_event</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_event</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listener</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">deregister_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">register_listeners</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Start the client.</span>

<span class="sd">        If `mention_prefix` was passed to `Client.__init__` or</span>
<span class="sd">        `Client.from_gateway_bot` then this function may make a fetch request</span>
<span class="sd">        to Discord if it cannot get the current user from the cache.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the client is already active.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Client is already alive&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">:</span>
                <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">get_me</span><span class="p">()</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_my_user</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_my_user</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="sa">f</span><span class="s2">&quot;&lt;@</span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&gt;&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;&lt;@!</span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&gt;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">prefix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">register_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event_type</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_message_create_event</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_event</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">listener</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">register_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_request</span><span class="p">)</span>

        <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTED</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_rest_application_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Fetch the application ID of the application this client is linked to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.Snowflake</span>
<span class="sd">            The application ID of the application this client is linked to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">token_type</span> <span class="o">==</span> <span class="n">hikari</span><span class="o">.</span><span class="n">TokenType</span><span class="o">.</span><span class="n">BOT</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_application</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_authorization</span><span class="p">())</span><span class="o">.</span><span class="n">application</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">application</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span>

    <span class="k">def</span> <span class="nf">set_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the general command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every slash and message</span>
<span class="sd">        command execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.AnyHooks]</span>
<span class="sd">            The general command execution hooks to set for this client.</span>

<span class="sd">            Passing `None` will remove all hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the slash command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every slash command</span>
<span class="sd">        execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.SlashHooks]</span>
<span class="sd">            The slash context specific command execution hooks to set for this</span>
<span class="sd">            client.</span>

<span class="sd">            Passing `None` will remove the hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_message_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the message command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every message command</span>
<span class="sd">        execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.MessageHooks]</span>
<span class="sd">            The message context specific command execution hooks to set for this</span>
<span class="sd">            client.</span>

<span class="sd">            Passing `None` will remove all hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_iter_module_members</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="n">exported</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;__all__&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">exported</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exported</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">):</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Scanning </span><span class="si">%s</span><span class="s2"> module based on its declared __all__)&quot;</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">exported</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">))</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Scanning all public members on </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">member</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_load_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iter_module_members</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">_LoaderDescriptor</span><span class="p">):</span>
                <span class="n">member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Didn&#39;t find any loader descriptors in </span><span class="si">{</span><span class="n">module_repr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">_log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load entities into this client from modules based on loader descriptors.</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find loaders.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_loader`</span>
<span class="sd">        decorated top level function which takes one positional argument</span>
<span class="sd">        of type `Client`.</span>

<span class="sd">        ```py</span>
<span class="sd">        @tanjun.as_loader</span>
<span class="sd">        def load_module(client: tanjun.Client) -&gt; None:</span>
<span class="sd">            client.add_component(component.copy())</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules : typing.Union[str, pathlib.Path]</span>
<span class="sd">            Path(s) of the modules to load from.</span>

<span class="sd">            When `str` this will be treated as a normal import path which is</span>
<span class="sd">            absolute (`&quot;foo.bar.baz&quot;`). It&#39;s worth noting that absolute module</span>
<span class="sd">            paths may be imported from the current location if the top level</span>
<span class="sd">            module is a valid module file or module directory in the current</span>
<span class="sd">            working directory.</span>

<span class="sd">            When `pathlib.Path` the module will be imported directly from</span>
<span class="sd">            the given path. In this mode any relative imports in the target</span>
<span class="sd">            module will fail to resolve.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module is already loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no loader descriptors are found in the module.</span>
<span class="sd">        ModuleNotFoundError</span>
<span class="sd">            If the module is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> already loaded&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                    <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">[</span><span class="n">module_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">module_path_abs</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">module_path_abs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module at </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> already loaded&quot;</span><span class="p">)</span>

                <span class="n">module_name</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="n">importlib_util</span><span class="o">.</span><span class="n">spec_from_file_location</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">module_path_abs</span><span class="p">)</span>

                <span class="c1"># https://github.com/python/typeshed/issues/2793</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">spec</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="p">,</span> <span class="n">importlib_abc</span><span class="o">.</span><span class="n">Loader</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ModuleNotFoundError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Module not found at </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">module_name</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                    <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib_util</span><span class="o">.</span><span class="n">module_from_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
                <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">exec_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">[</span><span class="n">module_path_abs</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">_unload_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iter_module_members</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">_UnloaderDescriptor</span><span class="p">):</span>
                <span class="n">member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Didn&#39;t find any unloaders in </span><span class="si">{</span><span class="n">module_repr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">unload_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">_log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Unload entities from this client based on unloader descriptors in one or more modules.</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find unloaders.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_unloader`</span>
<span class="sd">        decorated top level function which takes one positional argument</span>
<span class="sd">        of type `Client`.</span>

<span class="sd">        ```py</span>
<span class="sd">        @tanjun.as_unloader</span>
<span class="sd">        def unload_component(client: tanjun.Client) -&gt; None:</span>
<span class="sd">            client.remove_component_by_name(component.name)</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules: typing.Union[str, pathlib.Path]</span>
<span class="sd">            Path of one or more modules to unload.</span>

<span class="sd">            These should be the same path(s) which were passed to `load_module`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module hasn&#39;t been loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no unloader descriptors are found in the module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">module_path</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module </span><span class="si">{</span><span class="n">module_path</span><span class="si">!s}</span><span class="s2"> not loaded&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Unloading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_unload_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">reload_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Reload entities in this client based on the descriptors in loaded module(s).</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find descriptors.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_loader` and</span>
<span class="sd">        one `as_unloader` decorated top level function which each take one</span>
<span class="sd">        positional argument of type `Client`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules: typing.Union[str, pathlib.Path]</span>
<span class="sd">            Paths of one or more module to unload.</span>

<span class="sd">            These should be the same paths which were passed to `load_module`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module hasn&#39;t been loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no unloader descriptors are found in the current state of the module.</span>
<span class="sd">            If no loader descriptors are found in the new state of the module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> not loaded&quot;</span><span class="p">)</span>

                <span class="n">module_repr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Reloading </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unload_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">[</span><span class="n">module_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Reloading </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unload_modules</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="n">_log</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">load_modules</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="n">_log</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_message_create_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a message command based on a gateway event.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hikari.events.message_events.MessageCreateEvent</span>
<span class="sd">            The event to handle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">message</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">prefix</span> <span class="o">:=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_prefix</span><span class="p">(</span><span class="n">ctx</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">ctx</span><span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="p">:]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span><span class="o">.</span><span class="n">set_triggering_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_message</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">return</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">MESSAGE_COMMAND_NOT_FOUND</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]:</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">}</span>

        <span class="k">return</span> <span class="n">hooks</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_slash_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">context</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">SLASH_COMMAND_NOT_FOUND</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ctx</span><span class="o">.</span><span class="n">has_responded</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_interaction_create_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a slash command based on Gateway events.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Any event where `event.interaction` is not</span>
<span class="sd">            `hikari.CommandInteraction` will be ignored.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : hikari.events.interaction_events.InteractionCreateEvent</span>
<span class="sd">            The event to execute commands based on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">interaction</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">,</span>
            <span class="n">on_not_found</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_slash_not_found</span><span class="p">,</span>
            <span class="n">default_to_ephemeral</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slash_hooks</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">start_defer_timer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="c1"># This is set on each iteration to ensure that any component</span>
                    <span class="c1"># state which was set to this isn&#39;t propagated to other components.</span>
                    <span class="n">ctx</span><span class="o">.</span><span class="n">set_ephemeral_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">future</span> <span class="o">:=</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_interaction</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">await</span> <span class="n">future</span>
                        <span class="k">return</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_interaction_create_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">ResponseTypeT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a slash command based on received REST requests.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        interaction : hikari.CommandInteraction</span>
<span class="sd">            The interaction to execute a command based on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun.context.ResponseType</span>
<span class="sd">            The initial response to send back to Discord.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">interaction</span><span class="o">=</span><span class="n">interaction</span><span class="p">,</span>
            <span class="n">on_not_found</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_slash_not_found</span><span class="p">,</span>
            <span class="n">default_to_ephemeral</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">start_defer_timer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">)</span>

        <span class="n">hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slash_hooks</span><span class="p">()</span>
        <span class="n">future</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_response_future</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_interaction</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="c1"># Under very specific timing there may be another future which could set a result while we await</span>
            <span class="c1"># ctx.respond therefore we create a task to avoid any erroneous behaviour from this trying to create</span>
            <span class="c1"># another response before it&#39;s returned the initial response.</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interaction</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> command error responder&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>

        <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interaction</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>
</pre></div>

        </details>

            <div class="docstring"><p>Tanjun's standard <code><a href="tanjun/abc.html#Client">tanjun.abc.Client</a></code> implementation.</p>

<p>This implementation supports dependency injection for checks, command
callbacks, prefix getters and event listeners. For more information on how
this works see <code><a href="tanjun/injecting.html">tanjun.injecting</a></code>.</p>

<h6 id="notes">Notes</h6>

<ul>
<li>For a quicker way to initiate this client around a standard bot aware
client, see <code><a href="#Client.from_gateway_bot">Client.from_gateway_bot</a></code> and <code><a href="#Client.from_rest_bot">Client.from_rest_bot</a></code>.</li>
<li>The endpoint used by <code><a href="#Client.declare_global_commands">declare_global_commands</a></code> has a strict ratelimit which,
as of writing, only allows for 2 requests per minute (with that ratelimit
either being per-guild if targeting a specific guild otherwise globally).</li>
<li><code>event_manager</code> is necessary for message command dispatch and will also
be necessary for interaction command dispatch if <code><a href="#Client.server">server</a></code> isn't
provided.</li>
<li><code><a href="#Client.server">server</a></code> is used for interaction command dispatch if interaction
events aren't being received from the event manager.</li>
<li>By default this client includes a parser error handling hook which will
by overwritten if you call <code><a href="#Client.set_hooks">Client.set_hooks</a></code>.</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>rest</strong> (hikari.api.rest.RestClient):
The Hikari REST client this will use.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>cache</strong> (hikari.api.cache.CacheClient):
The Hikari cache client this will use if applicable.</li>
<li><strong>event_manager</strong> (hikari.api.event_manager.EventManagerClient):
The Hikari event manager client this will use if applicable.</li>
<li><strong>server</strong> (hikari.api.interaction_server.InteractionServer):
The Hikari interaction server client this will use if applicable.</li>
<li><strong>shards</strong> (hikari.traits.ShardAware):
The Hikari shard aware client this will use if applicable.</li>
<li><strong>voice</strong> (hikari.api.voice.VoiceComponent):
The Hikari voice component this will use if applicable.</li>
<li><p><strong>event_managed</strong> (bool):
Whether or not this client is managed by the event manager.</p>

<p>An event managed client will be automatically started and closed based
on Hikari's lifetime events.</p>

<p>Defaults to <code>False</code> and can only be passed as <code>True</code> if <code>event_manager</code>
is also provided.</p></li>
<li><p><strong>mention_prefix</strong> (bool):
Whether or not mention prefixes should be automatically set when this
client is first started.</p>

<p>Defaults to <code>False</code> and it should be noted that this only applies to
message commands.</p></li>
<li><p><strong>declare_global_commands</strong> (typing.Union[hikari.SnowflakeishSequenceOr[hikari.PartialGuild], hikari.SnowflakeishOr[hikari.PartialGuild], bool]):
Whether or not to automatically set global slash commands when this
client is first started. Defaults to <code>False</code>.</p>

<p>If one or more guild objects/IDs are passed here then the registered
global commands will be set on the specified guild(s) at startup rather
than globally. This can be useful for testing/debug purposes as slash
commands may take up to an hour to propagate globally but will
immediately propagate when set on a specific guild.</p></li>
<li><strong>set_global_commands</strong> (typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]):
Deprecated as of v2.1.1a1 alias of <code><a href="#Client.declare_global_commands">declare_global_commands</a></code>.</li>
<li><p><strong>command_ids</strong> (typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]):
If provided, a mapping of top level command names to IDs of the commands to update.</p>

<p>This field is complementary to <code><a href="#Client.declare_global_commands">declare_global_commands</a></code> and, while it
isn't necessarily required, this will in some situations help avoid
permissions which were previously set for a command from being lost
after a rename.</p>

<p>This currently isn't supported when multiple guild IDs are passed for
<code><a href="#Client.declare_global_commands">declare_global_commands</a></code>.</p></li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: Raises for the following reasons:
<ul>
<li>If <code>event_managed</code> is <code>True</code> when <code>event_manager</code> is <code>None</code>.</li>
<li>If <code>command_ids</code> is passed when multiple guild ids are provided for <code><a href="#Client.declare_global_commands">declare_global_commands</a></code>.</li>
<li>If <code>command_ids</code> is passed when <code><a href="#Client.declare_global_commands">declare_global_commands</a></code> is <code>False</code>.</li>
</ul></li>
</ul>
</div>


                            <div id="Client.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">Client</span><span class="signature">(
    rest: hikari.api.rest.RESTClient,
    *,
    cache: Optional[hikari.api.cache.Cache] = None,
    events: Optional[hikari.api.event_manager.EventManager] = None,
    server: Optional[hikari.api.interaction_server.InteractionServer] = None,
    shards: Optional[hikari.traits.ShardAware] = None,
    voice: Optional[hikari.api.voice.VoiceComponent] = None,
    event_managed: bool = False,
    mention_prefix: bool = False,
    set_global_commands: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, bool] = False,
    declare_global_commands: Union[Sequence[Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int]], hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, bool] = False,
    command_ids: Optional[collections.abc.Mapping[str, Union[hikari.commands.Command, hikari.snowflakes.Snowflake, int]]] = None,
    _stack_level: int = 0
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rest</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">cache</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">events</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">server</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">shards</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">voice</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">VoiceComponent</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mention_prefix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># InjectorClient.__init__</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">dependencies</span><span class="o">.</span><span class="n">set_standard_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># TODO: logging or something to indicate this is running statelessly rather than statefully.</span>
        <span class="c1"># TODO: warn if server and dispatch both None but don&#39;t error</span>

        <span class="c1"># TODO: separate slash and gateway checks?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span> <span class="o">=</span> <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">ALL</span> <span class="k">if</span> <span class="n">events</span> <span class="k">else</span> <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">NONE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="n">cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">checks</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span><span class="p">:</span> <span class="n">_MessageContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">MessageContext</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">:</span> <span class="n">_SlashContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">SlashContext</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_events</span> <span class="o">=</span> <span class="n">events</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span> <span class="o">=</span> <span class="n">mention_prefix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">]</span> <span class="o">=</span> <span class="n">hooks</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">()</span><span class="o">.</span><span class="n">set_on_parser_error</span><span class="p">(</span><span class="n">on_parser_error</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command not found&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">SelfInjectingCallback</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span> <span class="o">=</span> <span class="n">rest</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_server</span> <span class="o">=</span> <span class="n">server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shards</span> <span class="o">=</span> <span class="n">shards</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_voice</span> <span class="o">=</span> <span class="n">voice</span>

        <span class="k">if</span> <span class="n">event_managed</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Client cannot be event managed without an event manager&quot;</span><span class="p">)</span>

            <span class="n">events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_starting_event</span><span class="p">)</span>
            <span class="n">events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_stopping_event</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">set_global_commands</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;The `set_global_commands` argument is deprecated since v2.1.1a1. &quot;</span>
                <span class="s2">&quot;Use `declare_global_commands` instead.&quot;</span><span class="p">,</span>
                <span class="ne">DeprecationWarning</span><span class="p">,</span>
                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">_stack_level</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">declare_global_commands</span> <span class="o">=</span> <span class="n">declare_global_commands</span> <span class="ow">or</span> <span class="n">set_global_commands</span>
        <span class="n">command_ids</span> <span class="o">=</span> <span class="n">command_ids</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">declare_global_commands</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">command_ids</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">command_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot declare global guilds in multiple-guilds and pass command IDs&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">guild</span> <span class="ow">in</span> <span class="n">declare_global_commands</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">guild</span><span class="p">))</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">declare_global_commands</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">declare_global_commands</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span>
                    <span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="n">command_ids</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot pass command IDs when not declaring global commands&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span>
                <span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">declare_global_commands</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">Client</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span> <span class="n">rest</span><span class="p">)</span>
            <span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">rest</span><span class="p">),</span> <span class="n">rest</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">cache</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">cache</span><span class="p">),</span> <span class="n">cache</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">,</span> <span class="n">events</span><span class="p">)</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">events</span><span class="p">),</span> <span class="n">events</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">,</span> <span class="n">server</span><span class="p">)</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">server</span><span class="p">),</span> <span class="n">server</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">shards</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">,</span> <span class="n">shards</span><span class="p">)</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">shards</span><span class="p">),</span> <span class="n">shards</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">voice</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">VoiceComponent</span><span class="p">,</span> <span class="n">voice</span><span class="p">)</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">voice</span><span class="p">),</span> <span class="n">voice</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Client.from_gateway_bot" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.from_gateway_bot">#&nbsp;&nbsp</a>

                <div class="decorator">@classmethod</div>

            <span class="def">def</span>
            <span class="name">from_gateway_bot</span><span class="signature">(
    cls,
    bot: hikari.traits.GatewayBotAware,
    /,
    *,
    event_managed: bool = True,
    mention_prefix: bool = False,
    declare_global_commands: Union[Sequence[Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int]], hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, bool] = False,
    set_global_commands: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, bool] = False,
    command_ids: Optional[collections.abc.Mapping[str, Union[hikari.commands.Command, hikari.snowflakes.Snowflake, int]]] = None
) -&gt; <a href="tanjun/clients.html#Client">tanjun.clients.Client</a></span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_gateway_bot</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">GatewayBotAware</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">mention_prefix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a `Client` from a `hikari.traits.GatewayBotAware` instance.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This implicitly defaults the client to human only mode.</span>
<span class="sd">        * This sets type dependency injectors for the hikari traits present in</span>
<span class="sd">          `bot` (including `hikari.traits.GatewayBotaWARE`).</span>
<span class="sd">        * The endpoint used by `declare_global_commands` has a strict ratelimit</span>
<span class="sd">          which, as of writing, only allows for 2 requests per minute (with that</span>
<span class="sd">          ratelimit either being per-guild if targeting a specific guild</span>
<span class="sd">          otherwise globally).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.GatewayBotAware</span>
<span class="sd">            The bot client to build from.</span>

<span class="sd">            This will be used to infer the relevant Hikari clients to use.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        event_managed : bool</span>
<span class="sd">            Whether or not this client is managed by the event manager.</span>

<span class="sd">            An event managed client will be automatically started and closed</span>
<span class="sd">            based on Hikari&#39;s lifetime events.</span>

<span class="sd">            Defaults to `True`.</span>
<span class="sd">        mention_prefix : bool</span>
<span class="sd">            Whether or not mention prefixes should be automatically set when this</span>
<span class="sd">            client is first started.</span>

<span class="sd">            Defaults to `False` and it should be noted that this only applies to</span>
<span class="sd">            message commands.</span>
<span class="sd">        declare_global_commands : typing.Union[hikari.SnowflakeishSequenceOr[hikari.PartialGuild], hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Whether or not to automatically set global slash commands when this</span>
<span class="sd">            client is first started. Defaults to `False`.</span>

<span class="sd">            If one or more guild objects/IDs are passed here then the registered</span>
<span class="sd">            global commands will be set on the specified guild(s) at startup rather</span>
<span class="sd">            than globally. This can be useful for testing/debug purposes as slash</span>
<span class="sd">            commands may take up to an hour to propagate globally but will</span>
<span class="sd">            immediately propagate when set on a specific guild.</span>
<span class="sd">        set_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Deprecated as of v2.1.1a1 alias of `declare_global_commands`.</span>
<span class="sd">        command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">            If provided, a mapping of top level command names to IDs of the commands to update.</span>

<span class="sd">            This field is complementary to `declare_global_commands` and, while it</span>
<span class="sd">            isn&#39;t necessarily required, this will in some situations help avoid</span>
<span class="sd">            permissions which were previously set for a command from being lost</span>
<span class="sd">            after a rename.</span>

<span class="sd">            This currently isn&#39;t supported when multiple guild IDs are passed for</span>
<span class="sd">            `declare_global_commands`.</span>
<span class="sd">        &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501 - line too long</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">cls</span><span class="p">(</span>
                <span class="n">rest</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span>
                <span class="n">cache</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span>
                <span class="n">events</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">event_manager</span><span class="p">,</span>
                <span class="n">shards</span><span class="o">=</span><span class="n">bot</span><span class="p">,</span>
                <span class="n">voice</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">voice</span><span class="p">,</span>
                <span class="n">event_managed</span><span class="o">=</span><span class="n">event_managed</span><span class="p">,</span>
                <span class="n">mention_prefix</span><span class="o">=</span><span class="n">mention_prefix</span><span class="p">,</span>
                <span class="n">declare_global_commands</span><span class="o">=</span><span class="n">declare_global_commands</span><span class="p">,</span>
                <span class="n">set_global_commands</span><span class="o">=</span><span class="n">set_global_commands</span><span class="p">,</span>
                <span class="n">command_ids</span><span class="o">=</span><span class="n">command_ids</span><span class="p">,</span>
                <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">set_human_only</span><span class="p">()</span>
            <span class="o">.</span><span class="n">set_hikari_trait_injectors</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>
        <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Build a <code><a href="#Client">Client</a></code> from a <code>hikari.traits.GatewayBotAware</code> instance.</p>

<h6 id="notes">Notes</h6>

<ul>
<li>This implicitly defaults the client to human only mode.</li>
<li>This sets type dependency injectors for the hikari traits present in
<code>bot</code> (including <code>hikari.traits.GatewayBotaWARE</code>).</li>
<li>The endpoint used by <code><a href="#Client.declare_global_commands">declare_global_commands</a></code> has a strict ratelimit
which, as of writing, only allows for 2 requests per minute (with that
ratelimit either being per-guild if targeting a specific guild
otherwise globally).</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>bot</strong> (hikari.traits.GatewayBotAware):
The bot client to build from.</p>

<p>This will be used to infer the relevant Hikari clients to use.</p></li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>event_managed</strong> (bool):
Whether or not this client is managed by the event manager.</p>

<p>An event managed client will be automatically started and closed
based on Hikari's lifetime events.</p>

<p>Defaults to <code>True</code>.</p></li>
<li><p><strong>mention_prefix</strong> (bool):
Whether or not mention prefixes should be automatically set when this
client is first started.</p>

<p>Defaults to <code>False</code> and it should be noted that this only applies to
message commands.</p></li>
<li><p><strong>declare_global_commands</strong> (typing.Union[hikari.SnowflakeishSequenceOr[hikari.PartialGuild], hikari.SnowflakeishOr[hikari.PartialGuild], bool]):
Whether or not to automatically set global slash commands when this
client is first started. Defaults to <code>False</code>.</p>

<p>If one or more guild objects/IDs are passed here then the registered
global commands will be set on the specified guild(s) at startup rather
than globally. This can be useful for testing/debug purposes as slash
commands may take up to an hour to propagate globally but will
immediately propagate when set on a specific guild.</p></li>
<li><strong>set_global_commands</strong> (typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]):
Deprecated as of v2.1.1a1 alias of <code><a href="#Client.declare_global_commands">declare_global_commands</a></code>.</li>
<li><p><strong>command_ids</strong> (typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]):
If provided, a mapping of top level command names to IDs of the commands to update.</p>

<p>This field is complementary to <code><a href="#Client.declare_global_commands">declare_global_commands</a></code> and, while it
isn't necessarily required, this will in some situations help avoid
permissions which were previously set for a command from being lost
after a rename.</p>

<p>This currently isn't supported when multiple guild IDs are passed for
<code><a href="#Client.declare_global_commands">declare_global_commands</a></code>.</p></li>
</ul>
</div>


                            </div>
                            <div id="Client.from_rest_bot" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.from_rest_bot">#&nbsp;&nbsp</a>

                <div class="decorator">@classmethod</div>

            <span class="def">def</span>
            <span class="name">from_rest_bot</span><span class="signature">(
    cls,
    bot: hikari.traits.RESTBotAware,
    /,
    declare_global_commands: Union[Sequence[Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int]], hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, bool] = False,
    set_global_commands: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, bool] = False,
    command_ids: Optional[collections.abc.Mapping[str, Union[hikari.commands.Command, hikari.snowflakes.Snowflake, int]]] = None
) -&gt; <a href="tanjun/clients.html#Client">tanjun.clients.Client</a></span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_rest_bot</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">RESTBotAware</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a `Client` from a `hikari.traits.RESTBotAware` instance.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This sets type dependency injectors for the hikari traits present in</span>
<span class="sd">          `bot` (including `hikari.traits.RESTBotAware`).</span>
<span class="sd">        * The endpoint used by `declare_global_commands` has a strict ratelimit</span>
<span class="sd">          which, as of writing, only allows for 2 requests per minute (with that</span>
<span class="sd">          ratelimit either being per-guild if targeting a specific guild</span>
<span class="sd">          otherwise globally).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.RESTBotAware</span>
<span class="sd">            The bot client to build from.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        declare_global_commands : typing.Union[hikari.SnowflakeishSequenceOr[hikari.PartialGuild], hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Whether or not to automatically set global slash commands when this</span>
<span class="sd">            client is first started. Defaults to `False`.</span>

<span class="sd">            If one or more guild objects/IDs are passed here then the registered</span>
<span class="sd">            global commands will be set on the specified guild(s) at startup rather</span>
<span class="sd">            than globally. This can be useful for testing/debug purposes as slash</span>
<span class="sd">            commands may take up to an hour to propagate globally but will</span>
<span class="sd">            immediately propagate when set on a specific guild.</span>
<span class="sd">        set_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Deprecated as of v2.1.1a1 alias of `declare_global_commands`.</span>
<span class="sd">        command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">            If provided, a mapping of top level command names to IDs of the commands to update.</span>

<span class="sd">            This field is complementary to `declare_global_commands` and, while it</span>
<span class="sd">            isn&#39;t necessarily required, this will in some situations help avoid</span>
<span class="sd">            permissions which were previously set for a command from being lost</span>
<span class="sd">            after a rename.</span>

<span class="sd">            This currently isn&#39;t supported when multiple guild IDs are passed for</span>
<span class="sd">            `declare_global_commands`.</span>
<span class="sd">        &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501 - line too long</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">rest</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span>
            <span class="n">server</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">interaction_server</span><span class="p">,</span>
            <span class="n">declare_global_commands</span><span class="o">=</span><span class="n">declare_global_commands</span><span class="p">,</span>
            <span class="n">set_global_commands</span><span class="o">=</span><span class="n">set_global_commands</span><span class="p">,</span>
            <span class="n">command_ids</span><span class="o">=</span><span class="n">command_ids</span><span class="p">,</span>
            <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">set_hikari_trait_injectors</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Build a <code><a href="#Client">Client</a></code> from a <code>hikari.traits.RESTBotAware</code> instance.</p>

<h6 id="notes">Notes</h6>

<ul>
<li>This sets type dependency injectors for the hikari traits present in
<code>bot</code> (including <code>hikari.traits.RESTBotAware</code>).</li>
<li>The endpoint used by <code><a href="#Client.declare_global_commands">declare_global_commands</a></code> has a strict ratelimit
which, as of writing, only allows for 2 requests per minute (with that
ratelimit either being per-guild if targeting a specific guild
otherwise globally).</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>bot</strong> (hikari.traits.RESTBotAware):
The bot client to build from.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>declare_global_commands</strong> (typing.Union[hikari.SnowflakeishSequenceOr[hikari.PartialGuild], hikari.SnowflakeishOr[hikari.PartialGuild], bool]):
Whether or not to automatically set global slash commands when this
client is first started. Defaults to <code>False</code>.</p>

<p>If one or more guild objects/IDs are passed here then the registered
global commands will be set on the specified guild(s) at startup rather
than globally. This can be useful for testing/debug purposes as slash
commands may take up to an hour to propagate globally but will
immediately propagate when set on a specific guild.</p></li>
<li><strong>set_global_commands</strong> (typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]):
Deprecated as of v2.1.1a1 alias of <code><a href="#Client.declare_global_commands">declare_global_commands</a></code>.</li>
<li><p><strong>command_ids</strong> (typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]):
If provided, a mapping of top level command names to IDs of the commands to update.</p>

<p>This field is complementary to <code><a href="#Client.declare_global_commands">declare_global_commands</a></code> and, while it
isn't necessarily required, this will in some situations help avoid
permissions which were previously set for a command from being lost
after a rename.</p>

<p>This currently isn't supported when multiple guild IDs are passed for
<code><a href="#Client.declare_global_commands">declare_global_commands</a></code>.</p></li>
</ul>
</div>


                            </div>
                            <div id="Client.defaults_to_ephemeral" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.defaults_to_ephemeral">#&nbsp;&nbsp</a>

        <span class="name">defaults_to_ephemeral</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether slash contexts spawned by this client should default to ephemeral responses.</p>

<p>This effects calls to <code><a href="#SlashContext.create_followup">SlashContext.create_followup</a></code>,
<code><a href="#SlashContext.create_initial_response">SlashContext.create_initial_response</a></code>, <code><a href="#SlashContext.defer">SlashContext.defer</a></code> and
<code><a href="#SlashContext.respond">SlashContext.respond</a></code> unless the <code>flags</code> field is provided for the
methods which support it.</p>

<h6 id="notes">Notes</h6>

<ul>
<li>This may be overridden by <code>BaseSlashCommand.defaults_to_ephemeral</code>
and <code><a href="#Component.defaults_to_ephemeral">Component.defaults_to_ephemeral</a></code>.</li>
<li>This defaults to <code>False</code>.</li>
<li>This only effects slash command execution.</li>
</ul>
</div>


                            </div>
                            <div id="Client.message_accepts" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.message_accepts">#&nbsp;&nbsp</a>

        <span class="name">message_accepts</span><span class="annotation">: <a href="tanjun/clients.html#MessageAcceptsEnum">tanjun.clients.MessageAcceptsEnum</a></span>
    </div>

            <div class="docstring"><p>Type of message create events this command client accepts for execution.</p>
</div>


                            </div>
                            <div id="Client.is_human_only" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.is_human_only">#&nbsp;&nbsp</a>

        <span class="name">is_human_only</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether this client is only executing for non-bot/webhook users messages.</p>
</div>


                            </div>
                            <div id="Client.cache" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.cache">#&nbsp;&nbsp</a>

        <span class="name">cache</span><span class="annotation">: Optional[hikari.api.cache.Cache]</span>
    </div>

            <div class="docstring"><p>Hikari cache instance this command client was initialised with.</p>
</div>


                            </div>
                            <div id="Client.checks" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.checks">#&nbsp;&nbsp</a>

        <span class="name">checks</span><span class="annotation">: collections.abc.Collection[collections.abc.Callable[..., typing.Union[bool, collections.abc.Awaitable[bool]]]]</span>
    </div>

            <div class="docstring"><p>Collection of the level <code><a href="tanjun/abc.html#Context">tanjun.abc.Context</a></code> checks registered to this client.</p>

<p><em>Note:</em>
These may be taking advantage of the standard dependency injection.</p>
</div>


                            </div>
                            <div id="Client.components" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.components">#&nbsp;&nbsp</a>

        <span class="name">components</span><span class="annotation">: collections.abc.Collection[<a href="tanjun/abc.html#Component">tanjun.abc.Component</a>]</span>
    </div>

            <div class="docstring"><p>Collection of the components this command client is using.</p>
</div>


                            </div>
                            <div id="Client.events" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.events">#&nbsp;&nbsp</a>

        <span class="name">events</span><span class="annotation">: Optional[hikari.api.event_manager.EventManager]</span>
    </div>

            <div class="docstring"><p>Object of the event manager this client was initialised with.</p>

<p>This is used for executing message commands if set.</p>
</div>


                            </div>
                            <div id="Client.listeners" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.listeners">#&nbsp;&nbsp</a>

        <span class="name">listeners</span><span class="annotation">: collections.abc.Mapping[type[hikari.events.base_events.Event], collections.abc.Collection[collections.abc.Callable[..., collections.abc.Coroutine[typing.Any, typing.Any, None]]]]</span>
    </div>

            <div class="docstring"><p>Mapping of event types to the listeners registered in this client.</p>
</div>


                            </div>
                            <div id="Client.hooks" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.hooks">#&nbsp;&nbsp</a>

        <span class="name">hooks</span><span class="annotation">: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#Context">tanjun.abc.Context</a>]]</span>
    </div>

            <div class="docstring"><p>Top level <code><a href="tanjun/abc.html#AnyHooks">tanjun.abc.AnyHooks</a></code> set for this client.</p>

<p>These are called during both message and interaction command execution.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Optional[<a href="tanjun/abc.html#AnyHooks">tanjun.abc.AnyHooks</a>]</strong>: The top level <code><a href="tanjun/abc.html#Context">tanjun.abc.Context</a></code> based hooks set for this
client if applicable, else <code>None</code>.</li>
</ul>
</div>


                            </div>
                            <div id="Client.slash_hooks" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.slash_hooks">#&nbsp;&nbsp</a>

        <span class="name">slash_hooks</span><span class="annotation">: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#SlashContext">tanjun.abc.SlashContext</a>]]</span>
    </div>

            <div class="docstring"><p>Top level <code><a href="tanjun/abc.html#SlashHooks">tanjun.abc.SlashHooks</a></code> set for this client.</p>

<p>These are only called during interaction command execution.</p>
</div>


                            </div>
                            <div id="Client.is_alive" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.is_alive">#&nbsp;&nbsp</a>

        <span class="name">is_alive</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether this client is alive.</p>
</div>


                            </div>
                            <div id="Client.message_hooks" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.message_hooks">#&nbsp;&nbsp</a>

        <span class="name">message_hooks</span><span class="annotation">: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a>]]</span>
    </div>

            <div class="docstring"><p>Top level <code><a href="tanjun/abc.html#MessageHooks">tanjun.abc.MessageHooks</a></code> set for this client.</p>

<p>These are only called during both message command execution.</p>
</div>


                            </div>
                            <div id="Client.metadata" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.metadata">#&nbsp;&nbsp</a>

        <span class="name">metadata</span><span class="annotation">: collections.abc.MutableMapping[typing.Any, typing.Any]</span>
    </div>

            <div class="docstring"><p>Mutable mapping of the metadata set for this client.</p>

<p><em>Note:</em>
Any modifications made to this mutable mapping will be preserved by
the client.</p>
</div>


                            </div>
                            <div id="Client.prefix_getter" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.prefix_getter">#&nbsp;&nbsp</a>

        <span class="name">prefix_getter</span><span class="annotation">: Optional[collections.abc.Callable[..., collections.abc.Awaitable[collections.abc.Iterable[str]]]]</span>
    </div>

            <div class="docstring"><p>Prefix getter method set for this client.</p>

<p>For more information on this callback's signature see <code>PrefixGetter</code>.</p>
</div>


                            </div>
                            <div id="Client.prefixes" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.prefixes">#&nbsp;&nbsp</a>

        <span class="name">prefixes</span><span class="annotation">: collections.abc.Collection[str]</span>
    </div>

            <div class="docstring"><p>Collection of the standard prefixes set for this client.</p>
</div>


                            </div>
                            <div id="Client.rest" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.rest">#&nbsp;&nbsp</a>

        <span class="name">rest</span><span class="annotation">: hikari.api.rest.RESTClient</span>
    </div>

            <div class="docstring"><p>Object of the Hikari REST client this client was initialised with.</p>
</div>


                            </div>
                            <div id="Client.server" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.server">#&nbsp;&nbsp</a>

        <span class="name">server</span><span class="annotation">: Optional[hikari.api.interaction_server.InteractionServer]</span>
    </div>

            <div class="docstring"><p>Object of the Hikari interaction server provided for this client.</p>

<p>This is used for executing slash commands if set.</p>
</div>


                            </div>
                            <div id="Client.shards" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.shards">#&nbsp;&nbsp</a>

        <span class="name">shards</span><span class="annotation">: Optional[hikari.traits.ShardAware]</span>
    </div>

            <div class="docstring"><p>Object of the Hikari shard manager this client was initialised with.</p>
</div>


                            </div>
                            <div id="Client.voice" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.voice">#&nbsp;&nbsp</a>

        <span class="name">voice</span><span class="annotation">: Optional[hikari.api.voice.VoiceComponent]</span>
    </div>

            <div class="docstring"><p>Object of the Hikari voice component this client was initialised with.</p>
</div>


                            </div>
                            <div id="Client.clear_slash_commands" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.clear_slash_commands">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">clear_slash_commands</span><span class="signature">(
    self,
    *,
    application: Union[hikari.guilds.PartialApplication, hikari.snowflakes.Snowflake, int, NoneType] = None,
    guild: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, hikari.undefined.UndefinedType] = UNDEFINED
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">clear_slash_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">if</span> <span class="n">application</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">()</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">set_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="p">(),</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Clear the commands declared either globally or for a specific guild.</p>

<p><em>Note:</em>
The endpoint this uses has a strict ratelimit which, as of writing,
only allows for 2 requests per minute (with that ratelimit either
being per-guild if targeting a specific guild otherwise globally).</p>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>application</strong> (typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]):
The application to clear commands for.</p>

<p>If left as <code>None</code> then this will be inferred from the authorization
being used by <code><a href="#Client.rest">Client.rest</a></code>.</p></li>
<li><p><strong>guild</strong> (hikari.UndefinedOr[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]):
Object or ID of the guild to clear commands for.</p>

<p>If left as <code>None</code> global commands will be cleared.</p></li>
</ul>
</div>


                            </div>
                            <div id="Client.set_global_commands" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_global_commands">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">set_global_commands</span><span class="signature">(
    self,
    *,
    application: Union[hikari.guilds.PartialApplication, hikari.snowflakes.Snowflake, int, NoneType] = None,
    guild: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, hikari.undefined.UndefinedType] = UNDEFINED,
    force: bool = False
) -&gt; collections.abc.Sequence[hikari.commands.Command]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">set_global_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Alias of `Client.declare_global_commands`.</span>

<span class="sd">        .. deprecated:: v2.1.1a1</span>
<span class="sd">            Use `Client.declare_global_commands` instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;The `Client.set_global_commands` method has been deprecated since v2.1.1a1. &quot;</span>
            <span class="s2">&quot;Use `Client.declare_global_commands` instead.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">declare_global_commands</span><span class="p">(</span><span class="n">application</span><span class="o">=</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Alias of <code><a href="#Client.declare_global_commands">Client.declare_global_commands</a></code>.</p>

<p><em>Deprecated since version v2.1.1a1:</em>
Use <code><a href="#Client.declare_global_commands">Client.declare_global_commands</a></code> instead.</p>
</div>


                            </div>
                            <div id="Client.declare_global_commands" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.declare_global_commands">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">declare_global_commands</span><span class="signature">(
    self,
    command_ids: Optional[collections.abc.Mapping[str, Union[hikari.commands.Command, hikari.snowflakes.Snowflake, int]]] = None,
    *,
    application: Union[hikari.guilds.PartialApplication, hikari.snowflakes.Snowflake, int, NoneType] = None,
    guild: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, hikari.undefined.UndefinedType] = UNDEFINED,
    force: bool = False
) -&gt; collections.abc.Sequence[hikari.commands.Command]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_global_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">commands</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">command</span>
            <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
                <span class="n">component</span><span class="o">.</span><span class="n">slash_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">is_global</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">declare_slash_commands</span><span class="p">(</span>
            <span class="n">commands</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">application</span><span class="o">=</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span>
        <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the global application commands for a bot based on the loaded components.</p>

<p><em>Warning:</em>
This will overwrite any previously set application commands and
only targets commands marked as global.</p>

<h6 id="notes">Notes</h6>

<ul>
<li>The endpoint this uses has a strict ratelimit which, as of writing,
only allows for 2 requests per minute (with that ratelimit either
being per-guild if targeting a specific guild otherwise globally).</li>
<li>Setting a specific <code>guild</code> can be useful for testing/debug purposes
as slash commands may take up to an hour to propagate globally but
will immediately propagate when set on a specific guild.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>command_ids</strong> (typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]):
If provided, a mapping of top level command names to IDs of the existing commands to update.</li>
<li><p><strong>application</strong> (typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]):
Object or ID of the application to set the global commands for.</p>

<p>If left as <code>None</code> then this will be inferred from the authorization
being used by <code><a href="#Client.rest">Client.rest</a></code>.</p></li>
<li><p><strong>guild</strong> (hikari.UndefinedOr[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]):
Object or ID of the guild to set the global commands to.</p>

<p>If left as <code>None</code> global commands will be set.</p></li>
<li><p><strong>force</strong> (bool):
Force this to declare the commands regardless of whether or not
they match the current state of the declared commands.</p>

<p>Defaults to <code>False</code>. This default behaviour helps avoid issues with the
2 request per minute (per-guild or globally) ratelimit and the other limit
of only 200 application command creates per day (per guild or globally).</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Sequence[hikari..Command]</strong>: API representations of the set commands.</li>
</ul>
</div>


                            </div>
                            <div id="Client.declare_slash_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.declare_slash_command">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">declare_slash_command</span><span class="signature">(
    self,
    command: <a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>,
    /,
    command_id: Union[hikari.snowflakes.Snowflake, int, NoneType] = None,
    *,
    application: Union[hikari.guilds.PartialApplication, hikari.snowflakes.Snowflake, int, NoneType] = None,
    guild: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, hikari.undefined.UndefinedType] = UNDEFINED
) -&gt; hikari.commands.Command</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_slash_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflakeish</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">builder</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">command_id</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">edit_application_command</span><span class="p">(</span>
                <span class="n">application</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">(),</span>
                <span class="n">command_id</span><span class="p">,</span>
                <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">create_application_command</span><span class="p">(</span>
                <span class="n">application</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">(),</span>
                <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">guild</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">set_tracked_command</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>  <span class="c1"># TODO: is this fine?</span>

        <span class="k">return</span> <span class="n">response</span>
</pre></div>

        </details>

            <div class="docstring"><p>Declare a single slash command for a bot.</p>

<p><em>Warning:</em>
Providing <code>command_id</code> when updating a command helps avoid any
permissions set for the command being lose (e.g. when changing the
command's name).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (BaseSlashCommand):
The command to register.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>application</strong> (typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]):
The application to register the command with.</p>

<p>If left as <code>None</code> then this will be inferred from the authorization
being used by <code><a href="#Client.rest">Client.rest</a></code>.</p></li>
<li><strong>command_id</strong> (typing.Optional[hikari.snowflakes.Snowflakeish]):
ID of the command to update.</li>
<li><p><strong>guild</strong> (typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]):
Object or ID of the guild to register the command with.</p>

<p>If left as <code>None</code> then the command will be registered globally.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.Command</strong>: API representation of the command that was registered.</li>
</ul>
</div>


                            </div>
                            <div id="Client.declare_slash_commands" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.declare_slash_commands">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">declare_slash_commands</span><span class="signature">(
    self,
    commands: collections.abc.Iterable[<a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>],
    /,
    command_ids: Optional[collections.abc.Mapping[str, Union[hikari.commands.Command, hikari.snowflakes.Snowflake, int]]] = None,
    *,
    application: Union[hikari.guilds.PartialApplication, hikari.snowflakes.Snowflake, int, NoneType] = None,
    guild: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, hikari.undefined.UndefinedType] = UNDEFINED,
    force: bool = False
) -&gt; collections.abc.Sequence[hikari.commands.Command]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_slash_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">commands</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">],</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">command_ids</span> <span class="o">=</span> <span class="n">command_ids</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">names_to_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">conflicts</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">builders</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">CommandBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">commands</span><span class="p">:</span>
            <span class="n">names_to_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">command</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">builders</span><span class="p">:</span>
                <span class="n">conflicts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

            <span class="n">builder</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">command_id</span> <span class="o">:=</span> <span class="n">command_ids</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                <span class="n">builder</span><span class="o">.</span><span class="n">set_id</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">command_id</span><span class="p">))</span>

            <span class="n">builders</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">builder</span>

        <span class="k">if</span> <span class="n">conflicts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Couldn&#39;t declare commands due to conflicts. The following command names have more than one command &quot;</span>
                <span class="s2">&quot;registered for them &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conflicts</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You can only declare up to 100 top level commands in a guild or globally&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">application</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">()</span>

        <span class="n">target_type</span> <span class="o">=</span> <span class="s2">&quot;global&quot;</span> <span class="k">if</span> <span class="n">guild</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;guild </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">guild</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
            <span class="n">registered_commands</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">registered_commands</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span>
                <span class="n">_cmp_command</span><span class="p">(</span><span class="n">builders</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">command</span><span class="p">)</span> <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">registered_commands</span>
            <span class="p">):</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Skipping bulk declare for </span><span class="si">%s</span><span class="s2"> slash commands due to them already being set&quot;</span><span class="p">,</span> <span class="n">target_type</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">registered_commands</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Bulk declaring </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> slash commands&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">),</span> <span class="n">target_type</span><span class="p">)</span>
        <span class="n">responses</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">set_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">builders</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">responses</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">guild</span><span class="p">:</span>
                <span class="n">names_to_commands</span><span class="p">[</span><span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">set_tracked_command</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>  <span class="c1"># TODO: is this fine?</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">expected_id</span> <span class="o">:=</span> <span class="n">command_ids</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="ow">and</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">expected_id</span><span class="p">)</span> <span class="o">!=</span> <span class="n">response</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;ID mismatch found for </span><span class="si">%s</span><span class="s2"> command </span><span class="si">%r</span><span class="s2">, expected </span><span class="si">%s</span><span class="s2"> but got </span><span class="si">%s</span><span class="s2">. &quot;</span>
                    <span class="s2">&quot;This suggests that any previous permissions set for this command will have been lost.&quot;</span><span class="p">,</span>
                    <span class="n">target_type</span><span class="p">,</span>
                    <span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">expected_id</span><span class="p">,</span>
                    <span class="n">response</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Successfully declared </span><span class="si">%s</span><span class="s2"> (top-level) </span><span class="si">%s</span><span class="s2"> commands&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">responses</span><span class="p">),</span> <span class="n">target_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_LOGGER</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;declared </span><span class="si">%s</span><span class="s2"> command ids: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">target_type</span><span class="p">,</span> <span class="p">{</span><span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">response</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">responses</span><span class="p">}</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">responses</span>
</pre></div>

        </details>

            <div class="docstring"><p>Declare a collection of slash commands for a bot.</p>

<p><em>Note:</em>
The endpoint this uses has a strict ratelimit which, as of writing,
only allows for 2 requests per minute (with that ratelimit either
being per-guild if targeting a specific guild otherwise globally).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>commands</strong> (collections.abc.Iterable[BaseSlashCommand]):
Iterable of the commands to register.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>command_ids</strong> (typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]):
If provided, a mapping of top level command names to IDs of the existing commands to update.</p>

<p>While optional, this can be helpful when updating commands as
providing the current IDs will prevent changes such as renames from
leading to other state set for commands (e.g. permissions) from
being lost.</p></li>
<li><p><strong>application</strong> (typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]):
The application to register the commands with.</p>

<p>If left as <code>None</code> then this will be inferred from the authorization
being used by <code><a href="#Client.rest">Client.rest</a></code>.</p></li>
<li><p><strong>guild</strong> (typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]):
Object or ID of the guild to register the commands with.</p>

<p>If left as <code>None</code> then the commands will be registered globally.</p></li>
<li><p><strong>force</strong> (bool):
Force this to declare the commands regardless of whether or not
they match the current state of the declared commands.</p>

<p>Defaults to <code>False</code>. This default behaviour helps avoid issues with the
2 request per minute (per-guild or globally) ratelimit and the other limit
of only 200 application command creates per day (per guild or globally).</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Sequence[hikari.Command]</strong>: API representations of the commands which were registered.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: Raises a value error for any of the following reasons:
<ul>
<li>If conflicting command names are found (multiple commanbds have the same top-level name).</li>
<li>If more than 100 top-level commands are passed.</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="Client.set_auto_defer_after" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_auto_defer_after">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_auto_defer_after</span><span class="signature">(self: ~_ClientT, time: Optional[float], /) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_auto_defer_after</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set when this client should automatically defer execution of commands.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            If `time` is set to `None` then automatic deferrals will be disabled.</span>
<span class="sd">            This may lead to unexpected behaviour.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        time : typing.Optional[float]</span>
<span class="sd">            The time in seconds to defer interaction command responses after.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="k">if</span> <span class="n">time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set when this client should automatically defer execution of commands.</p>

<p><em>Warning:</em>
If <code>time</code> is set to <code>None</code> then automatic deferrals will be disabled.
This may lead to unexpected behaviour.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>time</strong> (typing.Optional[float]):
The time in seconds to defer interaction command responses after.</li>
</ul>
</div>


                            </div>
                            <div id="Client.set_ephemeral_default" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_ephemeral_default">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_ephemeral_default</span><span class="signature">(self: ~_ClientT, state: bool, /) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_ephemeral_default</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set whether slash contexts spawned by this client should default to ephemeral responses.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether slash command contexts executed in this component should</span>
<span class="sd">            should default to ephemeral.</span>

<span class="sd">            This will be overridden by any response calls which specify flags</span>
<span class="sd">            and defaults to `False`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This component to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set whether slash contexts spawned by this client should default to ephemeral responses.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>bool</strong>: Whether slash command contexts executed in this component should
should default to ephemeral.</li>
</ul>

<p>This will be overridden by any response calls which specify flags
and defaults to <code>False</code>.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>SelfT</strong>: This component to enable method chaining.</li>
</ul>
</div>


                            </div>
                            <div id="Client.set_hikari_trait_injectors" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_hikari_trait_injectors">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_hikari_trait_injectors</span><span class="signature">(self: ~_ClientT, bot: hikari.traits.RESTAware, /) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_hikari_trait_injectors</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">RESTAware</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set type based dependency injection based on the hikari traits found in `bot`.</span>

<span class="sd">        This is a short hand for calling `Client.add_type_dependency` for all</span>
<span class="sd">        the hikari trait types `bot` is valid for with bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari_traits.RESTAware</span>
<span class="sd">            The hikari client to set dependency injectors for.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">hikari_traits</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">member</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bot</span><span class="p">,</span> <span class="n">member</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">bot</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set type based dependency injection based on the hikari traits found in <code>bot</code>.</p>

<p>This is a short hand for calling <code>Client.add_type_dependency</code> for all
the hikari trait types <code>bot</code> is valid for with bot.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>bot</strong> (hikari_traits.RESTAware):
The hikari client to set dependency injectors for.</li>
</ul>
</div>


                            </div>
                            <div id="Client.set_interaction_not_found" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_interaction_not_found">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_interaction_not_found</span><span class="signature">(self: ~_ClientT, message: Optional[str], /) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_interaction_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the response message for when an interaction command is not found.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            Setting this to `None` may lead to unexpected behaviour (especially</span>
<span class="sd">            when the client is still set to auto-defer interactions) and should</span>
<span class="sd">            only be done if you know what you&#39;re doing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : typing.Optional[str]</span>
<span class="sd">            The message to respond with when an interaction command isn&#39;t found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span> <span class="o">=</span> <span class="n">message</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the response message for when an interaction command is not found.</p>

<p><em>Warning:</em>
Setting this to <code>None</code> may lead to unexpected behaviour (especially
when the client is still set to auto-defer interactions) and should
only be done if you know what you're doing.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>message</strong> (typing.Optional[str]):
The message to respond with when an interaction command isn't found.</li>
</ul>
</div>


                            </div>
                            <div id="Client.set_message_accepts" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_message_accepts">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_message_accepts</span><span class="signature">(
    self: ~_ClientT,
    accepts: <a href="tanjun/clients.html#MessageAcceptsEnum">tanjun.clients.MessageAcceptsEnum</a>,
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_message_accepts</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">accepts</span><span class="p">:</span> <span class="n">MessageAcceptsEnum</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the kind of messages commands should be executed based on.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        accepts : MessageAcceptsEnum</span>
<span class="sd">            The type of messages commands should be executed based on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot set accepts level on a client with no event manager&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span> <span class="o">=</span> <span class="n">accepts</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the kind of messages commands should be executed based on.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>accepts</strong> (MessageAcceptsEnum):
The type of messages commands should be executed based on.</li>
</ul>
</div>


                            </div>
                            <div id="Client.set_message_ctx_maker" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_message_ctx_maker">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_message_ctx_maker</span><span class="signature">(
    self: ~_ClientT,
    maker: <a href="tanjun/clients.html#_MessageContextMakerProto">tanjun.clients._MessageContextMakerProto</a> = &lt;class &#39;<a href="tanjun/context.html#MessageContext">tanjun.context.MessageContext</a>&#39;&gt;,
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_message_ctx_maker</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">maker</span><span class="p">:</span> <span class="n">_MessageContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the message context maker to use when creating context for a message.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            The caller must return an instance of `tanjun.context.MessageContext`</span>
<span class="sd">            rather than just any implementation of the MessageContext abc due to</span>
<span class="sd">            this client relying on implementation detail of</span>
<span class="sd">            `tanjun.context.MessageContext`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        maker : _MessageContextMakerProto</span>
<span class="sd">            The message context maker to use.</span>

<span class="sd">            This is a callback which should match the signature of</span>
<span class="sd">            `tanjun.context.MessageContext.__init__` and return an instance</span>
<span class="sd">            of `tanjun.context.MessageContext`.</span>

<span class="sd">            This defaults to `tanjun.context.MessageContext`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span> <span class="o">=</span> <span class="n">maker</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the message context maker to use when creating context for a message.</p>

<p><em>Warning:</em>
The caller must return an instance of <code><a href="tanjun/context.html#MessageContext">tanjun.context.MessageContext</a></code>
rather than just any implementation of the MessageContext abc due to
this client relying on implementation detail of
<code><a href="tanjun/context.html#MessageContext">tanjun.context.MessageContext</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>maker</strong> (_MessageContextMakerProto):
The message context maker to use.</p>

<p>This is a callback which should match the signature of
<code><a href="tanjun/context.html#MessageContext.__init__">tanjun.context.MessageContext.__init__</a></code> and return an instance
of <code><a href="tanjun/context.html#MessageContext">tanjun.context.MessageContext</a></code>.</p>

<p>This defaults to <code><a href="tanjun/context.html#MessageContext">tanjun.context.MessageContext</a></code>.</p></li>
</ul>
</div>


                            </div>
                            <div id="Client.set_slash_ctx_maker" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_slash_ctx_maker">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_slash_ctx_maker</span><span class="signature">(
    self: ~_ClientT,
    maker: <a href="tanjun/clients.html#_SlashContextMakerProto">tanjun.clients._SlashContextMakerProto</a> = &lt;class &#39;<a href="tanjun/context.html#SlashContext">tanjun.context.SlashContext</a>&#39;&gt;,
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_slash_ctx_maker</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">maker</span><span class="p">:</span> <span class="n">_SlashContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the slash context maker to use when creating context for a slash command.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            The caller must return an instance of `tanjun.context.SlashContext`</span>
<span class="sd">            rather than just any implementation of the SlashContext abc due to</span>
<span class="sd">            this client relying on implementation detail of</span>
<span class="sd">            `tanjun.context.SlashContext`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        maker : _SlashContextMakerProto</span>
<span class="sd">            The slash context maker to use.</span>

<span class="sd">            This is a callback which should match the signature of</span>
<span class="sd">            `tanjun.context.SlashContext.__init__` and return an instance</span>
<span class="sd">            of `tanjun.context.SlashContext`.</span>

<span class="sd">            This defaults to `tanjun.context.SlashContext`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span> <span class="o">=</span> <span class="n">maker</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the slash context maker to use when creating context for a slash command.</p>

<p><em>Warning:</em>
The caller must return an instance of <code><a href="tanjun/context.html#SlashContext">tanjun.context.SlashContext</a></code>
rather than just any implementation of the SlashContext abc due to
this client relying on implementation detail of
<code><a href="tanjun/context.html#SlashContext">tanjun.context.SlashContext</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>maker</strong> (_SlashContextMakerProto):
The slash context maker to use.</p>

<p>This is a callback which should match the signature of
<code><a href="tanjun/context.html#SlashContext.__init__">tanjun.context.SlashContext.__init__</a></code> and return an instance
of <code><a href="tanjun/context.html#SlashContext">tanjun.context.SlashContext</a></code>.</p>

<p>This defaults to <code><a href="tanjun/context.html#SlashContext">tanjun.context.SlashContext</a></code>.</p></li>
</ul>
</div>


                            </div>
                            <div id="Client.set_human_only" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_human_only">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_human_only</span><span class="signature">(self: ~_ClientT, value: bool = True) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_human_only</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set whether or not message commands execution should be limited to &quot;human&quot; users.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This doesn&#39;t apply to interaction commands as these can only be</span>
<span class="sd">            triggered by a &quot;human&quot; (normal user account).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether or not message commands execution should be limited to &quot;human&quot; users.</span>

<span class="sd">            Passing `True` here will prevent message commands from being executed</span>
<span class="sd">            based on webhook and bot messages.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">_check_human</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_check</span><span class="p">(</span><span class="n">_check_human</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set whether or not message commands execution should be limited to "human" users.</p>

<p><em>Note:</em>
This doesn't apply to interaction commands as these can only be
triggered by a "human" (normal user account).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>value</strong> (bool):
Whether or not message commands execution should be limited to "human" users.</p>

<p>Passing <code>True</code> here will prevent message commands from being executed
based on webhook and bot messages.</p></li>
</ul>
</div>


                            </div>
                            <div id="Client.add_check" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.add_check">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_check</span><span class="signature">(
    self: ~_ClientT,
    check: collections.abc.Callable[..., typing.Union[bool, collections.abc.Awaitable[bool]]],
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a generic check to this client.</span>

<span class="sd">        This will be applied to both message and slash command execution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to add. This may be either synchronous or asynchronous</span>
<span class="sd">            and must take one positional argument of type `tanjun.abc.Context`</span>
<span class="sd">            with dependency injection being supported for its keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">check</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checks</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">(</span><span class="n">check</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a generic check to this client.</p>

<p>This will be applied to both message and slash command execution.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>check</strong> (tanjun_abc.CheckSig):
The check to add. This may be either synchronous or asynchronous
and must take one positional argument of type <code><a href="tanjun/abc.html#Context">tanjun.abc.Context</a></code>
with dependency injection being supported for its keyword arguments.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.remove_check" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.remove_check">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_check</span><span class="signature">(
    self: ~_ClientT,
    check: collections.abc.Callable[..., typing.Union[bool, collections.abc.Awaitable[bool]]],
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a check from the client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the check was not previously added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;checks.InjectableCheck&quot;</span><span class="p">,</span> <span class="n">check</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a check from the client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>check</strong> (tanjun_abc.CheckSig):
The check to remove.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the check was not previously added.</li>
</ul>
</div>


                            </div>
                            <div id="Client.with_check" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.with_check">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_check</span><span class="signature">(self, check: ~CheckSigT, /) -&gt; ~CheckSigT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a check to this client through a decorator call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to add. This may be either synchronous or asynchronous</span>
<span class="sd">            and must take one positional argument of type `tanjun.abc.Context`</span>
<span class="sd">            with dependency injection being supported for its keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun_abc.CheckSig</span>
<span class="sd">            The added check.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">check</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a check to this client through a decorator call.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>check</strong> (tanjun_abc.CheckSig):
The check to add. This may be either synchronous or asynchronous
and must take one positional argument of type <code><a href="tanjun/abc.html#Context">tanjun.abc.Context</a></code>
with dependency injection being supported for its keyword arguments.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>tanjun_abc.CheckSig</strong>: The added check.</li>
</ul>
</div>


                            </div>
                            <div id="Client.check" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.check">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">check</span><span class="signature">(self, ctx: <a href="tanjun/abc.html#Context">tanjun.abc.Context</a>, /) -&gt; bool</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">gather_checks</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Client.add_component" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.add_component">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_component</span><span class="signature">(
    self: ~_ClientT,
    component: <a href="tanjun/abc.html#Component">tanjun.abc.Component</a>,
    /,
    *,
    add_injector: bool = False
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">add_injector</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a component to this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        component: Component</span>
<span class="sd">            The component to move to this client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to allow chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the component&#39;s name is already registered.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">component</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A component named </span><span class="si">{</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="si">!r}</span><span class="s2"> is already registered.&quot;</span><span class="p">)</span>

        <span class="n">component</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">component</span>

        <span class="k">if</span> <span class="n">add_injector</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">component</span><span class="p">),</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">component</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">COMPONENT_ADDED</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a component to this client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>component</strong> (Component):
The component to move to this client.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to allow chained calls.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the component's name is already registered.</li>
</ul>
</div>


                            </div>
                            <div id="Client.get_component_by_name" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.get_component_by_name">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_component_by_name</span><span class="signature">(self, name: str, /) -&gt; Optional[<a href="tanjun/abc.html#Component">tanjun.abc.Component</a>]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">get_component_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Get a component from this client by name.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
Name to get a component by.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Optional[Component]</strong>: The component instance if found, else <code>None</code>.</li>
</ul>
</div>


                            </div>
                            <div id="Client.remove_component" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.remove_component">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_component</span><span class="signature">(self: ~_ClientT, component: <a href="tanjun/abc.html#Component">tanjun.abc.Component</a>, /) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">stored_component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">stored_component</span> <span class="ow">or</span> <span class="n">stored_component</span> <span class="o">!=</span> <span class="n">component</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The component </span><span class="si">{</span><span class="n">component</span><span class="si">!r}</span><span class="s2"> is not registered.&quot;</span><span class="p">)</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="n">stored_component</span><span class="o">.</span><span class="n">unbind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">COMPONENT_REMOVED</span><span class="p">,</span> <span class="n">stored_component</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a component from this client.</p>

<p>This will unsubscribe any client callbacks, commands and listeners
registered in the provided component.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>component</strong> (Component):
The component to remove from this client.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the provided component isn't found.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to allow chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.remove_component_by_name" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.remove_component_by_name">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_component_by_name</span><span class="signature">(self: ~_ClientT, name: str, /) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_component_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a component from this client by name.</p>

<p>This will unsubscribe any client callbacks, commands and listeners
registered in the provided component.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
Name of the component to remove from this client.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>KeyError</strong>: If the provided component name isn't found.</li>
</ul>
</div>


                            </div>
                            <div id="Client.add_client_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.add_client_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_client_callback</span><span class="signature">(
    self: ~_ClientT,
    name: str,
    callback: collections.abc.Callable[..., typing.Optional[collections.abc.Awaitable[NoneType]]],
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">descriptor</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">descriptor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">descriptor</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">descriptor</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a client callback.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>_name</strong> (str):
The name this callback is being registered to.</p>

<p>This is case-insensitive.</p></li>
<li><p><strong>callback</strong> (MetaEventSigT):
The callback to register.</p>

<p>This may be sync or async and must return None. The positional and
keyword arguments a callback should expect depend on implementation
detail around the <code>name</code> being subscribed to.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.dispatch_client_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.dispatch_client_callback">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">dispatch_client_callback</span><span class="signature">(self, name: str, /, *args: Any, **kwargs: Any) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">dispatch_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Dispatch a client callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The name of the callback to dispatch.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        *args : typing.Any</span>
<span class="sd">            Positional arguments to pass to the callback(s).</span>
<span class="sd">        **kwargs : typing.Any</span>
<span class="sd">            Keyword arguments to pass to the callback(s).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        KeyError</span>
<span class="sd">            If no callbacks are registered for the given name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">callbacks</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="n">calls</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">_wrap_client_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">injecting</span><span class="o">.</span><span class="n">BasicInjectionContext</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">calls</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Dispatch a client callback.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the callback to dispatch.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>*args</strong> (typing.Any):
Positional arguments to pass to the callback(s).</li>
<li><strong>**kwargs</strong> (typing.Any):
Keyword arguments to pass to the callback(s).</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>KeyError</strong>: If no callbacks are registered for the given name.</li>
</ul>
</div>


                            </div>
                            <div id="Client.get_client_callbacks" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.get_client_callbacks">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_client_callbacks</span><span class="signature">(
    self,
    name: str,
    /
) -&gt; collections.abc.Collection[collections.abc.Callable[..., typing.Optional[collections.abc.Awaitable[NoneType]]]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">get_client_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">callback</span><span class="o">.</span><span class="n">callback</span> <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Get a collection of the callbacks registered for a specific name.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>name</strong> (str):
The name to get the callbacks registered for.</p>

<p>This is case-insensitive.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Collection[MetaEventSig]</strong>: Collection of the callbacks for the provided name.</li>
</ul>
</div>


                            </div>
                            <div id="Client.remove_client_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.remove_client_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_client_callback</span><span class="signature">(
    self: ~_ClientT,
    name: str,
    callback: collections.abc.Callable[..., typing.Optional[collections.abc.Awaitable[NoneType]]],
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;injecting.CallbackDescriptor[None]&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a client callback.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>name</strong> (str):
The name this callback is being registered to.</p>

<p>This is case-insensitive.</p></li>
<li><strong>callback</strong> (MetaEventSigT):
The callback to remove from the client's callbacks.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>KeyError</strong>: If the provided name isn't found.</li>
<li><strong>ValueError</strong>: If the provided callback isn't found.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.with_client_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.with_client_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_client_callback</span><span class="signature">(
    self,
    name: str,
    /
) -&gt; collections.abc.Callable[[~MetaEventSigT], ~MetaEventSigT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_client_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">],</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a client callback through a decorator call.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="n">client</span> <span class="o">=</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">from_rest_bot</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>

<span class="nd">@client</span><span class="o">.</span><span class="n">with_client_callback</span><span class="p">(</span><span class="s2">&quot;closed&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">on_close</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>name</strong> (str):
The name this callback is being registered to.</p>

<p>This is case-insensitive.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[MetaEventSigT], MetaEventSigT]</strong>: Decorator callback used to register the client callback.</li>
</ul>

<p>This may be sync or async and must return None. The positional and
keyword arguments a callback should expect depend on implementation
detail around the <code>name</code> being subscribed to.</p>
</div>


                            </div>
                            <div id="Client.add_listener" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.add_listener">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_listener</span><span class="signature">(
    self: ~_ClientT,
    event_type: type[hikari.events.base_events.Event],
    callback: collections.abc.Callable[..., collections.abc.Coroutine[typing.Any, typing.Any, None]],
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">injected</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">SelfInjectingCallback</span><span class="p">[</span><span class="kc">None</span><span class="p">](</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injected</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">injected</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">injected</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a listener to the client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>event_type</strong> (type[hikari.Event]):
The event type to add a listener for.</li>
<li><p><strong>callback</strong> (ListenerCallbackSig):
The callback to register as a listener.</p>

<p>This callback must be a coroutine function which returns <code>None</code> and
always takes at least one positional arg of type <code>hikari.Event</code>
regardless of client implementation detail.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.remove_listener" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.remove_listener">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_listener</span><span class="signature">(
    self: ~_ClientT,
    event_type: type[hikari.events.base_events.Event],
    callback: collections.abc.Callable[..., collections.abc.Coroutine[typing.Any, typing.Any, None]],
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;injecting.SelfInjectingCallback[None]&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="p">))</span>
        <span class="n">registered_callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">registered_callback</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a listener from the client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>event_type</strong> (type[hikari.Event]):
The event type to remove a listener for.</li>
<li><strong>callback</strong> (ListenerCallbackSig):
The callback to remove.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>KeyError</strong>: If the provided event type isn't found.</li>
<li><strong>ValueError</strong>: If the provided callback isn't found.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.with_listener" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.with_listener">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_listener</span><span class="signature">(
    self,
    event_type: type[hikari.events.base_events.Event],
    /
) -&gt; collections.abc.Callable[[~ListenerCallbackSigT], ~ListenerCallbackSigT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">],</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_listener</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add an event listener to this client through a decorator call.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="n">client</span> <span class="o">=</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">from_gateway_bot</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>

<span class="nd">@client</span><span class="o">.</span><span class="n">with_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">on_message_create</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>event_type</strong> (type[hikari.Event]):
The event type to listener for.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[ListenerCallbackSigT], ListenerCallbackSigT]</strong>: Decorator callback used to register the event callback.</li>
</ul>

<p>The callback must be a coroutine function which returns <code>None</code> and
always takes at least one positional arg of type <code>hikari.Event</code>
regardless of client implementation detail.</p>
</div>


                            </div>
                            <div id="Client.add_prefix" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.add_prefix">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_prefix</span><span class="signature">(
    self: ~_ClientT,
    prefixes: Union[collections.abc.Iterable[str], str],
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">prefixes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a prefix used to filter message command calls.</span>

<span class="sd">        This will be matched against the first character(s) in a message&#39;s</span>
<span class="sd">        content to determine whether the message command search stage of</span>
<span class="sd">        execution should be initiated.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        prefixes : typing.Union[collections.abc.Iterable[str], str]</span>
<span class="sd">            Either a single string or an iterable of strings to be used as</span>
<span class="sd">            prefixes.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prefixes</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">prefixes</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefixes</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">prefix</span> <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">prefixes</span> <span class="k">if</span> <span class="n">prefix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a prefix used to filter message command calls.</p>

<p>This will be matched against the first character(s) in a message's
content to determine whether the message command search stage of
execution should be initiated.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>prefixes</strong> (typing.Union[collections.abc.Iterable[str], str]):
Either a single string or an iterable of strings to be used as
prefixes.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.remove_prefix" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.remove_prefix">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_prefix</span><span class="signature">(self: ~_ClientT, prefix: str, /) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a message content prefix from the client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        prefix : str</span>
<span class="sd">            The prefix to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the prefix is not registered with the client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a message content prefix from the client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>prefix</strong> (str):
The prefix to remove.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the prefix is not registered with the client.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.set_prefix_getter" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_prefix_getter">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_prefix_getter</span><span class="signature">(
    self: ~_ClientT,
    getter: Optional[collections.abc.Callable[..., collections.abc.Awaitable[collections.abc.Iterable[str]]]],
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_prefix_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">getter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">PrefixGetterSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the callback used to retrieve message prefixes set for the relevant guild.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        getter : typing.Optional[PrefixGetterSig]</span>
<span class="sd">            The callback which&#39;ll be used to retrieve prefixes for the guild a</span>
<span class="sd">            message context is from. If `None` is passed here then the callback</span>
<span class="sd">            will be unset.</span>

<span class="sd">            This should be an async callback which one argument of type</span>
<span class="sd">            `tanjun.abc.MessageContext` and returns an iterable of string prefixes.</span>
<span class="sd">            Dependency injection is supported for this callback&#39;s keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">getter</span><span class="p">)</span> <span class="k">if</span> <span class="n">getter</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the callback used to retrieve message prefixes set for the relevant guild.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>getter</strong> (typing.Optional[PrefixGetterSig]):
The callback which'll be used to retrieve prefixes for the guild a
message context is from. If <code>None</code> is passed here then the callback
will be unset.</p>

<p>This should be an async callback which one argument of type
<code><a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a></code> and returns an iterable of string prefixes.
Dependency injection is supported for this callback's keyword arguments.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.with_prefix_getter" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.with_prefix_getter">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_prefix_getter</span><span class="signature">(self, getter: ~PrefixGetterSigT, /) -&gt; ~PrefixGetterSigT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_prefix_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">getter</span><span class="p">:</span> <span class="n">PrefixGetterSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PrefixGetterSigT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the prefix getter callback for this client through decorator call.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ```py</span>
<span class="sd">        client = tanjun.Client.from_rest_bot(bot)</span>

<span class="sd">        @client.with_prefix_getter</span>
<span class="sd">        async def prefix_getter(ctx: tanjun.abc.MessageContext) -&gt; collections.abc.Iterable[str]:</span>
<span class="sd">            raise NotImplementedError</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        getter : PrefixGetterSig</span>
<span class="sd">            The callback which&#39;ll be  to retrieve prefixes for the guild a</span>
<span class="sd">            message event is from.</span>

<span class="sd">            This should be an async callback which one argument of type</span>
<span class="sd">            `tanjun.abc.MessageContext` and returns an iterable of string prefixes.</span>
<span class="sd">            Dependency injection is supported for this callback&#39;s keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PrefixGetterSigT</span>
<span class="sd">            The registered callback.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_prefix_getter</span><span class="p">(</span><span class="n">getter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">getter</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the prefix getter callback for this client through decorator call.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="n">client</span> <span class="o">=</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">from_rest_bot</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>

<span class="nd">@client</span><span class="o">.</span><span class="n">with_prefix_getter</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">prefix_getter</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>getter</strong> (PrefixGetterSig):
The callback which'll be  to retrieve prefixes for the guild a
message event is from.</p>

<p>This should be an async callback which one argument of type
<code><a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a></code> and returns an iterable of string prefixes.
Dependency injection is supported for this callback's keyword arguments.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>PrefixGetterSigT</strong>: The registered callback.</li>
</ul>
</div>


                            </div>
                            <div id="Client.iter_commands" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.iter_commands">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">iter_commands</span><span class="signature">(
    self
) -&gt; collections.abc.Iterator[<a href="tanjun/abc.html#ExecutableCommand">tanjun.abc.ExecutableCommand</a>[<a href="tanjun/abc.html#Context">tanjun.abc.Context</a>]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">iter_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">]]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">slash_commands</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_slash_commands</span><span class="p">(</span><span class="n">global_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_message_commands</span><span class="p">()</span>
        <span class="k">yield from</span> <span class="n">slash_commands</span>
</pre></div>

        </details>

            <div class="docstring"><p>Iterate over all the commands (both message and slash) registered to this client.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Iterator[ExecutableCommand[Context]]</strong>: Iterator of all the commands registered to this client.</li>
</ul>
</div>


                            </div>
                            <div id="Client.iter_message_commands" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.iter_message_commands">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">iter_message_commands</span><span class="signature">(self) -&gt; collections.abc.Iterator[<a href="tanjun/abc.html#MessageCommand">tanjun.abc.MessageCommand</a>]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">iter_message_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">message_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Iterate over all the message commands registered to this client.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Iterator[MessageCommand]</strong>: Iterator of all the message commands registered to this client.</li>
</ul>
</div>


                            </div>
                            <div id="Client.iter_slash_commands" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.iter_slash_commands">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">iter_slash_commands</span><span class="signature">(
    self,
    *,
    global_only: bool = False
) -&gt; collections.abc.Iterator[<a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">iter_slash_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">global_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">if</span> <span class="n">global_only</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">is_global</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_slash_commands</span><span class="p">(</span><span class="n">global_only</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">slash_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Iterate over all the slash commands registered to this client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>global_only</strong> (bool):
Whether to only iterate over global slash commands.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Iterator[BaseSlashCommand]</strong>: Iterator of all the slash commands registered to this client.</li>
</ul>
</div>


                            </div>
                            <div id="Client.check_message_name" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.check_message_name">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">check_message_name</span><span class="signature">(
    self,
    name: str,
    /
) -&gt; collections.abc.Iterator[tuple[str, <a href="tanjun/abc.html#MessageCommand">tanjun.abc.MessageCommand</a>]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">check_message_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="n">component</span><span class="o">.</span><span class="n">check_message_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Check whether a message command name is present in the current client.</p>

<p><em>Note:</em>
Dependent on implementation this may partial check name against the
message command's name based on command_name.startswith(name).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name to match commands against.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Iterator[tuple[str, MessageCommand]]</strong>: Iterator of the matched command names to the matched message command objects.</li>
</ul>
</div>


                            </div>
                            <div id="Client.check_slash_name" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.check_slash_name">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">check_slash_name</span><span class="signature">(
    self,
    name: str,
    /
) -&gt; collections.abc.Iterator[<a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">check_slash_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="n">component</span><span class="o">.</span><span class="n">check_slash_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Check whether a slash command name is present in the current client.</p>

<p><em>Note:</em>
This won't check the commands within command groups.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
Name to check against.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Iterator[BaseSlashCommand]</strong>: Iterator of the matched slash command objects.</li>
</ul>
</div>


                            </div>
                            <div id="Client.close" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.close">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">close</span><span class="signature">(self, *, deregister_listeners: bool = True) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">deregister_listeners</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close the client.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the client isn&#39;t running.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Client isn&#39;t active&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span><span class="p">:</span>
            <span class="n">event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSING</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deregister_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event_type</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">event_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_message_create_event</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_event</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listener</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">deregister_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

        </details>

            <div class="docstring"><p>Close the client.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>RuntimeError</strong>: If the client isn't running.</li>
</ul>
</div>


                            </div>
                            <div id="Client.open" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.open">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">open</span><span class="signature">(self, *, register_listeners: bool = True) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">register_listeners</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Start the client.</span>

<span class="sd">        If `mention_prefix` was passed to `Client.__init__` or</span>
<span class="sd">        `Client.from_gateway_bot` then this function may make a fetch request</span>
<span class="sd">        to Discord if it cannot get the current user from the cache.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the client is already active.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Client is already alive&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">:</span>
                <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">get_me</span><span class="p">()</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_my_user</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_my_user</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="sa">f</span><span class="s2">&quot;&lt;@</span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&gt;&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;&lt;@!</span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&gt;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">prefix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">register_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event_type</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_message_create_event</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_event</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">listener</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">register_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_request</span><span class="p">)</span>

        <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTED</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Start the client.</p>

<p>If <code>mention_prefix</code> was passed to <code><a href="#Client.__init__">Client.__init__</a></code> or
<code><a href="#Client.from_gateway_bot">Client.from_gateway_bot</a></code> then this function may make a fetch request
to Discord if it cannot get the current user from the cache.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>RuntimeError</strong>: If the client is already active.</li>
</ul>
</div>


                            </div>
                            <div id="Client.fetch_rest_application_id" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.fetch_rest_application_id">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">fetch_rest_application_id</span><span class="signature">(self) -&gt; hikari.snowflakes.Snowflake</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_rest_application_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Fetch the application ID of the application this client is linked to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.Snowflake</span>
<span class="sd">            The application ID of the application this client is linked to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">token_type</span> <span class="o">==</span> <span class="n">hikari</span><span class="o">.</span><span class="n">TokenType</span><span class="o">.</span><span class="n">BOT</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_application</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_authorization</span><span class="p">())</span><span class="o">.</span><span class="n">application</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">application</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span>
</pre></div>

        </details>

            <div class="docstring"><p>Fetch the application ID of the application this client is linked to.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.Snowflake</strong>: The application ID of the application this client is linked to.</li>
</ul>
</div>


                            </div>
                            <div id="Client.set_hooks" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_hooks">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_hooks</span><span class="signature">(
    self: ~_ClientT,
    hooks: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#Context">tanjun.abc.Context</a>]],
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the general command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every slash and message</span>
<span class="sd">        command execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.AnyHooks]</span>
<span class="sd">            The general command execution hooks to set for this client.</span>

<span class="sd">            Passing `None` will remove all hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the general command execution hooks for this client.</p>

<p>The callbacks within this hook will be added to every slash and message
command execution started by this client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>hooks</strong> (typing.Optional[tanjun_abc.AnyHooks]):
The general command execution hooks to set for this client.</p>

<p>Passing <code>None</code> will remove all hooks.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.set_slash_hooks" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_slash_hooks">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_slash_hooks</span><span class="signature">(
    self: ~_ClientT,
    hooks: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#SlashContext">tanjun.abc.SlashContext</a>]],
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the slash command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every slash command</span>
<span class="sd">        execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.SlashHooks]</span>
<span class="sd">            The slash context specific command execution hooks to set for this</span>
<span class="sd">            client.</span>

<span class="sd">            Passing `None` will remove the hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the slash command execution hooks for this client.</p>

<p>The callbacks within this hook will be added to every slash command
execution started by this client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>hooks</strong> (typing.Optional[tanjun_abc.SlashHooks]):
The slash context specific command execution hooks to set for this
client.</p>

<p>Passing <code>None</code> will remove the hooks.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.set_message_hooks" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_message_hooks">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_message_hooks</span><span class="signature">(
    self: ~_ClientT,
    hooks: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a>]],
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_message_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the message command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every message command</span>
<span class="sd">        execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.MessageHooks]</span>
<span class="sd">            The message context specific command execution hooks to set for this</span>
<span class="sd">            client.</span>

<span class="sd">            Passing `None` will remove all hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the message command execution hooks for this client.</p>

<p>The callbacks within this hook will be added to every message command
execution started by this client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>hooks</strong> (typing.Optional[tanjun_abc.MessageHooks]):
The message context specific command execution hooks to set for this
client.</p>

<p>Passing <code>None</code> will remove all hooks.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.load_modules" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.load_modules">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">load_modules</span><span class="signature">(
    self: ~_ClientT,
    *modules: Union[str, pathlib.Path],
    _log: bool = True
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">load_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">_log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load entities into this client from modules based on loader descriptors.</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find loaders.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_loader`</span>
<span class="sd">        decorated top level function which takes one positional argument</span>
<span class="sd">        of type `Client`.</span>

<span class="sd">        ```py</span>
<span class="sd">        @tanjun.as_loader</span>
<span class="sd">        def load_module(client: tanjun.Client) -&gt; None:</span>
<span class="sd">            client.add_component(component.copy())</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules : typing.Union[str, pathlib.Path]</span>
<span class="sd">            Path(s) of the modules to load from.</span>

<span class="sd">            When `str` this will be treated as a normal import path which is</span>
<span class="sd">            absolute (`&quot;foo.bar.baz&quot;`). It&#39;s worth noting that absolute module</span>
<span class="sd">            paths may be imported from the current location if the top level</span>
<span class="sd">            module is a valid module file or module directory in the current</span>
<span class="sd">            working directory.</span>

<span class="sd">            When `pathlib.Path` the module will be imported directly from</span>
<span class="sd">            the given path. In this mode any relative imports in the target</span>
<span class="sd">            module will fail to resolve.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module is already loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no loader descriptors are found in the module.</span>
<span class="sd">        ModuleNotFoundError</span>
<span class="sd">            If the module is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> already loaded&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                    <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">[</span><span class="n">module_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">module_path_abs</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">module_path_abs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module at </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> already loaded&quot;</span><span class="p">)</span>

                <span class="n">module_name</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="n">importlib_util</span><span class="o">.</span><span class="n">spec_from_file_location</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">module_path_abs</span><span class="p">)</span>

                <span class="c1"># https://github.com/python/typeshed/issues/2793</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">spec</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="p">,</span> <span class="n">importlib_abc</span><span class="o">.</span><span class="n">Loader</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ModuleNotFoundError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Module not found at </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">module_name</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                    <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib_util</span><span class="o">.</span><span class="n">module_from_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
                <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">exec_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">[</span><span class="n">module_path_abs</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Load entities into this client from modules based on loader descriptors.</p>

<p><em>Note:</em>
If an <code>__all__</code> is present in the target module then it will be
used to find loaders.</p>

<h6 id="examples">Examples</h6>

<p>For this to work the module has to have at least one <code><a href="#as_loader">as_loader</a></code>
decorated top level function which takes one positional argument
of type <code><a href="#Client">Client</a></code>.</p>

<div class="codehilite"><pre><span></span><code><span class="nd">@tanjun</span><span class="o">.</span><span class="n">as_loader</span>
<span class="k">def</span> <span class="nf">load_module</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">Client</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">client</span><span class="o">.</span><span class="n">add_component</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>*modules</strong> (typing.Union[str, pathlib.Path]):
Path(s) of the modules to load from.</p>

<p>When <code>str</code> this will be treated as a normal import path which is
absolute (<code>"foo.bar.baz"</code>). It's worth noting that absolute module
paths may be imported from the current location if the top level
module is a valid module file or module directory in the current
working directory.</p>

<p>When <code>pathlib.Path</code> the module will be imported directly from
the given path. In this mode any relative imports in the target
module will fail to resolve.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: This client instance to enable chained calls.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the module is already loaded.</li>
<li><strong>RuntimeError</strong>: If no loader descriptors are found in the module.</li>
<li><strong>ModuleNotFoundError</strong>: If the module is not found.</li>
</ul>
</div>


                            </div>
                            <div id="Client.unload_modules" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.unload_modules">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">unload_modules</span><span class="signature">(
    self: ~_ClientT,
    *modules: Union[str, pathlib.Path],
    _log: bool = True
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">unload_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">_log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Unload entities from this client based on unloader descriptors in one or more modules.</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find unloaders.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_unloader`</span>
<span class="sd">        decorated top level function which takes one positional argument</span>
<span class="sd">        of type `Client`.</span>

<span class="sd">        ```py</span>
<span class="sd">        @tanjun.as_unloader</span>
<span class="sd">        def unload_component(client: tanjun.Client) -&gt; None:</span>
<span class="sd">            client.remove_component_by_name(component.name)</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules: typing.Union[str, pathlib.Path]</span>
<span class="sd">            Path of one or more modules to unload.</span>

<span class="sd">            These should be the same path(s) which were passed to `load_module`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module hasn&#39;t been loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no unloader descriptors are found in the module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">module_path</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module </span><span class="si">{</span><span class="n">module_path</span><span class="si">!s}</span><span class="s2"> not loaded&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Unloading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_unload_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Unload entities from this client based on unloader descriptors in one or more modules.</p>

<p><em>Note:</em>
If an <code>__all__</code> is present in the target module then it will be
used to find unloaders.</p>

<h6 id="examples">Examples</h6>

<p>For this to work the module has to have at least one <code><a href="#as_unloader">as_unloader</a></code>
decorated top level function which takes one positional argument
of type <code><a href="#Client">Client</a></code>.</p>

<div class="codehilite"><pre><span></span><code><span class="nd">@tanjun</span><span class="o">.</span><span class="n">as_unloader</span>
<span class="k">def</span> <span class="nf">unload_component</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">Client</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">client</span><span class="o">.</span><span class="n">remove_component_by_name</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>*modules</strong> (typing.Union[str, pathlib.Path]):
Path of one or more modules to unload.</p>

<p>These should be the same path(s) which were passed to <code>load_module</code>.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: This client instance to enable chained calls.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the module hasn't been loaded.</li>
<li><strong>RuntimeError</strong>: If no unloader descriptors are found in the module.</li>
</ul>
</div>


                            </div>
                            <div id="Client.reload_modules" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.reload_modules">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">reload_modules</span><span class="signature">(self: ~_ClientT, *modules: Union[str, pathlib.Path]) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">reload_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Reload entities in this client based on the descriptors in loaded module(s).</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find descriptors.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_loader` and</span>
<span class="sd">        one `as_unloader` decorated top level function which each take one</span>
<span class="sd">        positional argument of type `Client`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules: typing.Union[str, pathlib.Path]</span>
<span class="sd">            Paths of one or more module to unload.</span>

<span class="sd">            These should be the same paths which were passed to `load_module`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module hasn&#39;t been loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no unloader descriptors are found in the current state of the module.</span>
<span class="sd">            If no loader descriptors are found in the new state of the module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> not loaded&quot;</span><span class="p">)</span>

                <span class="n">module_repr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Reloading </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unload_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">[</span><span class="n">module_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Reloading </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unload_modules</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="n">_log</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">load_modules</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="n">_log</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Reload entities in this client based on the descriptors in loaded module(s).</p>

<p><em>Note:</em>
If an <code>__all__</code> is present in the target module then it will be
used to find descriptors.</p>

<h6 id="examples">Examples</h6>

<p>For this to work the module has to have at least one <code><a href="#as_loader">as_loader</a></code> and
one <code><a href="#as_unloader">as_unloader</a></code> decorated top level function which each take one
positional argument of type <code><a href="#Client">Client</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>*modules</strong> (typing.Union[str, pathlib.Path]):
Paths of one or more module to unload.</p>

<p>These should be the same paths which were passed to <code>load_module</code>.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: This client instance to enable chained calls.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the module hasn't been loaded.</li>
<li><strong>RuntimeError</strong>: If no unloader descriptors are found in the current state of the module.
If no loader descriptors are found in the new state of the module.</li>
</ul>
</div>


                            </div>
                            <div id="Client.on_message_create_event" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.on_message_create_event">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">on_message_create_event</span><span class="signature">(
    self,
    event: hikari.events.message_events.MessageCreateEvent,
    /
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_message_create_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a message command based on a gateway event.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hikari.events.message_events.MessageCreateEvent</span>
<span class="sd">            The event to handle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">message</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">prefix</span> <span class="o">:=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_prefix</span><span class="p">(</span><span class="n">ctx</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">ctx</span><span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="p">:]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span><span class="o">.</span><span class="n">set_triggering_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_message</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">return</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">MESSAGE_COMMAND_NOT_FOUND</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Execute a message command based on a gateway event.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>hikari.events.message_events.MessageCreateEvent</strong>: The event to handle.</li>
</ul>
</div>


                            </div>
                            <div id="Client.on_interaction_create_event" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.on_interaction_create_event">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">on_interaction_create_event</span><span class="signature">(
    self,
    event: hikari.events.interaction_events.InteractionCreateEvent,
    /
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_interaction_create_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a slash command based on Gateway events.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Any event where `event.interaction` is not</span>
<span class="sd">            `hikari.CommandInteraction` will be ignored.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : hikari.events.interaction_events.InteractionCreateEvent</span>
<span class="sd">            The event to execute commands based on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">interaction</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">,</span>
            <span class="n">on_not_found</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_slash_not_found</span><span class="p">,</span>
            <span class="n">default_to_ephemeral</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slash_hooks</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">start_defer_timer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="c1"># This is set on each iteration to ensure that any component</span>
                    <span class="c1"># state which was set to this isn&#39;t propagated to other components.</span>
                    <span class="n">ctx</span><span class="o">.</span><span class="n">set_ephemeral_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">future</span> <span class="o">:=</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_interaction</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">await</span> <span class="n">future</span>
                        <span class="k">return</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Execute a slash command based on Gateway events.</p>

<p><em>Note:</em>
Any event where <code>event.interaction</code> is not
<code>hikari.CommandInteraction</code> will be ignored.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>event</strong> (hikari.events.interaction_events.InteractionCreateEvent):
The event to execute commands based on.</li>
</ul>
</div>


                            </div>
                            <div id="Client.on_interaction_create_request" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.on_interaction_create_request">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">on_interaction_create_request</span><span class="signature">(
    self,
    interaction: hikari.interactions.command_interactions.CommandInteraction,
    /
) -&gt; Union[hikari.api.special_endpoints.InteractionMessageBuilder, hikari.api.special_endpoints.InteractionDeferredBuilder]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_interaction_create_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">ResponseTypeT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a slash command based on received REST requests.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        interaction : hikari.CommandInteraction</span>
<span class="sd">            The interaction to execute a command based on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun.context.ResponseType</span>
<span class="sd">            The initial response to send back to Discord.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">interaction</span><span class="o">=</span><span class="n">interaction</span><span class="p">,</span>
            <span class="n">on_not_found</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_slash_not_found</span><span class="p">,</span>
            <span class="n">default_to_ephemeral</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">start_defer_timer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">)</span>

        <span class="n">hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slash_hooks</span><span class="p">()</span>
        <span class="n">future</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_response_future</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_interaction</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="c1"># Under very specific timing there may be another future which could set a result while we await</span>
            <span class="c1"># ctx.respond therefore we create a task to avoid any erroneous behaviour from this trying to create</span>
            <span class="c1"># another response before it&#39;s returned the initial response.</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interaction</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> command error responder&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>

        <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interaction</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>
</pre></div>

        </details>

            <div class="docstring"><p>Execute a slash command based on received REST requests.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>interaction</strong> (hikari.CommandInteraction):
The interaction to execute a command based on.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong><a href="tanjun/context.html#ResponseType">tanjun.context.ResponseType</a></strong>: The initial response to send back to Discord.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="tanjun/injecting.html#InjectorClient">tanjun.injecting.InjectorClient</a></dt>
                                <dd id="Client.set_type_dependency" class="function"><a href="tanjun/injecting.html#InjectorClient.set_type_dependency">set_type_dependency</a></dd>
                <dd id="Client.get_type_dependency" class="function"><a href="tanjun/injecting.html#InjectorClient.get_type_dependency">get_type_dependency</a></dd>
                <dd id="Client.remove_type_dependency" class="function"><a href="tanjun/injecting.html#InjectorClient.remove_type_dependency">remove_type_dependency</a></dd>
                <dd id="Client.set_callback_override" class="function"><a href="tanjun/injecting.html#InjectorClient.set_callback_override">set_callback_override</a></dd>
                <dd id="Client.get_callback_override" class="function"><a href="tanjun/injecting.html#InjectorClient.get_callback_override">get_callback_override</a></dd>
                <dd id="Client.remove_callback_override" class="function"><a href="tanjun/injecting.html#InjectorClient.remove_callback_override">remove_callback_override</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ClientCallbackNames">
                                <div class="attr class">
        <a class="headerlink" href="#ClientCallbackNames">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ClientCallbackNames</span><wbr>(<span class="base">builtins.str</span>, <span class="base">enum.Enum</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ClientCallbackNames</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Enum of the client callback names dispatched by the standard `Client`.&quot;&quot;&quot;</span>

    <span class="n">CLOSED</span> <span class="o">=</span> <span class="s2">&quot;closed&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when the client has finished closing.</span>

<span class="sd">    No positional arguments are provided for this event.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CLOSING</span> <span class="o">=</span> <span class="s2">&quot;closing&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when the client is initially instructed to close.</span>

<span class="sd">    No positional arguments are provided for this event.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">COMPONENT_ADDED</span> <span class="o">=</span> <span class="s2">&quot;component_added&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when a component is added to an active client.</span>

<span class="sd">    .. warning::</span>
<span class="sd">        This event isn&#39;t dispatched for components which were registered while</span>
<span class="sd">        the client is inactive.</span>

<span class="sd">    The first positional argument is the `tanjun.abc.Component` being added.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">COMPONENT_REMOVED</span> <span class="o">=</span> <span class="s2">&quot;component_removed&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when a component is added to an active client.</span>

<span class="sd">    .. warning::</span>
<span class="sd">        This event isn&#39;t dispatched for components which were removed while</span>
<span class="sd">        the client is inactive.</span>

<span class="sd">    The first positional argument is the `tanjun.abc.Component` being removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">MESSAGE_COMMAND_NOT_FOUND</span> <span class="o">=</span> <span class="s2">&quot;message_command_not_found&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when a message command is not found.</span>

<span class="sd">    `tanjun.abc.MessageContext` is provided as the first positional argument.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SLASH_COMMAND_NOT_FOUND</span> <span class="o">=</span> <span class="s2">&quot;slash_command_not_found&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when a slash command is not found.</span>

<span class="sd">    `tanjun.abc.MessageContext` is provided as the first positional argument.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">STARTED</span> <span class="o">=</span> <span class="s2">&quot;started&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when the client has finished starting.</span>

<span class="sd">    No positional arguments are provided for this event.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">STARTING</span> <span class="o">=</span> <span class="s2">&quot;starting&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when the client is initially instructed to start.</span>

<span class="sd">    No positional arguments are provided for this event.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>

        </details>

            <div class="docstring"><p>Enum of the client callback names dispatched by the standard <code><a href="#Client">Client</a></code>.</p>
</div>


                            <div id="ClientCallbackNames.CLOSED" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ClientCallbackNames.CLOSED">#&nbsp;&nbsp</a>

        <span class="name">CLOSED</span><span class="default_value"> = &lt;<a href="#ClientCallbackNames.CLOSED">ClientCallbackNames.CLOSED</a>: &#39;closed&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Called when the client has finished closing.</p>

<p>No positional arguments are provided for this event.</p>
</div>


                            </div>
                            <div id="ClientCallbackNames.CLOSING" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ClientCallbackNames.CLOSING">#&nbsp;&nbsp</a>

        <span class="name">CLOSING</span><span class="default_value"> = &lt;<a href="#ClientCallbackNames.CLOSING">ClientCallbackNames.CLOSING</a>: &#39;closing&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Called when the client is initially instructed to close.</p>

<p>No positional arguments are provided for this event.</p>
</div>


                            </div>
                            <div id="ClientCallbackNames.COMPONENT_ADDED" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ClientCallbackNames.COMPONENT_ADDED">#&nbsp;&nbsp</a>

        <span class="name">COMPONENT_ADDED</span><span class="default_value"> = &lt;<a href="#ClientCallbackNames.COMPONENT_ADDED">ClientCallbackNames.COMPONENT_ADDED</a>: &#39;component_added&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Called when a component is added to an active client.</p>

<p><em>Warning:</em>
This event isn't dispatched for components which were registered while
the client is inactive.</p>

<p>The first positional argument is the <code><a href="tanjun/abc.html#Component">tanjun.abc.Component</a></code> being added.</p>
</div>


                            </div>
                            <div id="ClientCallbackNames.COMPONENT_REMOVED" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ClientCallbackNames.COMPONENT_REMOVED">#&nbsp;&nbsp</a>

        <span class="name">COMPONENT_REMOVED</span><span class="default_value"> = &lt;<a href="#ClientCallbackNames.COMPONENT_REMOVED">ClientCallbackNames.COMPONENT_REMOVED</a>: &#39;component_removed&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Called when a component is added to an active client.</p>

<p><em>Warning:</em>
This event isn't dispatched for components which were removed while
the client is inactive.</p>

<p>The first positional argument is the <code><a href="tanjun/abc.html#Component">tanjun.abc.Component</a></code> being removed.</p>
</div>


                            </div>
                            <div id="ClientCallbackNames.MESSAGE_COMMAND_NOT_FOUND" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ClientCallbackNames.MESSAGE_COMMAND_NOT_FOUND">#&nbsp;&nbsp</a>

        <span class="name">MESSAGE_COMMAND_NOT_FOUND</span><span class="default_value"> = &lt;<a href="#ClientCallbackNames.MESSAGE_COMMAND_NOT_FOUND">ClientCallbackNames.MESSAGE_COMMAND_NOT_FOUND</a>: &#39;message_command_not_found&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Called when a message command is not found.</p>

<p><code><a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a></code> is provided as the first positional argument.</p>
</div>


                            </div>
                            <div id="ClientCallbackNames.SLASH_COMMAND_NOT_FOUND" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ClientCallbackNames.SLASH_COMMAND_NOT_FOUND">#&nbsp;&nbsp</a>

        <span class="name">SLASH_COMMAND_NOT_FOUND</span><span class="default_value"> = &lt;<a href="#ClientCallbackNames.SLASH_COMMAND_NOT_FOUND">ClientCallbackNames.SLASH_COMMAND_NOT_FOUND</a>: &#39;slash_command_not_found&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Called when a slash command is not found.</p>

<p><code><a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a></code> is provided as the first positional argument.</p>
</div>


                            </div>
                            <div id="ClientCallbackNames.STARTED" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ClientCallbackNames.STARTED">#&nbsp;&nbsp</a>

        <span class="name">STARTED</span><span class="default_value"> = &lt;<a href="#ClientCallbackNames.STARTED">ClientCallbackNames.STARTED</a>: &#39;started&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Called when the client has finished starting.</p>

<p>No positional arguments are provided for this event.</p>
</div>


                            </div>
                            <div id="ClientCallbackNames.STARTING" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ClientCallbackNames.STARTING">#&nbsp;&nbsp</a>

        <span class="name">STARTING</span><span class="default_value"> = &lt;<a href="#ClientCallbackNames.STARTING">ClientCallbackNames.STARTING</a>: &#39;starting&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Called when the client is initially instructed to start.</p>

<p>No positional arguments are provided for this event.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>enum.Enum</dt>
                                <dd id="ClientCallbackNames.name" class="variable">name</dd>
                <dd id="ClientCallbackNames.value" class="variable">value</dd>

            </div>
            <div><dt>builtins.str</dt>
                                <dd id="ClientCallbackNames.encode" class="function">encode</dd>
                <dd id="ClientCallbackNames.replace" class="function">replace</dd>
                <dd id="ClientCallbackNames.split" class="function">split</dd>
                <dd id="ClientCallbackNames.rsplit" class="function">rsplit</dd>
                <dd id="ClientCallbackNames.join" class="function">join</dd>
                <dd id="ClientCallbackNames.capitalize" class="function">capitalize</dd>
                <dd id="ClientCallbackNames.casefold" class="function">casefold</dd>
                <dd id="ClientCallbackNames.title" class="function">title</dd>
                <dd id="ClientCallbackNames.center" class="function">center</dd>
                <dd id="ClientCallbackNames.count" class="function">count</dd>
                <dd id="ClientCallbackNames.expandtabs" class="function">expandtabs</dd>
                <dd id="ClientCallbackNames.find" class="function">find</dd>
                <dd id="ClientCallbackNames.partition" class="function">partition</dd>
                <dd id="ClientCallbackNames.index" class="function">index</dd>
                <dd id="ClientCallbackNames.ljust" class="function">ljust</dd>
                <dd id="ClientCallbackNames.lower" class="function">lower</dd>
                <dd id="ClientCallbackNames.lstrip" class="function">lstrip</dd>
                <dd id="ClientCallbackNames.rfind" class="function">rfind</dd>
                <dd id="ClientCallbackNames.rindex" class="function">rindex</dd>
                <dd id="ClientCallbackNames.rjust" class="function">rjust</dd>
                <dd id="ClientCallbackNames.rstrip" class="function">rstrip</dd>
                <dd id="ClientCallbackNames.rpartition" class="function">rpartition</dd>
                <dd id="ClientCallbackNames.splitlines" class="function">splitlines</dd>
                <dd id="ClientCallbackNames.strip" class="function">strip</dd>
                <dd id="ClientCallbackNames.swapcase" class="function">swapcase</dd>
                <dd id="ClientCallbackNames.translate" class="function">translate</dd>
                <dd id="ClientCallbackNames.upper" class="function">upper</dd>
                <dd id="ClientCallbackNames.startswith" class="function">startswith</dd>
                <dd id="ClientCallbackNames.endswith" class="function">endswith</dd>
                <dd id="ClientCallbackNames.removeprefix" class="function">removeprefix</dd>
                <dd id="ClientCallbackNames.removesuffix" class="function">removesuffix</dd>
                <dd id="ClientCallbackNames.isascii" class="function">isascii</dd>
                <dd id="ClientCallbackNames.islower" class="function">islower</dd>
                <dd id="ClientCallbackNames.isupper" class="function">isupper</dd>
                <dd id="ClientCallbackNames.istitle" class="function">istitle</dd>
                <dd id="ClientCallbackNames.isspace" class="function">isspace</dd>
                <dd id="ClientCallbackNames.isdecimal" class="function">isdecimal</dd>
                <dd id="ClientCallbackNames.isdigit" class="function">isdigit</dd>
                <dd id="ClientCallbackNames.isnumeric" class="function">isnumeric</dd>
                <dd id="ClientCallbackNames.isalpha" class="function">isalpha</dd>
                <dd id="ClientCallbackNames.isalnum" class="function">isalnum</dd>
                <dd id="ClientCallbackNames.isidentifier" class="function">isidentifier</dd>
                <dd id="ClientCallbackNames.isprintable" class="function">isprintable</dd>
                <dd id="ClientCallbackNames.zfill" class="function">zfill</dd>
                <dd id="ClientCallbackNames.format" class="function">format</dd>
                <dd id="ClientCallbackNames.format_map" class="function">format_map</dd>
                <dd id="ClientCallbackNames.maketrans" class="function">maketrans</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MessageAcceptsEnum">
                                <div class="attr class">
        <a class="headerlink" href="#MessageAcceptsEnum">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">MessageAcceptsEnum</span><wbr>(<span class="base">builtins.str</span>, <span class="base">enum.Enum</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MessageAcceptsEnum</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The possible configurations for which events `Client` should execute commands based on.&quot;&quot;&quot;</span>

    <span class="n">ALL</span> <span class="o">=</span> <span class="s2">&quot;ALL&quot;</span>
    <span class="sd">&quot;&quot;&quot;Set the client to execute commands based on both DM and guild message create events.&quot;&quot;&quot;</span>

    <span class="n">DM_ONLY</span> <span class="o">=</span> <span class="s2">&quot;DM_ONLY&quot;</span>
    <span class="sd">&quot;&quot;&quot;Set the client to execute commands based only DM message create events.&quot;&quot;&quot;</span>

    <span class="n">GUILD_ONLY</span> <span class="o">=</span> <span class="s2">&quot;GUILD_ONLY&quot;</span>
    <span class="sd">&quot;&quot;&quot;Set the client to execute commands based only guild message create events.&quot;&quot;&quot;</span>

    <span class="n">NONE</span> <span class="o">=</span> <span class="s2">&quot;NONE&quot;</span>
    <span class="sd">&quot;&quot;&quot;Set the client to not execute commands based on message create events.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_event_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Get the base event type this mode listens to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[type[hikari.message_events.MessageCreateEvent]]</span>
<span class="sd">            The type object of the MessageCreateEvent class this mode will</span>
<span class="sd">            register a listener for.</span>

<span class="sd">            This will be `None` if this mode disables listening to</span>
<span class="sd">            message create events.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_ACCEPTS_EVENT_TYPE_MAPPING</span><span class="p">[</span><span class="bp">self</span><span class="p">]</span>
</pre></div>

        </details>

            <div class="docstring"><p>The possible configurations for which events <code><a href="#Client">Client</a></code> should execute commands based on.</p>
</div>


                            <div id="MessageAcceptsEnum.ALL" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageAcceptsEnum.ALL">#&nbsp;&nbsp</a>

        <span class="name">ALL</span><span class="default_value"> = &lt;<a href="#MessageAcceptsEnum.ALL">MessageAcceptsEnum.ALL</a>: &#39;ALL&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Set the client to execute commands based on both DM and guild message create events.</p>
</div>


                            </div>
                            <div id="MessageAcceptsEnum.DM_ONLY" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageAcceptsEnum.DM_ONLY">#&nbsp;&nbsp</a>

        <span class="name">DM_ONLY</span><span class="default_value"> = &lt;<a href="#MessageAcceptsEnum.DM_ONLY">MessageAcceptsEnum.DM_ONLY</a>: &#39;DM_ONLY&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Set the client to execute commands based only DM message create events.</p>
</div>


                            </div>
                            <div id="MessageAcceptsEnum.GUILD_ONLY" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageAcceptsEnum.GUILD_ONLY">#&nbsp;&nbsp</a>

        <span class="name">GUILD_ONLY</span><span class="default_value"> = &lt;<a href="#MessageAcceptsEnum.GUILD_ONLY">MessageAcceptsEnum.GUILD_ONLY</a>: &#39;GUILD_ONLY&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Set the client to execute commands based only guild message create events.</p>
</div>


                            </div>
                            <div id="MessageAcceptsEnum.NONE" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageAcceptsEnum.NONE">#&nbsp;&nbsp</a>

        <span class="name">NONE</span><span class="default_value"> = &lt;<a href="#MessageAcceptsEnum.NONE">MessageAcceptsEnum.NONE</a>: &#39;NONE&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Set the client to not execute commands based on message create events.</p>
</div>


                            </div>
                            <div id="MessageAcceptsEnum.get_event_type" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageAcceptsEnum.get_event_type">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_event_type</span><span class="signature">(
    self
) -&gt; Optional[type[hikari.events.message_events.MessageCreateEvent]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">get_event_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Get the base event type this mode listens to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[type[hikari.message_events.MessageCreateEvent]]</span>
<span class="sd">            The type object of the MessageCreateEvent class this mode will</span>
<span class="sd">            register a listener for.</span>

<span class="sd">            This will be `None` if this mode disables listening to</span>
<span class="sd">            message create events.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_ACCEPTS_EVENT_TYPE_MAPPING</span><span class="p">[</span><span class="bp">self</span><span class="p">]</span>
</pre></div>

        </details>

            <div class="docstring"><p>Get the base event type this mode listens to.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Optional[type[hikari.message_events.MessageCreateEvent]]</strong>: The type object of the MessageCreateEvent class this mode will
register a listener for.</li>
</ul>

<p>This will be <code>None</code> if this mode disables listening to
message create events.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>enum.Enum</dt>
                                <dd id="MessageAcceptsEnum.name" class="variable">name</dd>
                <dd id="MessageAcceptsEnum.value" class="variable">value</dd>

            </div>
            <div><dt>builtins.str</dt>
                                <dd id="MessageAcceptsEnum.encode" class="function">encode</dd>
                <dd id="MessageAcceptsEnum.replace" class="function">replace</dd>
                <dd id="MessageAcceptsEnum.split" class="function">split</dd>
                <dd id="MessageAcceptsEnum.rsplit" class="function">rsplit</dd>
                <dd id="MessageAcceptsEnum.join" class="function">join</dd>
                <dd id="MessageAcceptsEnum.capitalize" class="function">capitalize</dd>
                <dd id="MessageAcceptsEnum.casefold" class="function">casefold</dd>
                <dd id="MessageAcceptsEnum.title" class="function">title</dd>
                <dd id="MessageAcceptsEnum.center" class="function">center</dd>
                <dd id="MessageAcceptsEnum.count" class="function">count</dd>
                <dd id="MessageAcceptsEnum.expandtabs" class="function">expandtabs</dd>
                <dd id="MessageAcceptsEnum.find" class="function">find</dd>
                <dd id="MessageAcceptsEnum.partition" class="function">partition</dd>
                <dd id="MessageAcceptsEnum.index" class="function">index</dd>
                <dd id="MessageAcceptsEnum.ljust" class="function">ljust</dd>
                <dd id="MessageAcceptsEnum.lower" class="function">lower</dd>
                <dd id="MessageAcceptsEnum.lstrip" class="function">lstrip</dd>
                <dd id="MessageAcceptsEnum.rfind" class="function">rfind</dd>
                <dd id="MessageAcceptsEnum.rindex" class="function">rindex</dd>
                <dd id="MessageAcceptsEnum.rjust" class="function">rjust</dd>
                <dd id="MessageAcceptsEnum.rstrip" class="function">rstrip</dd>
                <dd id="MessageAcceptsEnum.rpartition" class="function">rpartition</dd>
                <dd id="MessageAcceptsEnum.splitlines" class="function">splitlines</dd>
                <dd id="MessageAcceptsEnum.strip" class="function">strip</dd>
                <dd id="MessageAcceptsEnum.swapcase" class="function">swapcase</dd>
                <dd id="MessageAcceptsEnum.translate" class="function">translate</dd>
                <dd id="MessageAcceptsEnum.upper" class="function">upper</dd>
                <dd id="MessageAcceptsEnum.startswith" class="function">startswith</dd>
                <dd id="MessageAcceptsEnum.endswith" class="function">endswith</dd>
                <dd id="MessageAcceptsEnum.removeprefix" class="function">removeprefix</dd>
                <dd id="MessageAcceptsEnum.removesuffix" class="function">removesuffix</dd>
                <dd id="MessageAcceptsEnum.isascii" class="function">isascii</dd>
                <dd id="MessageAcceptsEnum.islower" class="function">islower</dd>
                <dd id="MessageAcceptsEnum.isupper" class="function">isupper</dd>
                <dd id="MessageAcceptsEnum.istitle" class="function">istitle</dd>
                <dd id="MessageAcceptsEnum.isspace" class="function">isspace</dd>
                <dd id="MessageAcceptsEnum.isdecimal" class="function">isdecimal</dd>
                <dd id="MessageAcceptsEnum.isdigit" class="function">isdigit</dd>
                <dd id="MessageAcceptsEnum.isnumeric" class="function">isnumeric</dd>
                <dd id="MessageAcceptsEnum.isalpha" class="function">isalpha</dd>
                <dd id="MessageAcceptsEnum.isalnum" class="function">isalnum</dd>
                <dd id="MessageAcceptsEnum.isidentifier" class="function">isidentifier</dd>
                <dd id="MessageAcceptsEnum.isprintable" class="function">isprintable</dd>
                <dd id="MessageAcceptsEnum.zfill" class="function">zfill</dd>
                <dd id="MessageAcceptsEnum.format" class="function">format</dd>
                <dd id="MessageAcceptsEnum.format_map" class="function">format_map</dd>
                <dd id="MessageAcceptsEnum.maketrans" class="function">maketrans</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="commands">
                                <div class="attr module"><a class="headerlink" href="#commands">#&nbsp;&nbsp</a>
<span class="name"><a href="tanjun/commands.html">tanjun.commands</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;Standard implementation of Tanjun&#39;s command objects.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;AnyMessageCommandT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CommandCallbackSigT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ConverterSig&quot;</span><span class="p">,</span>
    <span class="s2">&quot;as_message_command&quot;</span><span class="p">,</span>
    <span class="s2">&quot;as_message_command_group&quot;</span><span class="p">,</span>
    <span class="s2">&quot;as_slash_command&quot;</span><span class="p">,</span>
    <span class="s2">&quot;slash_command_group&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MessageCommand&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MessageCommandGroup&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PartialCommand&quot;</span><span class="p">,</span>
    <span class="s2">&quot;BaseSlashCommand&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SlashCommand&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SlashCommandGroup&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_str_slash_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_int_slash_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_float_slash_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_bool_slash_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_role_slash_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_user_slash_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_member_slash_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_channel_slash_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_mentionable_slash_option&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">types</span>
<span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">collections</span>

<span class="kn">import</span> <span class="nn">hikari</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">abc</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">checks</span> <span class="k">as</span> <span class="n">checks_</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">components</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">conversion</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">errors</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">hooks</span> <span class="k">as</span> <span class="n">hooks_</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">injecting</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">utilities</span>

<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">hikari.api</span> <span class="kn">import</span> <span class="n">special_endpoints</span> <span class="k">as</span> <span class="n">special_endpoints_api</span>

    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">parsing</span>

    <span class="n">_MessageCommandT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_MessageCommandT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;MessageCommand[typing.Any]&quot;</span><span class="p">)</span>
    <span class="n">_MessageCommandGroupT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_MessageCommandGroupT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;MessageCommandGroup[typing.Any]&quot;</span><span class="p">)</span>
    <span class="n">_PartialCommandT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_PartialCommandT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;PartialCommand[typing.Any]&quot;</span><span class="p">)</span>
    <span class="n">_BaseSlashCommandT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_BaseSlashCommandT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;BaseSlashCommand&quot;</span><span class="p">)</span>
    <span class="n">_SlashCommandT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_SlashCommandT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;SlashCommand[typing.Any]&quot;</span><span class="p">)</span>
    <span class="n">_SlashCommandGroupT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_SlashCommandGroupT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;SlashCommandGroup&quot;</span><span class="p">)</span>


<span class="n">AnyMessageCommandT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;AnyMessageCommandT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">)</span>
<span class="n">CommandCallbackSigT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;CommandCallbackSigT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">abc</span><span class="o">.</span><span class="n">CommandCallbackSig</span><span class="p">)</span>
<span class="n">ConverterSig</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MaybeAwaitableT</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span>
<span class="sd">&quot;&quot;&quot;Type hint of a converter used for a slash command option.&quot;&quot;&quot;</span>
<span class="n">_EMPTY_DICT</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">_EMPTY_HOOKS</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">hooks_</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hooks_</span><span class="o">.</span><span class="n">Hooks</span><span class="p">()</span>
<span class="n">_EMPTY_LIST</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>


<span class="k">class</span> <span class="nc">_LoadableInjector</span><span class="p">(</span><span class="n">checks_</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="nf">make_method_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Callback is already a method type&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">overwrite_callback</span><span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">,</span> <span class="n">component</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">PartialCommand</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Base class for the standard ExecutableCommand implementations.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_checks&quot;</span><span class="p">,</span> <span class="s2">&quot;_component&quot;</span><span class="p">,</span> <span class="s2">&quot;_hooks&quot;</span><span class="p">,</span> <span class="s2">&quot;_metadata&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">checks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">checks_</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">[</span><span class="n">checks_</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">(</span><span class="n">check</span><span class="p">)</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">checks</span><span class="p">)]</span> <span class="k">if</span> <span class="n">checks</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span> <span class="k">if</span> <span class="n">metadata</span> <span class="k">else</span> <span class="p">{}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">checks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">check</span><span class="o">.</span><span class="n">callback</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_component</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT</span><span class="p">]]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">needs_injector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.injecting.Injectable&gt;&gt;.</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">check</span><span class="o">.</span><span class="n">needs_injector</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_PartialCommandT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_PartialCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span> <span class="o">=</span> <span class="p">[</span><span class="n">check</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_PartialCommandT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT</span><span class="p">]],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_PartialCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_PartialCommandT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_PartialCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="n">check</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checks_</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">(</span><span class="n">check</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_PartialCommandT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_PartialCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;checks_.InjectableCheck&quot;</span><span class="p">,</span> <span class="n">check</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">check</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_LoadableInjector</span><span class="p">(</span><span class="n">check</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">check</span>

    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_PartialCommandT</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_PartialCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_PartialCommandT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_PartialCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_component</span> <span class="o">=</span> <span class="n">component</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">load_into_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_PartialCommandT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_PartialCommandT</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">check</span><span class="p">,</span> <span class="n">_LoadableInjector</span><span class="p">):</span>
                <span class="n">check</span><span class="o">.</span><span class="n">make_method_type</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>


<span class="n">_SCOMMAND_NAME_REG</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">Pattern</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^[a-z0-9_-]{1,32}$&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">slash_command_group</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">default_permission</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">default_to_ephemeral</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_global</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SlashCommandGroup</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Create a slash command group.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Sub-commands can be added to the created slash command object through</span>
<span class="sd">    the following decorator based approach:</span>
<span class="sd">    ```python</span>
<span class="sd">    help_group = tanjun.slash_command_group(&quot;help&quot;, &quot;get help&quot;)</span>

<span class="sd">    @help_group.with_command</span>
<span class="sd">    @tanjun.with_str_slash_option(&quot;commad_name&quot;, &quot;command name&quot;)</span>
<span class="sd">    @tanjun.as_slash_command(&quot;command&quot;, &quot;Get help with a command&quot;)</span>
<span class="sd">    async def help_command_command(ctx: tanjun.abc.SlashContext, command_name: str) -&gt; None:</span>
<span class="sd">        ...</span>

<span class="sd">    @help_group.with_command</span>
<span class="sd">    @tanjun.as_slash_command(&quot;me&quot;, &quot;help me&quot;)</span>
<span class="sd">    async def help_me_command(ctx: tanjun.abc.SlashContext) -&gt; None:</span>
<span class="sd">        ...</span>

<span class="sd">    component = tanjun.Component().add_slash_command_command(help_group)</span>
<span class="sd">    ```</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * Unlike message command grups, slash command groups cannot</span>
<span class="sd">      be callable functions themselves.</span>
<span class="sd">    * Under the standard implementation, `is_global` is used to determine whether</span>
<span class="sd">      the command should be bulk set by `tanjun.Client.set_global_commands`</span>
<span class="sd">      or when `set_global_commands` is True</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the command group.</span>
<span class="sd">    description : str</span>
<span class="sd">        The description of the command group.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    command_id : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.Command]]</span>
<span class="sd">        Object or ID of the command the group tracks.</span>

<span class="sd">        This is useful when bulk updating the commands as if the ID isn&#39;t</span>
<span class="sd">        specified then any previously set permissions may be lost (i.e. if the</span>
<span class="sd">        command&#39;s name is changed).</span>
<span class="sd">    default_permission : bool</span>
<span class="sd">        Whether this command can be accessed without set permissions.</span>

<span class="sd">        Defaults to `True`, meaning that users can access the command by default.</span>
<span class="sd">    default_to_ephemeral : typing.Optional[bool]</span>
<span class="sd">        Whether this command&#39;s responses should default to ephemeral unless flags</span>
<span class="sd">        are set to override this.</span>

<span class="sd">        If this is left as `None` then the default set on the parent command(s),</span>
<span class="sd">        component or client will be in effect.</span>
<span class="sd">    is_global : bool</span>
<span class="sd">        Whether this command is a global command. Defaults to `True`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SlashCommandGroup</span>
<span class="sd">        The command group.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raises a value error for any of the following reasons:</span>
<span class="sd">        * If the command name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        * If the description is over 100 characters long.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">SlashCommandGroup</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">description</span><span class="p">,</span>
        <span class="n">command_id</span><span class="o">=</span><span class="n">command_id</span><span class="p">,</span>
        <span class="n">default_permission</span><span class="o">=</span><span class="n">default_permission</span><span class="p">,</span>
        <span class="n">default_to_ephemeral</span><span class="o">=</span><span class="n">default_to_ephemeral</span><span class="p">,</span>
        <span class="n">is_global</span><span class="o">=</span><span class="n">is_global</span><span class="p">,</span>
        <span class="n">_stack</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">as_slash_command</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">default_permission</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">default_to_ephemeral</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_global</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">sort_options</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandCallbackSigT</span><span class="p">],</span> <span class="n">SlashCommand</span><span class="p">[</span><span class="n">CommandCallbackSigT</span><span class="p">]]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Build a `SlashCommand` by decorating a function.</span>

<span class="sd">    .. note::</span>
<span class="sd">        Under the standard implementation, `is_global` is used to determine whether</span>
<span class="sd">        the command should be bulk set by `tanjun.Client.set_global_commands`</span>
<span class="sd">        or when `set_global_commands` is True</span>

<span class="sd">    .. warning::</span>
<span class="sd">        `command_id`, `default_permission` and `is_global` are ignored for commands</span>
<span class="sd">        within slash command groups.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @as_slash_command(&quot;ping&quot;, &quot;Get the bot&#39;s latency&quot;)</span>
<span class="sd">    async def ping_command(self, ctx: tanjun.abc.SlashContext) -&gt; None:</span>
<span class="sd">        start_time = time.perf_counter()</span>
<span class="sd">        await ctx.rest.fetch_my_user()</span>
<span class="sd">        time_taken = (time.perf_counter() - start_time) * 1_000</span>
<span class="sd">        await ctx.respond(f&quot;PONG\n - REST: {time_taken:.0f}mss&quot;)</span>
<span class="sd">    ```</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The command&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">    description : str</span>
<span class="sd">        The command&#39;s description.</span>
<span class="sd">        This should be inclusively between 1-100 characters in length.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    command_id : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.Command]]</span>
<span class="sd">        ID of the global command this should be tracking.</span>

<span class="sd">        This is useful when bulk updating the commands as if the ID isn&#39;t</span>
<span class="sd">        specified then any previously set permissions may be lost (i.e. if the</span>
<span class="sd">        command&#39;s name is changed).</span>
<span class="sd">    default_permission : bool</span>
<span class="sd">        Whether this command can be accessed without set permissions.</span>

<span class="sd">        Defaults to `True`, meaning that users can access the command by default.</span>
<span class="sd">    default_to_ephemeral : typing.Optional[bool]</span>
<span class="sd">        Whether this command&#39;s responses should default to ephemeral unless flags</span>
<span class="sd">        are set to override this.</span>

<span class="sd">        If this is left as `None` then the default set on the parent command(s),</span>
<span class="sd">        component or client will be in effect.</span>
<span class="sd">    is_global : bool</span>
<span class="sd">        Whether this command is a global command. Defaults to `True`.</span>
<span class="sd">    sort_options : bool</span>
<span class="sd">        Whether this command should sort its set options based on whether</span>
<span class="sd">        they&#39;re required.</span>

<span class="sd">        If this is `True` then the options are re-sorted to meet the requirement</span>
<span class="sd">        from Discord that required command options be listed before optional</span>
<span class="sd">        ones.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[CommandCallbackSigT], SlashCommand[CommandCallbackSigT]]</span>
<span class="sd">        The decorator callback used to build the command to a `SlashCommand`.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raises a value error for any of the following reasons:</span>
<span class="sd">        * If the command name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        * If the description is over 100 characters long.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">SlashCommand</span><span class="p">(</span>
        <span class="n">c</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">description</span><span class="p">,</span>
        <span class="n">command_id</span><span class="o">=</span><span class="n">command_id</span><span class="p">,</span>
        <span class="n">default_permission</span><span class="o">=</span><span class="n">default_permission</span><span class="p">,</span>
        <span class="n">default_to_ephemeral</span><span class="o">=</span><span class="n">default_to_ephemeral</span><span class="p">,</span>
        <span class="n">is_global</span><span class="o">=</span><span class="n">is_global</span><span class="p">,</span>
        <span class="n">sort_options</span><span class="o">=</span><span class="n">sort_options</span><span class="p">,</span>
        <span class="n">_stack</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>


<span class="n">_UNDEFINED_DEFAULT</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">with_str_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
    <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a string option to a slash command.</span>

<span class="sd">    For more information on this function&#39;s parameters see `SlashCommand.add_str_option`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_str_slash_option(&quot;name&quot;, &quot;A name.&quot;)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, name: str) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_str_option</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">description</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
        <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">with_int_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
    <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add an integer option to a slash command.</span>

<span class="sd">    For information on this function&#39;s parameters see `SlashCommand.add_int_option`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_int_slash_option(&quot;int_value&quot;, &quot;Int value.&quot;)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, int_value: int) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_int_option</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">description</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
        <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">with_float_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">always_float</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
    <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a float option to a slash command.</span>

<span class="sd">    For information on this function&#39;s parameters see `SlashCommand.add_float_option`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_float_slash_option(&quot;float_value&quot;, &quot;Float value.&quot;)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, float_value: float) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_float_option</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">description</span><span class="p">,</span>
        <span class="n">always_float</span><span class="o">=</span><span class="n">always_float</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
        <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">with_bool_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a boolean option to a slash command.</span>

<span class="sd">    For information on this function&#39;s parameters see `SlashContext.add_bool_option`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_bool_slash_option(&quot;flag&quot;, &quot;Whether this flag should be enabled.&quot;, default=False)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, flag: bool) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_bool_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">with_user_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a user option to a slash command.</span>

<span class="sd">    For information on this function&#39;s parameters see `SlashContext.add_user_option`.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This may result in `hikari.InteractionMember` or</span>
<span class="sd">        `hikari.users.User` if the user isn&#39;t in the current guild or if this</span>
<span class="sd">        command was executed in a DM channel.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_user_slash_option(&quot;user&quot;, &quot;user to target.&quot;)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, user: Union[InteractionMember, User]) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_user_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">with_member_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a member option to a slash command.</span>

<span class="sd">    For information on this function&#39;s arguments see `SlashCommand.add_member_option`.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This will always result in `hikari.InteractionMember`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_member_slash_option(&quot;member&quot;, &quot;member to target.&quot;)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, member: hikari.InteractionMember) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_member_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">)</span>


<span class="n">_channel_types</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialChannel</span><span class="p">],</span> <span class="nb">set</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">ChannelType</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hikari</span><span class="o">.</span><span class="n">GuildTextChannel</span><span class="p">:</span> <span class="p">{</span><span class="n">hikari</span><span class="o">.</span><span class="n">ChannelType</span><span class="o">.</span><span class="n">GUILD_TEXT</span><span class="p">},</span>
    <span class="n">hikari</span><span class="o">.</span><span class="n">DMChannel</span><span class="p">:</span> <span class="p">{</span><span class="n">hikari</span><span class="o">.</span><span class="n">ChannelType</span><span class="o">.</span><span class="n">DM</span><span class="p">},</span>
    <span class="n">hikari</span><span class="o">.</span><span class="n">GuildVoiceChannel</span><span class="p">:</span> <span class="p">{</span><span class="n">hikari</span><span class="o">.</span><span class="n">ChannelType</span><span class="o">.</span><span class="n">GUILD_VOICE</span><span class="p">},</span>
    <span class="n">hikari</span><span class="o">.</span><span class="n">GroupDMChannel</span><span class="p">:</span> <span class="p">{</span><span class="n">hikari</span><span class="o">.</span><span class="n">ChannelType</span><span class="o">.</span><span class="n">GROUP_DM</span><span class="p">},</span>
    <span class="n">hikari</span><span class="o">.</span><span class="n">GuildCategory</span><span class="p">:</span> <span class="p">{</span><span class="n">hikari</span><span class="o">.</span><span class="n">ChannelType</span><span class="o">.</span><span class="n">GUILD_CATEGORY</span><span class="p">},</span>
    <span class="n">hikari</span><span class="o">.</span><span class="n">GuildNewsChannel</span><span class="p">:</span> <span class="p">{</span><span class="n">hikari</span><span class="o">.</span><span class="n">ChannelType</span><span class="o">.</span><span class="n">GUILD_NEWS</span><span class="p">},</span>
    <span class="n">hikari</span><span class="o">.</span><span class="n">GuildStoreChannel</span><span class="p">:</span> <span class="p">{</span><span class="n">hikari</span><span class="o">.</span><span class="n">ChannelType</span><span class="o">.</span><span class="n">GUILD_STORE</span><span class="p">},</span>
    <span class="n">hikari</span><span class="o">.</span><span class="n">GuildStageChannel</span><span class="p">:</span> <span class="p">{</span><span class="n">hikari</span><span class="o">.</span><span class="n">ChannelType</span><span class="o">.</span><span class="n">GUILD_STAGE</span><span class="p">},</span>
<span class="p">}</span>


<span class="k">for</span> <span class="n">_channel_cls</span><span class="p">,</span> <span class="n">_types</span> <span class="ow">in</span> <span class="n">_channel_types</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">_mro_type</span> <span class="ow">in</span> <span class="n">_channel_cls</span><span class="o">.</span><span class="n">mro</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_mro_type</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">_mro_type</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">PartialChannel</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">_channel_types</span><span class="p">[</span><span class="n">_mro_type</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">_types</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">_channel_types</span><span class="p">[</span><span class="n">_mro_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">_types</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">with_channel_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">types</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialChannel</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
    <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a channel option to a slash command.</span>

<span class="sd">    For information on this function&#39;s parameters see `SlashCommand.add_channel_option`.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This will always result in `hikari..InteractionChannel`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_channel_slash_option(&quot;channel&quot;, &quot;channel to target.&quot;)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, channel: hikari.InteractionChannel) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_channel_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="n">types</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">with_role_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a role option to a slash command.</span>

<span class="sd">    For information on this function&#39;s parameters see `SlashCommand.add_role_option`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_role_slash_option(&quot;role&quot;, &quot;Role to target.&quot;)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, role: hikari.Role) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_role_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">with_mentionable_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a mentionable option to a slash command.</span>

<span class="sd">    For information on this function&#39;s arguments see `SlashCommand.add_mentionable_option`.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This may target roles, guild members or users and results in</span>
<span class="sd">        `Union[hikari.User, hikari.InteractionMember, hikari.Role]`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_mentionable_slash_option(&quot;mentionable&quot;, &quot;Mentionable entity to target.&quot;)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, mentionable: [Role, InteractionMember, User]) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_mentionable_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_convert_to_injectable</span><span class="p">(</span><span class="n">converter</span><span class="p">:</span> <span class="n">ConverterSig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">conversion</span><span class="o">.</span><span class="n">InjectableConverter</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">converter</span><span class="p">,</span> <span class="n">conversion</span><span class="o">.</span><span class="n">InjectableConverter</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;conversion.InjectableConverter[typing.Any]&quot;</span><span class="p">,</span> <span class="n">converter</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">conversion</span><span class="o">.</span><span class="n">InjectableConverter</span><span class="p">(</span><span class="n">conversion</span><span class="o">.</span><span class="n">override_type</span><span class="p">(</span><span class="n">converter</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">_TrackedOption</span><span class="p">:</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;converters&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="s2">&quot;is_always_float&quot;</span><span class="p">,</span> <span class="s2">&quot;is_only_member&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">option_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
        <span class="n">always_float</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">conversion</span><span class="o">.</span><span class="n">InjectableConverter</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">only_member</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">converters</span> <span class="o">=</span> <span class="n">converters</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="n">default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_always_float</span> <span class="o">=</span> <span class="n">always_float</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_only_member</span> <span class="o">=</span> <span class="n">only_member</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">option_type</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">needs_injector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">converter</span><span class="o">.</span><span class="n">needs_injector</span> <span class="k">for</span> <span class="n">converter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">converters</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">converter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">converters</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">converter</span><span class="o">.</span><span class="n">callback</span><span class="p">,</span> <span class="n">conversion</span><span class="o">.</span><span class="n">BaseConverter</span><span class="p">):</span>
                <span class="n">converter</span><span class="o">.</span><span class="n">callback</span><span class="o">.</span><span class="n">check_client</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> slash command option&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">converters</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>

        <span class="n">exceptions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="ne">ValueError</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">converter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">converters</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">await</span> <span class="n">converter</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="n">exceptions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>

        <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">ConversionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Couldn&#39;t convert </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">exceptions</span><span class="p">)</span>


<span class="n">_CommandBuilderT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_CommandBuilderT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;_CommandBuilder&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_CommandBuilder</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">CommandBuilder</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_has_been_sorted&quot;</span><span class="p">,</span> <span class="s2">&quot;_sort_options&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">sort_options</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>  <span class="c1"># noqa: A002</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_sorted</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sort_options</span> <span class="o">=</span> <span class="n">sort_options</span>

    <span class="k">def</span> <span class="nf">add_option</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_CommandBuilderT</span><span class="p">,</span> <span class="n">option</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandOption</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_CommandBuilderT</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_sorted</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_CommandBuilderT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_CommandBuilderT</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sort_options</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_sorted</span><span class="p">:</span>
            <span class="n">required</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandOption</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">not_required</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandOption</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">is_required</span><span class="p">:</span>
                    <span class="n">required</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">not_required</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">required</span><span class="p">,</span> <span class="o">*</span><span class="n">not_required</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_sorted</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_CommandBuilder</span><span class="p">:</span>  <span class="c1"># TODO: can we just del _CommandBuilder.__copy__ to go back to the default?</span>
        <span class="n">builder</span> <span class="o">=</span> <span class="n">_CommandBuilder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sort_options</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">:</span>
            <span class="n">builder</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">builder</span>


<span class="k">class</span> <span class="nc">BaseSlashCommand</span><span class="p">(</span><span class="n">PartialCommand</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_command_id&quot;</span><span class="p">,</span> <span class="s2">&quot;_defaults_to_ephemeral&quot;</span><span class="p">,</span> <span class="s2">&quot;_description&quot;</span><span class="p">,</span> <span class="s2">&quot;_is_global&quot;</span><span class="p">,</span> <span class="s2">&quot;_name&quot;</span><span class="p">,</span> <span class="s2">&quot;_parent&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default_to_ephemeral</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_global</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">checks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">_stack</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_SCOMMAND_NAME_REG</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid command name provided, </span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s2"> doesn&#39;t match the required regex `^[a-z0-9_-]</span><span class="si">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">32</span><span class="si">}</span><span class="s2">$`&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">description</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The command description cannot be over 100 characters in length&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">command_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Passing command_id to the command initialiser is deprecated as of v2.1.1a1. &quot;</span>
                <span class="s2">&quot;Please pass the command IDs to Client.declare_global_commands or Client.declare_commands&quot;</span><span class="p">,</span>
                <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">,</span>
                <span class="n">stacklevel</span><span class="o">=</span><span class="n">_stack</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_command_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">command_id</span><span class="p">)</span> <span class="k">if</span> <span class="n">command_id</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="o">=</span> <span class="n">default_to_ephemeral</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_description</span> <span class="o">=</span> <span class="n">description</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_global</span> <span class="o">=</span> <span class="n">is_global</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">defaults_to_ephemeral</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_description</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_global</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_global</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tracked_command_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_command_id</span>

    <span class="k">def</span> <span class="nf">set_tracked_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_BaseSlashCommandT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_BaseSlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the the global command this should be tracking.</span>

<span class="sd">        .. deprecated:: v2.1.1a1</span>
<span class="sd">            Passing a command ID instead of instance here is deprecated.</span>
<span class="sd">            Please pass the command IDs to Client.declare_global_commands or Client.declare_commands instead.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : hikari.Command</span>
<span class="sd">            object of the global command this should be tracking.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This command instance for chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Passing a command ID instead of instance here is deprecated. &quot;</span>
                <span class="s2">&quot;Please pass the command IDs to Client.declare_global_commands or Client.declare_commands instead.&quot;</span><span class="p">,</span>
                <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">,</span>
                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_command_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_ephemeral_default</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_BaseSlashCommandT</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_BaseSlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set whether this command&#39;s responses should default to ephemeral.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        typing.Optional[bool]</span>
<span class="sd">            Whether this command&#39;s responses should default to ephemeral.</span>
<span class="sd">            This will be overridden by any response calls which specify flags.</span>

<span class="sd">            Setting this to `None` will let the default set on the parent</span>
<span class="sd">            command(s), component or client propagate and decide the ephemeral</span>
<span class="sd">            default for contexts used by this command.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This command to allow for chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_BaseSlashCommandT</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_BaseSlashCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">check_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.SlashCommand&gt;&gt;.</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">gather_checks</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">set_command</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_BaseSlashCommandT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_BaseSlashCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_into_component</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_BaseSlashCommandT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_BaseSlashCommandT</span><span class="p">]:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
            <span class="n">component</span><span class="o">.</span><span class="n">add_slash_command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>


<span class="k">class</span> <span class="nc">SlashCommandGroup</span><span class="p">(</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_commands&quot;</span><span class="p">,</span> <span class="s2">&quot;_default_permission&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default_to_ephemeral</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default_permission</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">is_global</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">checks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">_stack</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">command_id</span><span class="o">=</span><span class="n">command_id</span><span class="p">,</span>
            <span class="n">default_to_ephemeral</span><span class="o">=</span><span class="n">default_to_ephemeral</span><span class="p">,</span>
            <span class="n">is_global</span><span class="o">=</span><span class="n">is_global</span><span class="p">,</span>
            <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">,</span>
            <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">_stack</span><span class="o">=</span><span class="n">_stack</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_permission</span> <span class="o">=</span> <span class="n">default_permission</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.SlashCommandGroup&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">special_endpoints_api</span><span class="o">.</span><span class="n">CommandBuilder</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="n">builder</span> <span class="o">=</span> <span class="n">_CommandBuilder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_description</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">set_default_permission</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_permission</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_command_id</span><span class="p">:</span>
            <span class="n">builder</span><span class="o">.</span><span class="n">set_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_id</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">option_type</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">SUB_COMMAND_GROUP</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">)</span>
                <span class="k">else</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">SUB_COMMAND</span>
            <span class="p">)</span>
            <span class="n">command_builder</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
            <span class="n">builder</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span>
                <span class="n">hikari</span><span class="o">.</span><span class="n">CommandOption</span><span class="p">(</span>
                    <span class="nb">type</span><span class="o">=</span><span class="n">option_type</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="n">command_builder</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                    <span class="n">is_required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">options</span><span class="o">=</span><span class="n">command_builder</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">builder</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandGroupT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandGroupT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandGroupT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandGroupT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a slash command to this group.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            Command groups are only supported within top-level groups.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.BaseSlashCommand</span>
<span class="sd">            Command to add to this group.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            Object of this group to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot add a slash command group to a nested slash command group&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot add more than 25 commands to a slash command group&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Command with name </span><span class="si">{</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="si">!r}</span><span class="s2"> already exists in this group&quot;</span><span class="p">)</span>

        <span class="n">command</span><span class="o">.</span><span class="n">set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">command</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandGroupT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandGroupT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a command from this group.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.BaseSlashCommand</span>
<span class="sd">            Command to remove from this group.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            Object of this group to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a slash command to this group through a decorator call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.BaseSlashCommand</span>
<span class="sd">            Command to add to this group.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun.abc.BaseSlashCommand</span>
<span class="sd">            Command which was added to this group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">command</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">option</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteractionOption</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">option</span> <span class="ow">and</span> <span class="n">ctx</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">option</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">option</span> <span class="ow">and</span> <span class="n">option</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">option</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Missing sub-command option&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">command</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">defaults_to_ephemeral</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">set_ephemeral_default</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">defaults_to_ephemeral</span><span class="p">)</span>

            <span class="k">if</span> <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">option</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">load_into_component</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandGroupT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_SlashCommandGroupT</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">components</span><span class="o">.</span><span class="n">LoadableProtocol</span><span class="p">):</span>
                <span class="n">command</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">SlashCommand</span><span class="p">(</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashCommand</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">CommandCallbackSigT</span><span class="p">]):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_builder&quot;</span><span class="p">,</span> <span class="s2">&quot;_callback&quot;</span><span class="p">,</span> <span class="s2">&quot;_client&quot;</span><span class="p">,</span> <span class="s2">&quot;_tracked_options&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">CommandCallbackSigT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">checks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default_permission</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">default_to_ephemeral</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_global</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sort_options</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">_stack</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">,</span>
            <span class="n">command_id</span><span class="o">=</span><span class="n">command_id</span><span class="p">,</span>
            <span class="n">default_to_ephemeral</span><span class="o">=</span><span class="n">default_to_ephemeral</span><span class="p">,</span>
            <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">,</span>
            <span class="n">is_global</span><span class="o">=</span><span class="n">is_global</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">_stack</span><span class="o">=</span><span class="n">_stack</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_builder</span> <span class="o">=</span> <span class="n">_CommandBuilder</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">sort_options</span><span class="p">)</span><span class="o">.</span><span class="n">set_default_permission</span><span class="p">(</span><span class="n">default_permission</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_command_id</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_builder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_builder</span><span class="o">.</span><span class="n">set_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_id</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracked_options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">_TrackedOption</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
        <span class="fm">__call__</span><span class="p">:</span> <span class="n">CommandCallbackSigT</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandCallbackSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.SlashCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">CommandCallbackSigT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">needs_injector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">needs_injector</span>
            <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">needs_injector</span> <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracked_options</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="ow">or</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">needs_injector</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracked_options</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">option</span><span class="o">.</span><span class="n">check_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">special_endpoints_api</span><span class="o">.</span><span class="n">CommandBuilder</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_builder</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_add_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">type_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">STRING</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">always_float</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">channel_types</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
            <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="kc">None</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">only_member</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_SCOMMAND_NAME_REG</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid command option name provided, </span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s2"> doesn&#39;t match the required regex `^[a-z0-9_-]</span><span class="si">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">32</span><span class="si">}</span><span class="s2">$`&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">description</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The option description cannot be over 100 characters in length&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_builder</span><span class="o">.</span><span class="n">options</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Slash commands cannot have more than 25 options&quot;</span><span class="p">)</span>

        <span class="n">type_</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">converters</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">):</span>
            <span class="n">converters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">_convert_to_injectable</span><span class="p">,</span> <span class="n">converters</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">converters</span> <span class="o">=</span> <span class="p">[</span><span class="n">_convert_to_injectable</span><span class="p">(</span><span class="n">converters</span><span class="p">)]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">converter</span> <span class="ow">in</span> <span class="n">converters</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">converter</span><span class="o">.</span><span class="n">callback</span><span class="p">,</span> <span class="n">conversion</span><span class="o">.</span><span class="n">BaseConverter</span><span class="p">):</span>
                    <span class="n">converter</span><span class="o">.</span><span class="n">callback</span><span class="o">.</span><span class="n">check_client</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="si">}</span><span class="s2">&#39;s slash option &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">choices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actual_choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandChoice</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">choices</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
            <span class="n">actual_choices</span> <span class="o">=</span> <span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandChoice</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">choices</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Passing a sequence of tuples to `choices` is deprecated since 2.1.2a1, &quot;</span>
                <span class="s2">&quot;please pass a mapping instead.&quot;</span><span class="p">,</span>
                <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">,</span>
                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">_stack_level</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">actual_choices</span> <span class="o">=</span> <span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandChoice</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">choices</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">actual_choices</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">actual_choices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Slash command options cannot have more than 25 choices&quot;</span><span class="p">)</span>

        <span class="n">required</span> <span class="o">=</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">_UNDEFINED_DEFAULT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_builder</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">CommandOption</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="n">type_</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
                <span class="n">is_required</span><span class="o">=</span><span class="n">required</span><span class="p">,</span>
                <span class="n">choices</span><span class="o">=</span><span class="n">actual_choices</span><span class="p">,</span>
                <span class="n">channel_types</span><span class="o">=</span><span class="n">channel_types</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">pass_as_kwarg</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tracked_options</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">_TrackedOption</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">option_type</span><span class="o">=</span><span class="n">type_</span><span class="p">,</span>
                <span class="n">always_float</span><span class="o">=</span><span class="n">always_float</span><span class="p">,</span>
                <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
                <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
                <span class="n">only_member</span><span class="o">=</span><span class="n">only_member</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_str_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a string option to the slash command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            As a shorthand, `choices` also supports passing strings in place of</span>
<span class="sd">            tuples each string will be used as both the choice&#39;s name and value</span>
<span class="sd">            (with the name being capitalised).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        choices : typing.Union[collections.abc.Mapping[str, str], collections.abc.Sequence[str], None]</span>
<span class="sd">            The option&#39;s choices.</span>

<span class="sd">            This either a mapping of [option_name, option_value] where both option_name</span>
<span class="sd">            and option_value should be strings of up to 100 characters or a sequence</span>
<span class="sd">            of strings where the string will be used for both the choice&#39;s name and</span>
<span class="sd">            value.</span>
<span class="sd">        converters : typing.Union[collections.abc.Sequence[ConverterSig], ConverterSig]</span>
<span class="sd">            The option&#39;s converters.</span>

<span class="sd">            This may be either one or multiple `ConverterSig` callbacks used to</span>
<span class="sd">            convert the option&#39;s value to the final form.</span>
<span class="sd">            If no converters are provided then the raw value will be passed.</span>

<span class="sd">            Only the first converter to pass will be used.</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used and the `coverters` field will be ignored.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the option has more than 25 choices.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">choices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actual_choices</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">choices</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
            <span class="n">actual_choices</span> <span class="o">=</span> <span class="n">choices</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">actual_choices</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">warned</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">choices</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">warned</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                            <span class="s2">&quot;Passing a sequence of tuples for &#39;choices&#39; is deprecated since 2.1.2a1, &quot;</span>
                            <span class="s2">&quot;please pass a mapping instead.&quot;</span><span class="p">,</span>
                            <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">,</span>
                            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">_stack_level</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="n">warned</span> <span class="o">=</span> <span class="kc">True</span>

                    <span class="n">actual_choices</span><span class="p">[</span><span class="n">choice</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">choice</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">actual_choices</span><span class="p">[</span><span class="n">choice</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()]</span> <span class="o">=</span> <span class="n">choice</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">STRING</span><span class="p">,</span>
            <span class="n">choices</span><span class="o">=</span><span class="n">actual_choices</span><span class="p">,</span>
            <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
            <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_int_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add an integer option to the slash command.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        choices : typing.Optional[collections.abc.Mapping[str, int]]</span>
<span class="sd">            The option&#39;s choices.</span>

<span class="sd">            This is a mapping of [option_name, option_value] where option_name</span>
<span class="sd">            should be a string of up to 100 characters and option_value should</span>
<span class="sd">            be an integer.</span>
<span class="sd">        converters : typing.Union[collections.abc.Sequence[ConverterSig], ConverterSig, None]</span>
<span class="sd">            The option&#39;s converters.</span>

<span class="sd">            This may be either one or multiple `ConverterSig` callbacks used to</span>
<span class="sd">            convert the option&#39;s value to the final form.</span>
<span class="sd">            If no converters are provided then the raw value will be passed.</span>

<span class="sd">            Only the first converter to pass will be used.</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used and the `coverters` field will be ignored.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the option has more than 25 choices.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">INTEGER</span><span class="p">,</span>
            <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
            <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
            <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
            <span class="n">_stack_level</span><span class="o">=</span><span class="n">_stack_level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_float_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">always_float</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a float option to a slash command.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        always_float : bool</span>
<span class="sd">            If this is set to `True` then the value will always be converted to a</span>
<span class="sd">            float (this will happen before it&#39;s passed to converters).</span>

<span class="sd">            This masks behaviour from Discord where we will either be provided a `float`</span>
<span class="sd">            or `int` dependent on what the user provided and defaults to `True`.</span>
<span class="sd">        choices : typing.Optional[collections.abc.Mapping[str, float]]</span>
<span class="sd">            The option&#39;s choices.</span>

<span class="sd">            This is a mapping of [option_name, option_value] where option_name</span>
<span class="sd">            should be a string of up to 100 characters and option_value should</span>
<span class="sd">            be a float.</span>
<span class="sd">        converters : typing.Union[collections.abc.Sequence[ConverterSig], ConverterSig, None]</span>
<span class="sd">            The option&#39;s converters.</span>

<span class="sd">            This may be either one or multiple `ConverterSig` callbacks used to</span>
<span class="sd">            convert the option&#39;s value to the final form.</span>
<span class="sd">            If no converters are provided then the raw value will be passed.</span>

<span class="sd">            Only the first converter to pass will be used.</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used and the fields `coverters`, and `always_float` will be</span>
<span class="sd">            ignored.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the option has more than 25 choices.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span>
            <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
            <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
            <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
            <span class="n">always_float</span><span class="o">=</span><span class="n">always_float</span><span class="p">,</span>
            <span class="n">_stack_level</span><span class="o">=</span><span class="n">_stack_level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_bool_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a boolean option to a slash command.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">BOOLEAN</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_user_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a user option to a slash command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This may result in `hikari.InteractionMember` or</span>
<span class="sd">            `hikari.users.User` if the user isn&#39;t in the current guild or if this</span>
<span class="sd">            command was executed in a DM channel.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the option has more than 25 choices.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_member_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a member option to a slash command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will always result in `hikari.InteractionMember`.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            Unlike the other options, this is an artificial option which adds</span>
<span class="sd">            a restraint to the USER option type and therefore cannot have</span>
<span class="sd">            `pass_as_kwarg` set to `False` as this artificial constaint isn&#39;t</span>
<span class="sd">            present when its not being passed as a keyword argument.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">only_member</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_channel_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">types</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialChannel</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a channel option to a slash command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will always result in `hikari.InteractionChannel`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        types : typing.Optional[collections.abc.Collection[type[hikari.PartialChannel]]]</span>
<span class="sd">            A collection of the channel classes this option should accept.</span>

<span class="sd">            If left as `None` or empty then the option will allow all channel types.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">            * If an invalid type is passed in `types`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">itertools</span>

        <span class="k">if</span> <span class="n">types</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">channel_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">_channel_types</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">,</span> <span class="n">types</span><span class="p">))))</span>

            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown channel type </span><span class="si">{</span><span class="n">exc</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">channel_types</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">CHANNEL</span><span class="p">,</span>
            <span class="n">channel_types</span><span class="o">=</span><span class="n">channel_types</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
            <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_role_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a role option to a slash command.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">ROLE</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_mentionable_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a mentionable option to a slash command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This may target roles, guild members or users and results in</span>
<span class="sd">            `Union[hikari.User, hikari.InteractionMember, hikari.Role]`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_process_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="n">keyword_args</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionChannel</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">tracked_option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracked_options</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">option</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tracked_option</span><span class="o">.</span><span class="n">name</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>  <span class="c1"># TODO: ConversionError?</span>
                        <span class="sa">f</span><span class="s2">&quot;Required option </span><span class="si">{</span><span class="n">tracked_option</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is missing data, are you sure your commands&quot;</span>
                        <span class="s2">&quot; are up to date?&quot;</span>
                    <span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">keyword_args</span><span class="p">[</span><span class="n">tracked_option</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">default</span>

            <span class="k">elif</span> <span class="n">option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">:</span>
                <span class="n">member</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">is_only_member</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">member</span> <span class="o">:=</span> <span class="n">option</span><span class="o">.</span><span class="n">resolve_to_member</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)):</span>
                    <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">ConversionError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Couldn&#39;t find member for provided user: </span><span class="si">{</span><span class="n">option</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">name</span>
                    <span class="p">)</span>

                <span class="n">keyword_args</span><span class="p">[</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">member</span> <span class="ow">or</span> <span class="n">option</span><span class="o">.</span><span class="n">resolve_to_user</span><span class="p">()</span>

            <span class="k">elif</span> <span class="n">option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">CHANNEL</span><span class="p">:</span>
                <span class="n">keyword_args</span><span class="p">[</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">resolve_to_channel</span><span class="p">()</span>

            <span class="k">elif</span> <span class="n">option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">ROLE</span><span class="p">:</span>
                <span class="n">keyword_args</span><span class="p">[</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">resolve_to_role</span><span class="p">()</span>

            <span class="k">elif</span> <span class="n">option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">ROLE</span><span class="p">:</span>
                    <span class="n">keyword_args</span><span class="p">[</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">resolve_to_role</span><span class="p">()</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">member</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">if</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">is_only_member</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">member</span> <span class="o">:=</span> <span class="n">option</span><span class="o">.</span><span class="n">resolve_to_member</span><span class="p">()):</span>
                        <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">ConversionError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Couldn&#39;t find member for provided user: </span><span class="si">{</span><span class="n">option</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">name</span>
                        <span class="p">)</span>

                    <span class="n">keyword_args</span><span class="p">[</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">member</span> <span class="ow">or</span> <span class="n">option</span><span class="o">.</span><span class="n">resolve_to_mentionable</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">value</span>
                <span class="c1"># To be type safe we obfuscate the fact that discord&#39;s double type will provide am int or float</span>
                <span class="c1"># depending on the value Disocrd input by always casting to float.</span>
                <span class="k">if</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">FLOAT</span> <span class="ow">and</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">is_always_float</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">converters</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="k">await</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">option</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

                <span class="n">keyword_args</span><span class="p">[</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">return</span> <span class="n">keyword_args</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">option</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteractionOption</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">own_hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="ow">or</span> <span class="n">_EMPTY_HOOKS</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_pre_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracked_options</span><span class="p">:</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_args</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="n">_EMPTY_DICT</span>

            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="c1"># Unlike a message command, this won&#39;t necessarily reach the client level try except</span>
            <span class="c1"># block so we have to handle this here.</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_error</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_success</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_post_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_into_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_SlashCommandT</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">callback</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Callback is already a method type&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">callback</span><span class="p">,</span> <span class="n">component</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
            <span class="n">component</span><span class="o">.</span><span class="n">add_slash_command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>


<span class="k">def</span> <span class="nf">as_message_command</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandCallbackSigT</span><span class="p">],</span> <span class="n">MessageCommand</span><span class="p">[</span><span class="n">CommandCallbackSigT</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Build a message command from a decorated callback.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The command name.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    names : str</span>
<span class="sd">        Variable positional arguments of other names for the command.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[CommandCallbackSigT], MessageCommand[CommandCallbackSigT]]</span>
<span class="sd">        Decorator callback used to build a MessageCommand` from the decorated callback.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">callback</span><span class="p">:</span> <span class="n">MessageCommand</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">as_message_command_group</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandCallbackSigT</span><span class="p">],</span> <span class="n">MessageCommandGroup</span><span class="p">[</span><span class="n">CommandCallbackSigT</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Build a message command group from a decorated callback.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The command name.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    names : str</span>
<span class="sd">        Variable positional arguments of other names for the command.</span>
<span class="sd">    strict : bool</span>
<span class="sd">        Whether this command group should only allow commands without spaces in their names.</span>

<span class="sd">        This allows for a more optimised command search pattern to be used and</span>
<span class="sd">        enforces that command names are unique to a single command within the group.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[CommandCallbackSigT], MessageCommandGroup[CommandCallbackSigT]]</span>
<span class="sd">        Decorator callback used to build a `MessageCommandGroup` from the decorated callback.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">callback</span><span class="p">:</span> <span class="n">MessageCommandGroup</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="n">strict</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MessageCommand</span><span class="p">(</span><span class="n">PartialCommand</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">CommandCallbackSigT</span><span class="p">]):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_callback&quot;</span><span class="p">,</span> <span class="s2">&quot;_names&quot;</span><span class="p">,</span> <span class="s2">&quot;_parent&quot;</span><span class="p">,</span> <span class="s2">&quot;_parser&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">CommandCallbackSigT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">checks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">parser</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">parsing</span><span class="o">.</span><span class="n">AbstractParser</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="o">=</span> <span class="n">parser</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Command &lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="si">}</span><span class="s2">&gt;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandCallbackSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">CommandCallbackSigT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">needs_injector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">needs_injector</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandGroup</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">parser</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">parsing</span><span class="o">.</span><span class="n">AbstractParser</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span>

    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandGroup</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="n">parser</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">parsing</span><span class="o">.</span><span class="n">AbstractParser</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="o">=</span> <span class="n">parser</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">check_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">gather_checks</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">set_command</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">own_hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="ow">or</span> <span class="n">_EMPTY_HOOKS</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_pre_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span> <span class="o">=</span> <span class="n">_EMPTY_LIST</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="n">_EMPTY_DICT</span>

            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">exc</span><span class="o">.</span><span class="n">message</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2000</span> <span class="k">else</span> <span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">[:</span><span class="mi">1997</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_error</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># TODO: how should this be handled around CommandError?</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_success</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_post_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_into_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_MessageCommandT</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Callback is already a method type&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">callback</span><span class="p">,</span> <span class="n">component</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
            <span class="n">component</span><span class="o">.</span><span class="n">add_message_command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>


<span class="k">class</span> <span class="nc">MessageCommandGroup</span><span class="p">(</span><span class="n">MessageCommand</span><span class="p">[</span><span class="n">CommandCallbackSigT</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandGroup</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_commands&quot;</span><span class="p">,</span> <span class="s2">&quot;_is_strict&quot;</span><span class="p">,</span> <span class="s2">&quot;_names_to_commands&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">CommandCallbackSigT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">checks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">parser</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">parsing</span><span class="o">.</span><span class="n">AbstractParser</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">parser</span><span class="o">=</span><span class="n">parser</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span> <span class="o">=</span> <span class="n">strict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;CommandGroup &lt;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="si">}</span><span class="s2">&gt;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommandGroup&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_strict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandGroupT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="n">commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">command</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">commands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">commands</span><span class="p">[</span><span class="n">command</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandGroupT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a command to this group.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : MessageCommand</span>
<span class="sd">            The command to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The group instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If one of the command&#39;s names is already registered in a strict</span>
<span class="sd">            command group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sub-command names may not contain spaces in a strict message command group&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">name_conflicts</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Sub-command names must be unique in a strict message command group. &quot;</span>
                    <span class="s2">&quot;The following conflicts were found &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_conflicts</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>

        <span class="n">command</span><span class="o">.</span><span class="n">set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandGroupT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommandGroup&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="n">command</span><span class="p">:</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="n">command</span><span class="o">.</span><span class="n">set_parent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">AnyMessageCommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnyMessageCommandT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">command</span>

    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandGroupT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandGroupT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">find_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">command</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">:=</span> <span class="n">utilities</span><span class="o">.</span><span class="n">match_prefix_names</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot execute a command with a content-less message&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hooks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hooks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

            <span class="n">hooks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_command</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>
            <span class="k">if</span> <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="n">content</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="p">:]</span>
                <span class="n">lstripped_content</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                <span class="n">space_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">lstripped_content</span><span class="p">)</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">set_triggering_name</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">triggering_name</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">space_len</span><span class="p">)</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="n">lstripped_content</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="k">await</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_into_component</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_MessageCommandGroupT</span><span class="p">]:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">components</span><span class="o">.</span><span class="n">LoadableProtocol</span><span class="p">):</span>
                <span class="n">command</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Standard implementation of Tanjun's command objects.</p>
</div>


                </section>
                <section id="as_message_command">
                            <div class="attr function"><a class="headerlink" href="#as_message_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">as_message_command</span><span class="signature">(
    name: str,
    /,
    *names: str
) -&gt; collections.abc.Callable[[~CommandCallbackSigT], <a href="tanjun/commands.html#MessageCommand">tanjun.commands.MessageCommand</a>[~CommandCallbackSigT]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">as_message_command</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandCallbackSigT</span><span class="p">],</span> <span class="n">MessageCommand</span><span class="p">[</span><span class="n">CommandCallbackSigT</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Build a message command from a decorated callback.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The command name.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    names : str</span>
<span class="sd">        Variable positional arguments of other names for the command.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[CommandCallbackSigT], MessageCommand[CommandCallbackSigT]]</span>
<span class="sd">        Decorator callback used to build a MessageCommand` from the decorated callback.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">callback</span><span class="p">:</span> <span class="n">MessageCommand</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Build a message command from a decorated callback.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The command name.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>names</strong> (str):
Variable positional arguments of other names for the command.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[CommandCallbackSigT], MessageCommand[CommandCallbackSigT]]</strong>: Decorator callback used to build a MessageCommand` from the decorated callback.</li>
</ul>
</div>


                </section>
                <section id="as_message_command_group">
                            <div class="attr function"><a class="headerlink" href="#as_message_command_group">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">as_message_command_group</span><span class="signature">(
    name: str,
    /,
    *names: str,
    strict: bool = False
) -&gt; collections.abc.Callable[[~CommandCallbackSigT], <a href="tanjun/commands.html#MessageCommandGroup">tanjun.commands.MessageCommandGroup</a>[~CommandCallbackSigT]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">as_message_command_group</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandCallbackSigT</span><span class="p">],</span> <span class="n">MessageCommandGroup</span><span class="p">[</span><span class="n">CommandCallbackSigT</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Build a message command group from a decorated callback.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The command name.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    names : str</span>
<span class="sd">        Variable positional arguments of other names for the command.</span>
<span class="sd">    strict : bool</span>
<span class="sd">        Whether this command group should only allow commands without spaces in their names.</span>

<span class="sd">        This allows for a more optimised command search pattern to be used and</span>
<span class="sd">        enforces that command names are unique to a single command within the group.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[CommandCallbackSigT], MessageCommandGroup[CommandCallbackSigT]]</span>
<span class="sd">        Decorator callback used to build a `MessageCommandGroup` from the decorated callback.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">callback</span><span class="p">:</span> <span class="n">MessageCommandGroup</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="n">strict</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Build a message command group from a decorated callback.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The command name.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>names</strong> (str):
Variable positional arguments of other names for the command.</li>
<li><p><strong>strict</strong> (bool):
Whether this command group should only allow commands without spaces in their names.</p>

<p>This allows for a more optimised command search pattern to be used and
enforces that command names are unique to a single command within the group.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[CommandCallbackSigT], MessageCommandGroup[CommandCallbackSigT]]</strong>: Decorator callback used to build a <code><a href="#MessageCommandGroup">MessageCommandGroup</a></code> from the decorated callback.</li>
</ul>
</div>


                </section>
                <section id="as_slash_command">
                            <div class="attr function"><a class="headerlink" href="#as_slash_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">as_slash_command</span><span class="signature">(
    name: str,
    description: str,
    /,
    *,
    command_id: Union[hikari.commands.Command, hikari.snowflakes.Snowflake, int, NoneType] = None,
    default_permission: bool = True,
    default_to_ephemeral: Optional[bool] = None,
    is_global: bool = True,
    sort_options: bool = True
) -&gt; collections.abc.Callable[[~CommandCallbackSigT], <a href="tanjun/commands.html#SlashCommand">tanjun.commands.SlashCommand</a>[~CommandCallbackSigT]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">as_slash_command</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">default_permission</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">default_to_ephemeral</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_global</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">sort_options</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandCallbackSigT</span><span class="p">],</span> <span class="n">SlashCommand</span><span class="p">[</span><span class="n">CommandCallbackSigT</span><span class="p">]]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Build a `SlashCommand` by decorating a function.</span>

<span class="sd">    .. note::</span>
<span class="sd">        Under the standard implementation, `is_global` is used to determine whether</span>
<span class="sd">        the command should be bulk set by `tanjun.Client.set_global_commands`</span>
<span class="sd">        or when `set_global_commands` is True</span>

<span class="sd">    .. warning::</span>
<span class="sd">        `command_id`, `default_permission` and `is_global` are ignored for commands</span>
<span class="sd">        within slash command groups.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @as_slash_command(&quot;ping&quot;, &quot;Get the bot&#39;s latency&quot;)</span>
<span class="sd">    async def ping_command(self, ctx: tanjun.abc.SlashContext) -&gt; None:</span>
<span class="sd">        start_time = time.perf_counter()</span>
<span class="sd">        await ctx.rest.fetch_my_user()</span>
<span class="sd">        time_taken = (time.perf_counter() - start_time) * 1_000</span>
<span class="sd">        await ctx.respond(f&quot;PONG\n - REST: {time_taken:.0f}mss&quot;)</span>
<span class="sd">    ```</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The command&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">    description : str</span>
<span class="sd">        The command&#39;s description.</span>
<span class="sd">        This should be inclusively between 1-100 characters in length.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    command_id : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.Command]]</span>
<span class="sd">        ID of the global command this should be tracking.</span>

<span class="sd">        This is useful when bulk updating the commands as if the ID isn&#39;t</span>
<span class="sd">        specified then any previously set permissions may be lost (i.e. if the</span>
<span class="sd">        command&#39;s name is changed).</span>
<span class="sd">    default_permission : bool</span>
<span class="sd">        Whether this command can be accessed without set permissions.</span>

<span class="sd">        Defaults to `True`, meaning that users can access the command by default.</span>
<span class="sd">    default_to_ephemeral : typing.Optional[bool]</span>
<span class="sd">        Whether this command&#39;s responses should default to ephemeral unless flags</span>
<span class="sd">        are set to override this.</span>

<span class="sd">        If this is left as `None` then the default set on the parent command(s),</span>
<span class="sd">        component or client will be in effect.</span>
<span class="sd">    is_global : bool</span>
<span class="sd">        Whether this command is a global command. Defaults to `True`.</span>
<span class="sd">    sort_options : bool</span>
<span class="sd">        Whether this command should sort its set options based on whether</span>
<span class="sd">        they&#39;re required.</span>

<span class="sd">        If this is `True` then the options are re-sorted to meet the requirement</span>
<span class="sd">        from Discord that required command options be listed before optional</span>
<span class="sd">        ones.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[CommandCallbackSigT], SlashCommand[CommandCallbackSigT]]</span>
<span class="sd">        The decorator callback used to build the command to a `SlashCommand`.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raises a value error for any of the following reasons:</span>
<span class="sd">        * If the command name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        * If the description is over 100 characters long.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">SlashCommand</span><span class="p">(</span>
        <span class="n">c</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">description</span><span class="p">,</span>
        <span class="n">command_id</span><span class="o">=</span><span class="n">command_id</span><span class="p">,</span>
        <span class="n">default_permission</span><span class="o">=</span><span class="n">default_permission</span><span class="p">,</span>
        <span class="n">default_to_ephemeral</span><span class="o">=</span><span class="n">default_to_ephemeral</span><span class="p">,</span>
        <span class="n">is_global</span><span class="o">=</span><span class="n">is_global</span><span class="p">,</span>
        <span class="n">sort_options</span><span class="o">=</span><span class="n">sort_options</span><span class="p">,</span>
        <span class="n">_stack</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Build a <code><a href="#SlashCommand">SlashCommand</a></code> by decorating a function.</p>

<p><em>Note:</em>
Under the standard implementation, <code>is_global</code> is used to determine whether
the command should be bulk set by <code><a href="#Client.set_global_commands">tanjun.Client.set_global_commands</a></code>
or when <code>set_global_commands</code> is True</p>

<p><em>Warning:</em>
<code>command_id</code>, <code>default_permission</code> and <code>is_global</code> are ignored for commands
within slash command groups.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="nd">@as_slash_command</span><span class="p">(</span><span class="s2">&quot;ping&quot;</span><span class="p">,</span> <span class="s2">&quot;Get the bot&#39;s latency&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">ping_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_my_user</span><span class="p">()</span>
    <span class="n">time_taken</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1_000</span>
    <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PONG</span><span class="se">\n</span><span class="s2"> - REST: </span><span class="si">{</span><span class="n">time_taken</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">mss&quot;</span><span class="p">)</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The command's name. This should match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li><strong>description</strong> (str):
The command's description.
This should be inclusively between 1-100 characters in length.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>command_id</strong> (typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.Command]]):
ID of the global command this should be tracking.</p>

<p>This is useful when bulk updating the commands as if the ID isn't
specified then any previously set permissions may be lost (i.e. if the
command's name is changed).</p></li>
<li><p><strong>default_permission</strong> (bool):
Whether this command can be accessed without set permissions.</p>

<p>Defaults to <code>True</code>, meaning that users can access the command by default.</p></li>
<li><p><strong>default_to_ephemeral</strong> (typing.Optional[bool]):
Whether this command's responses should default to ephemeral unless flags
are set to override this.</p>

<p>If this is left as <code>None</code> then the default set on the parent command(s),
component or client will be in effect.</p></li>
<li><strong>is_global</strong> (bool):
Whether this command is a global command. Defaults to <code>True</code>.</li>
<li><p><strong>sort_options</strong> (bool):
Whether this command should sort its set options based on whether
they're required.</p>

<p>If this is <code>True</code> then the options are re-sorted to meet the requirement
from Discord that required command options be listed before optional
ones.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[CommandCallbackSigT], SlashCommand[CommandCallbackSigT]]</strong>: The decorator callback used to build the command to a <code><a href="#SlashCommand">SlashCommand</a></code>.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: Raises a value error for any of the following reasons:
<ul>
<li>If the command name doesn't match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li>If the description is over 100 characters long.</li>
</ul></li>
</ul>
</div>


                </section>
                <section id="slash_command_group">
                            <div class="attr function"><a class="headerlink" href="#slash_command_group">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">slash_command_group</span><span class="signature">(
    name: str,
    description: str,
    /,
    *,
    command_id: Union[hikari.commands.Command, hikari.snowflakes.Snowflake, int, NoneType] = None,
    default_permission: bool = True,
    default_to_ephemeral: Optional[bool] = None,
    is_global: bool = True
) -&gt; <a href="tanjun/commands.html#SlashCommandGroup">tanjun.commands.SlashCommandGroup</a></span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">slash_command_group</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">default_permission</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">default_to_ephemeral</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_global</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SlashCommandGroup</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Create a slash command group.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Sub-commands can be added to the created slash command object through</span>
<span class="sd">    the following decorator based approach:</span>
<span class="sd">    ```python</span>
<span class="sd">    help_group = tanjun.slash_command_group(&quot;help&quot;, &quot;get help&quot;)</span>

<span class="sd">    @help_group.with_command</span>
<span class="sd">    @tanjun.with_str_slash_option(&quot;commad_name&quot;, &quot;command name&quot;)</span>
<span class="sd">    @tanjun.as_slash_command(&quot;command&quot;, &quot;Get help with a command&quot;)</span>
<span class="sd">    async def help_command_command(ctx: tanjun.abc.SlashContext, command_name: str) -&gt; None:</span>
<span class="sd">        ...</span>

<span class="sd">    @help_group.with_command</span>
<span class="sd">    @tanjun.as_slash_command(&quot;me&quot;, &quot;help me&quot;)</span>
<span class="sd">    async def help_me_command(ctx: tanjun.abc.SlashContext) -&gt; None:</span>
<span class="sd">        ...</span>

<span class="sd">    component = tanjun.Component().add_slash_command_command(help_group)</span>
<span class="sd">    ```</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * Unlike message command grups, slash command groups cannot</span>
<span class="sd">      be callable functions themselves.</span>
<span class="sd">    * Under the standard implementation, `is_global` is used to determine whether</span>
<span class="sd">      the command should be bulk set by `tanjun.Client.set_global_commands`</span>
<span class="sd">      or when `set_global_commands` is True</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the command group.</span>
<span class="sd">    description : str</span>
<span class="sd">        The description of the command group.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    command_id : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.Command]]</span>
<span class="sd">        Object or ID of the command the group tracks.</span>

<span class="sd">        This is useful when bulk updating the commands as if the ID isn&#39;t</span>
<span class="sd">        specified then any previously set permissions may be lost (i.e. if the</span>
<span class="sd">        command&#39;s name is changed).</span>
<span class="sd">    default_permission : bool</span>
<span class="sd">        Whether this command can be accessed without set permissions.</span>

<span class="sd">        Defaults to `True`, meaning that users can access the command by default.</span>
<span class="sd">    default_to_ephemeral : typing.Optional[bool]</span>
<span class="sd">        Whether this command&#39;s responses should default to ephemeral unless flags</span>
<span class="sd">        are set to override this.</span>

<span class="sd">        If this is left as `None` then the default set on the parent command(s),</span>
<span class="sd">        component or client will be in effect.</span>
<span class="sd">    is_global : bool</span>
<span class="sd">        Whether this command is a global command. Defaults to `True`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SlashCommandGroup</span>
<span class="sd">        The command group.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raises a value error for any of the following reasons:</span>
<span class="sd">        * If the command name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        * If the description is over 100 characters long.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">SlashCommandGroup</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">description</span><span class="p">,</span>
        <span class="n">command_id</span><span class="o">=</span><span class="n">command_id</span><span class="p">,</span>
        <span class="n">default_permission</span><span class="o">=</span><span class="n">default_permission</span><span class="p">,</span>
        <span class="n">default_to_ephemeral</span><span class="o">=</span><span class="n">default_to_ephemeral</span><span class="p">,</span>
        <span class="n">is_global</span><span class="o">=</span><span class="n">is_global</span><span class="p">,</span>
        <span class="n">_stack</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Create a slash command group.</p>

<h6 id="examples">Examples</h6>

<p>Sub-commands can be added to the created slash command object through
the following decorator based approach:</p>

<div class="codehilite"><pre><span></span><code><span class="n">help_group</span> <span class="o">=</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">slash_command_group</span><span class="p">(</span><span class="s2">&quot;help&quot;</span><span class="p">,</span> <span class="s2">&quot;get help&quot;</span><span class="p">)</span>

<span class="nd">@help_group</span><span class="o">.</span><span class="n">with_command</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">with_str_slash_option</span><span class="p">(</span><span class="s2">&quot;commad_name&quot;</span><span class="p">,</span> <span class="s2">&quot;command name&quot;</span><span class="p">)</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">as_slash_command</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="s2">&quot;Get help with a command&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">help_command_command</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="n">command_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>

<span class="nd">@help_group</span><span class="o">.</span><span class="n">with_command</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">as_slash_command</span><span class="p">(</span><span class="s2">&quot;me&quot;</span><span class="p">,</span> <span class="s2">&quot;help me&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">help_me_command</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>

<span class="n">component</span> <span class="o">=</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">Component</span><span class="p">()</span><span class="o">.</span><span class="n">add_slash_command_command</span><span class="p">(</span><span class="n">help_group</span><span class="p">)</span>
</code></pre></div>

<h6 id="notes">Notes</h6>

<ul>
<li>Unlike message command grups, slash command groups cannot
be callable functions themselves.</li>
<li>Under the standard implementation, <code>is_global</code> is used to determine whether
the command should be bulk set by <code><a href="#Client.set_global_commands">tanjun.Client.set_global_commands</a></code>
or when <code>set_global_commands</code> is True</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the command group.</li>
<li><strong>description</strong> (str):
The description of the command group.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>command_id</strong> (typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.Command]]):
Object or ID of the command the group tracks.</p>

<p>This is useful when bulk updating the commands as if the ID isn't
specified then any previously set permissions may be lost (i.e. if the
command's name is changed).</p></li>
<li><p><strong>default_permission</strong> (bool):
Whether this command can be accessed without set permissions.</p>

<p>Defaults to <code>True</code>, meaning that users can access the command by default.</p></li>
<li><p><strong>default_to_ephemeral</strong> (typing.Optional[bool]):
Whether this command's responses should default to ephemeral unless flags
are set to override this.</p>

<p>If this is left as <code>None</code> then the default set on the parent command(s),
component or client will be in effect.</p></li>
<li><strong>is_global</strong> (bool):
Whether this command is a global command. Defaults to <code>True</code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>SlashCommandGroup</strong>: The command group.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: Raises a value error for any of the following reasons:
<ul>
<li>If the command name doesn't match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li>If the description is over 100 characters long.</li>
</ul></li>
</ul>
</div>


                </section>
                <section id="MessageCommand">
                                <div class="attr class">
        <a class="headerlink" href="#MessageCommand">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">MessageCommand</span><wbr>(<span class="base"><a href="tanjun/commands.html#PartialCommand">tanjun.commands.PartialCommand[tanjun.abc.MessageContext]</a></span>, <span class="base"><a href="tanjun/abc.html#MessageCommand">tanjun.abc.MessageCommand</a></span>, <span class="base">typing.Generic[~CommandCallbackSigT]</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MessageCommand</span><span class="p">(</span><span class="n">PartialCommand</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">CommandCallbackSigT</span><span class="p">]):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_callback&quot;</span><span class="p">,</span> <span class="s2">&quot;_names&quot;</span><span class="p">,</span> <span class="s2">&quot;_parent&quot;</span><span class="p">,</span> <span class="s2">&quot;_parser&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">CommandCallbackSigT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">checks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">parser</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">parsing</span><span class="o">.</span><span class="n">AbstractParser</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="o">=</span> <span class="n">parser</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Command &lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="si">}</span><span class="s2">&gt;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandCallbackSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">CommandCallbackSigT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">needs_injector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">needs_injector</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandGroup</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">parser</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">parsing</span><span class="o">.</span><span class="n">AbstractParser</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span>

    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandGroup</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="n">parser</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">parsing</span><span class="o">.</span><span class="n">AbstractParser</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="o">=</span> <span class="n">parser</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">check_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">gather_checks</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">set_command</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">own_hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="ow">or</span> <span class="n">_EMPTY_HOOKS</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_pre_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span> <span class="o">=</span> <span class="n">_EMPTY_LIST</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="n">_EMPTY_DICT</span>

            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">exc</span><span class="o">.</span><span class="n">message</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2000</span> <span class="k">else</span> <span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">[:</span><span class="mi">1997</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_error</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># TODO: how should this be handled around CommandError?</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_success</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_post_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_into_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_MessageCommandT</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Callback is already a method type&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">callback</span><span class="p">,</span> <span class="n">component</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
            <span class="n">component</span><span class="o">.</span><span class="n">add_message_command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Base class for the standard ExecutableCommand implementations.</p>
</div>


                            <div id="MessageCommand.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommand.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">MessageCommand</span><span class="signature">(
    callback: ~CommandCallbackSigT,
    name: str,
    /,
    *names: str,
    checks: Optional[collections.abc.Iterable[collections.abc.Callable[..., Union[bool, collections.abc.Awaitable[bool]]]]] = None,
    hooks: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a>]] = None,
    metadata: Optional[collections.abc.MutableMapping[Any, Any]] = None,
    parser: Optional[<a href="tanjun/parsing.html#AbstractParser">tanjun.parsing.AbstractParser</a>] = None
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">CommandCallbackSigT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">checks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">parser</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">parsing</span><span class="o">.</span><span class="n">AbstractParser</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="o">=</span> <span class="n">parser</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MessageCommand.callback" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageCommand.callback">#&nbsp;&nbsp</a>

        <span class="name">callback</span><span class="annotation">: ~CommandCallbackSigT</span>
    </div>

            <div class="docstring"><p>Callback which is called during execution.</p>

<p><em>Note:</em>
For command groups, this is called when none of the inner-commands
matches the message.</p>
</div>


                            </div>
                            <div id="MessageCommand.names" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageCommand.names">#&nbsp;&nbsp</a>

        <span class="name">names</span><span class="annotation">: collections.abc.Collection[str]</span>
    </div>

            <div class="docstring"><p>Collection of this command's names.</p>
</div>


                            </div>
                            <div id="MessageCommand.needs_injector" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageCommand.needs_injector">#&nbsp;&nbsp</a>

        <span class="name">needs_injector</span><span class="annotation">: bool</span>
    </div>

    

                            </div>
                            <div id="MessageCommand.parent" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageCommand.parent">#&nbsp;&nbsp</a>

        <span class="name">parent</span><span class="annotation">: Optional[<a href="tanjun/abc.html#MessageCommandGroup">tanjun.abc.MessageCommandGroup</a>]</span>
    </div>

            <div class="docstring"><p>Parent group of this command if it's onwned by a group.</p>
</div>


                            </div>
                            <div id="MessageCommand.parser" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageCommand.parser">#&nbsp;&nbsp</a>

        <span class="name">parser</span><span class="annotation">: Optional[<a href="tanjun/parsing.html#AbstractParser">tanjun.parsing.AbstractParser</a>]</span>
    </div>

    

                            </div>
                            <div id="MessageCommand.bind_client" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommand.bind_client">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">bind_client</span><span class="signature">(
    self: ~_MessageCommandT,
    client: <a href="tanjun/abc.html#Client">tanjun.abc.Client</a>,
    /
) -&gt; ~_MessageCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MessageCommand.bind_component" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommand.bind_component">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">bind_component</span><span class="signature">(
    self: ~_MessageCommandT,
    component: <a href="tanjun/abc.html#Component">tanjun.abc.Component</a>,
    /
) -&gt; ~_MessageCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MessageCommand.copy" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommand.copy">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">copy</span><span class="signature">(
    self: ~_MessageCommandT,
    *,
    parent: Optional[<a href="tanjun/abc.html#MessageCommandGroup">tanjun.abc.MessageCommandGroup</a>] = None,
    _new: bool = True
) -&gt; ~_MessageCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Create a copy of this command.</p>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>parent</strong> (typing.Optional[MessageCommandGroup]):
The parent of the copy.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The copy.</li>
</ul>
</div>


                            </div>
                            <div id="MessageCommand.set_parent" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommand.set_parent">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_parent</span><span class="signature">(
    self: ~_MessageCommandT,
    parent: Optional[<a href="tanjun/abc.html#MessageCommandGroup">tanjun.abc.MessageCommandGroup</a>],
    /
) -&gt; ~_MessageCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandGroup</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the parent of this command.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>parent</strong> (typing.Optional[MessageCommandGroup]):
The parent of this command.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The command instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="MessageCommand.set_parser" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommand.set_parser">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_parser</span><span class="signature">(
    self: ~_MessageCommandT,
    parser: Optional[<a href="tanjun/parsing.html#AbstractParser">tanjun.parsing.AbstractParser</a>],
    /
) -&gt; ~_MessageCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="n">parser</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">parsing</span><span class="o">.</span><span class="n">AbstractParser</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="o">=</span> <span class="n">parser</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MessageCommand.check_context" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommand.check_context">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">check_context</span><span class="signature">(self, ctx: <a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a>, /) -&gt; bool</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">check_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">gather_checks</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">set_command</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MessageCommand.execute" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommand.execute">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">execute</span><span class="signature">(
    self,
    ctx: <a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a>,
    /,
    *,
    hooks: Optional[collections.abc.MutableSet[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a>]]] = None
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">own_hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="ow">or</span> <span class="n">_EMPTY_HOOKS</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_pre_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span> <span class="o">=</span> <span class="n">_EMPTY_LIST</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="n">_EMPTY_DICT</span>

            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">exc</span><span class="o">.</span><span class="n">message</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2000</span> <span class="k">else</span> <span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">[:</span><span class="mi">1997</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_error</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># TODO: how should this be handled around CommandError?</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_success</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_post_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MessageCommand.load_into_component" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommand.load_into_component">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">load_into_component</span><span class="signature">(
    self: ~_MessageCommandT,
    component: <a href="tanjun/abc.html#Component">tanjun.abc.Component</a>,
    /
) -&gt; Optional[~_MessageCommandT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">load_into_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_MessageCommandT</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Callback is already a method type&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">callback</span><span class="p">,</span> <span class="n">component</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
            <span class="n">component</span><span class="o">.</span><span class="n">add_message_command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="tanjun/commands.html#PartialCommand">tanjun.commands.PartialCommand</a></dt>
                                <dd id="MessageCommand.checks" class="variable"><a href="tanjun/commands.html#PartialCommand.checks">checks</a></dd>
                <dd id="MessageCommand.component" class="variable"><a href="tanjun/commands.html#PartialCommand.component">component</a></dd>
                <dd id="MessageCommand.hooks" class="variable"><a href="tanjun/commands.html#PartialCommand.hooks">hooks</a></dd>
                <dd id="MessageCommand.metadata" class="variable"><a href="tanjun/commands.html#PartialCommand.metadata">metadata</a></dd>
                <dd id="MessageCommand.set_hooks" class="function"><a href="tanjun/commands.html#PartialCommand.set_hooks">set_hooks</a></dd>
                <dd id="MessageCommand.add_check" class="function"><a href="tanjun/commands.html#PartialCommand.add_check">add_check</a></dd>
                <dd id="MessageCommand.remove_check" class="function"><a href="tanjun/commands.html#PartialCommand.remove_check">remove_check</a></dd>
                <dd id="MessageCommand.with_check" class="function"><a href="tanjun/commands.html#PartialCommand.with_check">with_check</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MessageCommandGroup">
                                <div class="attr class">
        <a class="headerlink" href="#MessageCommandGroup">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">MessageCommandGroup</span><wbr>(<span class="base"><a href="#MessageCommand">tanjun.MessageCommand[~CommandCallbackSigT]</a></span>, <span class="base"><a href="tanjun/abc.html#MessageCommandGroup">tanjun.abc.MessageCommandGroup</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MessageCommandGroup</span><span class="p">(</span><span class="n">MessageCommand</span><span class="p">[</span><span class="n">CommandCallbackSigT</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandGroup</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_commands&quot;</span><span class="p">,</span> <span class="s2">&quot;_is_strict&quot;</span><span class="p">,</span> <span class="s2">&quot;_names_to_commands&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">CommandCallbackSigT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">checks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">parser</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">parsing</span><span class="o">.</span><span class="n">AbstractParser</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">parser</span><span class="o">=</span><span class="n">parser</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span> <span class="o">=</span> <span class="n">strict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;CommandGroup &lt;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="si">}</span><span class="s2">&gt;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommandGroup&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_strict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandGroupT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="n">commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">command</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">commands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">commands</span><span class="p">[</span><span class="n">command</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandGroupT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a command to this group.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : MessageCommand</span>
<span class="sd">            The command to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The group instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If one of the command&#39;s names is already registered in a strict</span>
<span class="sd">            command group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sub-command names may not contain spaces in a strict message command group&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">name_conflicts</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Sub-command names must be unique in a strict message command group. &quot;</span>
                    <span class="s2">&quot;The following conflicts were found &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_conflicts</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>

        <span class="n">command</span><span class="o">.</span><span class="n">set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandGroupT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommandGroup&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="n">command</span><span class="p">:</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="n">command</span><span class="o">.</span><span class="n">set_parent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">AnyMessageCommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnyMessageCommandT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">command</span>

    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandGroupT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandGroupT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">find_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">command</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">:=</span> <span class="n">utilities</span><span class="o">.</span><span class="n">match_prefix_names</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot execute a command with a content-less message&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hooks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hooks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

            <span class="n">hooks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_command</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>
            <span class="k">if</span> <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="n">content</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="p">:]</span>
                <span class="n">lstripped_content</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                <span class="n">space_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">lstripped_content</span><span class="p">)</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">set_triggering_name</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">triggering_name</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">space_len</span><span class="p">)</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="n">lstripped_content</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="k">await</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_into_component</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_MessageCommandGroupT</span><span class="p">]:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">components</span><span class="o">.</span><span class="n">LoadableProtocol</span><span class="p">):</span>
                <span class="n">command</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Base class for the standard ExecutableCommand implementations.</p>
</div>


                            <div id="MessageCommandGroup.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommandGroup.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">MessageCommandGroup</span><span class="signature">(
    callback: ~CommandCallbackSigT,
    name: str,
    /,
    *names: str,
    checks: Optional[collections.abc.Iterable[collections.abc.Callable[..., Union[bool, collections.abc.Awaitable[bool]]]]] = None,
    hooks: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a>]] = None,
    metadata: Optional[collections.abc.MutableMapping[Any, Any]] = None,
    strict: bool = False,
    parser: Optional[<a href="tanjun/parsing.html#AbstractParser">tanjun.parsing.AbstractParser</a>] = None
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">CommandCallbackSigT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">checks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">parser</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">parsing</span><span class="o">.</span><span class="n">AbstractParser</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">parser</span><span class="o">=</span><span class="n">parser</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span> <span class="o">=</span> <span class="n">strict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MessageCommandGroup.commands" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageCommandGroup.commands">#&nbsp;&nbsp</a>

        <span class="name">commands</span><span class="annotation">: collections.abc.Collection[<a href="tanjun/abc.html#MessageCommand">tanjun.abc.MessageCommand</a>]</span>
    </div>

            <div class="docstring"><p>Collection of the commands in this group.</p>

<p><em>Note:</em>
This may include command groups.</p>
</div>


                            </div>
                            <div id="MessageCommandGroup.is_strict" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageCommandGroup.is_strict">#&nbsp;&nbsp</a>

        <span class="name">is_strict</span><span class="annotation">: bool</span>
    </div>

    

                            </div>
                            <div id="MessageCommandGroup.copy" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommandGroup.copy">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">copy</span><span class="signature">(
    self: ~_MessageCommandGroupT,
    *,
    parent: Optional[<a href="tanjun/abc.html#MessageCommandGroup">tanjun.abc.MessageCommandGroup</a>] = None,
    _new: bool = True
) -&gt; ~_MessageCommandGroupT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandGroupT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="n">commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">command</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">commands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">commands</span><span class="p">[</span><span class="n">command</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Create a copy of this command.</p>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>parent</strong> (typing.Optional[MessageCommandGroup]):
The parent of the copy.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The copy.</li>
</ul>
</div>


                            </div>
                            <div id="MessageCommandGroup.add_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommandGroup.add_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_command</span><span class="signature">(
    self: ~_MessageCommandGroupT,
    command: <a href="tanjun/abc.html#MessageCommand">tanjun.abc.MessageCommand</a>,
    /
) -&gt; ~_MessageCommandGroupT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandGroupT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a command to this group.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : MessageCommand</span>
<span class="sd">            The command to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The group instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If one of the command&#39;s names is already registered in a strict</span>
<span class="sd">            command group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sub-command names may not contain spaces in a strict message command group&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">name_conflicts</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Sub-command names must be unique in a strict message command group. &quot;</span>
                    <span class="s2">&quot;The following conflicts were found &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_conflicts</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>

        <span class="n">command</span><span class="o">.</span><span class="n">set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a command to this group.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (MessageCommand):
The command to add.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The group instance to enable chained calls.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If one of the command's names is already registered in a strict
command group.</li>
</ul>
</div>


                            </div>
                            <div id="MessageCommandGroup.remove_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommandGroup.remove_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_command</span><span class="signature">(
    self: ~_MessageCommandGroupT,
    command: <a href="tanjun/abc.html#MessageCommand">tanjun.abc.MessageCommand</a>,
    /
) -&gt; ~_MessageCommandGroupT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandGroupT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommandGroup&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="n">command</span><span class="p">:</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="n">command</span><span class="o">.</span><span class="n">set_parent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a command from this group.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (MessageCommand):
The command to remove.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the provided command isn't found.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The group instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="MessageCommandGroup.with_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommandGroup.with_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_command</span><span class="signature">(self, command: ~AnyMessageCommandT, /) -&gt; ~AnyMessageCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">AnyMessageCommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnyMessageCommandT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">command</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a command to this group through a decorator call.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (MessageCommand):
The command to add.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>MessageCommand</strong>: The added command.</li>
</ul>
</div>


                            </div>
                            <div id="MessageCommandGroup.bind_client" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommandGroup.bind_client">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">bind_client</span><span class="signature">(
    self: ~_MessageCommandGroupT,
    client: <a href="tanjun/abc.html#Client">tanjun.abc.Client</a>,
    /
) -&gt; ~_MessageCommandGroupT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandGroupT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MessageCommandGroup.bind_component" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommandGroup.bind_component">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">bind_component</span><span class="signature">(
    self: ~_MessageCommandGroupT,
    component: <a href="tanjun/abc.html#Component">tanjun.abc.Component</a>,
    /
) -&gt; ~_MessageCommandGroupT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageCommandGroupT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MessageCommandGroup.find_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommandGroup.find_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">find_command</span><span class="signature">(
    self,
    content: str,
    /
) -&gt; collections.abc.Iterable[tuple[str, <a href="tanjun/abc.html#MessageCommand">tanjun.abc.MessageCommand</a>]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">find_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">command</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">:=</span> <span class="n">utilities</span><span class="o">.</span><span class="n">match_prefix_names</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MessageCommandGroup.execute" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommandGroup.execute">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">execute</span><span class="signature">(
    self,
    ctx: <a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a>,
    /,
    *,
    hooks: Optional[collections.abc.MutableSet[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a>]]] = None
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.MessageCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot execute a command with a content-less message&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hooks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hooks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

            <span class="n">hooks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_command</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>
            <span class="k">if</span> <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="n">content</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="p">:]</span>
                <span class="n">lstripped_content</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                <span class="n">space_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">lstripped_content</span><span class="p">)</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">set_triggering_name</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">triggering_name</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">space_len</span><span class="p">)</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="n">lstripped_content</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="k">await</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MessageCommandGroup.load_into_component" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageCommandGroup.load_into_component">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">load_into_component</span><span class="signature">(
    self: ~_MessageCommandGroupT,
    component: <a href="tanjun/abc.html#Component">tanjun.abc.Component</a>,
    /
) -&gt; Optional[~_MessageCommandGroupT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">load_into_component</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_MessageCommandGroupT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_MessageCommandGroupT</span><span class="p">]:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">components</span><span class="o">.</span><span class="n">LoadableProtocol</span><span class="p">):</span>
                <span class="n">command</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#MessageCommand">MessageCommand</a></dt>
                                <dd id="MessageCommandGroup.callback" class="variable"><a href="#MessageCommand.callback">callback</a></dd>
                <dd id="MessageCommandGroup.names" class="variable"><a href="#MessageCommand.names">names</a></dd>
                <dd id="MessageCommandGroup.needs_injector" class="variable"><a href="#MessageCommand.needs_injector">needs_injector</a></dd>
                <dd id="MessageCommandGroup.parent" class="variable"><a href="#MessageCommand.parent">parent</a></dd>
                <dd id="MessageCommandGroup.parser" class="variable"><a href="#MessageCommand.parser">parser</a></dd>
                <dd id="MessageCommandGroup.set_parent" class="function"><a href="#MessageCommand.set_parent">set_parent</a></dd>
                <dd id="MessageCommandGroup.set_parser" class="function"><a href="#MessageCommand.set_parser">set_parser</a></dd>
                <dd id="MessageCommandGroup.check_context" class="function"><a href="#MessageCommand.check_context">check_context</a></dd>

            </div>
            <div><dt><a href="tanjun/commands.html#PartialCommand">tanjun.commands.PartialCommand</a></dt>
                                <dd id="MessageCommandGroup.checks" class="variable"><a href="tanjun/commands.html#PartialCommand.checks">checks</a></dd>
                <dd id="MessageCommandGroup.component" class="variable"><a href="tanjun/commands.html#PartialCommand.component">component</a></dd>
                <dd id="MessageCommandGroup.hooks" class="variable"><a href="tanjun/commands.html#PartialCommand.hooks">hooks</a></dd>
                <dd id="MessageCommandGroup.metadata" class="variable"><a href="tanjun/commands.html#PartialCommand.metadata">metadata</a></dd>
                <dd id="MessageCommandGroup.set_hooks" class="function"><a href="tanjun/commands.html#PartialCommand.set_hooks">set_hooks</a></dd>
                <dd id="MessageCommandGroup.add_check" class="function"><a href="tanjun/commands.html#PartialCommand.add_check">add_check</a></dd>
                <dd id="MessageCommandGroup.remove_check" class="function"><a href="tanjun/commands.html#PartialCommand.remove_check">remove_check</a></dd>
                <dd id="MessageCommandGroup.with_check" class="function"><a href="tanjun/commands.html#PartialCommand.with_check">with_check</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="SlashCommand">
                                <div class="attr class">
        <a class="headerlink" href="#SlashCommand">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">SlashCommand</span><wbr>(<span class="base"><a href="tanjun/commands.html#BaseSlashCommand">tanjun.commands.BaseSlashCommand</a></span>, <span class="base"><a href="tanjun/abc.html#SlashCommand">tanjun.abc.SlashCommand</a></span>, <span class="base">typing.Generic[~CommandCallbackSigT]</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">SlashCommand</span><span class="p">(</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashCommand</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">CommandCallbackSigT</span><span class="p">]):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_builder&quot;</span><span class="p">,</span> <span class="s2">&quot;_callback&quot;</span><span class="p">,</span> <span class="s2">&quot;_client&quot;</span><span class="p">,</span> <span class="s2">&quot;_tracked_options&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">CommandCallbackSigT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">checks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default_permission</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">default_to_ephemeral</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_global</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sort_options</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">_stack</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">,</span>
            <span class="n">command_id</span><span class="o">=</span><span class="n">command_id</span><span class="p">,</span>
            <span class="n">default_to_ephemeral</span><span class="o">=</span><span class="n">default_to_ephemeral</span><span class="p">,</span>
            <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">,</span>
            <span class="n">is_global</span><span class="o">=</span><span class="n">is_global</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">_stack</span><span class="o">=</span><span class="n">_stack</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_builder</span> <span class="o">=</span> <span class="n">_CommandBuilder</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">sort_options</span><span class="p">)</span><span class="o">.</span><span class="n">set_default_permission</span><span class="p">(</span><span class="n">default_permission</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_command_id</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_builder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_builder</span><span class="o">.</span><span class="n">set_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_id</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracked_options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">_TrackedOption</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
        <span class="fm">__call__</span><span class="p">:</span> <span class="n">CommandCallbackSigT</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandCallbackSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.SlashCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">CommandCallbackSigT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">needs_injector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">needs_injector</span>
            <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">needs_injector</span> <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracked_options</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="ow">or</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">needs_injector</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracked_options</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">option</span><span class="o">.</span><span class="n">check_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">special_endpoints_api</span><span class="o">.</span><span class="n">CommandBuilder</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_builder</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_add_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">type_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">STRING</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">always_float</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">channel_types</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
            <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="kc">None</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">only_member</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_SCOMMAND_NAME_REG</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid command option name provided, </span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s2"> doesn&#39;t match the required regex `^[a-z0-9_-]</span><span class="si">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">32</span><span class="si">}</span><span class="s2">$`&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">description</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The option description cannot be over 100 characters in length&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_builder</span><span class="o">.</span><span class="n">options</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Slash commands cannot have more than 25 options&quot;</span><span class="p">)</span>

        <span class="n">type_</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">converters</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">):</span>
            <span class="n">converters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">_convert_to_injectable</span><span class="p">,</span> <span class="n">converters</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">converters</span> <span class="o">=</span> <span class="p">[</span><span class="n">_convert_to_injectable</span><span class="p">(</span><span class="n">converters</span><span class="p">)]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">converter</span> <span class="ow">in</span> <span class="n">converters</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">converter</span><span class="o">.</span><span class="n">callback</span><span class="p">,</span> <span class="n">conversion</span><span class="o">.</span><span class="n">BaseConverter</span><span class="p">):</span>
                    <span class="n">converter</span><span class="o">.</span><span class="n">callback</span><span class="o">.</span><span class="n">check_client</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="si">}</span><span class="s2">&#39;s slash option &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">choices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actual_choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandChoice</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">choices</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
            <span class="n">actual_choices</span> <span class="o">=</span> <span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandChoice</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">choices</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Passing a sequence of tuples to `choices` is deprecated since 2.1.2a1, &quot;</span>
                <span class="s2">&quot;please pass a mapping instead.&quot;</span><span class="p">,</span>
                <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">,</span>
                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">_stack_level</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">actual_choices</span> <span class="o">=</span> <span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandChoice</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">choices</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">actual_choices</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">actual_choices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Slash command options cannot have more than 25 choices&quot;</span><span class="p">)</span>

        <span class="n">required</span> <span class="o">=</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">_UNDEFINED_DEFAULT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_builder</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">CommandOption</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="n">type_</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
                <span class="n">is_required</span><span class="o">=</span><span class="n">required</span><span class="p">,</span>
                <span class="n">choices</span><span class="o">=</span><span class="n">actual_choices</span><span class="p">,</span>
                <span class="n">channel_types</span><span class="o">=</span><span class="n">channel_types</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">pass_as_kwarg</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tracked_options</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">_TrackedOption</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">option_type</span><span class="o">=</span><span class="n">type_</span><span class="p">,</span>
                <span class="n">always_float</span><span class="o">=</span><span class="n">always_float</span><span class="p">,</span>
                <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
                <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
                <span class="n">only_member</span><span class="o">=</span><span class="n">only_member</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_str_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a string option to the slash command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            As a shorthand, `choices` also supports passing strings in place of</span>
<span class="sd">            tuples each string will be used as both the choice&#39;s name and value</span>
<span class="sd">            (with the name being capitalised).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        choices : typing.Union[collections.abc.Mapping[str, str], collections.abc.Sequence[str], None]</span>
<span class="sd">            The option&#39;s choices.</span>

<span class="sd">            This either a mapping of [option_name, option_value] where both option_name</span>
<span class="sd">            and option_value should be strings of up to 100 characters or a sequence</span>
<span class="sd">            of strings where the string will be used for both the choice&#39;s name and</span>
<span class="sd">            value.</span>
<span class="sd">        converters : typing.Union[collections.abc.Sequence[ConverterSig], ConverterSig]</span>
<span class="sd">            The option&#39;s converters.</span>

<span class="sd">            This may be either one or multiple `ConverterSig` callbacks used to</span>
<span class="sd">            convert the option&#39;s value to the final form.</span>
<span class="sd">            If no converters are provided then the raw value will be passed.</span>

<span class="sd">            Only the first converter to pass will be used.</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used and the `coverters` field will be ignored.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the option has more than 25 choices.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">choices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actual_choices</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">choices</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
            <span class="n">actual_choices</span> <span class="o">=</span> <span class="n">choices</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">actual_choices</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">warned</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">choices</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">warned</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                            <span class="s2">&quot;Passing a sequence of tuples for &#39;choices&#39; is deprecated since 2.1.2a1, &quot;</span>
                            <span class="s2">&quot;please pass a mapping instead.&quot;</span><span class="p">,</span>
                            <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">,</span>
                            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">_stack_level</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="n">warned</span> <span class="o">=</span> <span class="kc">True</span>

                    <span class="n">actual_choices</span><span class="p">[</span><span class="n">choice</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">choice</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">actual_choices</span><span class="p">[</span><span class="n">choice</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()]</span> <span class="o">=</span> <span class="n">choice</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">STRING</span><span class="p">,</span>
            <span class="n">choices</span><span class="o">=</span><span class="n">actual_choices</span><span class="p">,</span>
            <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
            <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_int_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add an integer option to the slash command.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        choices : typing.Optional[collections.abc.Mapping[str, int]]</span>
<span class="sd">            The option&#39;s choices.</span>

<span class="sd">            This is a mapping of [option_name, option_value] where option_name</span>
<span class="sd">            should be a string of up to 100 characters and option_value should</span>
<span class="sd">            be an integer.</span>
<span class="sd">        converters : typing.Union[collections.abc.Sequence[ConverterSig], ConverterSig, None]</span>
<span class="sd">            The option&#39;s converters.</span>

<span class="sd">            This may be either one or multiple `ConverterSig` callbacks used to</span>
<span class="sd">            convert the option&#39;s value to the final form.</span>
<span class="sd">            If no converters are provided then the raw value will be passed.</span>

<span class="sd">            Only the first converter to pass will be used.</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used and the `coverters` field will be ignored.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the option has more than 25 choices.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">INTEGER</span><span class="p">,</span>
            <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
            <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
            <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
            <span class="n">_stack_level</span><span class="o">=</span><span class="n">_stack_level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_float_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">always_float</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a float option to a slash command.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        always_float : bool</span>
<span class="sd">            If this is set to `True` then the value will always be converted to a</span>
<span class="sd">            float (this will happen before it&#39;s passed to converters).</span>

<span class="sd">            This masks behaviour from Discord where we will either be provided a `float`</span>
<span class="sd">            or `int` dependent on what the user provided and defaults to `True`.</span>
<span class="sd">        choices : typing.Optional[collections.abc.Mapping[str, float]]</span>
<span class="sd">            The option&#39;s choices.</span>

<span class="sd">            This is a mapping of [option_name, option_value] where option_name</span>
<span class="sd">            should be a string of up to 100 characters and option_value should</span>
<span class="sd">            be a float.</span>
<span class="sd">        converters : typing.Union[collections.abc.Sequence[ConverterSig], ConverterSig, None]</span>
<span class="sd">            The option&#39;s converters.</span>

<span class="sd">            This may be either one or multiple `ConverterSig` callbacks used to</span>
<span class="sd">            convert the option&#39;s value to the final form.</span>
<span class="sd">            If no converters are provided then the raw value will be passed.</span>

<span class="sd">            Only the first converter to pass will be used.</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used and the fields `coverters`, and `always_float` will be</span>
<span class="sd">            ignored.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the option has more than 25 choices.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span>
            <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
            <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
            <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
            <span class="n">always_float</span><span class="o">=</span><span class="n">always_float</span><span class="p">,</span>
            <span class="n">_stack_level</span><span class="o">=</span><span class="n">_stack_level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_bool_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a boolean option to a slash command.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">BOOLEAN</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_user_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a user option to a slash command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This may result in `hikari.InteractionMember` or</span>
<span class="sd">            `hikari.users.User` if the user isn&#39;t in the current guild or if this</span>
<span class="sd">            command was executed in a DM channel.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the option has more than 25 choices.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_member_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a member option to a slash command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will always result in `hikari.InteractionMember`.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            Unlike the other options, this is an artificial option which adds</span>
<span class="sd">            a restraint to the USER option type and therefore cannot have</span>
<span class="sd">            `pass_as_kwarg` set to `False` as this artificial constaint isn&#39;t</span>
<span class="sd">            present when its not being passed as a keyword argument.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">only_member</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_channel_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">types</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialChannel</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a channel option to a slash command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will always result in `hikari.InteractionChannel`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        types : typing.Optional[collections.abc.Collection[type[hikari.PartialChannel]]]</span>
<span class="sd">            A collection of the channel classes this option should accept.</span>

<span class="sd">            If left as `None` or empty then the option will allow all channel types.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">            * If an invalid type is passed in `types`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">itertools</span>

        <span class="k">if</span> <span class="n">types</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">channel_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">_channel_types</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">,</span> <span class="n">types</span><span class="p">))))</span>

            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown channel type </span><span class="si">{</span><span class="n">exc</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">channel_types</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">CHANNEL</span><span class="p">,</span>
            <span class="n">channel_types</span><span class="o">=</span><span class="n">channel_types</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
            <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_role_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a role option to a slash command.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">ROLE</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_mentionable_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a mentionable option to a slash command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This may target roles, guild members or users and results in</span>
<span class="sd">            `Union[hikari.User, hikari.InteractionMember, hikari.Role]`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_process_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="n">keyword_args</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionChannel</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">tracked_option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracked_options</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">option</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tracked_option</span><span class="o">.</span><span class="n">name</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>  <span class="c1"># TODO: ConversionError?</span>
                        <span class="sa">f</span><span class="s2">&quot;Required option </span><span class="si">{</span><span class="n">tracked_option</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is missing data, are you sure your commands&quot;</span>
                        <span class="s2">&quot; are up to date?&quot;</span>
                    <span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">keyword_args</span><span class="p">[</span><span class="n">tracked_option</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">default</span>

            <span class="k">elif</span> <span class="n">option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">:</span>
                <span class="n">member</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">is_only_member</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">member</span> <span class="o">:=</span> <span class="n">option</span><span class="o">.</span><span class="n">resolve_to_member</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)):</span>
                    <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">ConversionError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Couldn&#39;t find member for provided user: </span><span class="si">{</span><span class="n">option</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">name</span>
                    <span class="p">)</span>

                <span class="n">keyword_args</span><span class="p">[</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">member</span> <span class="ow">or</span> <span class="n">option</span><span class="o">.</span><span class="n">resolve_to_user</span><span class="p">()</span>

            <span class="k">elif</span> <span class="n">option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">CHANNEL</span><span class="p">:</span>
                <span class="n">keyword_args</span><span class="p">[</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">resolve_to_channel</span><span class="p">()</span>

            <span class="k">elif</span> <span class="n">option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">ROLE</span><span class="p">:</span>
                <span class="n">keyword_args</span><span class="p">[</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">resolve_to_role</span><span class="p">()</span>

            <span class="k">elif</span> <span class="n">option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">ROLE</span><span class="p">:</span>
                    <span class="n">keyword_args</span><span class="p">[</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">resolve_to_role</span><span class="p">()</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">member</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">if</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">is_only_member</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">member</span> <span class="o">:=</span> <span class="n">option</span><span class="o">.</span><span class="n">resolve_to_member</span><span class="p">()):</span>
                        <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">ConversionError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Couldn&#39;t find member for provided user: </span><span class="si">{</span><span class="n">option</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">name</span>
                        <span class="p">)</span>

                    <span class="n">keyword_args</span><span class="p">[</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">member</span> <span class="ow">or</span> <span class="n">option</span><span class="o">.</span><span class="n">resolve_to_mentionable</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">value</span>
                <span class="c1"># To be type safe we obfuscate the fact that discord&#39;s double type will provide am int or float</span>
                <span class="c1"># depending on the value Disocrd input by always casting to float.</span>
                <span class="k">if</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">FLOAT</span> <span class="ow">and</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">is_always_float</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">converters</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="k">await</span> <span class="n">tracked_option</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">option</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

                <span class="n">keyword_args</span><span class="p">[</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">return</span> <span class="n">keyword_args</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">option</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteractionOption</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">own_hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="ow">or</span> <span class="n">_EMPTY_HOOKS</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_pre_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracked_options</span><span class="p">:</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_args</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="n">_EMPTY_DICT</span>

            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="c1"># Unlike a message command, this won&#39;t necessarily reach the client level try except</span>
            <span class="c1"># block so we have to handle this here.</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_error</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_success</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_post_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_into_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_SlashCommandT</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">callback</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Callback is already a method type&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">callback</span><span class="p">,</span> <span class="n">component</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
            <span class="n">component</span><span class="o">.</span><span class="n">add_slash_command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Base class for the standard ExecutableCommand implementations.</p>
</div>


                            <div id="SlashCommand.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommand.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">SlashCommand</span><span class="signature">(
    callback: ~CommandCallbackSigT,
    name: str,
    description: str,
    /,
    *,
    checks: Optional[collections.abc.Iterable[collections.abc.Callable[..., Union[bool, collections.abc.Awaitable[bool]]]]] = None,
    command_id: Union[hikari.commands.Command, hikari.snowflakes.Snowflake, int, NoneType] = None,
    default_permission: bool = True,
    default_to_ephemeral: Optional[bool] = None,
    is_global: bool = True,
    hooks: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#SlashContext">tanjun.abc.SlashContext</a>]] = None,
    metadata: Optional[collections.abc.MutableMapping[Any, Any]] = None,
    sort_options: bool = True,
    _stack: int = 0
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">CommandCallbackSigT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">checks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default_permission</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">default_to_ephemeral</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_global</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sort_options</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">_stack</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">,</span>
            <span class="n">command_id</span><span class="o">=</span><span class="n">command_id</span><span class="p">,</span>
            <span class="n">default_to_ephemeral</span><span class="o">=</span><span class="n">default_to_ephemeral</span><span class="p">,</span>
            <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">,</span>
            <span class="n">is_global</span><span class="o">=</span><span class="n">is_global</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">_stack</span><span class="o">=</span><span class="n">_stack</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_builder</span> <span class="o">=</span> <span class="n">_CommandBuilder</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">sort_options</span><span class="p">)</span><span class="o">.</span><span class="n">set_default_permission</span><span class="p">(</span><span class="n">default_permission</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_command_id</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_builder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_builder</span><span class="o">.</span><span class="n">set_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_id</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracked_options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">_TrackedOption</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="SlashCommand.callback" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashCommand.callback">#&nbsp;&nbsp</a>

        <span class="name">callback</span><span class="annotation">: ~CommandCallbackSigT</span>
    </div>

            <div class="docstring"><p>Callback which is called during execution.</p>
</div>


                            </div>
                            <div id="SlashCommand.needs_injector" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashCommand.needs_injector">#&nbsp;&nbsp</a>

        <span class="name">needs_injector</span><span class="annotation">: bool</span>
    </div>

    

                            </div>
                            <div id="SlashCommand.bind_client" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommand.bind_client">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">bind_client</span><span class="signature">(
    self: ~_SlashCommandT,
    client: <a href="tanjun/abc.html#Client">tanjun.abc.Client</a>,
    /
) -&gt; ~_SlashCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracked_options</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">option</span><span class="o">.</span><span class="n">check_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="SlashCommand.build" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommand.build">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">build</span><span class="signature">(self) -&gt; hikari.api.special_endpoints.CommandBuilder</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">special_endpoints_api</span><span class="o">.</span><span class="n">CommandBuilder</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_builder</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Get a builder object for this command.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.api.CommandBuilder</strong>: A builder object for this command. Use to declare this command on
globally or for a specific guild.</li>
</ul>
</div>


                            </div>
                            <div id="SlashCommand.add_str_option" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommand.add_str_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_str_option</span><span class="signature">(
    self: ~_SlashCommandT,
    name: str,
    description: str,
    /,
    *,
    choices: Union[collections.abc.Mapping[str, str], collections.abc.Sequence[str], NoneType] = None,
    converters: Union[collections.abc.Sequence[collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]], collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]] = (),
    default: Any = &lt;object object&gt;,
    pass_as_kwarg: bool = True,
    _stack_level: int = 0
) -&gt; ~_SlashCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_str_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a string option to the slash command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            As a shorthand, `choices` also supports passing strings in place of</span>
<span class="sd">            tuples each string will be used as both the choice&#39;s name and value</span>
<span class="sd">            (with the name being capitalised).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        choices : typing.Union[collections.abc.Mapping[str, str], collections.abc.Sequence[str], None]</span>
<span class="sd">            The option&#39;s choices.</span>

<span class="sd">            This either a mapping of [option_name, option_value] where both option_name</span>
<span class="sd">            and option_value should be strings of up to 100 characters or a sequence</span>
<span class="sd">            of strings where the string will be used for both the choice&#39;s name and</span>
<span class="sd">            value.</span>
<span class="sd">        converters : typing.Union[collections.abc.Sequence[ConverterSig], ConverterSig]</span>
<span class="sd">            The option&#39;s converters.</span>

<span class="sd">            This may be either one or multiple `ConverterSig` callbacks used to</span>
<span class="sd">            convert the option&#39;s value to the final form.</span>
<span class="sd">            If no converters are provided then the raw value will be passed.</span>

<span class="sd">            Only the first converter to pass will be used.</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used and the `coverters` field will be ignored.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the option has more than 25 choices.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">choices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actual_choices</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">choices</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
            <span class="n">actual_choices</span> <span class="o">=</span> <span class="n">choices</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">actual_choices</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">warned</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">choices</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">warned</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                            <span class="s2">&quot;Passing a sequence of tuples for &#39;choices&#39; is deprecated since 2.1.2a1, &quot;</span>
                            <span class="s2">&quot;please pass a mapping instead.&quot;</span><span class="p">,</span>
                            <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">,</span>
                            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">_stack_level</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="n">warned</span> <span class="o">=</span> <span class="kc">True</span>

                    <span class="n">actual_choices</span><span class="p">[</span><span class="n">choice</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">choice</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">actual_choices</span><span class="p">[</span><span class="n">choice</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()]</span> <span class="o">=</span> <span class="n">choice</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">STRING</span><span class="p">,</span>
            <span class="n">choices</span><span class="o">=</span><span class="n">actual_choices</span><span class="p">,</span>
            <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
            <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
        <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a string option to the slash command.</p>

<p><em>Note:</em>
As a shorthand, <code>choices</code> also supports passing strings in place of
tuples each string will be used as both the choice's name and value
(with the name being capitalised).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The option's name. This should match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li><strong>description</strong> (str):
The option's description.
This should be inclusively between 1-100 characters in length.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>choices</strong> (typing.Union[collections.abc.Mapping[str, str], collections.abc.Sequence[str], None]):
The option's choices.</p>

<p>This either a mapping of [option_name, option_value] where both option_name
and option_value should be strings of up to 100 characters or a sequence
of strings where the string will be used for both the choice's name and
value.</p></li>
<li><p><strong>converters</strong> (typing.Union[collections.abc.Sequence[ConverterSig], ConverterSig]):
The option's converters.</p>

<p>This may be either one or multiple <code>ConverterSig</code> callbacks used to
convert the option's value to the final form.
If no converters are provided then the raw value will be passed.</p>

<p>Only the first converter to pass will be used.</p></li>
<li><strong>default</strong> (typing.Any):
The option's default value.
If this is left as undefined then this option will be required.</li>
<li><p><strong>pass_as_kwarg</strong> (bool):
Whether or not to pass this option as a keyword argument to the
command callback.</p>

<p>Defaults to <code>True</code>. If <code>False</code> is passed here then <code>default</code> will
only decide whether the option is required without the actual value
being used and the <code>coverters</code> field will be ignored.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The command object for chaining.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: Raises a value error for any of the following reasons:
<ul>
<li>If the option name doesn't match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li>If the option description is over 100 characters in length.</li>
<li>If the option has more than 25 choices.</li>
<li>If the command already has 25 options.</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="SlashCommand.add_int_option" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommand.add_int_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_int_option</span><span class="signature">(
    self: ~_SlashCommandT,
    name: str,
    description: str,
    /,
    *,
    choices: Optional[collections.abc.Mapping[str, int]] = None,
    converters: Union[collections.abc.Collection[collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]], collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]] = (),
    default: Any = &lt;object object&gt;,
    pass_as_kwarg: bool = True,
    _stack_level: int = 0
) -&gt; ~_SlashCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_int_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add an integer option to the slash command.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        choices : typing.Optional[collections.abc.Mapping[str, int]]</span>
<span class="sd">            The option&#39;s choices.</span>

<span class="sd">            This is a mapping of [option_name, option_value] where option_name</span>
<span class="sd">            should be a string of up to 100 characters and option_value should</span>
<span class="sd">            be an integer.</span>
<span class="sd">        converters : typing.Union[collections.abc.Sequence[ConverterSig], ConverterSig, None]</span>
<span class="sd">            The option&#39;s converters.</span>

<span class="sd">            This may be either one or multiple `ConverterSig` callbacks used to</span>
<span class="sd">            convert the option&#39;s value to the final form.</span>
<span class="sd">            If no converters are provided then the raw value will be passed.</span>

<span class="sd">            Only the first converter to pass will be used.</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used and the `coverters` field will be ignored.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the option has more than 25 choices.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">INTEGER</span><span class="p">,</span>
            <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
            <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
            <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
            <span class="n">_stack_level</span><span class="o">=</span><span class="n">_stack_level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add an integer option to the slash command.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The option's name. This should match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li><strong>description</strong> (str):
The option's description.
This should be inclusively between 1-100 characters in length.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>choices</strong> (typing.Optional[collections.abc.Mapping[str, int]]):
The option's choices.</p>

<p>This is a mapping of [option_name, option_value] where option_name
should be a string of up to 100 characters and option_value should
be an integer.</p></li>
<li><p><strong>converters</strong> (typing.Union[collections.abc.Sequence[ConverterSig], ConverterSig, None]):
The option's converters.</p>

<p>This may be either one or multiple <code>ConverterSig</code> callbacks used to
convert the option's value to the final form.
If no converters are provided then the raw value will be passed.</p>

<p>Only the first converter to pass will be used.</p></li>
<li><strong>default</strong> (typing.Any):
The option's default value.
If this is left as undefined then this option will be required.</li>
<li><p><strong>pass_as_kwarg</strong> (bool):
Whether or not to pass this option as a keyword argument to the
command callback.</p>

<p>Defaults to <code>True</code>. If <code>False</code> is passed here then <code>default</code> will
only decide whether the option is required without the actual value
being used and the <code>coverters</code> field will be ignored.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The command object for chaining.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: Raises a value error for any of the following reasons:
<ul>
<li>If the option name doesn't match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li>If the option description is over 100 characters in length.</li>
<li>If the option has more than 25 choices.</li>
<li>If the command already has 25 options.</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="SlashCommand.add_float_option" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommand.add_float_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_float_option</span><span class="signature">(
    self: ~_SlashCommandT,
    name: str,
    description: str,
    /,
    *,
    always_float: bool = True,
    choices: Optional[collections.abc.Mapping[str, float]] = None,
    converters: Union[collections.abc.Collection[collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]], collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]] = (),
    default: Any = &lt;object object&gt;,
    pass_as_kwarg: bool = True,
    _stack_level: int = 0
) -&gt; ~_SlashCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_float_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">always_float</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a float option to a slash command.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        always_float : bool</span>
<span class="sd">            If this is set to `True` then the value will always be converted to a</span>
<span class="sd">            float (this will happen before it&#39;s passed to converters).</span>

<span class="sd">            This masks behaviour from Discord where we will either be provided a `float`</span>
<span class="sd">            or `int` dependent on what the user provided and defaults to `True`.</span>
<span class="sd">        choices : typing.Optional[collections.abc.Mapping[str, float]]</span>
<span class="sd">            The option&#39;s choices.</span>

<span class="sd">            This is a mapping of [option_name, option_value] where option_name</span>
<span class="sd">            should be a string of up to 100 characters and option_value should</span>
<span class="sd">            be a float.</span>
<span class="sd">        converters : typing.Union[collections.abc.Sequence[ConverterSig], ConverterSig, None]</span>
<span class="sd">            The option&#39;s converters.</span>

<span class="sd">            This may be either one or multiple `ConverterSig` callbacks used to</span>
<span class="sd">            convert the option&#39;s value to the final form.</span>
<span class="sd">            If no converters are provided then the raw value will be passed.</span>

<span class="sd">            Only the first converter to pass will be used.</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used and the fields `coverters`, and `always_float` will be</span>
<span class="sd">            ignored.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the option has more than 25 choices.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span>
            <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
            <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
            <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
            <span class="n">always_float</span><span class="o">=</span><span class="n">always_float</span><span class="p">,</span>
            <span class="n">_stack_level</span><span class="o">=</span><span class="n">_stack_level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a float option to a slash command.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The option's name. This should match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li><strong>description</strong> (str):
The option's description.
This should be inclusively between 1-100 characters in length.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>always_float</strong> (bool):
If this is set to <code>True</code> then the value will always be converted to a
float (this will happen before it's passed to converters).</p>

<p>This masks behaviour from Discord where we will either be provided a <code>float</code>
or <code>int</code> dependent on what the user provided and defaults to <code>True</code>.</p></li>
<li><p><strong>choices</strong> (typing.Optional[collections.abc.Mapping[str, float]]):
The option's choices.</p>

<p>This is a mapping of [option_name, option_value] where option_name
should be a string of up to 100 characters and option_value should
be a float.</p></li>
<li><p><strong>converters</strong> (typing.Union[collections.abc.Sequence[ConverterSig], ConverterSig, None]):
The option's converters.</p>

<p>This may be either one or multiple <code>ConverterSig</code> callbacks used to
convert the option's value to the final form.
If no converters are provided then the raw value will be passed.</p>

<p>Only the first converter to pass will be used.</p></li>
<li><strong>default</strong> (typing.Any):
The option's default value.
If this is left as undefined then this option will be required.</li>
<li><p><strong>pass_as_kwarg</strong> (bool):
Whether or not to pass this option as a keyword argument to the
command callback.</p>

<p>Defaults to <code>True</code>. If <code>False</code> is passed here then <code>default</code> will
only decide whether the option is required without the actual value
being used and the fields <code>coverters</code>, and <code>always_float</code> will be
ignored.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The command object for chaining.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: Raises a value error for any of the following reasons:
<ul>
<li>If the option name doesn't match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li>If the option description is over 100 characters in length.</li>
<li>If the option has more than 25 choices.</li>
<li>If the command already has 25 options.</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="SlashCommand.add_bool_option" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommand.add_bool_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_bool_option</span><span class="signature">(
    self: ~_SlashCommandT,
    name: str,
    description: str,
    /,
    *,
    default: Any = &lt;object object&gt;,
    pass_as_kwarg: bool = True
) -&gt; ~_SlashCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_bool_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a boolean option to a slash command.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">BOOLEAN</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span>
        <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a boolean option to a slash command.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The option's name. This should match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li><strong>description</strong> (str):
The option's description.
This should be inclusively between 1-100 characters in length.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>default</strong> (typing.Any):
The option's default value.
If this is left as undefined then this option will be required.</li>
<li><p><strong>pass_as_kwarg</strong> (bool):
Whether or not to pass this option as a keyword argument to the
command callback.</p>

<p>Defaults to <code>True</code>. If <code>False</code> is passed here then <code>default</code> will
only decide whether the option is required without the actual value
being used.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The command object for chaining.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: Raises a value error for any of the following reasons:
<ul>
<li>If the option name doesn't match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li>If the option description is over 100 characters in length.</li>
<li>If the command already has 25 options.</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="SlashCommand.add_user_option" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommand.add_user_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_user_option</span><span class="signature">(
    self: ~_SlashCommandT,
    name: str,
    description: str,
    /,
    *,
    default: Any = &lt;object object&gt;,
    pass_as_kwarg: bool = True
) -&gt; ~_SlashCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_user_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a user option to a slash command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This may result in `hikari.InteractionMember` or</span>
<span class="sd">            `hikari.users.User` if the user isn&#39;t in the current guild or if this</span>
<span class="sd">            command was executed in a DM channel.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the option has more than 25 choices.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a user option to a slash command.</p>

<p><em>Note:</em>
This may result in <code>hikari.InteractionMember</code> or
<code>hikari.users.User</code> if the user isn't in the current guild or if this
command was executed in a DM channel.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The option's name. This should match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li><strong>description</strong> (str):
The option's description.
This should be inclusively between 1-100 characters in length.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>default</strong> (typing.Any):
The option's default value.
If this is left as undefined then this option will be required.</li>
<li><p><strong>pass_as_kwarg</strong> (bool):
Whether or not to pass this option as a keyword argument to the
command callback.</p>

<p>Defaults to <code>True</code>. If <code>False</code> is passed here then <code>default</code> will
only decide whether the option is required without the actual value
being used.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The command object for chaining.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: Raises a value error for any of the following reasons:
<ul>
<li>If the option name doesn't match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li>If the option description is over 100 characters in length.</li>
<li>If the option has more than 25 choices.</li>
<li>If the command already has 25 options.</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="SlashCommand.add_member_option" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommand.add_member_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_member_option</span><span class="signature">(
    self: ~_SlashCommandT,
    name: str,
    description: str,
    /,
    *,
    default: Any = &lt;object object&gt;
) -&gt; ~_SlashCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_member_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a member option to a slash command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will always result in `hikari.InteractionMember`.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            Unlike the other options, this is an artificial option which adds</span>
<span class="sd">            a restraint to the USER option type and therefore cannot have</span>
<span class="sd">            `pass_as_kwarg` set to `False` as this artificial constaint isn&#39;t</span>
<span class="sd">            present when its not being passed as a keyword argument.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">only_member</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a member option to a slash command.</p>

<p><em>Note:</em>
This will always result in <code>hikari.InteractionMember</code>.</p>

<p><em>Warning:</em>
Unlike the other options, this is an artificial option which adds
a restraint to the USER option type and therefore cannot have
<code>pass_as_kwarg</code> set to <code>False</code> as this artificial constaint isn't
present when its not being passed as a keyword argument.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The option's name. This should match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li><strong>description</strong> (str):
The option's description.
This should be inclusively between 1-100 characters in length.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>default</strong> (typing.Any):
The option's default value.
If this is left as undefined then this option will be required.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The command object for chaining.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: Raises a value error for any of the following reasons:
<ul>
<li>If the option name doesn't match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li>If the option description is over 100 characters in length.</li>
<li>If the command already has 25 options.</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="SlashCommand.add_channel_option" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommand.add_channel_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_channel_option</span><span class="signature">(
    self: ~_SlashCommandT,
    name: str,
    description: str,
    /,
    *,
    default: Any = &lt;object object&gt;,
    types: Optional[collections.abc.Collection[type[hikari.channels.PartialChannel]]] = None,
    pass_as_kwarg: bool = True
) -&gt; ~_SlashCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_channel_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">types</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialChannel</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a channel option to a slash command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will always result in `hikari.InteractionChannel`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        types : typing.Optional[collections.abc.Collection[type[hikari.PartialChannel]]]</span>
<span class="sd">            A collection of the channel classes this option should accept.</span>

<span class="sd">            If left as `None` or empty then the option will allow all channel types.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">            * If an invalid type is passed in `types`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">itertools</span>

        <span class="k">if</span> <span class="n">types</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">channel_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">_channel_types</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">,</span> <span class="n">types</span><span class="p">))))</span>

            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown channel type </span><span class="si">{</span><span class="n">exc</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">channel_types</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">CHANNEL</span><span class="p">,</span>
            <span class="n">channel_types</span><span class="o">=</span><span class="n">channel_types</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
            <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
        <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a channel option to a slash command.</p>

<p><em>Note:</em>
This will always result in <code>hikari.InteractionChannel</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The option's name. This should match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li><strong>description</strong> (str):
The option's description.
This should be inclusively between 1-100 characters in length.</li>
</ul>

<h6 id="parameters-2">Parameters</h6>

<ul>
<li><strong>default</strong> (typing.Any):
The option's default value.
If this is left as undefined then this option will be required.</li>
<li><p><strong>types</strong> (typing.Optional[collections.abc.Collection[type[hikari.PartialChannel]]]):
A collection of the channel classes this option should accept.</p>

<p>If left as <code>None</code> or empty then the option will allow all channel types.</p></li>
<li><p><strong>pass_as_kwarg</strong> (bool):
Whether or not to pass this option as a keyword argument to the
command callback.</p>

<p>Defaults to <code>True</code>. If <code>False</code> is passed here then <code>default</code> will
only decide whether the option is required without the actual value
being used.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The command object for chaining.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: Raises a value error for any of the following reasons:
<ul>
<li>If the option name doesn't match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li>If the option description is over 100 characters in length.</li>
<li>If the command already has 25 options.</li>
<li>If an invalid type is passed in <code>types</code>.</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="SlashCommand.add_role_option" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommand.add_role_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_role_option</span><span class="signature">(
    self: ~_SlashCommandT,
    name: str,
    description: str,
    /,
    *,
    default: Any = &lt;object object&gt;,
    pass_as_kwarg: bool = True
) -&gt; ~_SlashCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_role_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a role option to a slash command.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">ROLE</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a role option to a slash command.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The option's name. This should match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li><strong>description</strong> (str):
The option's description.
This should be inclusively between 1-100 characters in length.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>default</strong> (typing.Any):
The option's default value.
If this is left as undefined then this option will be required.</li>
<li><p><strong>pass_as_kwarg</strong> (bool):
Whether or not to pass this option as a keyword argument to the
command callback.</p>

<p>Defaults to <code>True</code>. If <code>False</code> is passed here then <code>default</code> will
only decide whether the option is required without the actual value
being used.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The command object for chaining.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: Raises a value error for any of the following reasons:
<ul>
<li>If the option name doesn't match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li>If the option description is over 100 characters in length.</li>
<li>If the command already has 25 options.</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="SlashCommand.add_mentionable_option" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommand.add_mentionable_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_mentionable_option</span><span class="signature">(
    self: ~_SlashCommandT,
    name: str,
    description: str,
    /,
    *,
    default: Any = &lt;object object&gt;,
    pass_as_kwarg: bool = True
) -&gt; ~_SlashCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_mentionable_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a mentionable option to a slash command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This may target roles, guild members or users and results in</span>
<span class="sd">            `Union[hikari.User, hikari.InteractionMember, hikari.Role]`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The option&#39;s name. This should match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">        description : str</span>
<span class="sd">            The option&#39;s description.</span>
<span class="sd">            This should be inclusively between 1-100 characters in length.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The option&#39;s default value.</span>
<span class="sd">            If this is left as undefined then this option will be required.</span>
<span class="sd">        pass_as_kwarg : bool</span>
<span class="sd">            Whether or not to pass this option as a keyword argument to the</span>
<span class="sd">            command callback.</span>

<span class="sd">            Defaults to `True`. If `False` is passed here then `default` will</span>
<span class="sd">            only decide whether the option is required without the actual value</span>
<span class="sd">            being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The command object for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If the option name doesn&#39;t match the regex `^[a-z0-9_-]{1,32}$`.</span>
<span class="sd">            * If the option description is over 100 characters in length.</span>
<span class="sd">            * If the command already has 25 options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_option</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span>
        <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a mentionable option to a slash command.</p>

<p><em>Note:</em>
This may target roles, guild members or users and results in
<code>Union[hikari.User, hikari.InteractionMember, hikari.Role]</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The option's name. This should match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li><strong>description</strong> (str):
The option's description.
This should be inclusively between 1-100 characters in length.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>default</strong> (typing.Any):
The option's default value.
If this is left as undefined then this option will be required.</li>
<li><p><strong>pass_as_kwarg</strong> (bool):
Whether or not to pass this option as a keyword argument to the
command callback.</p>

<p>Defaults to <code>True</code>. If <code>False</code> is passed here then <code>default</code> will
only decide whether the option is required without the actual value
being used.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The command object for chaining.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: Raises a value error for any of the following reasons:
<ul>
<li>If the option name doesn't match the regex <code>^[a-z0-9_-]{1,32}$</code>.</li>
<li>If the option description is over 100 characters in length.</li>
<li>If the command already has 25 options.</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="SlashCommand.execute" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommand.execute">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">execute</span><span class="signature">(
    self,
    ctx: <a href="tanjun/abc.html#SlashContext">tanjun.abc.SlashContext</a>,
    /,
    option: Optional[hikari.interactions.command_interactions.CommandInteractionOption] = None,
    *,
    hooks: Optional[collections.abc.MutableSet[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#SlashContext">tanjun.abc.SlashContext</a>]]] = None
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">option</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteractionOption</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">own_hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="ow">or</span> <span class="n">_EMPTY_HOOKS</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_pre_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracked_options</span><span class="p">:</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_args</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="n">_EMPTY_DICT</span>

            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="c1"># Unlike a message command, this won&#39;t necessarily reach the client level try except</span>
            <span class="c1"># block so we have to handle this here.</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_error</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_success</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">own_hooks</span><span class="o">.</span><span class="n">trigger_post_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="SlashCommand.copy" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommand.copy">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">copy</span><span class="signature">(
    self: ~_SlashCommandT,
    *,
    _new: bool = True,
    parent: Optional[<a href="tanjun/abc.html#SlashCommandGroup">tanjun.abc.SlashCommandGroup</a>] = None
) -&gt; ~_SlashCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Create a copy of this command.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: A copy of this command.</li>
</ul>
</div>


                            </div>
                            <div id="SlashCommand.load_into_component" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommand.load_into_component">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">load_into_component</span><span class="signature">(
    self: ~_SlashCommandT,
    component: <a href="tanjun/abc.html#Component">tanjun.abc.Component</a>,
    /
) -&gt; Optional[~_SlashCommandT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">load_into_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_SlashCommandT</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">callback</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Callback is already a method type&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">callback</span><span class="p">,</span> <span class="n">component</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
            <span class="n">component</span><span class="o">.</span><span class="n">add_slash_command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="tanjun/commands.html#BaseSlashCommand">tanjun.commands.BaseSlashCommand</a></dt>
                                <dd id="SlashCommand.defaults_to_ephemeral" class="variable"><a href="tanjun/commands.html#BaseSlashCommand.defaults_to_ephemeral">defaults_to_ephemeral</a></dd>
                <dd id="SlashCommand.description" class="variable"><a href="tanjun/commands.html#BaseSlashCommand.description">description</a></dd>
                <dd id="SlashCommand.is_global" class="variable"><a href="tanjun/commands.html#BaseSlashCommand.is_global">is_global</a></dd>
                <dd id="SlashCommand.name" class="variable"><a href="tanjun/commands.html#BaseSlashCommand.name">name</a></dd>
                <dd id="SlashCommand.parent" class="variable"><a href="tanjun/commands.html#BaseSlashCommand.parent">parent</a></dd>
                <dd id="SlashCommand.tracked_command_id" class="variable"><a href="tanjun/commands.html#BaseSlashCommand.tracked_command_id">tracked_command_id</a></dd>
                <dd id="SlashCommand.set_tracked_command" class="function"><a href="tanjun/commands.html#BaseSlashCommand.set_tracked_command">set_tracked_command</a></dd>
                <dd id="SlashCommand.set_ephemeral_default" class="function"><a href="tanjun/commands.html#BaseSlashCommand.set_ephemeral_default">set_ephemeral_default</a></dd>
                <dd id="SlashCommand.set_parent" class="function"><a href="tanjun/commands.html#BaseSlashCommand.set_parent">set_parent</a></dd>
                <dd id="SlashCommand.check_context" class="function"><a href="tanjun/commands.html#BaseSlashCommand.check_context">check_context</a></dd>

            </div>
            <div><dt><a href="tanjun/commands.html#PartialCommand">tanjun.commands.PartialCommand</a></dt>
                                <dd id="SlashCommand.checks" class="variable"><a href="tanjun/commands.html#PartialCommand.checks">checks</a></dd>
                <dd id="SlashCommand.component" class="variable"><a href="tanjun/commands.html#PartialCommand.component">component</a></dd>
                <dd id="SlashCommand.hooks" class="variable"><a href="tanjun/commands.html#PartialCommand.hooks">hooks</a></dd>
                <dd id="SlashCommand.metadata" class="variable"><a href="tanjun/commands.html#PartialCommand.metadata">metadata</a></dd>
                <dd id="SlashCommand.set_hooks" class="function"><a href="tanjun/commands.html#PartialCommand.set_hooks">set_hooks</a></dd>
                <dd id="SlashCommand.add_check" class="function"><a href="tanjun/commands.html#PartialCommand.add_check">add_check</a></dd>
                <dd id="SlashCommand.remove_check" class="function"><a href="tanjun/commands.html#PartialCommand.remove_check">remove_check</a></dd>
                <dd id="SlashCommand.with_check" class="function"><a href="tanjun/commands.html#PartialCommand.with_check">with_check</a></dd>
                <dd id="SlashCommand.bind_component" class="function"><a href="tanjun/commands.html#PartialCommand.bind_component">bind_component</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="SlashCommandGroup">
                                <div class="attr class">
        <a class="headerlink" href="#SlashCommandGroup">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">SlashCommandGroup</span><wbr>(<span class="base"><a href="tanjun/commands.html#PartialCommand">tanjun.commands.PartialCommand[tanjun.abc.SlashContext]</a></span>, <span class="base"><a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">SlashCommandGroup</span><span class="p">(</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_commands&quot;</span><span class="p">,</span> <span class="s2">&quot;_default_permission&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default_to_ephemeral</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default_permission</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">is_global</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">checks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">_stack</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">command_id</span><span class="o">=</span><span class="n">command_id</span><span class="p">,</span>
            <span class="n">default_to_ephemeral</span><span class="o">=</span><span class="n">default_to_ephemeral</span><span class="p">,</span>
            <span class="n">is_global</span><span class="o">=</span><span class="n">is_global</span><span class="p">,</span>
            <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">,</span>
            <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">_stack</span><span class="o">=</span><span class="n">_stack</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_permission</span> <span class="o">=</span> <span class="n">default_permission</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.SlashCommandGroup&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">special_endpoints_api</span><span class="o">.</span><span class="n">CommandBuilder</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="n">builder</span> <span class="o">=</span> <span class="n">_CommandBuilder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_description</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">set_default_permission</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_permission</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_command_id</span><span class="p">:</span>
            <span class="n">builder</span><span class="o">.</span><span class="n">set_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_id</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">option_type</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">SUB_COMMAND_GROUP</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">)</span>
                <span class="k">else</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">SUB_COMMAND</span>
            <span class="p">)</span>
            <span class="n">command_builder</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
            <span class="n">builder</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span>
                <span class="n">hikari</span><span class="o">.</span><span class="n">CommandOption</span><span class="p">(</span>
                    <span class="nb">type</span><span class="o">=</span><span class="n">option_type</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="n">command_builder</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                    <span class="n">is_required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">options</span><span class="o">=</span><span class="n">command_builder</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">builder</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandGroupT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandGroupT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandGroupT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandGroupT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a slash command to this group.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            Command groups are only supported within top-level groups.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.BaseSlashCommand</span>
<span class="sd">            Command to add to this group.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            Object of this group to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot add a slash command group to a nested slash command group&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot add more than 25 commands to a slash command group&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Command with name </span><span class="si">{</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="si">!r}</span><span class="s2"> already exists in this group&quot;</span><span class="p">)</span>

        <span class="n">command</span><span class="o">.</span><span class="n">set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">command</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandGroupT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandGroupT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a command from this group.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.BaseSlashCommand</span>
<span class="sd">            Command to remove from this group.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            Object of this group to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a slash command to this group through a decorator call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.BaseSlashCommand</span>
<span class="sd">            Command to add to this group.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun.abc.BaseSlashCommand</span>
<span class="sd">            Command which was added to this group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">command</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">option</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteractionOption</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">option</span> <span class="ow">and</span> <span class="n">ctx</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">option</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">option</span> <span class="ow">and</span> <span class="n">option</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">option</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Missing sub-command option&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">command</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">defaults_to_ephemeral</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">set_ephemeral_default</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">defaults_to_ephemeral</span><span class="p">)</span>

            <span class="k">if</span> <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">option</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">load_into_component</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandGroupT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_SlashCommandGroupT</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">components</span><span class="o">.</span><span class="n">LoadableProtocol</span><span class="p">):</span>
                <span class="n">command</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Base class for the standard ExecutableCommand implementations.</p>
</div>


                            <div id="SlashCommandGroup.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommandGroup.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">SlashCommandGroup</span><span class="signature">(
    name: str,
    description: str,
    /,
    *,
    command_id: Union[hikari.commands.Command, hikari.snowflakes.Snowflake, int, NoneType] = None,
    default_to_ephemeral: Optional[bool] = None,
    default_permission: bool = True,
    is_global: bool = True,
    checks: Optional[collections.abc.Iterable[collections.abc.Callable[..., Union[bool, collections.abc.Awaitable[bool]]]]] = None,
    hooks: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#SlashContext">tanjun.abc.SlashContext</a>]] = None,
    metadata: Optional[collections.abc.MutableMapping[Any, Any]] = None,
    _stack: int = 0
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default_to_ephemeral</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default_permission</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">is_global</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">checks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">_stack</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="p">,</span>
            <span class="n">command_id</span><span class="o">=</span><span class="n">command_id</span><span class="p">,</span>
            <span class="n">default_to_ephemeral</span><span class="o">=</span><span class="n">default_to_ephemeral</span><span class="p">,</span>
            <span class="n">is_global</span><span class="o">=</span><span class="n">is_global</span><span class="p">,</span>
            <span class="n">checks</span><span class="o">=</span><span class="n">checks</span><span class="p">,</span>
            <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">_stack</span><span class="o">=</span><span class="n">_stack</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_permission</span> <span class="o">=</span> <span class="n">default_permission</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="SlashCommandGroup.commands" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashCommandGroup.commands">#&nbsp;&nbsp</a>

        <span class="name">commands</span><span class="annotation">: collections.abc.Collection[<a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>]</span>
    </div>

            <div class="docstring"><p>Collection of the commands in this group.</p>
</div>


                            </div>
                            <div id="SlashCommandGroup.build" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommandGroup.build">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">build</span><span class="signature">(self) -&gt; hikari.api.special_endpoints.CommandBuilder</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">special_endpoints_api</span><span class="o">.</span><span class="n">CommandBuilder</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="n">builder</span> <span class="o">=</span> <span class="n">_CommandBuilder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_description</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">set_default_permission</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_permission</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_command_id</span><span class="p">:</span>
            <span class="n">builder</span><span class="o">.</span><span class="n">set_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_id</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">option_type</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">SUB_COMMAND_GROUP</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">)</span>
                <span class="k">else</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">SUB_COMMAND</span>
            <span class="p">)</span>
            <span class="n">command_builder</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
            <span class="n">builder</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span>
                <span class="n">hikari</span><span class="o">.</span><span class="n">CommandOption</span><span class="p">(</span>
                    <span class="nb">type</span><span class="o">=</span><span class="n">option_type</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="n">command_builder</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                    <span class="n">is_required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">options</span><span class="o">=</span><span class="n">command_builder</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">builder</span>
</pre></div>

        </details>

            <div class="docstring"><p>Get a builder object for this command.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.api.CommandBuilder</strong>: A builder object for this command. Use to declare this command on
globally or for a specific guild.</li>
</ul>
</div>


                            </div>
                            <div id="SlashCommandGroup.copy" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommandGroup.copy">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">copy</span><span class="signature">(
    self: ~_SlashCommandGroupT,
    *,
    _new: bool = True,
    parent: Optional[<a href="tanjun/abc.html#SlashCommandGroup">tanjun.abc.SlashCommandGroup</a>] = None
) -&gt; ~_SlashCommandGroupT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandGroupT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandGroupT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.ExecutableCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="n">_new</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Create a copy of this command.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: A copy of this command.</li>
</ul>
</div>


                            </div>
                            <div id="SlashCommandGroup.add_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommandGroup.add_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_command</span><span class="signature">(
    self: ~_SlashCommandGroupT,
    command: <a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>,
    /
) -&gt; ~_SlashCommandGroupT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandGroupT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandGroupT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a slash command to this group.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            Command groups are only supported within top-level groups.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.BaseSlashCommand</span>
<span class="sd">            Command to add to this group.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            Object of this group to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashCommandGroup</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot add a slash command group to a nested slash command group&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot add more than 25 commands to a slash command group&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Command with name </span><span class="si">{</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="si">!r}</span><span class="s2"> already exists in this group&quot;</span><span class="p">)</span>

        <span class="n">command</span><span class="o">.</span><span class="n">set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">command</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a slash command to this group.</p>

<p><em>Warning:</em>
Command groups are only supported within top-level groups.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (<a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>):
Command to add to this group.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: Object of this group to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="SlashCommandGroup.remove_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommandGroup.remove_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_command</span><span class="signature">(
    self: ~_SlashCommandGroupT,
    command: <a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>,
    /
) -&gt; ~_SlashCommandGroupT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandGroupT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashCommandGroupT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a command from this group.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.BaseSlashCommand</span>
<span class="sd">            Command to remove from this group.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            Object of this group to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a command from this group.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (<a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>):
Command to remove from this group.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: Object of this group to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="SlashCommandGroup.with_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommandGroup.with_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_command</span><span class="signature">(self, command: ~BaseSlashCommandT, /) -&gt; ~BaseSlashCommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a slash command to this group through a decorator call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.BaseSlashCommand</span>
<span class="sd">            Command to add to this group.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun.abc.BaseSlashCommand</span>
<span class="sd">            Command which was added to this group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">command</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a slash command to this group through a decorator call.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (<a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>):
Command to add to this group.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong><a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a></strong>: Command which was added to this group.</li>
</ul>
</div>


                            </div>
                            <div id="SlashCommandGroup.execute" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommandGroup.execute">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">execute</span><span class="signature">(
    self,
    ctx: <a href="tanjun/abc.html#SlashContext">tanjun.abc.SlashContext</a>,
    /,
    option: Optional[hikari.interactions.command_interactions.CommandInteractionOption] = None,
    *,
    hooks: Optional[collections.abc.MutableSet[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#SlashContext">tanjun.abc.SlashContext</a>]]] = None
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">option</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteractionOption</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.BaseSlashCommand&gt;&gt;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">option</span> <span class="ow">and</span> <span class="n">ctx</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">option</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">option</span> <span class="ow">and</span> <span class="n">option</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="n">option</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Missing sub-command option&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">command</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">defaults_to_ephemeral</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">set_ephemeral_default</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">defaults_to_ephemeral</span><span class="p">)</span>

            <span class="k">if</span> <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">option</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">()</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="SlashCommandGroup.load_into_component" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashCommandGroup.load_into_component">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">load_into_component</span><span class="signature">(
    self: ~_SlashCommandGroupT,
    component: <a href="tanjun/abc.html#Component">tanjun.abc.Component</a>,
    /
) -&gt; Optional[~_SlashCommandGroupT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">load_into_component</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_SlashCommandGroupT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_SlashCommandGroupT</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">components</span><span class="o">.</span><span class="n">LoadableProtocol</span><span class="p">):</span>
                <span class="n">command</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="tanjun/commands.html#BaseSlashCommand">tanjun.commands.BaseSlashCommand</a></dt>
                                <dd id="SlashCommandGroup.defaults_to_ephemeral" class="variable"><a href="tanjun/commands.html#BaseSlashCommand.defaults_to_ephemeral">defaults_to_ephemeral</a></dd>
                <dd id="SlashCommandGroup.description" class="variable"><a href="tanjun/commands.html#BaseSlashCommand.description">description</a></dd>
                <dd id="SlashCommandGroup.is_global" class="variable"><a href="tanjun/commands.html#BaseSlashCommand.is_global">is_global</a></dd>
                <dd id="SlashCommandGroup.name" class="variable"><a href="tanjun/commands.html#BaseSlashCommand.name">name</a></dd>
                <dd id="SlashCommandGroup.parent" class="variable"><a href="tanjun/commands.html#BaseSlashCommand.parent">parent</a></dd>
                <dd id="SlashCommandGroup.tracked_command_id" class="variable"><a href="tanjun/commands.html#BaseSlashCommand.tracked_command_id">tracked_command_id</a></dd>
                <dd id="SlashCommandGroup.set_tracked_command" class="function"><a href="tanjun/commands.html#BaseSlashCommand.set_tracked_command">set_tracked_command</a></dd>
                <dd id="SlashCommandGroup.set_ephemeral_default" class="function"><a href="tanjun/commands.html#BaseSlashCommand.set_ephemeral_default">set_ephemeral_default</a></dd>
                <dd id="SlashCommandGroup.set_parent" class="function"><a href="tanjun/commands.html#BaseSlashCommand.set_parent">set_parent</a></dd>
                <dd id="SlashCommandGroup.check_context" class="function"><a href="tanjun/commands.html#BaseSlashCommand.check_context">check_context</a></dd>

            </div>
            <div><dt><a href="tanjun/commands.html#PartialCommand">tanjun.commands.PartialCommand</a></dt>
                                <dd id="SlashCommandGroup.checks" class="variable"><a href="tanjun/commands.html#PartialCommand.checks">checks</a></dd>
                <dd id="SlashCommandGroup.component" class="variable"><a href="tanjun/commands.html#PartialCommand.component">component</a></dd>
                <dd id="SlashCommandGroup.hooks" class="variable"><a href="tanjun/commands.html#PartialCommand.hooks">hooks</a></dd>
                <dd id="SlashCommandGroup.metadata" class="variable"><a href="tanjun/commands.html#PartialCommand.metadata">metadata</a></dd>
                <dd id="SlashCommandGroup.needs_injector" class="variable"><a href="tanjun/commands.html#PartialCommand.needs_injector">needs_injector</a></dd>
                <dd id="SlashCommandGroup.set_hooks" class="function"><a href="tanjun/commands.html#PartialCommand.set_hooks">set_hooks</a></dd>
                <dd id="SlashCommandGroup.add_check" class="function"><a href="tanjun/commands.html#PartialCommand.add_check">add_check</a></dd>
                <dd id="SlashCommandGroup.remove_check" class="function"><a href="tanjun/commands.html#PartialCommand.remove_check">remove_check</a></dd>
                <dd id="SlashCommandGroup.with_check" class="function"><a href="tanjun/commands.html#PartialCommand.with_check">with_check</a></dd>
                <dd id="SlashCommandGroup.bind_client" class="function"><a href="tanjun/commands.html#PartialCommand.bind_client">bind_client</a></dd>
                <dd id="SlashCommandGroup.bind_component" class="function"><a href="tanjun/commands.html#PartialCommand.bind_component">bind_component</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="with_str_slash_option">
                            <div class="attr function"><a class="headerlink" href="#with_str_slash_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_str_slash_option</span><span class="signature">(
    name: str,
    description: str,
    /,
    *,
    choices: Union[collections.abc.Mapping[str, str], collections.abc.Sequence[str], NoneType] = None,
    converters: Union[collections.abc.Sequence[collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]], collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]] = (),
    default: Any = &lt;object object&gt;,
    pass_as_kwarg: bool = True
) -&gt; collections.abc.Callable[[~_SlashCommandT], ~_SlashCommandT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_str_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
    <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a string option to a slash command.</span>

<span class="sd">    For more information on this function&#39;s parameters see `SlashCommand.add_str_option`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_str_slash_option(&quot;name&quot;, &quot;A name.&quot;)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, name: str) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_str_option</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">description</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
        <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a string option to a slash command.</p>

<p>For more information on this function's parameters see <code><a href="#SlashCommand.add_str_option">SlashCommand.add_str_option</a></code>.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="nd">@with_str_slash_option</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;A name.&quot;</span><span class="p">)</span>
<span class="nd">@as_slash_command</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="s2">&quot;A command&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</strong>: Decorator callback which adds the option to the command.</li>
</ul>
</div>


                </section>
                <section id="with_int_slash_option">
                            <div class="attr function"><a class="headerlink" href="#with_int_slash_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_int_slash_option</span><span class="signature">(
    name: str,
    description: str,
    /,
    *,
    choices: Optional[collections.abc.Mapping[str, int]] = None,
    converters: Union[collections.abc.Collection[collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]], collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]] = (),
    default: Any = &lt;object object&gt;,
    pass_as_kwarg: bool = True
) -&gt; collections.abc.Callable[[~_SlashCommandT], ~_SlashCommandT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_int_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
    <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add an integer option to a slash command.</span>

<span class="sd">    For information on this function&#39;s parameters see `SlashCommand.add_int_option`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_int_slash_option(&quot;int_value&quot;, &quot;Int value.&quot;)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, int_value: int) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_int_option</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">description</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
        <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add an integer option to a slash command.</p>

<p>For information on this function's parameters see <code><a href="#SlashCommand.add_int_option">SlashCommand.add_int_option</a></code>.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="nd">@with_int_slash_option</span><span class="p">(</span><span class="s2">&quot;int_value&quot;</span><span class="p">,</span> <span class="s2">&quot;Int value.&quot;</span><span class="p">)</span>
<span class="nd">@as_slash_command</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="s2">&quot;A command&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="n">int_value</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</strong>: Decorator callback which adds the option to the command.</li>
</ul>
</div>


                </section>
                <section id="with_float_slash_option">
                            <div class="attr function"><a class="headerlink" href="#with_float_slash_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_float_slash_option</span><span class="signature">(
    name: str,
    description: str,
    /,
    *,
    always_float: bool = True,
    choices: Optional[collections.abc.Mapping[str, float]] = None,
    converters: Union[collections.abc.Collection[collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]], collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]] = (),
    default: Any = &lt;object object&gt;,
    pass_as_kwarg: bool = True
) -&gt; collections.abc.Callable[[~_SlashCommandT], ~_SlashCommandT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_float_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">always_float</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">choices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
    <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a float option to a slash command.</span>

<span class="sd">    For information on this function&#39;s parameters see `SlashCommand.add_float_option`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_float_slash_option(&quot;float_value&quot;, &quot;Float value.&quot;)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, float_value: float) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_float_option</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">description</span><span class="p">,</span>
        <span class="n">always_float</span><span class="o">=</span><span class="n">always_float</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
        <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span>
        <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a float option to a slash command.</p>

<p>For information on this function's parameters see <code><a href="#SlashCommand.add_float_option">SlashCommand.add_float_option</a></code>.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="nd">@with_float_slash_option</span><span class="p">(</span><span class="s2">&quot;float_value&quot;</span><span class="p">,</span> <span class="s2">&quot;Float value.&quot;</span><span class="p">)</span>
<span class="nd">@as_slash_command</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="s2">&quot;A command&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="n">float_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</strong>: Decorator callback which adds the option to the command.</li>
</ul>
</div>


                </section>
                <section id="with_bool_slash_option">
                            <div class="attr function"><a class="headerlink" href="#with_bool_slash_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_bool_slash_option</span><span class="signature">(
    name: str,
    description: str,
    /,
    *,
    default: Any = &lt;object object&gt;,
    pass_as_kwarg: bool = True
) -&gt; collections.abc.Callable[[~_SlashCommandT], ~_SlashCommandT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_bool_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a boolean option to a slash command.</span>

<span class="sd">    For information on this function&#39;s parameters see `SlashContext.add_bool_option`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_bool_slash_option(&quot;flag&quot;, &quot;Whether this flag should be enabled.&quot;, default=False)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, flag: bool) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_bool_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a boolean option to a slash command.</p>

<p>For information on this function's parameters see <code>SlashContext.add_bool_option</code>.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="nd">@with_bool_slash_option</span><span class="p">(</span><span class="s2">&quot;flag&quot;</span><span class="p">,</span> <span class="s2">&quot;Whether this flag should be enabled.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nd">@as_slash_command</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="s2">&quot;A command&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</strong>: Decorator callback which adds the option to the command.</li>
</ul>
</div>


                </section>
                <section id="with_role_slash_option">
                            <div class="attr function"><a class="headerlink" href="#with_role_slash_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_role_slash_option</span><span class="signature">(
    name: str,
    description: str,
    /,
    *,
    default: Any = &lt;object object&gt;,
    pass_as_kwarg: bool = True
) -&gt; collections.abc.Callable[[~_SlashCommandT], ~_SlashCommandT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_role_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a role option to a slash command.</span>

<span class="sd">    For information on this function&#39;s parameters see `SlashCommand.add_role_option`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_role_slash_option(&quot;role&quot;, &quot;Role to target.&quot;)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, role: hikari.Role) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_role_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a role option to a slash command.</p>

<p>For information on this function's parameters see <code><a href="#SlashCommand.add_role_option">SlashCommand.add_role_option</a></code>.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="nd">@with_role_slash_option</span><span class="p">(</span><span class="s2">&quot;role&quot;</span><span class="p">,</span> <span class="s2">&quot;Role to target.&quot;</span><span class="p">)</span>
<span class="nd">@as_slash_command</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="s2">&quot;A command&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="n">role</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</strong>: Decorator callback which adds the option to the command.</li>
</ul>
</div>


                </section>
                <section id="with_user_slash_option">
                            <div class="attr function"><a class="headerlink" href="#with_user_slash_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_user_slash_option</span><span class="signature">(
    name: str,
    description: str,
    /,
    *,
    default: Any = &lt;object object&gt;,
    pass_as_kwarg: bool = True
) -&gt; collections.abc.Callable[[~_SlashCommandT], ~_SlashCommandT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_user_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a user option to a slash command.</span>

<span class="sd">    For information on this function&#39;s parameters see `SlashContext.add_user_option`.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This may result in `hikari.InteractionMember` or</span>
<span class="sd">        `hikari.users.User` if the user isn&#39;t in the current guild or if this</span>
<span class="sd">        command was executed in a DM channel.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_user_slash_option(&quot;user&quot;, &quot;user to target.&quot;)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, user: Union[InteractionMember, User]) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_user_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a user option to a slash command.</p>

<p>For information on this function's parameters see <code>SlashContext.add_user_option</code>.</p>

<p><em>Note:</em>
This may result in <code>hikari.InteractionMember</code> or
<code>hikari.users.User</code> if the user isn't in the current guild or if this
command was executed in a DM channel.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="nd">@with_user_slash_option</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;user to target.&quot;</span><span class="p">)</span>
<span class="nd">@as_slash_command</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="s2">&quot;A command&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">InteractionMember</span><span class="p">,</span> <span class="n">User</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</strong>: Decorator callback which adds the option to the command.</li>
</ul>
</div>


                </section>
                <section id="with_member_slash_option">
                            <div class="attr function"><a class="headerlink" href="#with_member_slash_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_member_slash_option</span><span class="signature">(
    name: str,
    description: str,
    /,
    *,
    default: Any = &lt;object object&gt;
) -&gt; collections.abc.Callable[[~_SlashCommandT], ~_SlashCommandT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_member_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a member option to a slash command.</span>

<span class="sd">    For information on this function&#39;s arguments see `SlashCommand.add_member_option`.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This will always result in `hikari.InteractionMember`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_member_slash_option(&quot;member&quot;, &quot;member to target.&quot;)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, member: hikari.InteractionMember) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_member_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a member option to a slash command.</p>

<p>For information on this function's arguments see <code><a href="#SlashCommand.add_member_option">SlashCommand.add_member_option</a></code>.</p>

<p><em>Note:</em>
This will always result in <code>hikari.InteractionMember</code>.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="nd">@with_member_slash_option</span><span class="p">(</span><span class="s2">&quot;member&quot;</span><span class="p">,</span> <span class="s2">&quot;member to target.&quot;</span><span class="p">)</span>
<span class="nd">@as_slash_command</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="s2">&quot;A command&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="n">member</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</strong>: Decorator callback which adds the option to the command.</li>
</ul>
</div>


                </section>
                <section id="with_channel_slash_option">
                            <div class="attr function"><a class="headerlink" href="#with_channel_slash_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_channel_slash_option</span><span class="signature">(
    name: str,
    description: str,
    /,
    *,
    types: &#39;collections.Collection[type[hikari.PartialChannel]] | None&#39; = None,
    default: Any = &lt;object object&gt;,
    pass_as_kwarg: bool = True
) -&gt; collections.abc.Callable[[~_SlashCommandT], ~_SlashCommandT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_channel_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">types</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialChannel</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span>
    <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a channel option to a slash command.</span>

<span class="sd">    For information on this function&#39;s parameters see `SlashCommand.add_channel_option`.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This will always result in `hikari..InteractionChannel`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_channel_slash_option(&quot;channel&quot;, &quot;channel to target.&quot;)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, channel: hikari.InteractionChannel) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_channel_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="n">types</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a channel option to a slash command.</p>

<p>For information on this function's parameters see <code><a href="#SlashCommand.add_channel_option">SlashCommand.add_channel_option</a></code>.</p>

<p><em>Note:</em>
This will always result in <code>hikari..InteractionChannel</code>.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="nd">@with_channel_slash_option</span><span class="p">(</span><span class="s2">&quot;channel&quot;</span><span class="p">,</span> <span class="s2">&quot;channel to target.&quot;</span><span class="p">)</span>
<span class="nd">@as_slash_command</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="s2">&quot;A command&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="n">channel</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionChannel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</strong>: Decorator callback which adds the option to the command.</li>
</ul>
</div>


                </section>
                <section id="with_mentionable_slash_option">
                            <div class="attr function"><a class="headerlink" href="#with_mentionable_slash_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_mentionable_slash_option</span><span class="signature">(
    name: str,
    description: str,
    /,
    *,
    default: Any = &lt;object object&gt;,
    pass_as_kwarg: bool = True
) -&gt; collections.abc.Callable[[~_SlashCommandT], ~_SlashCommandT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_mentionable_slash_option</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_UNDEFINED_DEFAULT</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_SlashCommandT</span><span class="p">],</span> <span class="n">_SlashCommandT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a mentionable option to a slash command.</span>

<span class="sd">    For information on this function&#39;s arguments see `SlashCommand.add_mentionable_option`.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This may target roles, guild members or users and results in</span>
<span class="sd">        `Union[hikari.User, hikari.InteractionMember, hikari.Role]`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @with_mentionable_slash_option(&quot;mentionable&quot;, &quot;Mentionable entity to target.&quot;)</span>
<span class="sd">    @as_slash_command(&quot;command&quot;, &quot;A command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.SlashContext, mentionable: [Role, InteractionMember, User]) -&gt; None:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</span>
<span class="sd">        Decorator callback which adds the option to the command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">add_mentionable_option</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">pass_as_kwarg</span><span class="o">=</span><span class="n">pass_as_kwarg</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a mentionable option to a slash command.</p>

<p>For information on this function's arguments see <code><a href="#SlashCommand.add_mentionable_option">SlashCommand.add_mentionable_option</a></code>.</p>

<p><em>Note:</em>
This may target roles, guild members or users and results in
<code>Union[hikari.User, hikari.InteractionMember, hikari.Role]</code>.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="nd">@with_mentionable_slash_option</span><span class="p">(</span><span class="s2">&quot;mentionable&quot;</span><span class="p">,</span> <span class="s2">&quot;Mentionable entity to target.&quot;</span><span class="p">)</span>
<span class="nd">@as_slash_command</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="s2">&quot;A command&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="n">mentionable</span><span class="p">:</span> <span class="p">[</span><span class="n">Role</span><span class="p">,</span> <span class="n">InteractionMember</span><span class="p">,</span> <span class="n">User</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[_SlashCommandT], _SlashCommandT]</strong>: Decorator callback which adds the option to the command.</li>
</ul>
</div>


                </section>
                <section id="components">
                                <div class="attr module"><a class="headerlink" href="#components">#&nbsp;&nbsp</a>
<span class="name"><a href="tanjun/components.html">tanjun.components</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;Standard implementation of Tanjun&#39;s &quot;components&quot; used to manage separate features within a client.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CommandT&quot;</span><span class="p">,</span> <span class="s2">&quot;Component&quot;</span><span class="p">,</span> <span class="s2">&quot;LoadableProtocol&quot;</span><span class="p">,</span> <span class="s2">&quot;WithCommandReturnSig&quot;</span><span class="p">]</span>

<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">collections</span>

<span class="kn">from</span> <span class="nn">hikari.events</span> <span class="kn">import</span> <span class="n">base_events</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">abc</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">checks</span> <span class="k">as</span> <span class="n">checks_</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">errors</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">utilities</span>

<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="n">_ComponentT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_ComponentT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;Component&quot;</span><span class="p">)</span>
    <span class="n">_T</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_T&quot;</span><span class="p">)</span>


<span class="n">CommandT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;CommandT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;abc.ExecutableCommand[typing.Any]&quot;</span><span class="p">)</span>
<span class="n">_LOGGER</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;hikari.tanjun.components&quot;</span><span class="p">)</span>
<span class="c1"># This errors on earlier 3.9 releases when not quotes cause dumb handling of the [CommandT] list</span>
<span class="n">WithCommandReturnSig</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">CommandT</span><span class="p">,</span> <span class="s2">&quot;collections.Callable[[CommandT], CommandT]&quot;</span><span class="p">]</span>


<span class="nd">@typing</span><span class="o">.</span><span class="n">runtime_checkable</span>
<span class="k">class</span> <span class="nc">LoadableProtocol</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Protocol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Protocol of an object which can be loaded into a component from an instance variable.&quot;&quot;&quot;</span>

    <span class="c1"># This fucks with MyPy even though at runtime python just straight out ignores slots when considering protocol</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>  <span class="c1"># compatibility.</span>
        <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Copy the object.</span>

<span class="sd">        This will be called before load_into_component.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The copied object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">load_into_component</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Load the object into the component.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        component : tanjun.abc.Component</span>
<span class="sd">            The component this object should be loaded into.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[typing.Any]</span>
<span class="sd">            An object to replace the attribute this object was found at.</span>
<span class="sd">            If `None` is returned, the attribute will be left as-is.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>


<span class="k">def</span> <span class="nf">_with_command</span><span class="p">(</span>
    <span class="n">add_command</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandT</span><span class="p">],</span> <span class="n">Component</span><span class="p">],</span>
    <span class="n">maybe_command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CommandT</span><span class="p">],</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WithCommandReturnSig</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">maybe_command</span><span class="p">:</span>
        <span class="n">maybe_command</span> <span class="o">=</span> <span class="n">maybe_command</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="n">copy</span> <span class="k">else</span> <span class="n">maybe_command</span>
        <span class="n">add_command</span><span class="p">(</span><span class="n">maybe_command</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">maybe_command</span>

    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">command</span><span class="p">:</span> <span class="n">CommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandT</span><span class="p">:</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="n">copy</span> <span class="k">else</span> <span class="n">command</span>
        <span class="n">add_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">command</span>

    <span class="k">return</span> <span class="n">decorator</span>


<span class="k">def</span> <span class="nf">_filter_scope</span><span class="p">(</span><span class="n">scope</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">scope</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">))</span>


<span class="c1"># TODO: do we want to setup a custom equality and hash here to make it easier to unload components?</span>
<span class="k">class</span> <span class="nc">Component</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Standard implementation of `tanjun.abc.Component`.</span>

<span class="sd">    This is a collcetion of commands (both message and slash), hooks and listener</span>
<span class="sd">    callbacks which can be added to a generic client.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This implementation supports dependency injection for its checks,</span>
<span class="sd">        command callbacks and listeners when linked to a client which</span>
<span class="sd">        supports dependency injection.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    checks : typing.Optional[collections.abc.Iterable[abc.CheckSig]]</span>
<span class="sd">        Iterable of check callbacks to set for this component, if provided.</span>
<span class="sd">    hooks : typing.Optional[tanjun.abc.AnyHooks]</span>
<span class="sd">        The hooks this component should add to the execution of all its</span>
<span class="sd">        commands (message and slash).</span>
<span class="sd">    slash_hooks : typing.Optional[tanjun.abc.SlashHooks]</span>
<span class="sd">        The slash hooks this component should add to the execution of its</span>
<span class="sd">        slash commands.</span>
<span class="sd">    message_hooks : typing.Optional[tanjun.abc.MessageHooks]</span>
<span class="sd">        The message hooks this component should add to the execution of its</span>
<span class="sd">        message commands.</span>
<span class="sd">    name : str</span>
<span class="sd">        The component&#39;s identifier.</span>

<span class="sd">        If not provided then this will be a random string.</span>
<span class="sd">    strict : bool</span>
<span class="sd">        Whether this component should use a stricter (more optimal) approach</span>
<span class="sd">        for message command search.</span>

<span class="sd">        When this is `True`, message command names will not be allowed to contain</span>
<span class="sd">        spaces and will have to be unique to one command within the component.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_checks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_client&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_client_callbacks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_defaults_to_ephemeral&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_hooks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_is_strict&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_listeners&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_message_commands&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_message_hooks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_metadata&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_names_to_commands&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_slash_commands&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_slash_hooks&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">checks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">slash_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">message_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">checks_</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">[</span><span class="n">checks_</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">(</span><span class="n">check</span><span class="p">)</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">checks</span><span class="p">)]</span> <span class="k">if</span> <span class="n">checks</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span> <span class="o">=</span> <span class="n">strict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">base_events</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span> <span class="o">=</span> <span class="n">message_hooks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randbytes</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span> <span class="o">=</span> <span class="n">slash_hooks</span>

        <span class="k">if</span> <span class="n">load_from_attributes</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Component</span><span class="p">:</span>  <span class="c1"># No need to run this on the base class.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_load_from_properties</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">checks</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">hooks</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">slash_hooks</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">message_hooks</span><span class="si">=}</span><span class="s2">)&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">checks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">check</span><span class="o">.</span><span class="n">callback</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">defaults_to_ephemeral</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">slash_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">message_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">message_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">needs_injector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">check</span><span class="o">.</span><span class="n">needs_injector</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">listeners</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">base_events</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">]]:</span>
        <span class="k">return</span> <span class="n">utilities</span><span class="o">.</span><span class="n">CastedView</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span> <span class="o">=</span> <span class="p">[</span><span class="n">check</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">event</span><span class="p">:</span> <span class="p">[</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">listener</span><span class="p">)</span> <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">]</span> <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>
            <span class="n">commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">command</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">commands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">commands</span><span class="p">[</span><span class="n">command</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">detect_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">detect_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">include_globals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">detect_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">include_globals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">scope</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load top-level commands into the component from the calling scope.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This will ignore commands which are owned by command groups.</span>
<span class="sd">        * This will detect commands from the calling scope unless `scope` is</span>
<span class="sd">          passed but this isn&#39;t possible in a stack-less python implementation;</span>
<span class="sd">          in stack-less environments the scope will have to be explicitly</span>
<span class="sd">          passed as `scope`.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        include_globals: bool</span>
<span class="sd">            Whether to include global variables (along with local) while</span>
<span class="sd">            detecting from the calling scope.</span>

<span class="sd">            This defaults to `False`, cannot be `True` when `scope` is provided</span>
<span class="sd">            and will only ever be needed when the local scope is different</span>
<span class="sd">            from the global scope.</span>
<span class="sd">        scope : typing.Optional[collections.Mapping[str, typing.Any]]</span>
<span class="sd">            The scope to detect commands from.</span>

<span class="sd">            This overrides the default usage of stackframe introspection.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The current component to allow for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If this is called in a python implementation which doesn&#39;t support</span>
<span class="sd">            stack frame inspection when `scope` is not provided.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If `scope` is provided when `include_globals` is True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scope</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">stack</span> <span class="o">:=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">stack</span><span class="o">.</span><span class="n">f_back</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;Stackframe introspection is not supported in this runtime. Please explicitly pass `scope`.&quot;</span>
                <span class="p">)</span>

            <span class="n">values_iter</span> <span class="o">=</span> <span class="n">_filter_scope</span><span class="p">(</span><span class="n">stack</span><span class="o">.</span><span class="n">f_back</span><span class="o">.</span><span class="n">f_locals</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">include_globals</span><span class="p">:</span>
                <span class="n">values_iter</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="n">values_iter</span><span class="p">,</span> <span class="n">_filter_scope</span><span class="p">(</span><span class="n">stack</span><span class="o">.</span><span class="n">f_back</span><span class="o">.</span><span class="n">f_globals</span><span class="p">))</span>

        <span class="k">elif</span> <span class="n">include_globals</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot specify include_globals as True when scope is passed&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">values_iter</span> <span class="o">=</span> <span class="n">_filter_scope</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Loading commands for </span><span class="si">%s</span><span class="s2"> component from </span><span class="si">%s</span><span class="s2"> parent scope(s)&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;global and local&quot;</span> <span class="k">if</span> <span class="n">include_globals</span> <span class="k">else</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values_iter</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_slash_command</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message_command</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1"># def into_loader()</span>

    <span class="k">def</span> <span class="nf">set_ephemeral_default</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set whether slash contexts executed in this component should default to ephemeral responses.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        typing.Optional[bool]</span>
<span class="sd">            Whether slash command contexts executed in this component should</span>
<span class="sd">            should default to ephemeral.</span>
<span class="sd">            This will be overridden by any response calls which specify flags.</span>

<span class="sd">            Setting this to `None` will let the default set on the parent</span>
<span class="sd">            client propagate and decide the ephemeral default behaviour.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This component to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">hooks_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span> <span class="o">=</span> <span class="n">hooks_</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_message_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">hooks_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span> <span class="o">=</span> <span class="n">hooks_</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">check</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checks_</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">(</span><span class="n">check</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;checks_.InjectableCheck&quot;</span><span class="p">,</span> <span class="n">check</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">check</span>

    <span class="k">def</span> <span class="nf">add_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">event_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="n">event_name</span> <span class="o">=</span> <span class="n">event_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">callback</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">get_client_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">]:</span>
        <span class="n">event_name</span> <span class="o">=</span> <span class="n">event_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event_name</span><span class="p">)</span> <span class="ow">or</span> <span class="p">()</span>

    <span class="k">def</span> <span class="nf">remove_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">event_name</span> <span class="o">=</span> <span class="n">event_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">remove_client_callback</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">with_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">]:</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="k">def</span> <span class="nf">add_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_slash_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unexpected object passed, expected a MessageCommand or BaseSlashCommand but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_message_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_slash_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unexpected object passed, expected a MessageCommand or BaseSlashCommand but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">with_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">CommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandT</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">with_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandT</span><span class="p">],</span> <span class="n">CommandT</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">with_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WithCommandReturnSig</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_with_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_command</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_slash_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="n">command</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="n">command</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()]</span> <span class="o">=</span> <span class="n">command</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_slash_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Command </span><span class="si">{</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">with_slash_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">with_slash_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">with_slash_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WithCommandReturnSig</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_with_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_slash_command</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_message_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a message command to the component.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.MessageCommand</span>
<span class="sd">            The command to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The component to allow method chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If one of the command&#39;s name is already registered in a strict</span>
<span class="sd">            component.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Command name cannot contain spaces for this component implementation&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">name_conflicts</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Sub-command names must be unique in a strict component. &quot;</span>
                    <span class="s2">&quot;The following conflicts were found &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_conflicts</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">)</span>

        <span class="n">command</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_message_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="n">command</span><span class="p">:</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">with_message_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandT</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">with_message_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandT</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandT</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">with_message_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WithCommandReturnSig</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandT</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_with_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_message_command</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">base_events</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">listener</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">listener</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">listener</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">listener</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">add_listener</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">base_events</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">listener</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">listener</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">remove_listener</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1"># TODO: make event optional?</span>
    <span class="k">def</span> <span class="nf">with_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">base_events</span><span class="o">.</span><span class="n">Event</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">]:</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_listener</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Client already set&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="k">for</span> <span class="n">message_command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="p">:</span>
            <span class="n">message_command</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">slash_command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">slash_command</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">add_listener</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">event_name</span><span class="p">,</span> <span class="n">callbacks</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">unbind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">!=</span> <span class="n">client</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Component isn&#39;t bound to this client&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">remove_listener</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">LookupError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                    <span class="k">pass</span>

        <span class="k">for</span> <span class="n">event_name</span><span class="p">,</span> <span class="n">callbacks</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">remove_client_callback</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">LookupError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                    <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_check_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">gather_checks</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_check_message_context</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]]:</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">set_component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">command</span> <span class="ow">and</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="ow">and</span> <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">set_component</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

            <span class="k">return</span>

        <span class="n">checks_run</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_message_name</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">checks_run</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                    <span class="k">return</span>

                <span class="n">checks_run</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span>

        <span class="n">ctx</span><span class="o">.</span><span class="n">set_component</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_message_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">command</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">:=</span> <span class="n">utilities</span><span class="o">.</span><span class="n">match_prefix_names</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span>
                <span class="c1"># Don&#39;t want to match a command multiple times</span>
                <span class="k">continue</span>

    <span class="k">def</span> <span class="nf">check_slash_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">command</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">command</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_execute_interaction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">],</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">command</span> <span class="ow">or</span> <span class="ow">not</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">None</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">())</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_future</span><span class="p">()</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hooks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hooks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

            <span class="n">hooks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hooks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hooks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

            <span class="n">hooks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">))</span>

    <span class="c1"># To ensure that ctx.set_ephemeral_default is called as soon as possible if</span>
    <span class="c1"># a match is found the public function is kept sync to avoid yielding</span>
    <span class="c1"># to the event loop until after this is set.</span>
    <span class="k">def</span> <span class="nf">execute_interaction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Coroutine</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]:</span>
        <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">command_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">command</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">defaults_to_ephemeral</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">set_ephemeral_default</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">defaults_to_ephemeral</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">set_ephemeral_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_interaction</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute_message</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_message_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">set_triggering_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="p">:]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">set_component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="c1"># Only add our hooks if we&#39;re sure we&#39;ll be executing the command here.</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">hooks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">hooks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

                <span class="n">hooks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">hooks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">hooks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

                <span class="n">hooks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">)</span>

            <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="n">ctx</span><span class="o">.</span><span class="n">set_component</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_load_from_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">LoadableProtocol</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">result</span> <span class="o">:=</span> <span class="n">member</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Standard implementation of Tanjun's "components" used to manage separate features within a client.</p>
</div>


                </section>
                <section id="Component">
                                <div class="attr class">
        <a class="headerlink" href="#Component">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">Component</span><wbr>(<span class="base"><a href="tanjun/abc.html#Component">tanjun.abc.Component</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Component</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Standard implementation of `tanjun.abc.Component`.</span>

<span class="sd">    This is a collcetion of commands (both message and slash), hooks and listener</span>
<span class="sd">    callbacks which can be added to a generic client.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This implementation supports dependency injection for its checks,</span>
<span class="sd">        command callbacks and listeners when linked to a client which</span>
<span class="sd">        supports dependency injection.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    checks : typing.Optional[collections.abc.Iterable[abc.CheckSig]]</span>
<span class="sd">        Iterable of check callbacks to set for this component, if provided.</span>
<span class="sd">    hooks : typing.Optional[tanjun.abc.AnyHooks]</span>
<span class="sd">        The hooks this component should add to the execution of all its</span>
<span class="sd">        commands (message and slash).</span>
<span class="sd">    slash_hooks : typing.Optional[tanjun.abc.SlashHooks]</span>
<span class="sd">        The slash hooks this component should add to the execution of its</span>
<span class="sd">        slash commands.</span>
<span class="sd">    message_hooks : typing.Optional[tanjun.abc.MessageHooks]</span>
<span class="sd">        The message hooks this component should add to the execution of its</span>
<span class="sd">        message commands.</span>
<span class="sd">    name : str</span>
<span class="sd">        The component&#39;s identifier.</span>

<span class="sd">        If not provided then this will be a random string.</span>
<span class="sd">    strict : bool</span>
<span class="sd">        Whether this component should use a stricter (more optimal) approach</span>
<span class="sd">        for message command search.</span>

<span class="sd">        When this is `True`, message command names will not be allowed to contain</span>
<span class="sd">        spaces and will have to be unique to one command within the component.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_checks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_client&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_client_callbacks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_defaults_to_ephemeral&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_hooks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_is_strict&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_listeners&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_message_commands&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_message_hooks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_metadata&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_names_to_commands&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_slash_commands&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_slash_hooks&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">checks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">slash_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">message_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">checks_</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">[</span><span class="n">checks_</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">(</span><span class="n">check</span><span class="p">)</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">checks</span><span class="p">)]</span> <span class="k">if</span> <span class="n">checks</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span> <span class="o">=</span> <span class="n">strict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">base_events</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span> <span class="o">=</span> <span class="n">message_hooks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randbytes</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span> <span class="o">=</span> <span class="n">slash_hooks</span>

        <span class="k">if</span> <span class="n">load_from_attributes</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Component</span><span class="p">:</span>  <span class="c1"># No need to run this on the base class.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_load_from_properties</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">checks</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">hooks</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">slash_hooks</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">message_hooks</span><span class="si">=}</span><span class="s2">)&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">checks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">check</span><span class="o">.</span><span class="n">callback</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">defaults_to_ephemeral</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">slash_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">message_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">message_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">needs_injector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">check</span><span class="o">.</span><span class="n">needs_injector</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">listeners</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">base_events</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">]]:</span>
        <span class="k">return</span> <span class="n">utilities</span><span class="o">.</span><span class="n">CastedView</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span> <span class="o">=</span> <span class="p">[</span><span class="n">check</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">event</span><span class="p">:</span> <span class="p">[</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">listener</span><span class="p">)</span> <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">]</span> <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>
            <span class="n">commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">command</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">commands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">commands</span><span class="p">[</span><span class="n">command</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">detect_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">detect_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">include_globals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">detect_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">include_globals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">scope</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load top-level commands into the component from the calling scope.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This will ignore commands which are owned by command groups.</span>
<span class="sd">        * This will detect commands from the calling scope unless `scope` is</span>
<span class="sd">          passed but this isn&#39;t possible in a stack-less python implementation;</span>
<span class="sd">          in stack-less environments the scope will have to be explicitly</span>
<span class="sd">          passed as `scope`.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        include_globals: bool</span>
<span class="sd">            Whether to include global variables (along with local) while</span>
<span class="sd">            detecting from the calling scope.</span>

<span class="sd">            This defaults to `False`, cannot be `True` when `scope` is provided</span>
<span class="sd">            and will only ever be needed when the local scope is different</span>
<span class="sd">            from the global scope.</span>
<span class="sd">        scope : typing.Optional[collections.Mapping[str, typing.Any]]</span>
<span class="sd">            The scope to detect commands from.</span>

<span class="sd">            This overrides the default usage of stackframe introspection.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The current component to allow for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If this is called in a python implementation which doesn&#39;t support</span>
<span class="sd">            stack frame inspection when `scope` is not provided.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If `scope` is provided when `include_globals` is True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scope</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">stack</span> <span class="o">:=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">stack</span><span class="o">.</span><span class="n">f_back</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;Stackframe introspection is not supported in this runtime. Please explicitly pass `scope`.&quot;</span>
                <span class="p">)</span>

            <span class="n">values_iter</span> <span class="o">=</span> <span class="n">_filter_scope</span><span class="p">(</span><span class="n">stack</span><span class="o">.</span><span class="n">f_back</span><span class="o">.</span><span class="n">f_locals</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">include_globals</span><span class="p">:</span>
                <span class="n">values_iter</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="n">values_iter</span><span class="p">,</span> <span class="n">_filter_scope</span><span class="p">(</span><span class="n">stack</span><span class="o">.</span><span class="n">f_back</span><span class="o">.</span><span class="n">f_globals</span><span class="p">))</span>

        <span class="k">elif</span> <span class="n">include_globals</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot specify include_globals as True when scope is passed&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">values_iter</span> <span class="o">=</span> <span class="n">_filter_scope</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Loading commands for </span><span class="si">%s</span><span class="s2"> component from </span><span class="si">%s</span><span class="s2"> parent scope(s)&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;global and local&quot;</span> <span class="k">if</span> <span class="n">include_globals</span> <span class="k">else</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values_iter</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_slash_command</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message_command</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1"># def into_loader()</span>

    <span class="k">def</span> <span class="nf">set_ephemeral_default</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set whether slash contexts executed in this component should default to ephemeral responses.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        typing.Optional[bool]</span>
<span class="sd">            Whether slash command contexts executed in this component should</span>
<span class="sd">            should default to ephemeral.</span>
<span class="sd">            This will be overridden by any response calls which specify flags.</span>

<span class="sd">            Setting this to `None` will let the default set on the parent</span>
<span class="sd">            client propagate and decide the ephemeral default behaviour.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This component to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">hooks_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span> <span class="o">=</span> <span class="n">hooks_</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_message_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">hooks_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span> <span class="o">=</span> <span class="n">hooks_</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">check</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checks_</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">(</span><span class="n">check</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;checks_.InjectableCheck&quot;</span><span class="p">,</span> <span class="n">check</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">check</span>

    <span class="k">def</span> <span class="nf">add_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">event_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="n">event_name</span> <span class="o">=</span> <span class="n">event_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">callback</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">get_client_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">]:</span>
        <span class="n">event_name</span> <span class="o">=</span> <span class="n">event_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event_name</span><span class="p">)</span> <span class="ow">or</span> <span class="p">()</span>

    <span class="k">def</span> <span class="nf">remove_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">event_name</span> <span class="o">=</span> <span class="n">event_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">remove_client_callback</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">with_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">]:</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="k">def</span> <span class="nf">add_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_slash_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unexpected object passed, expected a MessageCommand or BaseSlashCommand but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_message_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_slash_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unexpected object passed, expected a MessageCommand or BaseSlashCommand but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">with_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">CommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandT</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">with_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CommandT</span><span class="p">],</span> <span class="n">CommandT</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">with_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WithCommandReturnSig</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_with_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_command</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_slash_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="n">command</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="n">command</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()]</span> <span class="o">=</span> <span class="n">command</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_slash_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Command </span><span class="si">{</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">with_slash_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">with_slash_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">with_slash_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WithCommandReturnSig</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_with_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_slash_command</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_message_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a message command to the component.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.MessageCommand</span>
<span class="sd">            The command to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The component to allow method chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If one of the command&#39;s name is already registered in a strict</span>
<span class="sd">            component.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Command name cannot contain spaces for this component implementation&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">name_conflicts</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Sub-command names must be unique in a strict component. &quot;</span>
                    <span class="s2">&quot;The following conflicts were found &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_conflicts</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">)</span>

        <span class="n">command</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_message_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="n">command</span><span class="p">:</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">with_message_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandT</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">with_message_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandT</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandT</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">with_message_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WithCommandReturnSig</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandT</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_with_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_message_command</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">base_events</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">listener</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">listener</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">listener</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">listener</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">add_listener</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">base_events</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">listener</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">listener</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">remove_listener</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1"># TODO: make event optional?</span>
    <span class="k">def</span> <span class="nf">with_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">base_events</span><span class="o">.</span><span class="n">Event</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">]:</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_listener</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Client already set&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="k">for</span> <span class="n">message_command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="p">:</span>
            <span class="n">message_command</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">slash_command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">slash_command</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">add_listener</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">event_name</span><span class="p">,</span> <span class="n">callbacks</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">unbind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">!=</span> <span class="n">client</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Component isn&#39;t bound to this client&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">remove_listener</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">LookupError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                    <span class="k">pass</span>

        <span class="k">for</span> <span class="n">event_name</span><span class="p">,</span> <span class="n">callbacks</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">remove_client_callback</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">LookupError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                    <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_check_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">gather_checks</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_check_message_context</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]]:</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">set_component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">command</span> <span class="ow">and</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="ow">and</span> <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">set_component</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

            <span class="k">return</span>

        <span class="n">checks_run</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_message_name</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">checks_run</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                    <span class="k">return</span>

                <span class="n">checks_run</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span>

        <span class="n">ctx</span><span class="o">.</span><span class="n">set_component</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_message_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">command</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">:=</span> <span class="n">utilities</span><span class="o">.</span><span class="n">match_prefix_names</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span>
                <span class="c1"># Don&#39;t want to match a command multiple times</span>
                <span class="k">continue</span>

    <span class="k">def</span> <span class="nf">check_slash_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">command</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">command</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_execute_interaction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">],</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">command</span> <span class="ow">or</span> <span class="ow">not</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">check_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">None</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">())</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_future</span><span class="p">()</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hooks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hooks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

            <span class="n">hooks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hooks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hooks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

            <span class="n">hooks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">))</span>

    <span class="c1"># To ensure that ctx.set_ephemeral_default is called as soon as possible if</span>
    <span class="c1"># a match is found the public function is kept sync to avoid yielding</span>
    <span class="c1"># to the event loop until after this is set.</span>
    <span class="k">def</span> <span class="nf">execute_interaction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Coroutine</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]:</span>
        <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">command_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">command</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">defaults_to_ephemeral</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">set_ephemeral_default</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">defaults_to_ephemeral</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">set_ephemeral_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_interaction</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute_message</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_message_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">set_triggering_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="p">:]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">set_component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="c1"># Only add our hooks if we&#39;re sure we&#39;ll be executing the command here.</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">hooks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">hooks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

                <span class="n">hooks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">hooks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">hooks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

                <span class="n">hooks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">)</span>

            <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="n">ctx</span><span class="o">.</span><span class="n">set_component</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_load_from_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">LoadableProtocol</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">result</span> <span class="o">:=</span> <span class="n">member</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">load_into_component</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Standard implementation of <code><a href="tanjun/abc.html#Component">tanjun.abc.Component</a></code>.</p>

<p>This is a collcetion of commands (both message and slash), hooks and listener
callbacks which can be added to a generic client.</p>

<p><em>Note:</em>
This implementation supports dependency injection for its checks,
command callbacks and listeners when linked to a client which
supports dependency injection.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>checks</strong> (typing.Optional[collections.abc.Iterable[abc.CheckSig]]):
Iterable of check callbacks to set for this component, if provided.</li>
<li><strong>hooks</strong> (typing.Optional[<a href="tanjun/abc.html#AnyHooks">tanjun.abc.AnyHooks</a>]):
The hooks this component should add to the execution of all its
commands (message and slash).</li>
<li><strong>slash_hooks</strong> (typing.Optional[<a href="tanjun/abc.html#SlashHooks">tanjun.abc.SlashHooks</a>]):
The slash hooks this component should add to the execution of its
slash commands.</li>
<li><strong>message_hooks</strong> (typing.Optional[<a href="tanjun/abc.html#MessageHooks">tanjun.abc.MessageHooks</a>]):
The message hooks this component should add to the execution of its
message commands.</li>
<li><p><strong>name</strong> (str):
The component's identifier.</p>

<p>If not provided then this will be a random string.</p></li>
<li><p><strong>strict</strong> (bool):
Whether this component should use a stricter (more optimal) approach
for message command search.</p>

<p>When this is <code>True</code>, message command names will not be allowed to contain
spaces and will have to be unique to one command within the component.</p></li>
</ul>
</div>


                            <div id="Component.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">Component</span><span class="signature">(
    *,
    checks: Optional[collections.abc.Iterable[collections.abc.Callable[..., Union[bool, collections.abc.Awaitable[bool]]]]] = None,
    hooks: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#Context">tanjun.abc.Context</a>]] = None,
    slash_hooks: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#SlashContext">tanjun.abc.SlashContext</a>]] = None,
    message_hooks: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a>]] = None,
    name: Optional[str] = None,
    strict: bool = False,
    load_from_attributes: bool = False
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">checks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">slash_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">message_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">load_from_attributes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">checks_</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">[</span><span class="n">checks_</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">(</span><span class="n">check</span><span class="p">)</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">checks</span><span class="p">)]</span> <span class="k">if</span> <span class="n">checks</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span> <span class="o">=</span> <span class="n">strict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">base_events</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span> <span class="o">=</span> <span class="n">message_hooks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randbytes</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span> <span class="o">=</span> <span class="n">slash_hooks</span>

        <span class="k">if</span> <span class="n">load_from_attributes</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Component</span><span class="p">:</span>  <span class="c1"># No need to run this on the base class.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_load_from_properties</span><span class="p">()</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Component.checks" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Component.checks">#&nbsp;&nbsp</a>

        <span class="name">checks</span><span class="annotation">: collections.abc.Collection[collections.abc.Callable[..., typing.Union[bool, collections.abc.Awaitable[bool]]]]</span>
    </div>

    

                            </div>
                            <div id="Component.client" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Component.client">#&nbsp;&nbsp</a>

        <span class="name">client</span><span class="annotation">: Optional[<a href="tanjun/abc.html#Client">tanjun.abc.Client</a>]</span>
    </div>

            <div class="docstring"><p>Tanjun client this component is bound to.</p>
</div>


                            </div>
                            <div id="Component.defaults_to_ephemeral" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Component.defaults_to_ephemeral">#&nbsp;&nbsp</a>

        <span class="name">defaults_to_ephemeral</span><span class="annotation">: Optional[bool]</span>
    </div>

            <div class="docstring"><p>Whether slash contexts executed in this component should default to ephemeral responses.</p>

<p>This effects calls to <code><a href="#SlashContext.create_followup">SlashContext.create_followup</a></code>,
<code><a href="#SlashContext.create_initial_response">SlashContext.create_initial_response</a></code>, <code><a href="#SlashContext.defer">SlashContext.defer</a></code> and
<code><a href="#SlashContext.respond">SlashContext.respond</a></code> unless the <code>flags</code> field is provided for the
methods which support it.</p>

<h6 id="notes">Notes</h6>

<ul>
<li>This may be overridden by <code>BaseSlashCommand.defaults_to_ephemeral</code>.</li>
<li>This only effects slash command execution.</li>
<li>If this is <code>None</code> then the default from the parent client is used.</li>
</ul>
</div>


                            </div>
                            <div id="Component.hooks" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Component.hooks">#&nbsp;&nbsp</a>

        <span class="name">hooks</span><span class="annotation">: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#Context">tanjun.abc.Context</a>]]</span>
    </div>

    

                            </div>
                            <div id="Component.name" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Component.name">#&nbsp;&nbsp</a>

        <span class="name">name</span><span class="annotation">: str</span>
    </div>

            <div class="docstring"><p>Component's unique identifier.</p>

<p><em>Note:</em>
This will be preserved between copies of a component.</p>
</div>


                            </div>
                            <div id="Component.slash_commands" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Component.slash_commands">#&nbsp;&nbsp</a>

        <span class="name">slash_commands</span><span class="annotation">: collections.abc.Collection[<a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>]</span>
    </div>

            <div class="docstring"><p>Collection of the slash commands in this component.</p>
</div>


                            </div>
                            <div id="Component.slash_hooks" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Component.slash_hooks">#&nbsp;&nbsp</a>

        <span class="name">slash_hooks</span><span class="annotation">: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#SlashContext">tanjun.abc.SlashContext</a>]]</span>
    </div>

    

                            </div>
                            <div id="Component.message_commands" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Component.message_commands">#&nbsp;&nbsp</a>

        <span class="name">message_commands</span><span class="annotation">: collections.abc.Collection[<a href="tanjun/abc.html#MessageCommand">tanjun.abc.MessageCommand</a>]</span>
    </div>

            <div class="docstring"><p>Collection of the message commands in this component.</p>
</div>


                            </div>
                            <div id="Component.message_hooks" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Component.message_hooks">#&nbsp;&nbsp</a>

        <span class="name">message_hooks</span><span class="annotation">: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a>]]</span>
    </div>

    

                            </div>
                            <div id="Component.needs_injector" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Component.needs_injector">#&nbsp;&nbsp</a>

        <span class="name">needs_injector</span><span class="annotation">: bool</span>
    </div>

    

                            </div>
                            <div id="Component.listeners" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Component.listeners">#&nbsp;&nbsp</a>

        <span class="name">listeners</span><span class="annotation">: collections.abc.Mapping[type[hikari.events.base_events.Event], collections.abc.Collection[collections.abc.Callable[..., collections.abc.Coroutine[typing.Any, typing.Any, None]]]]</span>
    </div>

            <div class="docstring"><p>Mapping of event types to the listeners registered for them in this component.</p>
</div>


                            </div>
                            <div id="Component.metadata" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Component.metadata">#&nbsp;&nbsp</a>

        <span class="name">metadata</span><span class="annotation">: dict[typing.Any, typing.Any]</span>
    </div>

            <div class="docstring"><p>Mutable mapping of the metadata set for this component.</p>

<p><em>Note:</em>
Any modifications made to this mutable mapping will be preserved by
the component.</p>
</div>


                            </div>
                            <div id="Component.copy" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.copy">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">copy</span><span class="signature">(self: ~_ComponentT, *, _new: bool = True) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span> <span class="o">=</span> <span class="p">[</span><span class="n">check</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">event</span><span class="p">:</span> <span class="p">[</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">listener</span><span class="p">)</span> <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">]</span> <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>
            <span class="n">commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">command</span><span class="p">:</span> <span class="n">command</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">commands</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">commands</span><span class="p">[</span><span class="n">command</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Component.detect_commands" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.detect_commands">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">detect_commands</span><span class="signature">(
    self: ~_ComponentT,
    *,
    include_globals: bool = False,
    scope: Optional[collections.abc.Mapping[str, Any]] = None
) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">detect_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">include_globals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">scope</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load top-level commands into the component from the calling scope.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This will ignore commands which are owned by command groups.</span>
<span class="sd">        * This will detect commands from the calling scope unless `scope` is</span>
<span class="sd">          passed but this isn&#39;t possible in a stack-less python implementation;</span>
<span class="sd">          in stack-less environments the scope will have to be explicitly</span>
<span class="sd">          passed as `scope`.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        include_globals: bool</span>
<span class="sd">            Whether to include global variables (along with local) while</span>
<span class="sd">            detecting from the calling scope.</span>

<span class="sd">            This defaults to `False`, cannot be `True` when `scope` is provided</span>
<span class="sd">            and will only ever be needed when the local scope is different</span>
<span class="sd">            from the global scope.</span>
<span class="sd">        scope : typing.Optional[collections.Mapping[str, typing.Any]]</span>
<span class="sd">            The scope to detect commands from.</span>

<span class="sd">            This overrides the default usage of stackframe introspection.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The current component to allow for chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If this is called in a python implementation which doesn&#39;t support</span>
<span class="sd">            stack frame inspection when `scope` is not provided.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If `scope` is provided when `include_globals` is True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scope</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">stack</span> <span class="o">:=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">stack</span><span class="o">.</span><span class="n">f_back</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;Stackframe introspection is not supported in this runtime. Please explicitly pass `scope`.&quot;</span>
                <span class="p">)</span>

            <span class="n">values_iter</span> <span class="o">=</span> <span class="n">_filter_scope</span><span class="p">(</span><span class="n">stack</span><span class="o">.</span><span class="n">f_back</span><span class="o">.</span><span class="n">f_locals</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">include_globals</span><span class="p">:</span>
                <span class="n">values_iter</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="n">values_iter</span><span class="p">,</span> <span class="n">_filter_scope</span><span class="p">(</span><span class="n">stack</span><span class="o">.</span><span class="n">f_back</span><span class="o">.</span><span class="n">f_globals</span><span class="p">))</span>

        <span class="k">elif</span> <span class="n">include_globals</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot specify include_globals as True when scope is passed&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">values_iter</span> <span class="o">=</span> <span class="n">_filter_scope</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Loading commands for </span><span class="si">%s</span><span class="s2"> component from </span><span class="si">%s</span><span class="s2"> parent scope(s)&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;global and local&quot;</span> <span class="k">if</span> <span class="n">include_globals</span> <span class="k">else</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values_iter</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_slash_command</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_message_command</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Load top-level commands into the component from the calling scope.</p>

<h6 id="notes">Notes</h6>

<ul>
<li>This will ignore commands which are owned by command groups.</li>
<li>This will detect commands from the calling scope unless <code>scope</code> is
passed but this isn't possible in a stack-less python implementation;
in stack-less environments the scope will have to be explicitly
passed as <code>scope</code>.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>include_globals</strong> (bool):
Whether to include global variables (along with local) while
detecting from the calling scope.</p>

<p>This defaults to <code>False</code>, cannot be <code>True</code> when <code>scope</code> is provided
and will only ever be needed when the local scope is different
from the global scope.</p></li>
<li><p><strong>scope</strong> (typing.Optional[collections.Mapping[str, typing.Any]]):
The scope to detect commands from.</p>

<p>This overrides the default usage of stackframe introspection.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The current component to allow for chaining.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>RuntimeError</strong>: If this is called in a python implementation which doesn't support
stack frame inspection when <code>scope</code> is not provided.</li>
<li><strong>ValueError</strong>: If <code>scope</code> is provided when <code>include_globals</code> is True.</li>
</ul>
</div>


                            </div>
                            <div id="Component.set_ephemeral_default" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.set_ephemeral_default">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_ephemeral_default</span><span class="signature">(self: ~_ComponentT, state: Optional[bool], /) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_ephemeral_default</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set whether slash contexts executed in this component should default to ephemeral responses.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        typing.Optional[bool]</span>
<span class="sd">            Whether slash command contexts executed in this component should</span>
<span class="sd">            should default to ephemeral.</span>
<span class="sd">            This will be overridden by any response calls which specify flags.</span>

<span class="sd">            Setting this to `None` will let the default set on the parent</span>
<span class="sd">            client propagate and decide the ephemeral default behaviour.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This component to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set whether slash contexts executed in this component should default to ephemeral responses.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>typing.Optional[bool]</strong>: Whether slash command contexts executed in this component should
should default to ephemeral.
This will be overridden by any response calls which specify flags.</li>
</ul>

<p>Setting this to <code>None</code> will let the default set on the parent
client propagate and decide the ephemeral default behaviour.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>SelfT</strong>: This component to enable method chaining.</li>
</ul>
</div>


                            </div>
                            <div id="Component.set_slash_hooks" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.set_slash_hooks">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_slash_hooks</span><span class="signature">(
    self: ~_ComponentT,
    hooks_: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#SlashContext">tanjun.abc.SlashContext</a>]],
    /
) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">hooks_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span> <span class="o">=</span> <span class="n">hooks_</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Component.set_message_hooks" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.set_message_hooks">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_message_hooks</span><span class="signature">(
    self: ~_ComponentT,
    hooks_: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a>]],
    /
) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_message_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">hooks_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span> <span class="o">=</span> <span class="n">hooks_</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Component.set_hooks" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.set_hooks">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_hooks</span><span class="signature">(
    self: ~_ComponentT,
    hooks: Optional[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#Context">tanjun.abc.Context</a>]],
    /
) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Component.add_check" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.add_check">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_check</span><span class="signature">(
    self: ~_ComponentT,
    check: collections.abc.Callable[..., typing.Union[bool, collections.abc.Awaitable[bool]]],
    /
) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">check</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checks_</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">(</span><span class="n">check</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Component.remove_check" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.remove_check">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_check</span><span class="signature">(
    self: ~_ComponentT,
    check: collections.abc.Callable[..., typing.Union[bool, collections.abc.Awaitable[bool]]],
    /
) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;checks_.InjectableCheck&quot;</span><span class="p">,</span> <span class="n">check</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Component.with_check" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.with_check">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_check</span><span class="signature">(self, check: ~CheckSigT, /) -&gt; ~CheckSigT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">check</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Component.add_client_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.add_client_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_client_callback</span><span class="signature">(
    self: ~_ComponentT,
    event_name: str,
    callback: collections.abc.Callable[..., typing.Optional[collections.abc.Awaitable[NoneType]]],
    /
) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">event_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="n">event_name</span> <span class="o">=</span> <span class="n">event_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">callback</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Component.get_client_callbacks" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.get_client_callbacks">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_client_callbacks</span><span class="signature">(
    self,
    event_name: str,
    /
) -&gt; collections.abc.Collection[collections.abc.Callable[..., typing.Optional[collections.abc.Awaitable[NoneType]]]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">get_client_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">]:</span>
        <span class="n">event_name</span> <span class="o">=</span> <span class="n">event_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event_name</span><span class="p">)</span> <span class="ow">or</span> <span class="p">()</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Component.remove_client_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.remove_client_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_client_callback</span><span class="signature">(
    self,
    event_name: str,
    callback: collections.abc.Callable[..., typing.Optional[collections.abc.Awaitable[NoneType]]],
    /
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">event_name</span> <span class="o">=</span> <span class="n">event_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">event_name</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">remove_client_callback</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Component.with_client_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.with_client_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_client_callback</span><span class="signature">(
    self,
    event_name: str,
    /
) -&gt; collections.abc.Callable[[~MetaEventSigT], ~MetaEventSigT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">]:</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Component.add_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.add_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_command</span><span class="signature">(
    self: ~_ComponentT,
    command: <a href="tanjun/abc.html#ExecutableCommand">tanjun.abc.ExecutableCommand</a>[typing.Any],
    /
) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_message_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_slash_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unexpected object passed, expected a MessageCommand or BaseSlashCommand but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Component.remove_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.remove_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_command</span><span class="signature">(
    self: ~_ComponentT,
    command: <a href="tanjun/abc.html#ExecutableCommand">tanjun.abc.ExecutableCommand</a>[typing.Any],
    /
) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_message_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_slash_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unexpected object passed, expected a MessageCommand or BaseSlashCommand but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Component.with_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.with_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_command</span><span class="signature">(
    self,
    command: Optional[~CommandT] = None,
    /,
    *,
    copy: bool = False
) -&gt; Union[~CommandT, collections.abc.Callable[[~CommandT], ~CommandT]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WithCommandReturnSig</span><span class="p">[</span><span class="n">CommandT</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_with_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_command</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Component.add_slash_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.add_slash_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_slash_command</span><span class="signature">(
    self: ~_ComponentT,
    command: <a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>,
    /
) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_slash_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="n">command</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="n">command</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()]</span> <span class="o">=</span> <span class="n">command</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a slash command to this component.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (BaseSlashCommand):
The command to add.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The component to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Component.remove_slash_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.remove_slash_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_slash_command</span><span class="signature">(
    self: ~_ComponentT,
    command: <a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>,
    /
) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_slash_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Command </span><span class="si">{</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a slash command from this component.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (BaseSlashCommand):
The command to remove.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the provided command isn't found.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The component to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Component.with_slash_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.with_slash_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_slash_command</span><span class="signature">(
    self,
    command: Optional[~BaseSlashCommandT] = None,
    /,
    *,
    copy: bool = False
) -&gt; Union[~BaseSlashCommandT, collections.abc.Callable[[~CommandT], ~CommandT]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_slash_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WithCommandReturnSig</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommandT</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_with_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_slash_command</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a slash command to this component through a decorator call.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (BaseSlashCommandT):
The command to add.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>copy</strong> (bool):
Whether to copy the command before adding it.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>BaseSlashCommandT</strong>: The added command.</li>
</ul>
</div>


                            </div>
                            <div id="Component.add_message_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.add_message_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_message_command</span><span class="signature">(
    self: ~_ComponentT,
    command: <a href="tanjun/abc.html#MessageCommand">tanjun.abc.MessageCommand</a>,
    /
) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_message_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a message command to the component.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.MessageCommand</span>
<span class="sd">            The command to add.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The component to allow method chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If one of the command&#39;s name is already registered in a strict</span>
<span class="sd">            component.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Command name cannot contain spaces for this component implementation&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">name_conflicts</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Sub-command names must be unique in a strict component. &quot;</span>
                    <span class="s2">&quot;The following conflicts were found &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_conflicts</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">)</span>

        <span class="n">command</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a message command to the component.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (<a href="tanjun/abc.html#MessageCommand">tanjun.abc.MessageCommand</a>):
The command to add.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The component to allow method chaining.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If one of the command's name is already registered in a strict
component.</li>
</ul>
</div>


                            </div>
                            <div id="Component.remove_message_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.remove_message_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_message_command</span><span class="signature">(
    self: ~_ComponentT,
    command: <a href="tanjun/abc.html#MessageCommand">tanjun.abc.MessageCommand</a>,
    /
) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_message_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="n">command</span><span class="p">:</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a message command from this component.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (MessageCommand):
The command to remove.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the provided command isn't found.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The component to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Component.with_message_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.with_message_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_message_command</span><span class="signature">(
    self,
    command: Optional[~MessageCommandT] = None,
    /,
    *,
    copy: bool = False
) -&gt; Union[~MessageCommandT, collections.abc.Callable[[~CommandT], ~CommandT]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_message_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WithCommandReturnSig</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommandT</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_with_command</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_message_command</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a message command to this component through a decorator call.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (MessageCommandT):
The command to add.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>copy</strong> (bool):
Whether to copy the command before adding it.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>MessageCommandT</strong>: The added command.</li>
</ul>
</div>


                            </div>
                            <div id="Component.add_listener" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.add_listener">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_listener</span><span class="signature">(
    self: ~_ComponentT,
    event: type[hikari.events.base_events.Event],
    listener: collections.abc.Callable[..., collections.abc.Coroutine[typing.Any, typing.Any, None]],
    /
) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">base_events</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">listener</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">listener</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">listener</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">listener</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">add_listener</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a listener to this component.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>event</strong> (type[hikari.Event]):
The event to listen for.</li>
<li><strong>listener</strong> (ListenerCallbackSig):
The listener to add.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The component to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Component.remove_listener" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.remove_listener">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_listener</span><span class="signature">(
    self: ~_ComponentT,
    event: type[hikari.events.base_events.Event],
    listener: collections.abc.Callable[..., collections.abc.Coroutine[typing.Any, typing.Any, None]],
    /
) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">base_events</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">listener</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">listener</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">remove_listener</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a listener from this component.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>event</strong> (type[hikari.Event]):
The event to listen for.</li>
<li><strong>listener</strong> (ListenerCallbackSig):
The listener to remove.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the listener is not registered for the provided event.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The component to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Component.with_listener" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.with_listener">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_listener</span><span class="signature">(
    self,
    event_type: type[hikari.events.base_events.Event]
) -&gt; collections.abc.Callable[[~ListenerCallbackSigT], ~ListenerCallbackSigT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">base_events</span><span class="o">.</span><span class="n">Event</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">]:</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_listener</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a listener to this component through a decorator call.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>event_type</strong> (type[hikari.Event]):
The event to listen for.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[ListenerCallbackSigT], ListenerCallbackSigT]</strong>: Decorator callback which takes listener to add.</li>
</ul>
</div>


                            </div>
                            <div id="Component.bind_client" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.bind_client">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">bind_client</span><span class="signature">(self: ~_ComponentT, client: <a href="tanjun/abc.html#Client">tanjun.abc.Client</a>, /) -&gt; ~_ComponentT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ComponentT</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ComponentT</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Client already set&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="k">for</span> <span class="n">message_command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="p">:</span>
            <span class="n">message_command</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">slash_command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">slash_command</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">add_listener</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">event_name</span><span class="p">,</span> <span class="n">callbacks</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Component.unbind_client" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.unbind_client">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">unbind_client</span><span class="signature">(self, client: <a href="tanjun/abc.html#Client">tanjun.abc.Client</a>, /) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">unbind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">!=</span> <span class="n">client</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Component isn&#39;t bound to this client&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">remove_listener</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">listener</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">LookupError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                    <span class="k">pass</span>

        <span class="k">for</span> <span class="n">event_name</span><span class="p">,</span> <span class="n">callbacks</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">remove_client_callback</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">LookupError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                    <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Component.check_message_name" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.check_message_name">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">check_message_name</span><span class="signature">(
    self,
    content: str,
    /
) -&gt; collections.abc.Iterator[tuple[str, <a href="tanjun/abc.html#MessageCommand">tanjun.abc.MessageCommand</a>]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">check_message_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_strict</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">command</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names_to_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_commands</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">:=</span> <span class="n">utilities</span><span class="o">.</span><span class="n">match_prefix_names</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">command</span><span class="o">.</span><span class="n">names</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span>
                <span class="c1"># Don&#39;t want to match a command multiple times</span>
                <span class="k">continue</span>
</pre></div>

        </details>

            <div class="docstring"><p>Check whether a name matches any of this component's registered message commands.</p>

<h6 id="notes">Notes</h6>

<ul>
<li>This only checks for name matches against the top level command and
will not account for sub-commands.</li>
<li>Dependent on implementation detail this may partial check name against
command names using name.startswith(command_name), hence why it
also returns the name a command was matched by.</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name to check for command matches.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Iterator[tuple[str, MessageCommand]]</strong>: Iterator of tuples of command name matches to the relevant message
command objects.</li>
</ul>
</div>


                            </div>
                            <div id="Component.check_slash_name" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.check_slash_name">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">check_slash_name</span><span class="signature">(
    self,
    name: str,
    /
) -&gt; collections.abc.Iterator[<a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">check_slash_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">command</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">command</span>
</pre></div>

        </details>

            <div class="docstring"><p>Check whether a name matches any of this component's registered slash commands.</p>

<p><em>Note:</em>
This won't check for sub-commands and will expect <code><a href="#Component.name">name</a></code> to simply be
the top level command name.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name to check for command matches.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Iterator[BaseSlashCommand]</strong>: An iterator of the matching slash commands.</li>
</ul>
</div>


                            </div>
                            <div id="Component.execute_interaction" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.execute_interaction">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">execute_interaction</span><span class="signature">(
    self,
    ctx: <a href="tanjun/abc.html#SlashContext">tanjun.abc.SlashContext</a>,
    /,
    *,
    hooks: Optional[collections.abc.MutableSet[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#SlashContext">tanjun.abc.SlashContext</a>]]] = None
) -&gt; collections.abc.Coroutine[typing.Any, typing.Any, typing.Optional[collections.abc.Awaitable[None]]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">execute_interaction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Coroutine</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]:</span>
        <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">command_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">command</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">defaults_to_ephemeral</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">set_ephemeral_default</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">defaults_to_ephemeral</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">set_ephemeral_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_interaction</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Execute a slash context.</p>

<p><em>Note:</em>
Unlike <code><a href="#Component.execute_message">Component.execute_message</a></code>, this shouldn't be expected to
raise <code><a href="tanjun/errors.html#HaltExecution">tanjun.errors.HaltExecution</a></code> nor <code><a href="tanjun/errors.html#CommandError">tanjun.errors.CommandError</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>ctx</strong> (SlashContext):
The context to execute.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>hooks</strong> (typing.Optional[collections.abc.MutableSet[SlashHooks]] = None):
Set of hooks to include in this command execution.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Optional[collections.abc.Awaitable[None]]</strong>: Awaitable used to wait for the command execution to finish.</li>
</ul>

<p>This may be awaited or left to run as a background task.</p>

<p>If this is <code>None</code> then the client should carry on its search for a
component with a matching command.</p>
</div>


                            </div>
                            <div id="Component.execute_message" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Component.execute_message">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">execute_message</span><span class="signature">(
    self,
    ctx: <a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a>,
    /,
    *,
    hooks: Optional[collections.abc.MutableSet[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a>]]] = None
) -&gt; bool</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute_message</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">MutableSet</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_message_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">set_triggering_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="p">:]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">set_component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="c1"># Only add our hooks if we&#39;re sure we&#39;ll be executing the command here.</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">hooks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">hooks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

                <span class="n">hooks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">hooks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">hooks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

                <span class="n">hooks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">)</span>

            <span class="k">await</span> <span class="n">command</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="n">ctx</span><span class="o">.</span><span class="n">set_component</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
</pre></div>

        </details>

            <div class="docstring"><p>Execute a message context.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>ctx</strong> (MessageContext):
The context to execute.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>hooks</strong> (typing.Optional[collections.abc.MutableSet[MessageHooks]] = None):
Set of hooks to include in this command execution.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>bool</strong>: Whether a message command was executed in this component with the
provided context.</li>
</ul>

<p>If <code>False</code> then the client should carry on its search for a
component with a matching command.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong><a href="tanjun/errors.html#CommandError">tanjun.errors.CommandError</a></strong>: To end the command's execution with an error response message.</li>
<li><strong><a href="tanjun/errors.html#HaltExecution">tanjun.errors.HaltExecution</a></strong>: To indicate that the client should stop searching for commands to
execute with the current context.</li>
</ul>
</div>


                            </div>
                </section>
                <section id="context">
                                <div class="attr module"><a class="headerlink" href="#context">#&nbsp;&nbsp</a>
<span class="name"><a href="tanjun/context.html">tanjun.context</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;Standard command execution context implementations.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;MessageContext&quot;</span><span class="p">,</span> <span class="s2">&quot;ResponseTypeT&quot;</span><span class="p">,</span> <span class="s2">&quot;SlashContext&quot;</span><span class="p">,</span> <span class="s2">&quot;SlashOption&quot;</span><span class="p">]</span>

<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">import</span> <span class="nn">hikari</span>
<span class="kn">from</span> <span class="nn">hikari</span> <span class="kn">import</span> <span class="n">snowflakes</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">tanjun_abc</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">injecting</span>

<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">collections</span>

    <span class="kn">from</span> <span class="nn">hikari</span> <span class="kn">import</span> <span class="n">traits</span> <span class="k">as</span> <span class="n">hikari_traits</span>

    <span class="n">_BaseContextT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_BaseContextT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;BaseContext&quot;</span><span class="p">)</span>
    <span class="n">_MessageContextT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_MessageContextT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;MessageContext&quot;</span><span class="p">)</span>
    <span class="n">_SlashContextT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_SlashContextT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;SlashContext&quot;</span><span class="p">)</span>
    <span class="n">_T</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_T&quot;</span><span class="p">)</span>

<span class="n">ResponseTypeT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionMessageBuilder</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionDeferredBuilder</span><span class="p">]</span>
<span class="n">_INTERACTION_LIFETIME</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">_LOGGER</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;hikari.tanjun.context&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_delete_after_to_float</span><span class="p">(</span><span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">delete_after</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">delete_after</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">)</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">BaseContext</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">BasicInjectionContext</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for all standard context implementations.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_client&quot;</span><span class="p">,</span> <span class="s2">&quot;_component&quot;</span><span class="p">,</span> <span class="s2">&quot;_final&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span>
        <span class="n">injection_client</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">InjectorClient</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># injecting.BasicInjectionContext.__init__</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">injection_client</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_component</span> <span class="o">=</span> <span class="n">component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_final</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">BaseContext</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">cache</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_component</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">events</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">events</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">server</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">server</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rest</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">rest</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shards</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">shards</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">voice</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">VoiceComponent</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">voice</span>

    <span class="k">def</span> <span class="nf">_assert_not_final</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_final</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot modify a finalised context&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">finalise</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_BaseContextT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_BaseContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_final</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_BaseContextT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_BaseContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">component</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span>
                <span class="nb">type</span><span class="p">(</span><span class="n">component</span><span class="p">),</span> <span class="n">component</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">component_case</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">injecting</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component_case</span><span class="p">,</span> <span class="n">injecting</span><span class="o">.</span><span class="n">Undefined</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">component_case</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_component</span> <span class="o">=</span> <span class="n">component</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">get_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">TextableGuildChannel</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
            <span class="n">channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_guild_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_id</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">TextableGuildChannel</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">channel</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">get_guild</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Guild</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">guild_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_guild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">guild_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">TextableChannel</span><span class="p">:</span>
        <span class="n">channel</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_id</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">TextableChannel</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">channel</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_guild</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Guild</span><span class="p">]:</span>  <span class="c1"># TODO: or raise?</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">guild_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_guild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">guild_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>


<span class="k">class</span> <span class="nc">MessageContext</span><span class="p">(</span><span class="n">BaseContext</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Standard implementation of a command context as used within Tanjun.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_command&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_content&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_initial_response_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_last_response_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_response_lock&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_message&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_triggering_name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_triggering_prefix&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span>
        <span class="n">injection_client</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">InjectorClient</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">triggering_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">triggering_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot spawn context with a content-less message.&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">injection_client</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="n">message</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_triggering_name</span> <span class="o">=</span> <span class="n">triggering_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_triggering_prefix</span> <span class="o">=</span> <span class="n">triggering_prefix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">MessageContext</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;MessageContext &lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="si">!r}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_command</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">author</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">author</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">channel_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_command</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">content</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_content</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">created_at</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">created_at</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">guild_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">guild_id</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_responded</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_human</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">author</span><span class="o">.</span><span class="n">is_bot</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">webhook_id</span> <span class="ow">is</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Member</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">member</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">message</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">triggering_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_triggering_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">triggering_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_triggering_prefix</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shard</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">GatewayShard</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">shards</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">guild_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">shard_id</span> <span class="o">=</span> <span class="n">snowflakes</span><span class="o">.</span><span class="n">calculate_shard_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">shards</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">guild_id</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">shard_id</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">shards</span><span class="o">.</span><span class="n">shards</span><span class="p">[</span><span class="n">shard_id</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageContextT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="k">if</span> <span class="n">command</span><span class="p">:</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
                <span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
                <span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">command</span><span class="p">),</span> <span class="n">command</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">command_case</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">injecting</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command_case</span><span class="p">,</span> <span class="n">injecting</span><span class="o">.</span><span class="n">Undefined</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">)</span>  <span class="c1"># TODO: command group?</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">command_case</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_content</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageContextT</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_triggering_name</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageContextT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_triggering_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_triggering_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageContextT</span><span class="p">,</span> <span class="n">triggering_prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_triggering_prefix</span> <span class="o">=</span> <span class="n">triggering_prefix</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no initial response&quot;</span><span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">delete_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous responses&quot;</span><span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">delete_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="n">_delete_after_to_float</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no initial response&quot;</span><span class="p">)</span>

        <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
            <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
            <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
            <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
            <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
            <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
            <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
            <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">message</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_last_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="n">_delete_after_to_float</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous tracked response&quot;</span><span class="p">)</span>

        <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
            <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
            <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
            <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
            <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
            <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
            <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
            <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">message</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;No initial response found for this context&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;No responses found for this context&quot;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Failed to delete response message after </span><span class="si">%.2f</span><span class="s2"> seconds&quot;</span><span class="p">,</span> <span class="n">delete_after</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="n">exc</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">nonce</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">reply</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialMessage</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_reply</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="n">_delete_after_to_float</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
                <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">,</span>
                <span class="n">reply</span><span class="o">=</span><span class="n">reply</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">mentions_reply</span><span class="o">=</span><span class="n">mentions_reply</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">id</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">id</span>

            <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">message</span>


<span class="k">class</span> <span class="nc">SlashOption</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashOption</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_interaction&quot;</span><span class="p">,</span> <span class="s2">&quot;_option&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="n">option</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteractionOption</span><span class="p">,</span> <span class="o">/</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot build a slash option with a value-less API representation&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span> <span class="o">=</span> <span class="n">interaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_option</span> <span class="o">=</span> <span class="n">option</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="c1"># This is asserted in __init__</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">value</span>

    <span class="k">def</span> <span class="nf">resolve_value</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionChannel</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">CHANNEL</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_channel</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">ROLE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_role</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_user</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_mentionable</span><span class="p">()</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> isn&#39;t resolvable&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">resolve_to_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionChannel</span><span class="p">:</span>
        <span class="c1"># What does self.value being None mean?</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">CHANNEL</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)]</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot resolve non-channel option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> to a user&quot;</span><span class="p">)</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">resolve_to_member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">resolve_to_member</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">_T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">,</span> <span class="n">_T</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">resolve_to_member</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">_T</span> <span class="o">=</span> <span class="o">...</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">,</span> <span class="n">_T</span><span class="p">]:</span>
        <span class="c1"># What does self.value being None mean?</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">if</span> <span class="n">member</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)):</span>
                <span class="k">return</span> <span class="n">member</span>

            <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="o">...</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">default</span>

            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;User isn&#39;t in the current guild&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">:</span>
            <span class="n">target_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">if</span> <span class="n">member</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target_id</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">member</span>

            <span class="k">if</span> <span class="n">target_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="o">...</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">default</span>

                <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;User isn&#39;t in the current guild&quot;</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot resolve non-user option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> to a member&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">resolve_to_mentionable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Member</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">:</span>
            <span class="n">target_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">if</span> <span class="n">role</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target_id</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">role</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">target_id</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_user</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">ROLE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_role</span><span class="p">()</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot resolve non-mentionable option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> to a mentionable entity.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">resolve_to_role</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">ROLE</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">roles</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">if</span> <span class="n">role</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)):</span>
                <span class="k">return</span> <span class="n">role</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot resolve non-role option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> to a role&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">resolve_to_user</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Member</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="n">user_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">user_id</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="n">user_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="n">user_id</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="n">result</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot resolve non-user option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> to a user&quot;</span><span class="p">)</span>


<span class="n">_COMMAND_OPTION_TYPES</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span>
    <span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">SUB_COMMAND</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">SUB_COMMAND_GROUP</span><span class="p">]</span>
<span class="p">)</span>


<span class="k">class</span> <span class="nc">SlashContext</span><span class="p">(</span><span class="n">BaseContext</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_command&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_defaults_to_ephemeral&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_defer_task&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_has_been_deferred&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_has_responded&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_interaction&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_last_response_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_marked_not_found&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_on_not_found&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_options&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_response_future&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_response_lock&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span>
        <span class="n">injection_client</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">InjectorClient</span><span class="p">,</span>
        <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default_to_ephemeral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">on_not_found</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">SlashContext</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">injection_client</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="o">=</span> <span class="n">default_to_ephemeral</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span> <span class="o">=</span> <span class="n">interaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_marked_not_found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_not_found</span> <span class="o">=</span> <span class="n">on_not_found</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseTypeT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">SlashContext</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

        <span class="n">options</span> <span class="o">=</span> <span class="n">interaction</span><span class="o">.</span><span class="n">options</span>
        <span class="k">while</span> <span class="n">options</span> <span class="ow">and</span> <span class="p">(</span><span class="n">first_option</span> <span class="o">:=</span> <span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="n">_COMMAND_OPTION_TYPES</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">first_option</span><span class="o">.</span><span class="n">options</span>

        <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="p">{</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">SlashOption</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span> <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">options</span><span class="p">}</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">author</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">user</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">channel_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">channel_id</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_command</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">created_at</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">created_at</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">defaults_to_ephemeral</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">expires_at</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">created_at</span> <span class="o">+</span> <span class="n">_INTERACTION_LIFETIME</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">guild_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">guild_id</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_been_deferred</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_responded</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_human</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">]:</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">member</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">triggering_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># TODO: account for command groups</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">command_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">interaction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashOption</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_auto_defer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">countdown</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">countdown</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">cancel_defer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_flags</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">flags</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="o">.</span><span class="n">EPHEMERAL</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="k">else</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="o">.</span><span class="n">NONE</span>

        <span class="k">return</span> <span class="n">flags</span>

    <span class="k">def</span> <span class="nf">get_response_future</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseTypeT</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_future</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">mark_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_not_found</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_marked_not_found</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_marked_not_found</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">start_defer_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashContextT</span><span class="p">,</span> <span class="n">count_down</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Defer timer already set&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer</span><span class="p">(</span><span class="n">count_down</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashContextT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="k">if</span> <span class="n">command</span><span class="p">:</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
                <span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
                <span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashCommand</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
                <span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">command</span><span class="p">),</span> <span class="n">command</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">command_case</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">injecting</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command_case</span><span class="p">,</span> <span class="n">injecting</span><span class="o">.</span><span class="n">Undefined</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashCommand</span><span class="p">)</span>  <span class="c1"># TODO: command group?</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">command_case</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_ephemeral_default</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashContextT</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">defer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
        <span class="n">in_defer_task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span> <span class="ow">is</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">current_task</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">in_defer_task</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cancel_defer</span><span class="p">()</span>

        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">in_defer_task</span><span class="p">:</span>
                    <span class="k">return</span>

                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Context has already been responded to&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">build_deferred_response</span><span class="p">()</span><span class="o">.</span><span class="n">set_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">))</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span>
                    <span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">DEFERRED_MESSAGE_CREATE</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_delete_after</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="n">_delete_after_to_float</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span>
        <span class="n">time_left</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">_INTERACTION_LIFETIME</span> <span class="o">-</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">created_at</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">delete_after</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">&gt;</span> <span class="n">time_left</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This interaction will have expired before delete_after is reached&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">delete_after</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_delete_followup_after</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delete_after</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Failed to delete response message after </span><span class="si">%.2f</span><span class="s2"> seconds&quot;</span><span class="p">,</span> <span class="n">delete_after</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="n">exc</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_create_followup</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
            <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
            <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
            <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
            <span class="n">flags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">),</span>
            <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
            <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
            <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
            <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">id</span>

        <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_followup_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">message</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_followup</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_followup</span><span class="p">(</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
                <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_delete_initial_response_after</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delete_after</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_initial_response</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Failed to delete response message after </span><span class="si">%.2f</span><span class="s2"> seconds&quot;</span><span class="p">,</span> <span class="n">delete_after</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="n">exc</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_create_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Initial response has already been created&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;edit_initial_response must be used to set the initial response after a context has been deferred&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cancel_defer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span>
                <span class="n">response_type</span><span class="o">=</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_CREATE</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">component</span> <span class="ow">and</span> <span class="n">components</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only one of component or components may be passed&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">embed</span> <span class="ow">and</span> <span class="n">embeds</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only one of embed or embeds may be passed&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">component</span><span class="p">:</span>
                <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">)</span>
                <span class="n">components</span> <span class="o">=</span> <span class="p">(</span><span class="n">component</span><span class="p">,)</span>

            <span class="k">if</span> <span class="n">embed</span><span class="p">:</span>
                <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">embed</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">)</span>
                <span class="n">embeds</span> <span class="o">=</span> <span class="p">(</span><span class="n">embed</span><span class="p">,)</span>

            <span class="n">content</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span> <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="k">else</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span>
            <span class="c1"># Pyright doesn&#39;t properly support attrs and doesn&#39;t account for _ being removed from field</span>
            <span class="c1"># pre-fix in init.</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">InteractionMessageBuilder</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_CREATE</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">is_tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="k">if</span> <span class="n">embeds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">embed</span> <span class="ow">in</span> <span class="n">embeds</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">add_embed</span><span class="p">(</span><span class="n">embed</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_initial_response_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_initial_response</span><span class="p">(</span>
                <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_initial_response</span><span class="p">()</span>
        <span class="c1"># If they defer then delete the initial response then this should be treated as having</span>
        <span class="c1"># an initial response to allow for followup responses.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_initial_response</span><span class="p">()</span>
                <span class="c1"># If they defer then delete the initial response then this should be treated as having</span>
                <span class="c1"># an initial response to allow for followup responses.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">return</span>

            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no last response&quot;</span><span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
            <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
            <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
            <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
            <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
            <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
            <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
            <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_initial_response_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_last_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">:</span>
            <span class="n">delete_after</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_followup_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">message</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
                <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous responses&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous known responses&quot;</span><span class="p">)</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">]:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_followup</span><span class="p">(</span>
                    <span class="n">content</span><span class="p">,</span>
                    <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                    <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                    <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                    <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                    <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                    <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                    <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                    <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
                    <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                    <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                    <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                    <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                    <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                    <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                    <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                    <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                    <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_initial_response</span><span class="p">(</span>
                <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">ensure_result</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Standard command execution context implementations.</p>
</div>


                </section>
                <section id="MessageContext">
                                <div class="attr class">
        <a class="headerlink" href="#MessageContext">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">MessageContext</span><wbr>(<span class="base"><a href="tanjun/context.html#BaseContext">tanjun.context.BaseContext</a></span>, <span class="base"><a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MessageContext</span><span class="p">(</span><span class="n">BaseContext</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Standard implementation of a command context as used within Tanjun.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_command&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_content&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_initial_response_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_last_response_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_response_lock&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_message&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_triggering_name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_triggering_prefix&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span>
        <span class="n">injection_client</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">InjectorClient</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">triggering_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">triggering_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot spawn context with a content-less message.&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">injection_client</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="n">message</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_triggering_name</span> <span class="o">=</span> <span class="n">triggering_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_triggering_prefix</span> <span class="o">=</span> <span class="n">triggering_prefix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">MessageContext</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;MessageContext &lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="si">!r}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_command</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">author</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">author</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">channel_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_command</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">content</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_content</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">created_at</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">created_at</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">guild_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">guild_id</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_responded</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_human</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">author</span><span class="o">.</span><span class="n">is_bot</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">webhook_id</span> <span class="ow">is</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Member</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">member</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">message</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">triggering_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_triggering_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">triggering_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_triggering_prefix</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shard</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">GatewayShard</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">shards</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">guild_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">shard_id</span> <span class="o">=</span> <span class="n">snowflakes</span><span class="o">.</span><span class="n">calculate_shard_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">shards</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">guild_id</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">shard_id</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">shards</span><span class="o">.</span><span class="n">shards</span><span class="p">[</span><span class="n">shard_id</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageContextT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="k">if</span> <span class="n">command</span><span class="p">:</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
                <span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
                <span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">command</span><span class="p">),</span> <span class="n">command</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">command_case</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">injecting</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command_case</span><span class="p">,</span> <span class="n">injecting</span><span class="o">.</span><span class="n">Undefined</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">)</span>  <span class="c1"># TODO: command group?</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">command_case</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_content</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageContextT</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_triggering_name</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageContextT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_triggering_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_triggering_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageContextT</span><span class="p">,</span> <span class="n">triggering_prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_triggering_prefix</span> <span class="o">=</span> <span class="n">triggering_prefix</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no initial response&quot;</span><span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">delete_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous responses&quot;</span><span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">delete_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="n">_delete_after_to_float</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no initial response&quot;</span><span class="p">)</span>

        <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
            <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
            <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
            <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
            <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
            <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
            <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
            <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">message</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_last_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="n">_delete_after_to_float</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous tracked response&quot;</span><span class="p">)</span>

        <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
            <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
            <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
            <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
            <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
            <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
            <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
            <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">message</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;No initial response found for this context&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;No responses found for this context&quot;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Failed to delete response message after </span><span class="si">%.2f</span><span class="s2"> seconds&quot;</span><span class="p">,</span> <span class="n">delete_after</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="n">exc</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">nonce</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">reply</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialMessage</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_reply</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="n">_delete_after_to_float</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
                <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">,</span>
                <span class="n">reply</span><span class="o">=</span><span class="n">reply</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">mentions_reply</span><span class="o">=</span><span class="n">mentions_reply</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">id</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">id</span>

            <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">message</span>
</pre></div>

        </details>

            <div class="docstring"><p>Standard implementation of a command context as used within Tanjun.</p>
</div>


                            <div id="MessageContext.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageContext.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">MessageContext</span><span class="signature">(
    client: <a href="tanjun/abc.html#Client">tanjun.abc.Client</a>,
    injection_client: <a href="tanjun/injecting.html#InjectorClient">tanjun.injecting.InjectorClient</a>,
    content: str,
    message: hikari.messages.Message,
    *,
    command: Optional[<a href="tanjun/abc.html#MessageCommand">tanjun.abc.MessageCommand</a>] = None,
    component: Optional[<a href="tanjun/abc.html#Component">tanjun.abc.Component</a>] = None,
    triggering_name: str = &#39;&#39;,
    triggering_prefix: str = &#39;&#39;
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span>
        <span class="n">injection_client</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">InjectorClient</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">triggering_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">triggering_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot spawn context with a content-less message.&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">injection_client</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message</span> <span class="o">=</span> <span class="n">message</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_triggering_name</span> <span class="o">=</span> <span class="n">triggering_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_triggering_prefix</span> <span class="o">=</span> <span class="n">triggering_prefix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">MessageContext</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MessageContext.author" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageContext.author">#&nbsp;&nbsp</a>

        <span class="name">author</span><span class="annotation">: hikari.users.User</span>
    </div>

            <div class="docstring"><p>Object of the user who triggered this command.</p>
</div>


                            </div>
                            <div id="MessageContext.channel_id" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageContext.channel_id">#&nbsp;&nbsp</a>

        <span class="name">channel_id</span><span class="annotation">: hikari.snowflakes.Snowflake</span>
    </div>

            <div class="docstring"><p>ID of the channel this command was triggered in.</p>
</div>


                            </div>
                            <div id="MessageContext.command" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageContext.command">#&nbsp;&nbsp</a>

        <span class="name">command</span><span class="annotation">: Optional[<a href="tanjun/abc.html#MessageCommand">tanjun.abc.MessageCommand</a>]</span>
    </div>

            <div class="docstring"><p>Object of the command this context is bound to.</p>

<p><em>Note:</em>
This will only be <code>None</code> before this has been bound to a
specific command but never during command execution.</p>
</div>


                            </div>
                            <div id="MessageContext.content" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageContext.content">#&nbsp;&nbsp</a>

        <span class="name">content</span><span class="annotation">: str</span>
    </div>

            <div class="docstring"><p>Content of the context's message minus the triggering name and prefix.</p>
</div>


                            </div>
                            <div id="MessageContext.created_at" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageContext.created_at">#&nbsp;&nbsp</a>

        <span class="name">created_at</span><span class="annotation">: datetime.datetime</span>
    </div>

            <div class="docstring"><p>When this context was created.</p>

<p><em>Note:</em>
This will either refer to a message or integration's creation date.</p>
</div>


                            </div>
                            <div id="MessageContext.guild_id" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageContext.guild_id">#&nbsp;&nbsp</a>

        <span class="name">guild_id</span><span class="annotation">: Optional[hikari.snowflakes.Snowflake]</span>
    </div>

            <div class="docstring"><p>ID of the guild this command was executed in.</p>

<p>Will be <code>None</code> for all DM command executions.</p>
</div>


                            </div>
                            <div id="MessageContext.has_responded" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageContext.has_responded">#&nbsp;&nbsp</a>

        <span class="name">has_responded</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether an initial response has been made for this context.</p>
</div>


                            </div>
                            <div id="MessageContext.is_human" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageContext.is_human">#&nbsp;&nbsp</a>

        <span class="name">is_human</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether this command execution was triggered by a human.</p>

<p>Will be <code>False</code> for bot and webhook triggered commands.</p>
</div>


                            </div>
                            <div id="MessageContext.member" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageContext.member">#&nbsp;&nbsp</a>

        <span class="name">member</span><span class="annotation">: Optional[hikari.guilds.Member]</span>
    </div>

            <div class="docstring"><p>Guild member object of this command's author.</p>

<p>Will be <code>None</code> for DM command executions.</p>
</div>


                            </div>
                            <div id="MessageContext.message" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageContext.message">#&nbsp;&nbsp</a>

        <span class="name">message</span><span class="annotation">: hikari.messages.Message</span>
    </div>

            <div class="docstring"><p>Message that triggered the context.</p>
</div>


                            </div>
                            <div id="MessageContext.triggering_name" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageContext.triggering_name">#&nbsp;&nbsp</a>

        <span class="name">triggering_name</span><span class="annotation">: str</span>
    </div>

            <div class="docstring"><p>Command name this execution was triggered with.</p>
</div>


                            </div>
                            <div id="MessageContext.triggering_prefix" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageContext.triggering_prefix">#&nbsp;&nbsp</a>

        <span class="name">triggering_prefix</span><span class="annotation">: str</span>
    </div>

            <div class="docstring"><p>Prefix that triggered the context.</p>
</div>


                            </div>
                            <div id="MessageContext.shard" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageContext.shard">#&nbsp;&nbsp</a>

        <span class="name">shard</span><span class="annotation">: Optional[hikari.api.shard.GatewayShard]</span>
    </div>

            <div class="docstring"><p>Shard that triggered the context.</p>

<p><em>Note:</em>
This will be <code>None</code> if <code>ctx.shards</code> is also <code>None</code>.</p>
</div>


                            </div>
                            <div id="MessageContext.set_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageContext.set_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_command</span><span class="signature">(
    self: ~_MessageContextT,
    command: Optional[<a href="tanjun/abc.html#MessageCommand">tanjun.abc.MessageCommand</a>],
    /
) -&gt; ~_MessageContextT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageContextT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="k">if</span> <span class="n">command</span><span class="p">:</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
                <span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
                <span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">command</span><span class="p">),</span> <span class="n">command</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">command_case</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">injecting</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command_case</span><span class="p">,</span> <span class="n">injecting</span><span class="o">.</span><span class="n">Undefined</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">)</span>  <span class="c1"># TODO: command group?</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">command_case</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MessageContext.set_content" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageContext.set_content">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_content</span><span class="signature">(self: ~_MessageContextT, content: str, /) -&gt; ~_MessageContextT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_content</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageContextT</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MessageContext.set_triggering_name" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageContext.set_triggering_name">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_triggering_name</span><span class="signature">(self: ~_MessageContextT, name: str, /) -&gt; ~_MessageContextT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_triggering_name</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageContextT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_triggering_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MessageContext.set_triggering_prefix" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageContext.set_triggering_prefix">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_triggering_prefix</span><span class="signature">(
    self: ~_MessageContextT,
    triggering_prefix: str,
    /
) -&gt; ~_MessageContextT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_triggering_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_MessageContextT</span><span class="p">,</span> <span class="n">triggering_prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_MessageContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_triggering_prefix</span> <span class="o">=</span> <span class="n">triggering_prefix</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MessageContext.delete_initial_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageContext.delete_initial_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">delete_initial_response</span><span class="signature">(self) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no initial response&quot;</span><span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">delete_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Delete the initial response after invoking this context.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>LookupError, hikari.NotFoundError</strong>: The last context has no initial response.</li>
</ul>
</div>


                            </div>
                            <div id="MessageContext.delete_last_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageContext.delete_last_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">delete_last_response</span><span class="signature">(self) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous responses&quot;</span><span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">delete_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Delete the last response after invoking this context.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>LookupError, hikari.NotFoundError</strong>: The last context has no responses.</li>
</ul>
</div>


                            </div>
                            <div id="MessageContext.edit_initial_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageContext.edit_initial_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">edit_initial_response</span><span class="signature">(
    self,
    content: Union[Any, hikari.undefined.UndefinedType] = UNDEFINED,
    *,
    delete_after: Union[datetime.timedelta, float, int, NoneType] = None,
    attachment: &#39;hikari.UndefinedOr[hikari.Resourceish]&#39; = UNDEFINED,
    attachments: &#39;hikari.UndefinedOr[collections.Sequence[hikari.Resourceish]]&#39; = UNDEFINED,
    component: Union[hikari.api.special_endpoints.ComponentBuilder, hikari.undefined.UndefinedType, NoneType] = UNDEFINED,
    components: Union[collections.abc.Sequence[hikari.api.special_endpoints.ComponentBuilder], hikari.undefined.UndefinedType, NoneType] = UNDEFINED,
    embed: Union[hikari.embeds.Embed, hikari.undefined.UndefinedType, NoneType] = UNDEFINED,
    embeds: Union[collections.abc.Sequence[hikari.embeds.Embed], hikari.undefined.UndefinedType, NoneType] = UNDEFINED,
    replace_attachments: bool = False,
    mentions_everyone: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED,
    user_mentions: Union[Sequence[Union[hikari.users.PartialUser, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED,
    role_mentions: Union[Sequence[Union[hikari.guilds.PartialRole, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED
) -&gt; hikari.messages.Message</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="n">_delete_after_to_float</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no initial response&quot;</span><span class="p">)</span>

        <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
            <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
            <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
            <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
            <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
            <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
            <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
            <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">message</span>
</pre></div>

        </details>

            <div class="docstring"><p>Edit the initial response for this context.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>content</strong> (hikari.UndefinedOr[typing.Any]):
The content to edit the initial response with.</p>

<p>If provided, the message contents. If
<code>hikari.UNDEFINED</code>, then nothing will be sent
in the content. Any other value here will be cast to a
<code>str</code>.</p>

<p>If this is a <code>hikari.Embed</code> and no <code>embed</code> nor <code>embeds</code> kwarg
is provided, then this will instead update the embed. This allows
for simpler syntax when sending an embed alone.</p>

<p>Likewise, if this is a <code>hikari.Resource</code>, then the
content is instead treated as an attachment if no <code>attachment</code> and
no <code>attachments</code> kwargs are provided.</p></li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>delete_after</strong> (typing.Union[datetime.timedelta, float, int, None]):
If provided, the seconds after which the response message should be delete.</p>

<p><em>Note:</em>
As of writing, this does not support ephemeral slash command responses.</p></li>
<li><strong>attachment</strong> (hikari.UndefinedOr[hikari.Resourceish]):
A singular attachment to edit the initial response with.</li>
<li><strong>attachments</strong> (hikari.UndefinedOr[collections.abc.Sequence[hikari.Resourceish]]):
A sequence of attachments to edit the initial response with.</li>
<li><strong>component</strong> (hikari.UndefinedNoneOr[hikari.api.ComponentBuilder]):
If provided, builder object of the component to set for this message.
This component will replace any previously set components and passing
<code>None</code> will remove all components.</li>
<li><strong>components</strong> (hikari.UndefinedNoneOr[collections.abc.Sequence[hikari.api.ComponentBuilder]]):
If provided, a sequence of the component builder objects set for
this message. These components will replace any previously set
components and passing <code>None</code> or an empty sequence will
remove all components.</li>
<li><strong>embed</strong> (hikari.UndefinedOr[hikari.Embed]):
An embed to replace the initial response with.</li>
<li><strong>embeds</strong> (hikari.UndefinedOr[collections.abc.Sequence[hikari.Embed]]):
A sequence of embeds to replace the initial response with.</li>
<li><strong>replace_attachments</strong> (bool):
Whether to replace the attachments of the response or not. Default to <code>False</code>.</li>
<li><strong>mentions_everyone</strong> (hikari.UndefinedOr[bool]):
If provided, whether the message should parse @everyone/@here
mentions.</li>
<li><strong>user_mentions</strong> (hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialUser], bool]]):
If provided, and <code>True</code>, all mentions will be parsed.
If provided, and <code>False</code>, no mentions will be parsed.
Alternatively this may be a collection of
<code>hikari.Snowflake</code>, or <code>hikari.PartialUser</code>
derivatives to enforce mentioning specific users.</li>
<li><strong>role_mentions</strong> (hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialRole], bool]]):
If provided, and <code>True</code>, all mentions will be parsed.
If provided, and <code>False</code>, no mentions will be parsed.
Alternatively this may be a collection of
<code>hikari.Snowflake</code>, or
<code>hikari.PartialRole</code> derivatives to enforce mentioning
specific roles.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>Attachments can be passed as many different things, to aid in
convenience.</p>

<ul>
<li>If a <code>pathlib.PurePath</code> or <code>str</code> to a valid URL, the
resource at the given URL will be streamed to Discord when
sending the message. Subclasses of
<code>hikari.WebResource</code> such as
<code>hikari.URL</code>,
<code>hikari.Attachment</code>,
<code>hikari.Emoji</code>,
<code>EmbedResource</code>, etc will also be uploaded this way.
This will use bit-inception, so only a small percentage of the
resource will remain in memory at any one time, thus aiding in
scalability.</li>
<li>If a <code>hikari.Bytes</code> is passed, or a <code>str</code>
that contains a valid data URI is passed, then this is uploaded
with a randomized file name if not provided.</li>
<li>If a <code>hikari.File</code>, <code>pathlib.PurePath</code> or
<code>str</code> that is an absolute or relative path to a file
on your file system is passed, then this resource is uploaded
as an attachment using non-blocking code internally and streamed
using bit-inception where possible. This depends on the
type of <code>concurrent.futures.Executor</code> that is being used for
the application (default is a thread pool which supports this
behaviour).</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.Message</strong>: The message that has been edited.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If more than 100 unique objects/entities are passed for
<code>role_mentions</code> or <code>user_mentions</code>.</li>
<li><strong>TypeError</strong>: If both <code>attachment</code> and <code>attachments</code> are specified.</li>
<li><strong>hikari.BadRequestError</strong>: This may be raised in several discrete situations, such as messages
being empty with no attachments or embeds; messages with more than
2000 characters in them, embeds that exceed one of the many embed
limits; too many attachments; attachments that are too large;
invalid image URLs in embeds; if <code>reply</code> is not found or not in the
same channel as <code>channel</code>; too many components.</li>
<li><strong>hikari.UnauthorizedError</strong>: If you are unauthorized to make the request (invalid/missing token).</li>
<li><strong>hikari.ForbiddenError</strong>: If you are missing the <code>SEND_MESSAGES</code> in the channel or the
person you are trying to message has the DM's disabled.</li>
<li><strong>hikari.NotFoundError</strong>: If the channel is not found.</li>
<li><strong>hikari.RateLimitTooLongError</strong>: Raised in the event that a rate limit occurs that is
longer than <code>max_rate_limit</code> when making a request.</li>
<li><strong>hikari.RateLimitedError</strong>: Usually, Hikari will handle and retry on hitting
rate-limits automatically. This includes most bucket-specific
rate-limits and global rate-limits. In some rare edge cases,
however, Discord implements other undocumented rules for
rate-limiting, such as limits per attribute. These cannot be
detected or handled normally by Hikari due to their undocumented
nature, and will trigger this exception if they occur.</li>
<li><strong>hikari.InternalServerError</strong>: If an internal error occurs on Discord while handling the request.</li>
</ul>
</div>


                            </div>
                            <div id="MessageContext.edit_last_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageContext.edit_last_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">edit_last_response</span><span class="signature">(
    self,
    content: Union[Any, hikari.undefined.UndefinedType] = UNDEFINED,
    *,
    delete_after: Union[datetime.timedelta, float, int, NoneType] = None,
    attachment: &#39;hikari.UndefinedOr[hikari.Resourceish]&#39; = UNDEFINED,
    attachments: &#39;hikari.UndefinedOr[collections.Sequence[hikari.Resourceish]]&#39; = UNDEFINED,
    component: Union[hikari.api.special_endpoints.ComponentBuilder, hikari.undefined.UndefinedType, NoneType] = UNDEFINED,
    components: Union[collections.abc.Sequence[hikari.api.special_endpoints.ComponentBuilder], hikari.undefined.UndefinedType, NoneType] = UNDEFINED,
    embed: Union[hikari.embeds.Embed, hikari.undefined.UndefinedType, NoneType] = UNDEFINED,
    embeds: Union[collections.abc.Sequence[hikari.embeds.Embed], hikari.undefined.UndefinedType, NoneType] = UNDEFINED,
    replace_attachments: bool = False,
    mentions_everyone: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED,
    user_mentions: Union[Sequence[Union[hikari.users.PartialUser, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED,
    role_mentions: Union[Sequence[Union[hikari.guilds.PartialRole, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED
) -&gt; hikari.messages.Message</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_last_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="n">_delete_after_to_float</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous tracked response&quot;</span><span class="p">)</span>

        <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
            <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
            <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
            <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
            <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
            <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
            <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
            <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">message</span>
</pre></div>

        </details>

            <div class="docstring"><p>Edit the last response for this context.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>content</strong> (hikari.UndefinedOr[typing.Any]):
The content to edit the last response with.</p>

<p>If provided, the message contents. If
<code>hikari.UNDEFINED</code>, then nothing will be sent
in the content. Any other value here will be cast to a
<code>str</code>.</p>

<p>If this is a <code>hikari.Embed</code> and no <code>embed</code> nor <code>embeds</code> kwarg
is provided, then this will instead update the embed. This allows
for simpler syntax when sending an embed alone.</p>

<p>Likewise, if this is a <code>hikari.Resource</code>, then the
content is instead treated as an attachment if no <code>attachment</code> and
no <code>attachments</code> kwargs are provided.</p></li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>delete_after</strong> (typing.Union[datetime.timedelta, float, int, None]):
If provided, the seconds after which the response message should be delete.</p>

<p><em>Note:</em>
As of writing, this does not support ephemeral slash command responses.</p></li>
<li><strong>attachment</strong> (hikari.UndefinedOr[hikari.Resourceish]):
A singular attachment to edit the last response with.</li>
<li><strong>attachments</strong> (hikari.UndefinedOr[collections.abc.Sequence[hikari.Resourceish]]):
A sequence of attachments to edit the last response with.</li>
<li><strong>component</strong> (hikari.UndefinedNoneOr[hikari.api.ComponentBuilder]):
If provided, builder object of the component to set for this message.
This component will replace any previously set components and passing
<code>None</code> will remove all components.</li>
<li><strong>components</strong> (hikari.UndefinedNoneOr[collections.abc.Sequence[hikari.api.ComponentBuilder]]):
If provided, a sequence of the component builder objects set for
this message. These components will replace any previously set
components and passing <code>None</code> or an empty sequence will
remove all components.</li>
<li><strong>embed</strong> (hikari.UndefinedOr[hikari.Embed]):
An embed to replace the last response with.</li>
<li><strong>embeds</strong> (hikari.UndefinedOr[collections.abc.Sequence[hikari.Embed]]):
A sequence of embeds to replace the last response with.</li>
<li><strong>replace_attachments</strong> (bool):
Whether to replace the attachments of the response or not. Default to <code>False</code>.</li>
<li><strong>mentions_everyone</strong> (hikari.UndefinedOr[bool]):
If provided, whether the message should parse @everyone/@here
mentions.</li>
<li><p><strong>user_mentions</strong> (hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialUser], bool]]):
If provided, and <code>True</code>, all mentions will be parsed.
If provided, and <code>False</code>, no mentions will be parsed.</p>

<p>Alternatively this may be a collection of
<code>hikari.Snowflake</code>, or <code>hikari.PartialUser</code>
derivatives to enforce mentioning specific users.</p></li>
<li><p><strong>role_mentions</strong> (hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialRole], bool]]):
If provided, and <code>True</code>, all mentions will be parsed.
If provided, and <code>False</code>, no mentions will be parsed.</p>

<p>Alternatively this may be a collection of
<code>hikari.Snowflake</code>, or
<code>hikari.PartialRole</code> derivatives to enforce mentioning
specific roles.</p></li>
</ul>

<h6 id="notes">Notes</h6>

<p>Attachments can be passed as many different things, to aid in
convenience.</p>

<ul>
<li>If a <code>pathlib.PurePath</code> or <code>str</code> to a valid URL, the
resource at the given URL will be streamed to Discord when
sending the message. Subclasses of
<code>hikari.WebResource</code> such as
<code>hikari.URL</code>,
<code>hikari.Attachment</code>,
<code>hikari.Emoji</code>,
<code>EmbedResource</code>, etc will also be uploaded this way.
This will use bit-inception, so only a small percentage of the
resource will remain in memory at any one time, thus aiding in
scalability.</li>
<li>If a <code>hikari.Bytes</code> is passed, or a <code>str</code>
that contains a valid data URI is passed, then this is uploaded
with a randomized file name if not provided.</li>
<li>If a <code>hikari.File</code>, <code>pathlib.PurePath</code> or
<code>str</code> that is an absolute or relative path to a file
on your file system is passed, then this resource is uploaded
as an attachment using non-blocking code internally and streamed
using bit-inception where possible. This depends on the
type of <code>concurrent.futures.Executor</code> that is being used for
the application (default is a thread pool which supports this
behaviour).</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.Message</strong>: The message that has been edited.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If more than 100 unique objects/entities are passed for
<code>role_mentions</code> or <code>user_mentions</code>.</li>
<li><strong>TypeError</strong>: If both <code>attachment</code> and <code>attachments</code> are specified.</li>
<li><strong>hikari.BadRequestError</strong>: This may be raised in several discrete situations, such as messages
being empty with no attachments or embeds; messages with more than
2000 characters in them, embeds that exceed one of the many embed
limits; too many attachments; attachments that are too large;
invalid image URLs in embeds; if <code>reply</code> is not found or not in the
same channel as <code>channel</code>; too many components.</li>
<li><strong>hikari.UnauthorizedError</strong>: If you are unauthorized to make the request (invalid/missing token).</li>
<li><strong>hikari.ForbiddenError</strong>: If you are missing the <code>SEND_MESSAGES</code> in the channel or the
person you are trying to message has the DM's disabled.</li>
<li><strong>hikari.NotFoundError</strong>: If the channel is not found.</li>
<li><strong>hikari.RateLimitTooLongError</strong>: Raised in the event that a rate limit occurs that is
longer than <code>max_rate_limit</code> when making a request.</li>
<li><strong>hikari.RateLimitedError</strong>: Usually, Hikari will handle and retry on hitting
rate-limits automatically. This includes most bucket-specific
rate-limits and global rate-limits. In some rare edge cases,
however, Discord implements other undocumented rules for
rate-limiting, such as limits per attribute. These cannot be
detected or handled normally by Hikari due to their undocumented
nature, and will trigger this exception if they occur.</li>
<li><strong>hikari.InternalServerError</strong>: If an internal error occurs on Discord while handling the request.</li>
</ul>
</div>


                            </div>
                            <div id="MessageContext.fetch_initial_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageContext.fetch_initial_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">fetch_initial_response</span><span class="signature">(self) -&gt; hikari.messages.Message</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;No initial response found for this context&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Fetch the initial response for this context.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>LookupError, hikari.NotFoundError</strong>: The response was not found.</li>
</ul>
</div>


                            </div>
                            <div id="MessageContext.fetch_last_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageContext.fetch_last_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">fetch_last_response</span><span class="signature">(self) -&gt; hikari.messages.Message</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">channel_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;No responses found for this context&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Fetch the last response for this context.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>LookupError, hikari.NotFoundError</strong>: The response was not found.</li>
</ul>
</div>


                            </div>
                            <div id="MessageContext.respond" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageContext.respond">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">respond</span><span class="signature">(
    self,
    content: Union[Any, hikari.undefined.UndefinedType] = UNDEFINED,
    *,
    ensure_result: bool = True,
    delete_after: Union[datetime.timedelta, float, int, NoneType] = None,
    attachment: &#39;hikari.UndefinedOr[hikari.Resourceish]&#39; = UNDEFINED,
    attachments: &#39;hikari.UndefinedOr[collections.Sequence[hikari.Resourceish]]&#39; = UNDEFINED,
    component: Union[hikari.api.special_endpoints.ComponentBuilder, hikari.undefined.UndefinedType] = UNDEFINED,
    components: Union[collections.abc.Sequence[hikari.api.special_endpoints.ComponentBuilder], hikari.undefined.UndefinedType] = UNDEFINED,
    embed: Union[hikari.embeds.Embed, hikari.undefined.UndefinedType] = UNDEFINED,
    embeds: Union[collections.abc.Sequence[hikari.embeds.Embed], hikari.undefined.UndefinedType] = UNDEFINED,
    tts: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED,
    nonce: Union[str, hikari.undefined.UndefinedType] = UNDEFINED,
    reply: Union[hikari.messages.PartialMessage, hikari.snowflakes.Snowflake, int, hikari.undefined.UndefinedType] = UNDEFINED,
    mentions_everyone: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED,
    mentions_reply: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED,
    user_mentions: Union[Sequence[Union[hikari.users.PartialUser, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED,
    role_mentions: Union[Sequence[Union[hikari.guilds.PartialRole, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED
) -&gt; hikari.messages.Message</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">nonce</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">reply</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialMessage</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_reply</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="n">_delete_after_to_float</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
                <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">,</span>
                <span class="n">reply</span><span class="o">=</span><span class="n">reply</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">mentions_reply</span><span class="o">=</span><span class="n">mentions_reply</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">id</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_initial_response_id</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">id</span>

            <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">message</span>
</pre></div>

        </details>

            <div class="docstring"><p>Respond to this context.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>content</strong> (hikari.UndefinedOr[typing.Any]):
The content to respond with.</p>

<p>If provided, the message contents. If
<code>hikari.UNDEFINED</code>, then nothing will be sent
in the content. Any other value here will be cast to a
<code>str</code>.</p>

<p>If this is a <code>hikari.Embed</code> and no <code>embed</code> nor <code>embeds</code> kwarg
is provided, then this will instead update the embed. This allows
for simpler syntax when sending an embed alone.</p>

<p>Likewise, if this is a <code>hikari.Resource</code>, then the
content is instead treated as an attachment if no <code>attachment</code> and
no <code>attachments</code> kwargs are provided.</p></li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>ensure_result</strong> (bool):
If provided and set to <code>True</code> then this will always return <code>hikari.Message</code>,
otherwise this will return <code>Optional[hikari.Message]</code>.</p>

<p>It's worth noting that, under certain scenarios within the slash
command flow, this may lead to an extre request being made.</p></li>
<li><p><strong>delete_after</strong> (typing.Union[datetime.timedelta, float, int, None]):
If provided, the seconds after which the response message should be delete.</p>

<p><em>Note:</em>
As of writing, this does not support ephemeral slash command responses.</p></li>
<li><strong>component</strong> (hikari.UndefinedOr[hikari.api.ComponentBuilder]):
If provided, builder object of the component to include in this response.</li>
<li><strong>components</strong> (hikari.UndefinedOr[collections.abc.Sequence[hikari.api.ComponentBuilder]]):
If provided, a sequence of the component builder objects to include
in this response.</li>
<li><strong>embed</strong> (hikari.UndefinedOr[hikari.Embed]):
An embed to respond with.</li>
<li><strong>embeds</strong> (hikari.UndefinedOr[collections.abc.Sequence[hikari.Embed]]):
A sequence of embeds to respond with.</li>
<li><strong>mentions_everyone</strong> (hikari.UndefinedOr[bool]):
If provided, whether the message should parse @everyone/@here
mentions.</li>
<li><p><strong>user_mentions</strong> (hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialUser], bool]]):
If provided, and <code>True</code>, all mentions will be parsed.
If provided, and <code>False</code>, no mentions will be parsed.</p>

<p>Alternatively this may be a collection of
<code>hikari.Snowflake</code>, or <code>hikari.PartialUser</code>
derivatives to enforce mentioning specific users.</p></li>
<li><p><strong>role_mentions</strong> (hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialRole], bool]]):
If provided, and <code>True</code>, all mentions will be parsed.
If provided, and <code>False</code>, no mentions will be parsed.</p>

<p>Alternatively this may be a collection of
<code>hikari.Snowflake</code>, or
<code>hikari.PartialRole</code> derivatives to enforce mentioning
specific roles.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Optional[hikari.Message]</strong>: The message that has been created if it was immedieatly available or
<code>ensure_result</code> was set to <code>True</code>, else <code>None</code>.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If more than 100 unique objects/entities are passed for
<code>role_mentions</code> or <code>user_mentions</code>.</li>
<li><strong>TypeError</strong>: If both <code>attachment</code> and <code>attachments</code> are specified.</li>
<li><strong>hikari.BadRequestError</strong>: This may be raised in several discrete situations, such as messages
being empty with no attachments or embeds; messages with more than
2000 characters in them, embeds that exceed one of the many embed
limits; too many attachments; attachments that are too large;
invalid image URLs in embeds; if <code>reply</code> is not found or not in the
same channel as <code>channel</code>; too many components.</li>
<li><strong>hikari.UnauthorizedError</strong>: If you are unauthorized to make the request (invalid/missing token).</li>
<li><strong>hikari.ForbiddenError</strong>: If you are missing the <code>SEND_MESSAGES</code> in the channel or the
person you are trying to message has the DM's disabled.</li>
<li><strong>hikari.NotFoundError</strong>: If the channel is not found.</li>
<li><strong>hikari.RateLimitTooLongError</strong>: Raised in the event that a rate limit occurs that is
longer than <code>max_rate_limit</code> when making a request.</li>
<li><strong>hikari.RateLimitedError</strong>: Usually, Hikari will handle and retry on hitting
rate-limits automatically. This includes most bucket-specific
rate-limits and global rate-limits. In some rare edge cases,
however, Discord implements other undocumented rules for
rate-limiting, such as limits per attribute. These cannot be
detected or handled normally by Hikari due to their undocumented
nature, and will trigger this exception if they occur.</li>
<li><strong>hikari.InternalServerError</strong>: If an internal error occurs on Discord while handling the request.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="tanjun/context.html#BaseContext">tanjun.context.BaseContext</a></dt>
                                <dd id="MessageContext.cache" class="variable"><a href="tanjun/context.html#BaseContext.cache">cache</a></dd>
                <dd id="MessageContext.client" class="variable"><a href="tanjun/context.html#BaseContext.client">client</a></dd>
                <dd id="MessageContext.component" class="variable"><a href="tanjun/context.html#BaseContext.component">component</a></dd>
                <dd id="MessageContext.events" class="variable"><a href="tanjun/context.html#BaseContext.events">events</a></dd>
                <dd id="MessageContext.server" class="variable"><a href="tanjun/context.html#BaseContext.server">server</a></dd>
                <dd id="MessageContext.rest" class="variable"><a href="tanjun/context.html#BaseContext.rest">rest</a></dd>
                <dd id="MessageContext.shards" class="variable"><a href="tanjun/context.html#BaseContext.shards">shards</a></dd>
                <dd id="MessageContext.voice" class="variable"><a href="tanjun/context.html#BaseContext.voice">voice</a></dd>
                <dd id="MessageContext.finalise" class="function"><a href="tanjun/context.html#BaseContext.finalise">finalise</a></dd>
                <dd id="MessageContext.set_component" class="function"><a href="tanjun/context.html#BaseContext.set_component">set_component</a></dd>
                <dd id="MessageContext.get_channel" class="function"><a href="tanjun/context.html#BaseContext.get_channel">get_channel</a></dd>
                <dd id="MessageContext.get_guild" class="function"><a href="tanjun/context.html#BaseContext.get_guild">get_guild</a></dd>
                <dd id="MessageContext.fetch_channel" class="function"><a href="tanjun/context.html#BaseContext.fetch_channel">fetch_channel</a></dd>
                <dd id="MessageContext.fetch_guild" class="function"><a href="tanjun/context.html#BaseContext.fetch_guild">fetch_guild</a></dd>

            </div>
            <div><dt><a href="tanjun/injecting.html#BasicInjectionContext">tanjun.injecting.BasicInjectionContext</a></dt>
                                <dd id="MessageContext.injection_client" class="variable"><a href="tanjun/injecting.html#BasicInjectionContext.injection_client">injection_client</a></dd>
                <dd id="MessageContext.cache_result" class="function"><a href="tanjun/injecting.html#BasicInjectionContext.cache_result">cache_result</a></dd>
                <dd id="MessageContext.get_cached_result" class="function"><a href="tanjun/injecting.html#BasicInjectionContext.get_cached_result">get_cached_result</a></dd>
                <dd id="MessageContext.get_type_special_case" class="function"><a href="tanjun/injecting.html#BasicInjectionContext.get_type_special_case">get_type_special_case</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="SlashContext">
                                <div class="attr class">
        <a class="headerlink" href="#SlashContext">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">SlashContext</span><wbr>(<span class="base"><a href="tanjun/context.html#BaseContext">tanjun.context.BaseContext</a></span>, <span class="base"><a href="tanjun/abc.html#SlashContext">tanjun.abc.SlashContext</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">SlashContext</span><span class="p">(</span><span class="n">BaseContext</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_command&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_defaults_to_ephemeral&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_defer_task&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_has_been_deferred&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_has_responded&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_interaction&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_last_response_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_marked_not_found&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_on_not_found&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_options&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_response_future&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_response_lock&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span>
        <span class="n">injection_client</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">InjectorClient</span><span class="p">,</span>
        <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default_to_ephemeral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">on_not_found</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">SlashContext</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">injection_client</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="o">=</span> <span class="n">default_to_ephemeral</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span> <span class="o">=</span> <span class="n">interaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_marked_not_found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_not_found</span> <span class="o">=</span> <span class="n">on_not_found</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseTypeT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">SlashContext</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

        <span class="n">options</span> <span class="o">=</span> <span class="n">interaction</span><span class="o">.</span><span class="n">options</span>
        <span class="k">while</span> <span class="n">options</span> <span class="ow">and</span> <span class="p">(</span><span class="n">first_option</span> <span class="o">:=</span> <span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="n">_COMMAND_OPTION_TYPES</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">first_option</span><span class="o">.</span><span class="n">options</span>

        <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="p">{</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">SlashOption</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span> <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">options</span><span class="p">}</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">author</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">user</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">channel_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">channel_id</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_command</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">created_at</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">created_at</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">defaults_to_ephemeral</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">expires_at</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">created_at</span> <span class="o">+</span> <span class="n">_INTERACTION_LIFETIME</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">guild_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">guild_id</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_been_deferred</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_responded</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_human</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">]:</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">member</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">triggering_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># TODO: account for command groups</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">command_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">interaction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashOption</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_auto_defer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">countdown</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">countdown</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">defer</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">cancel_defer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_flags</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">flags</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="o">.</span><span class="n">EPHEMERAL</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="k">else</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="o">.</span><span class="n">NONE</span>

        <span class="k">return</span> <span class="n">flags</span>

    <span class="k">def</span> <span class="nf">get_response_future</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseTypeT</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_future</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">mark_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_not_found</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_marked_not_found</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_marked_not_found</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">start_defer_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashContextT</span><span class="p">,</span> <span class="n">count_down</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Defer timer already set&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer</span><span class="p">(</span><span class="n">count_down</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashContextT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="k">if</span> <span class="n">command</span><span class="p">:</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
                <span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
                <span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashCommand</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
                <span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">command</span><span class="p">),</span> <span class="n">command</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">command_case</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">injecting</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command_case</span><span class="p">,</span> <span class="n">injecting</span><span class="o">.</span><span class="n">Undefined</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashCommand</span><span class="p">)</span>  <span class="c1"># TODO: command group?</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">command_case</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_ephemeral_default</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashContextT</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">defer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
        <span class="n">in_defer_task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span> <span class="ow">is</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">current_task</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">in_defer_task</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cancel_defer</span><span class="p">()</span>

        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">in_defer_task</span><span class="p">:</span>
                    <span class="k">return</span>

                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Context has already been responded to&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">build_deferred_response</span><span class="p">()</span><span class="o">.</span><span class="n">set_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">))</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span>
                    <span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">DEFERRED_MESSAGE_CREATE</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_delete_after</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="n">_delete_after_to_float</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span>
        <span class="n">time_left</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">_INTERACTION_LIFETIME</span> <span class="o">-</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">created_at</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">delete_after</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">&gt;</span> <span class="n">time_left</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This interaction will have expired before delete_after is reached&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">delete_after</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_delete_followup_after</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delete_after</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Failed to delete response message after </span><span class="si">%.2f</span><span class="s2"> seconds&quot;</span><span class="p">,</span> <span class="n">delete_after</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="n">exc</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_create_followup</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
            <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
            <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
            <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
            <span class="n">flags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">),</span>
            <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
            <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
            <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
            <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">id</span>

        <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_followup_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">message</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_followup</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_followup</span><span class="p">(</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
                <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_delete_initial_response_after</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delete_after</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_initial_response</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Failed to delete response message after </span><span class="si">%.2f</span><span class="s2"> seconds&quot;</span><span class="p">,</span> <span class="n">delete_after</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="n">exc</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_create_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Initial response has already been created&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;edit_initial_response must be used to set the initial response after a context has been deferred&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cancel_defer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span>
                <span class="n">response_type</span><span class="o">=</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_CREATE</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">component</span> <span class="ow">and</span> <span class="n">components</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only one of component or components may be passed&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">embed</span> <span class="ow">and</span> <span class="n">embeds</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only one of embed or embeds may be passed&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">component</span><span class="p">:</span>
                <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">)</span>
                <span class="n">components</span> <span class="o">=</span> <span class="p">(</span><span class="n">component</span><span class="p">,)</span>

            <span class="k">if</span> <span class="n">embed</span><span class="p">:</span>
                <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">embed</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">)</span>
                <span class="n">embeds</span> <span class="o">=</span> <span class="p">(</span><span class="n">embed</span><span class="p">,)</span>

            <span class="n">content</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">content</span><span class="p">)</span> <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="k">else</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span>
            <span class="c1"># Pyright doesn&#39;t properly support attrs and doesn&#39;t account for _ being removed from field</span>
            <span class="c1"># pre-fix in init.</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">InteractionMessageBuilder</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">MESSAGE_CREATE</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">is_tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="k">if</span> <span class="n">embeds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">embed</span> <span class="ow">in</span> <span class="n">embeds</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">add_embed</span><span class="p">(</span><span class="n">embed</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_initial_response_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_initial_response</span><span class="p">(</span>
                <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_initial_response</span><span class="p">()</span>
        <span class="c1"># If they defer then delete the initial response then this should be treated as having</span>
        <span class="c1"># an initial response to allow for followup responses.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_initial_response</span><span class="p">()</span>
                <span class="c1"># If they defer then delete the initial response then this should be treated as having</span>
                <span class="c1"># an initial response to allow for followup responses.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">return</span>

            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no last response&quot;</span><span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
            <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
            <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
            <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
            <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
            <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
            <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
            <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_initial_response_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_last_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">:</span>
            <span class="n">delete_after</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_followup_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">message</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
                <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous responses&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous known responses&quot;</span><span class="p">)</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">]:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_followup</span><span class="p">(</span>
                    <span class="n">content</span><span class="p">,</span>
                    <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                    <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                    <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                    <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                    <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                    <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                    <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                    <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
                    <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                    <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                    <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                    <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                    <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                    <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                    <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                    <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                    <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_initial_response</span><span class="p">(</span>
                <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">ensure_result</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Base class for all standard context implementations.</p>
</div>


                            <div id="SlashContext.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashContext.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">SlashContext</span><span class="signature">(
    client: <a href="tanjun/abc.html#Client">tanjun.abc.Client</a>,
    injection_client: <a href="tanjun/injecting.html#InjectorClient">tanjun.injecting.InjectorClient</a>,
    interaction: hikari.interactions.command_interactions.CommandInteraction,
    *,
    command: Optional[<a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>] = None,
    component: Optional[<a href="tanjun/abc.html#Component">tanjun.abc.Component</a>] = None,
    default_to_ephemeral: bool = False,
    on_not_found: Optional[collections.abc.Callable[[<a href="tanjun/context.html#SlashContext">tanjun.context.SlashContext</a>], collections.abc.Awaitable[None]]] = None
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span>
        <span class="n">injection_client</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">InjectorClient</span><span class="p">,</span>
        <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default_to_ephemeral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">on_not_found</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">SlashContext</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">injection_client</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="o">=</span> <span class="n">default_to_ephemeral</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span> <span class="o">=</span> <span class="n">interaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_marked_not_found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_not_found</span> <span class="o">=</span> <span class="n">on_not_found</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseTypeT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">SlashContext</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

        <span class="n">options</span> <span class="o">=</span> <span class="n">interaction</span><span class="o">.</span><span class="n">options</span>
        <span class="k">while</span> <span class="n">options</span> <span class="ow">and</span> <span class="p">(</span><span class="n">first_option</span> <span class="o">:=</span> <span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="n">_COMMAND_OPTION_TYPES</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">first_option</span><span class="o">.</span><span class="n">options</span>

        <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="p">{</span><span class="n">option</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">SlashOption</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span> <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">options</span><span class="p">}</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="SlashContext.author" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashContext.author">#&nbsp;&nbsp</a>

        <span class="name">author</span><span class="annotation">: hikari.users.User</span>
    </div>

            <div class="docstring"><p>Object of the user who triggered this command.</p>
</div>


                            </div>
                            <div id="SlashContext.channel_id" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashContext.channel_id">#&nbsp;&nbsp</a>

        <span class="name">channel_id</span><span class="annotation">: hikari.snowflakes.Snowflake</span>
    </div>

            <div class="docstring"><p>ID of the channel this command was triggered in.</p>
</div>


                            </div>
                            <div id="SlashContext.client" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashContext.client">#&nbsp;&nbsp</a>

        <span class="name">client</span><span class="annotation">: <a href="tanjun/abc.html#Client">tanjun.abc.Client</a></span>
    </div>

            <div class="docstring"><p>Tanjun <code><a href="#Client">Client</a></code> implementation this context was spawned by.</p>
</div>


                            </div>
                            <div id="SlashContext.command" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashContext.command">#&nbsp;&nbsp</a>

        <span class="name">command</span><span class="annotation">: Optional[<a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>]</span>
    </div>

            <div class="docstring"><p>Object of the command this context is bound to.</p>

<p><em>Note:</em>
This will only be <code>None</code> before this has been bound to a
specific command but never during command execution.</p>
</div>


                            </div>
                            <div id="SlashContext.created_at" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashContext.created_at">#&nbsp;&nbsp</a>

        <span class="name">created_at</span><span class="annotation">: datetime.datetime</span>
    </div>

            <div class="docstring"><p>When this context was created.</p>

<p><em>Note:</em>
This will either refer to a message or integration's creation date.</p>
</div>


                            </div>
                            <div id="SlashContext.defaults_to_ephemeral" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashContext.defaults_to_ephemeral">#&nbsp;&nbsp</a>

        <span class="name">defaults_to_ephemeral</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether the context is marked as defaulting to ephemeral response.</p>

<p>This effects calls to <code><a href="#SlashContext.create_followup">SlashContext.create_followup</a></code>,
<code><a href="#SlashContext.create_initial_response">SlashContext.create_initial_response</a></code>, <code><a href="#SlashContext.defer">SlashContext.defer</a></code> and
<code><a href="#SlashContext.respond">SlashContext.respond</a></code> unless the <code>flags</code> field is provided for the
methods which support it.</p>
</div>


                            </div>
                            <div id="SlashContext.expires_at" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashContext.expires_at">#&nbsp;&nbsp</a>

        <span class="name">expires_at</span><span class="annotation">: datetime.datetime</span>
    </div>

            <div class="docstring"><p>When this application command context expires.</p>

<p>After this time is reached, the message/response methods on this
context will always raise <code>hikari.errors.NotFoundError</code>.</p>
</div>


                            </div>
                            <div id="SlashContext.guild_id" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashContext.guild_id">#&nbsp;&nbsp</a>

        <span class="name">guild_id</span><span class="annotation">: Optional[hikari.snowflakes.Snowflake]</span>
    </div>

            <div class="docstring"><p>ID of the guild this command was executed in.</p>

<p>Will be <code>None</code> for all DM command executions.</p>
</div>


                            </div>
                            <div id="SlashContext.has_been_deferred" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashContext.has_been_deferred">#&nbsp;&nbsp</a>

        <span class="name">has_been_deferred</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether the initial response for this context has been deferred.</p>

<p><em>Warning:</em>
If this is <code>True</code> when <code><a href="#SlashContext.has_responded">SlashContext.has_responded</a></code> is <code>False</code>
then <code><a href="#SlashContext.edit_initial_response">SlashContext.edit_initial_response</a></code> will need to be used
to create the initial response rather than
<code><a href="#SlashContext.create_initial_response">SlashContext.create_initial_response</a></code>.</p>
</div>


                            </div>
                            <div id="SlashContext.has_responded" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashContext.has_responded">#&nbsp;&nbsp</a>

        <span class="name">has_responded</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether an initial response has been made for this context.</p>
</div>


                            </div>
                            <div id="SlashContext.is_human" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashContext.is_human">#&nbsp;&nbsp</a>

        <span class="name">is_human</span><span class="annotation">: Literal[True]</span>
    </div>

            <div class="docstring"><p>Whether this command execution was triggered by a human.</p>

<p>Will be <code>False</code> for bot and webhook triggered commands.</p>
</div>


                            </div>
                            <div id="SlashContext.member" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashContext.member">#&nbsp;&nbsp</a>

        <span class="name">member</span><span class="annotation">: Optional[hikari.interactions.base_interactions.InteractionMember]</span>
    </div>

            <div class="docstring"><p>Guild member object of this command's author.</p>

<p>Will be <code>None</code> for DM command executions.</p>
</div>


                            </div>
                            <div id="SlashContext.triggering_name" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashContext.triggering_name">#&nbsp;&nbsp</a>

        <span class="name">triggering_name</span><span class="annotation">: str</span>
    </div>

            <div class="docstring"><p>Command name this execution was triggered with.</p>
</div>


                            </div>
                            <div id="SlashContext.interaction" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashContext.interaction">#&nbsp;&nbsp</a>

        <span class="name">interaction</span><span class="annotation">: hikari.interactions.command_interactions.CommandInteraction</span>
    </div>

            <div class="docstring"><p>Interaction this context is for.</p>
</div>


                            </div>
                            <div id="SlashContext.options" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashContext.options">#&nbsp;&nbsp</a>

        <span class="name">options</span><span class="annotation">: collections.abc.Mapping[str, <a href="tanjun/abc.html#SlashOption">tanjun.abc.SlashOption</a>]</span>
    </div>

            <div class="docstring"><p>Mapping of option names to the values provided for them.</p>
</div>


                            </div>
                            <div id="SlashContext.cancel_defer" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashContext.cancel_defer">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">cancel_defer</span><span class="signature">(self) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">cancel_defer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="SlashContext.get_response_future" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashContext.get_response_future">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_response_future</span><span class="signature">(self) -&gt; _asyncio.Future</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">get_response_future</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="n">ResponseTypeT</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_future</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="SlashContext.mark_not_found" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashContext.mark_not_found">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">mark_not_found</span><span class="signature">(self) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">mark_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_not_found</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_marked_not_found</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_marked_not_found</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Mark this context as not found.</p>

<p>Dependent on how the client is configured this may lead to a not found
response message being sent.</p>
</div>


                            </div>
                            <div id="SlashContext.start_defer_timer" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashContext.start_defer_timer">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">start_defer_timer</span><span class="signature">(
    self: ~_SlashContextT,
    count_down: Union[int, float],
    /
) -&gt; ~_SlashContextT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">start_defer_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashContextT</span><span class="p">,</span> <span class="n">count_down</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Defer timer already set&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer</span><span class="p">(</span><span class="n">count_down</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="SlashContext.set_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashContext.set_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_command</span><span class="signature">(
    self: ~_SlashContextT,
    command: Optional[<a href="tanjun/abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>],
    /
) -&gt; ~_SlashContextT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashContextT</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="k">if</span> <span class="n">command</span><span class="p">:</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
                <span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
                <span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashCommand</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
                <span class="o">.</span><span class="n">_set_type_special_case</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">command</span><span class="p">),</span> <span class="n">command</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">command_case</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">injecting</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command_case</span><span class="p">,</span> <span class="n">injecting</span><span class="o">.</span><span class="n">Undefined</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashCommand</span><span class="p">)</span>  <span class="c1"># TODO: command group?</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_type_special_case</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">command_case</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the command for this context.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (typing.Optional[BaseSlashCommand]):
The command this context is for.</li>
</ul>
</div>


                            </div>
                            <div id="SlashContext.set_ephemeral_default" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashContext.set_ephemeral_default">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_ephemeral_default</span><span class="signature">(self: ~_SlashContextT, state: bool, /) -&gt; ~_SlashContextT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_ephemeral_default</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_SlashContextT</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_SlashContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_not_final</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaults_to_ephemeral</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the ephemeral default state for this context.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>state</strong> (bool):
The new ephemeral default state.</p>

<p>If this is <code>True</code> then all calls to the response creating methods
on this context will default to being ephemeral.</p></li>
</ul>
</div>


                            </div>
                            <div id="SlashContext.defer" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashContext.defer">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">defer</span><span class="signature">(
    self,
    flags: Union[hikari.undefined.UndefinedType, int, hikari.messages.MessageFlag] = UNDEFINED
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">defer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
        <span class="n">in_defer_task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defer_task</span> <span class="ow">is</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">current_task</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">in_defer_task</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cancel_defer</span><span class="p">()</span>

        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">in_defer_task</span><span class="p">:</span>
                    <span class="k">return</span>

                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Context has already been responded to&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_response_future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">build_deferred_response</span><span class="p">()</span><span class="o">.</span><span class="n">set_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">))</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">create_initial_response</span><span class="p">(</span>
                    <span class="n">hikari</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">DEFERRED_MESSAGE_CREATE</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span>
                <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Defer the initial response for this context.</p>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>flags</strong> (typing.Union[hikari.UndefinedType, int, hikari.MessageFlag]):
The flags to use for the initial response.</li>
</ul>
</div>


                            </div>
                            <div id="SlashContext.create_followup" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashContext.create_followup">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">create_followup</span><span class="signature">(
    self,
    content: Union[Any, hikari.undefined.UndefinedType] = UNDEFINED,
    *,
    delete_after: Union[datetime.timedelta, float, int, NoneType] = None,
    attachment: &#39;hikari.UndefinedOr[hikari.Resourceish]&#39; = UNDEFINED,
    attachments: &#39;hikari.UndefinedOr[collections.Sequence[hikari.Resourceish]]&#39; = UNDEFINED,
    component: Union[hikari.api.special_endpoints.ComponentBuilder, hikari.undefined.UndefinedType] = UNDEFINED,
    components: Union[collections.abc.Sequence[hikari.api.special_endpoints.ComponentBuilder], hikari.undefined.UndefinedType] = UNDEFINED,
    embed: Union[hikari.embeds.Embed, hikari.undefined.UndefinedType] = UNDEFINED,
    embeds: Union[collections.abc.Sequence[hikari.embeds.Embed], hikari.undefined.UndefinedType] = UNDEFINED,
    mentions_everyone: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED,
    user_mentions: Union[Sequence[Union[hikari.users.PartialUser, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED,
    role_mentions: Union[Sequence[Union[hikari.guilds.PartialRole, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED,
    tts: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED,
    flags: Union[hikari.undefined.UndefinedType, int, hikari.messages.MessageFlag] = UNDEFINED
) -&gt; hikari.messages.Message</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_followup</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_followup</span><span class="p">(</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
                <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>
            <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Create a followup response for this context.</p>

<p><em>Warning:</em>
Calling this on a context which hasn't had an initial response yet
will lead to a <code>hikari.NotFoundError</code> being raised.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>content</strong> (hikari.UndefinedOr[typing.Any]):
If provided, the message contents. If
<code>hikari.UNDEFINED</code>, then nothing will be sent
in the content. Any other value here will be cast to a
<code>str</code>.</p>

<p>If this is a <code>hikari.Embed</code> and no <code>embed</code> kwarg is
provided, then this will instead update the embed. This allows for
simpler syntax when sending an embed alone.</p>

<p>Likewise, if this is a <code>hikari.Resource</code>, then the
content is instead treated as an attachment if no <code>attachment</code> and
no <code>attachments</code> kwargs are provided.</p></li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>delete_after</strong> (typing.Union[datetime.timedelta, float, int, None]):
If provided, the seconds after which the response message should be delete.</p>

<p><em>Note:</em>
As of writing, this does not support ephemeral slash command responses.</p></li>
<li><strong>attachment</strong> (hikari.UndefinedOr[hikari.Resourceish]):
If provided, the message attachment. This can be a resource,
or string of a path on your computer or a URL.</li>
<li><strong>attachments</strong> (hikari.UndefinedOr[collections.abc.Sequence[hikari.Resourceish]]):
If provided, the message attachments. These can be resources, or
strings consisting of paths on your computer or URLs.</li>
<li><strong>component</strong> (hikari.UndefinedOr[hikari.api.ComponentBuilder]):
If provided, builder object of the component to include in this message.</li>
<li><strong>components</strong> (hikari.UndefinedOr[collections.abc.Sequence[hikari.api.ComponentBuilder]]):
If provided, a sequence of the component builder objects to include
in this message.</li>
<li><strong>embed</strong> (hikari.UndefinedOr[hikari.Embed]):
If provided, the message embed.</li>
<li><strong>embeds</strong> (hikari.UndefinedOr[collections.abc.Sequence[hikari.Embed]]):
If provided, the message embeds.</li>
<li><strong>mentions_everyone</strong> (hikari.UndefinedOr[bool]):
If provided, whether the message should parse @everyone/@here
mentions.</li>
<li><p><strong>user_mentions</strong> (hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialUser], bool]]):
If provided, and <code>True</code>, all mentions will be parsed.
If provided, and <code>False</code>, no mentions will be parsed.</p>

<p>Alternatively this may be a collection of
<code>hikari.Snowflake</code>, or
<code>hikari.PartialUser</code> derivatives to enforce mentioning
specific users.</p></li>
<li><strong>role_mentions</strong> (hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialRole], bool]]):
If provided, and <code>True</code>, all mentions will be parsed.
If provided, and <code>False</code>, no mentions will be parsed.
Alternatively this may be a collection of
<code>hikari.Snowflake</code>, or
<code>hikari.PartialRole</code> derivatives to enforce mentioning
specific roles.</li>
<li><strong>tts</strong> (hikari.UndefinedOr[bool]):
If provided, whether the message will be sent as a TTS message.</li>
<li><p><strong>flags</strong> (typing.Union[hikari.UndefinedType, int, hikari.MessageFlag]):
The flags to set for this response.</p>

<p>As of writing this can only flag which can be provided is EPHEMERAL,
other flags are just ignored.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.Message</strong>: The created message object.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>hikari.NotFoundError</strong>: If the current interaction is not found or it hasn't had an initial
response yet.</li>
<li><strong>hikari.BadRequestError</strong>: This can be raised if the file is too large; if the embed exceeds
the defined limits; if the message content is specified only and
empty or greater than <code>2000</code> characters; if neither content, file
or embeds are specified.
If any invalid snowflake IDs are passed; a snowflake may be invalid
due to it being outside of the range of a 64 bit integer.</li>
<li><strong>ValueError</strong>: If more than 100 unique objects/entities are passed for
<code>role_mentions</code> or `user_mentions.</li>
</ul>

<p>If the interaction will have expired before <code>delete_after</code> is reached.</p>

<ul>
<li><strong>TypeError</strong>: If both <code>attachment</code> and <code>attachments</code> are specified.</li>
</ul>
</div>


                            </div>
                            <div id="SlashContext.create_initial_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashContext.create_initial_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">create_initial_response</span><span class="signature">(
    self,
    content: Union[Any, hikari.undefined.UndefinedType] = UNDEFINED,
    *,
    delete_after: Union[datetime.timedelta, float, int, NoneType] = None,
    component: Union[hikari.api.special_endpoints.ComponentBuilder, hikari.undefined.UndefinedType] = UNDEFINED,
    components: Union[collections.abc.Sequence[hikari.api.special_endpoints.ComponentBuilder], hikari.undefined.UndefinedType] = UNDEFINED,
    embed: Union[hikari.embeds.Embed, hikari.undefined.UndefinedType] = UNDEFINED,
    embeds: Union[collections.abc.Sequence[hikari.embeds.Embed], hikari.undefined.UndefinedType] = UNDEFINED,
    mentions_everyone: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED,
    user_mentions: Union[Sequence[Union[hikari.users.PartialUser, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED,
    role_mentions: Union[Sequence[Union[hikari.guilds.PartialRole, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED,
    flags: Union[int, hikari.messages.MessageFlag, hikari.undefined.UndefinedType] = UNDEFINED,
    tts: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageFlag</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedType</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">tts</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_initial_response</span><span class="p">(</span>
                <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">,</span>
                <span class="n">tts</span><span class="o">=</span><span class="n">tts</span><span class="p">,</span>
            <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Create the initial response for this context.</p>

<p><em>Warning:</em>
Calling this on a context which already has an initial
response will result in this raising a <code>hikari.NotFoundError</code>.
This includes if the REST interaction server has already responded
to the request and deferrals.</p>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>delete_after</strong> (typing.Union[datetime.timedelta, float, int, None]):
If provided, the seconds after which the response message should be delete.</p>

<p><em>Note:</em>
As of writing, this does not support ephemeral slash command responses.</p></li>
<li><p><strong>content</strong> (hikari.UndefinedOr[typing.Any]):
If provided, the message contents. If
<code>hikari.UNDEFINED</code>, then nothing will be sent
in the content. Any other value here will be cast to a
<code>str</code>.</p>

<p>If this is a <code>hikari.Embed</code> and no <code>embed</code> nor <code>embeds</code> kwarg
is provided, then this will instead update the embed. This allows
for simpler syntax when sending an embed alone.</p></li>
<li><strong>component</strong> (hikari.UndefinedOr[hikari.api.ComponentBuilder]):
If provided, builder object of the component to include in this message.</li>
<li><strong>components</strong> (hikari.UndefinedOr[collections.abc.Sequence[hikari.api.ComponentBuilder]]):
If provided, a sequence of the component builder objects to include
in this message.</li>
<li><strong>embed</strong> (hikari.UndefinedOr[hikari.Embed]):
If provided, the message embed.</li>
<li><strong>embeds</strong> (hikari.UndefinedOr[collections.abc.Sequence[hikari.Embed]]):
If provided, the message embeds.</li>
<li><p><strong>flags</strong> (typing.Union[int, hikari.MessageFlag, hikari.UndefinedType]):
If provided, the message flags this response should have.</p>

<p>As of writing the only message flag which can be set here is
<code>hikari.MessageFlag.EPHEMERAL</code>.</p></li>
<li><strong>tts</strong> (hikari.UndefinedOr[bool]):
If provided, whether the message will be read out by a screen
reader using Discord's TTS (text-to-speech) system.</li>
<li><strong>mentions_everyone</strong> (hikari.UndefinedOr[bool]):
If provided, whether the message should parse @everyone/@here
mentions.</li>
<li><p><strong>user_mentions</strong> (hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialUser], bool]]):
If provided, and <code>True</code>, all user mentions will be detected.
If provided, and <code>False</code>, all user mentions will be ignored
if appearing in the message body.</p>

<p>Alternatively this may be a collection of
<code>hikari.Snowflake</code>, or
<code>hikari.PartialUser</code> derivatives to enforce mentioning
specific users.</p></li>
<li><p><strong>role_mentions</strong> (hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialRole], bool]]):
If provided, and <code>True</code>, all role mentions will be detected.
If provided, and <code>False</code>, all role mentions will be ignored
if appearing in the message body.</p>

<p>Alternatively this may be a collection of
<code>hikari.Snowflake</code>, or
<code>hikari.PartialRole</code> derivatives to enforce mentioning
specific roles.</p></li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If more than 100 unique objects/entities are passed for
<code>role_mentions</code> or <code>user_mentions</code>.</li>
</ul>

<p>If the interaction will have expired before <code>delete_after</code> is reached.</p>

<ul>
<li><strong>TypeError</strong>: If both <code>embed</code> and <code>embeds</code> are specified.</li>
<li><strong>hikari.BadRequestError</strong>: This may be raised in several discrete situations, such as messages
being empty with no embeds; messages with more than
2000 characters in them, embeds that exceed one of the many embed
limits; invalid image URLs in embeds.</li>
<li><strong>hikari.UnauthorizedError</strong>: If you are unauthorized to make the request (invalid/missing token).</li>
<li><strong>hikari.NotFoundError</strong>: If the interaction is not found or if the interaction's initial
response has already been created.</li>
<li><strong>hikari.RateLimitTooLongError</strong>: Raised in the event that a rate limit occurs that is
longer than <code>max_rate_limit</code> when making a request.</li>
<li><strong>hikari.RateLimitedError</strong>: Usually, Hikari will handle and retry on hitting
rate-limits automatically. This includes most bucket-specific
rate-limits and global rate-limits. In some rare edge cases,
however, Discord implements other undocumented rules for
rate-limiting, such as limits per attribute. These cannot be
detected or handled normally by Hikari due to their undocumented
nature, and will trigger this exception if they occur.</li>
<li><strong>hikari.InternalServerError</strong>: If an internal error occurs on Discord while handling the request.</li>
</ul>
</div>


                            </div>
                            <div id="SlashContext.delete_initial_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashContext.delete_initial_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">delete_initial_response</span><span class="signature">(self) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_initial_response</span><span class="p">()</span>
        <span class="c1"># If they defer then delete the initial response then this should be treated as having</span>
        <span class="c1"># an initial response to allow for followup responses.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>

        </details>

            <div class="docstring"><p>Delete the initial response after invoking this context.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>LookupError, hikari.NotFoundError</strong>: The last context has no initial response.</li>
</ul>
</div>


                            </div>
                            <div id="SlashContext.delete_last_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashContext.delete_last_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">delete_last_response</span><span class="signature">(self) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">delete_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_initial_response</span><span class="p">()</span>
                <span class="c1"># If they defer then delete the initial response then this should be treated as having</span>
                <span class="c1"># an initial response to allow for followup responses.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">return</span>

            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no last response&quot;</span><span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">delete_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Delete the last response after invoking this context.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>LookupError, hikari.NotFoundError</strong>: The last context has no responses.</li>
</ul>
</div>


                            </div>
                            <div id="SlashContext.edit_initial_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashContext.edit_initial_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">edit_initial_response</span><span class="signature">(
    self,
    content: Union[Any, hikari.undefined.UndefinedType] = UNDEFINED,
    *,
    delete_after: Union[datetime.timedelta, float, int, NoneType] = None,
    attachment: &#39;hikari.UndefinedOr[hikari.Resourceish]&#39; = UNDEFINED,
    attachments: &#39;hikari.UndefinedOr[collections.Sequence[hikari.Resourceish]]&#39; = UNDEFINED,
    component: Union[hikari.api.special_endpoints.ComponentBuilder, hikari.undefined.UndefinedType, NoneType] = UNDEFINED,
    components: Union[collections.abc.Sequence[hikari.api.special_endpoints.ComponentBuilder], hikari.undefined.UndefinedType, NoneType] = UNDEFINED,
    embed: Union[hikari.embeds.Embed, hikari.undefined.UndefinedType, NoneType] = UNDEFINED,
    embeds: Union[collections.abc.Sequence[hikari.embeds.Embed], hikari.undefined.UndefinedType, NoneType] = UNDEFINED,
    replace_attachments: bool = False,
    mentions_everyone: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED,
    user_mentions: Union[Sequence[Union[hikari.users.PartialUser, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED,
    role_mentions: Union[Sequence[Union[hikari.guilds.PartialRole, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED
) -&gt; hikari.messages.Message</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_initial_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="n">delete_after</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
            <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
            <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
            <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
            <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
            <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
            <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
            <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_initial_response_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">result</span>
</pre></div>

        </details>

            <div class="docstring"><p>Edit the initial response for this context.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>content</strong> (hikari.UndefinedOr[typing.Any]):
The content to edit the initial response with.</p>

<p>If provided, the message contents. If
<code>hikari.UNDEFINED</code>, then nothing will be sent
in the content. Any other value here will be cast to a
<code>str</code>.</p>

<p>If this is a <code>hikari.Embed</code> and no <code>embed</code> nor <code>embeds</code> kwarg
is provided, then this will instead update the embed. This allows
for simpler syntax when sending an embed alone.</p>

<p>Likewise, if this is a <code>hikari.Resource</code>, then the
content is instead treated as an attachment if no <code>attachment</code> and
no <code>attachments</code> kwargs are provided.</p></li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>delete_after</strong> (typing.Union[datetime.timedelta, float, int, None]):
If provided, the seconds after which the response message should be delete.</p>

<p><em>Note:</em>
As of writing, this does not support ephemeral slash command responses.</p></li>
<li><strong>attachment</strong> (hikari.UndefinedOr[hikari.Resourceish]):
A singular attachment to edit the initial response with.</li>
<li><strong>attachments</strong> (hikari.UndefinedOr[collections.abc.Sequence[hikari.Resourceish]]):
A sequence of attachments to edit the initial response with.</li>
<li><strong>component</strong> (hikari.UndefinedNoneOr[hikari.api.ComponentBuilder]):
If provided, builder object of the component to set for this message.
This component will replace any previously set components and passing
<code>None</code> will remove all components.</li>
<li><strong>components</strong> (hikari.UndefinedNoneOr[collections.abc.Sequence[hikari.api.ComponentBuilder]]):
If provided, a sequence of the component builder objects set for
this message. These components will replace any previously set
components and passing <code>None</code> or an empty sequence will
remove all components.</li>
<li><strong>embed</strong> (hikari.UndefinedOr[hikari.Embed]):
An embed to replace the initial response with.</li>
<li><strong>embeds</strong> (hikari.UndefinedOr[collections.abc.Sequence[hikari.Embed]]):
A sequence of embeds to replace the initial response with.</li>
<li><strong>replace_attachments</strong> (bool):
Whether to replace the attachments of the response or not. Default to <code>False</code>.</li>
<li><strong>mentions_everyone</strong> (hikari.UndefinedOr[bool]):
If provided, whether the message should parse @everyone/@here
mentions.</li>
<li><strong>user_mentions</strong> (hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialUser], bool]]):
If provided, and <code>True</code>, all mentions will be parsed.
If provided, and <code>False</code>, no mentions will be parsed.
Alternatively this may be a collection of
<code>hikari.Snowflake</code>, or <code>hikari.PartialUser</code>
derivatives to enforce mentioning specific users.</li>
<li><strong>role_mentions</strong> (hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialRole], bool]]):
If provided, and <code>True</code>, all mentions will be parsed.
If provided, and <code>False</code>, no mentions will be parsed.
Alternatively this may be a collection of
<code>hikari.Snowflake</code>, or
<code>hikari.PartialRole</code> derivatives to enforce mentioning
specific roles.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>Attachments can be passed as many different things, to aid in
convenience.</p>

<ul>
<li>If a <code>pathlib.PurePath</code> or <code>str</code> to a valid URL, the
resource at the given URL will be streamed to Discord when
sending the message. Subclasses of
<code>hikari.WebResource</code> such as
<code>hikari.URL</code>,
<code>hikari.Attachment</code>,
<code>hikari.Emoji</code>,
<code>EmbedResource</code>, etc will also be uploaded this way.
This will use bit-inception, so only a small percentage of the
resource will remain in memory at any one time, thus aiding in
scalability.</li>
<li>If a <code>hikari.Bytes</code> is passed, or a <code>str</code>
that contains a valid data URI is passed, then this is uploaded
with a randomized file name if not provided.</li>
<li>If a <code>hikari.File</code>, <code>pathlib.PurePath</code> or
<code>str</code> that is an absolute or relative path to a file
on your file system is passed, then this resource is uploaded
as an attachment using non-blocking code internally and streamed
using bit-inception where possible. This depends on the
type of <code>concurrent.futures.Executor</code> that is being used for
the application (default is a thread pool which supports this
behaviour).</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.Message</strong>: The message that has been edited.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If more than 100 unique objects/entities are passed for
<code>role_mentions</code> or <code>user_mentions</code>.</li>
<li><strong>TypeError</strong>: If both <code>attachment</code> and <code>attachments</code> are specified.</li>
<li><strong>hikari.BadRequestError</strong>: This may be raised in several discrete situations, such as messages
being empty with no attachments or embeds; messages with more than
2000 characters in them, embeds that exceed one of the many embed
limits; too many attachments; attachments that are too large;
invalid image URLs in embeds; if <code>reply</code> is not found or not in the
same channel as <code>channel</code>; too many components.</li>
<li><strong>hikari.UnauthorizedError</strong>: If you are unauthorized to make the request (invalid/missing token).</li>
<li><strong>hikari.ForbiddenError</strong>: If you are missing the <code>SEND_MESSAGES</code> in the channel or the
person you are trying to message has the DM's disabled.</li>
<li><strong>hikari.NotFoundError</strong>: If the channel is not found.</li>
<li><strong>hikari.RateLimitTooLongError</strong>: Raised in the event that a rate limit occurs that is
longer than <code>max_rate_limit</code> when making a request.</li>
<li><strong>hikari.RateLimitedError</strong>: Usually, Hikari will handle and retry on hitting
rate-limits automatically. This includes most bucket-specific
rate-limits and global rate-limits. In some rare edge cases,
however, Discord implements other undocumented rules for
rate-limiting, such as limits per attribute. These cannot be
detected or handled normally by Hikari due to their undocumented
nature, and will trigger this exception if they occur.</li>
<li><strong>hikari.InternalServerError</strong>: If an internal error occurs on Discord while handling the request.</li>
</ul>
</div>


                            </div>
                            <div id="SlashContext.edit_last_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashContext.edit_last_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">edit_last_response</span><span class="signature">(
    self,
    content: Union[Any, hikari.undefined.UndefinedType] = UNDEFINED,
    *,
    delete_after: Union[datetime.timedelta, float, int, NoneType] = None,
    attachment: &#39;hikari.UndefinedOr[hikari.Resourceish]&#39; = UNDEFINED,
    attachments: &#39;hikari.UndefinedOr[collections.Sequence[hikari.Resourceish]]&#39; = UNDEFINED,
    component: Union[hikari.api.special_endpoints.ComponentBuilder, hikari.undefined.UndefinedType, NoneType] = UNDEFINED,
    components: Union[collections.abc.Sequence[hikari.api.special_endpoints.ComponentBuilder], hikari.undefined.UndefinedType, NoneType] = UNDEFINED,
    embed: Union[hikari.embeds.Embed, hikari.undefined.UndefinedType, NoneType] = UNDEFINED,
    embeds: Union[collections.abc.Sequence[hikari.embeds.Embed], hikari.undefined.UndefinedType, NoneType] = UNDEFINED,
    replace_attachments: bool = False,
    mentions_everyone: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED,
    user_mentions: Union[Sequence[Union[hikari.users.PartialUser, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED,
    role_mentions: Union[Sequence[Union[hikari.guilds.PartialRole, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED
) -&gt; hikari.messages.Message</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">edit_last_response</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attachment</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">attachments</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Resourceish</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedNoneOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">replace_attachments</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">:</span>
            <span class="n">delete_after</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_delete_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">)</span> <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">message</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">edit_message</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">delete_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delete_followup_after</span><span class="p">(</span><span class="n">delete_after</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">message</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
                <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">attachment</span><span class="o">=</span><span class="n">attachment</span><span class="p">,</span>
                <span class="n">attachments</span><span class="o">=</span><span class="n">attachments</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">replace_attachments</span><span class="o">=</span><span class="n">replace_attachments</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous responses&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Edit the last response for this context.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>content</strong> (hikari.UndefinedOr[typing.Any]):
The content to edit the last response with.</p>

<p>If provided, the message contents. If
<code>hikari.UNDEFINED</code>, then nothing will be sent
in the content. Any other value here will be cast to a
<code>str</code>.</p>

<p>If this is a <code>hikari.Embed</code> and no <code>embed</code> nor <code>embeds</code> kwarg
is provided, then this will instead update the embed. This allows
for simpler syntax when sending an embed alone.</p>

<p>Likewise, if this is a <code>hikari.Resource</code>, then the
content is instead treated as an attachment if no <code>attachment</code> and
no <code>attachments</code> kwargs are provided.</p></li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>delete_after</strong> (typing.Union[datetime.timedelta, float, int, None]):
If provided, the seconds after which the response message should be delete.</p>

<p><em>Note:</em>
As of writing, this does not support ephemeral slash command responses.</p></li>
<li><strong>attachment</strong> (hikari.UndefinedOr[hikari.Resourceish]):
A singular attachment to edit the last response with.</li>
<li><strong>attachments</strong> (hikari.UndefinedOr[collections.abc.Sequence[hikari.Resourceish]]):
A sequence of attachments to edit the last response with.</li>
<li><strong>component</strong> (hikari.UndefinedNoneOr[hikari.api.ComponentBuilder]):
If provided, builder object of the component to set for this message.
This component will replace any previously set components and passing
<code>None</code> will remove all components.</li>
<li><strong>components</strong> (hikari.UndefinedNoneOr[collections.abc.Sequence[hikari.api.ComponentBuilder]]):
If provided, a sequence of the component builder objects set for
this message. These components will replace any previously set
components and passing <code>None</code> or an empty sequence will
remove all components.</li>
<li><strong>embed</strong> (hikari.UndefinedOr[hikari.Embed]):
An embed to replace the last response with.</li>
<li><strong>embeds</strong> (hikari.UndefinedOr[collections.abc.Sequence[hikari.Embed]]):
A sequence of embeds to replace the last response with.</li>
<li><strong>replace_attachments</strong> (bool):
Whether to replace the attachments of the response or not. Default to <code>False</code>.</li>
<li><strong>mentions_everyone</strong> (hikari.UndefinedOr[bool]):
If provided, whether the message should parse @everyone/@here
mentions.</li>
<li><p><strong>user_mentions</strong> (hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialUser], bool]]):
If provided, and <code>True</code>, all mentions will be parsed.
If provided, and <code>False</code>, no mentions will be parsed.</p>

<p>Alternatively this may be a collection of
<code>hikari.Snowflake</code>, or <code>hikari.PartialUser</code>
derivatives to enforce mentioning specific users.</p></li>
<li><p><strong>role_mentions</strong> (hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialRole], bool]]):
If provided, and <code>True</code>, all mentions will be parsed.
If provided, and <code>False</code>, no mentions will be parsed.</p>

<p>Alternatively this may be a collection of
<code>hikari.Snowflake</code>, or
<code>hikari.PartialRole</code> derivatives to enforce mentioning
specific roles.</p></li>
</ul>

<h6 id="notes">Notes</h6>

<p>Attachments can be passed as many different things, to aid in
convenience.</p>

<ul>
<li>If a <code>pathlib.PurePath</code> or <code>str</code> to a valid URL, the
resource at the given URL will be streamed to Discord when
sending the message. Subclasses of
<code>hikari.WebResource</code> such as
<code>hikari.URL</code>,
<code>hikari.Attachment</code>,
<code>hikari.Emoji</code>,
<code>EmbedResource</code>, etc will also be uploaded this way.
This will use bit-inception, so only a small percentage of the
resource will remain in memory at any one time, thus aiding in
scalability.</li>
<li>If a <code>hikari.Bytes</code> is passed, or a <code>str</code>
that contains a valid data URI is passed, then this is uploaded
with a randomized file name if not provided.</li>
<li>If a <code>hikari.File</code>, <code>pathlib.PurePath</code> or
<code>str</code> that is an absolute or relative path to a file
on your file system is passed, then this resource is uploaded
as an attachment using non-blocking code internally and streamed
using bit-inception where possible. This depends on the
type of <code>concurrent.futures.Executor</code> that is being used for
the application (default is a thread pool which supports this
behaviour).</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.Message</strong>: The message that has been edited.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If more than 100 unique objects/entities are passed for
<code>role_mentions</code> or <code>user_mentions</code>.</li>
<li><strong>TypeError</strong>: If both <code>attachment</code> and <code>attachments</code> are specified.</li>
<li><strong>hikari.BadRequestError</strong>: This may be raised in several discrete situations, such as messages
being empty with no attachments or embeds; messages with more than
2000 characters in them, embeds that exceed one of the many embed
limits; too many attachments; attachments that are too large;
invalid image URLs in embeds; if <code>reply</code> is not found or not in the
same channel as <code>channel</code>; too many components.</li>
<li><strong>hikari.UnauthorizedError</strong>: If you are unauthorized to make the request (invalid/missing token).</li>
<li><strong>hikari.ForbiddenError</strong>: If you are missing the <code>SEND_MESSAGES</code> in the channel or the
person you are trying to message has the DM's disabled.</li>
<li><strong>hikari.NotFoundError</strong>: If the channel is not found.</li>
<li><strong>hikari.RateLimitTooLongError</strong>: Raised in the event that a rate limit occurs that is
longer than <code>max_rate_limit</code> when making a request.</li>
<li><strong>hikari.RateLimitedError</strong>: Usually, Hikari will handle and retry on hitting
rate-limits automatically. This includes most bucket-specific
rate-limits and global rate-limits. In some rare edge cases,
however, Discord implements other undocumented rules for
rate-limiting, such as limits per attribute. These cannot be
detected or handled normally by Hikari due to their undocumented
nature, and will trigger this exception if they occur.</li>
<li><strong>hikari.InternalServerError</strong>: If an internal error occurs on Discord while handling the request.</li>
</ul>
</div>


                            </div>
                            <div id="SlashContext.fetch_initial_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashContext.fetch_initial_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">fetch_initial_response</span><span class="signature">(self) -&gt; hikari.messages.Message</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_initial_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Fetch the initial response for this context.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>LookupError, hikari.NotFoundError</strong>: The response was not found.</li>
</ul>
</div>


                            </div>
                            <div id="SlashContext.fetch_last_response" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashContext.fetch_last_response">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">fetch_last_response</span><span class="signature">(self) -&gt; hikari.messages.Message</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_last_response</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_response_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>

        <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;Context has no previous known responses&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Fetch the last response for this context.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>LookupError, hikari.NotFoundError</strong>: The response was not found.</li>
</ul>
</div>


                            </div>
                            <div id="SlashContext.respond" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashContext.respond">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">respond</span><span class="signature">(
    self,
    content: Union[Any, hikari.undefined.UndefinedType] = UNDEFINED,
    *,
    ensure_result: bool = False,
    delete_after: Union[datetime.timedelta, float, int, NoneType] = None,
    component: Union[hikari.api.special_endpoints.ComponentBuilder, hikari.undefined.UndefinedType] = UNDEFINED,
    components: Union[collections.abc.Sequence[hikari.api.special_endpoints.ComponentBuilder], hikari.undefined.UndefinedType] = UNDEFINED,
    embed: Union[hikari.embeds.Embed, hikari.undefined.UndefinedType] = UNDEFINED,
    embeds: Union[collections.abc.Sequence[hikari.embeds.Embed], hikari.undefined.UndefinedType] = UNDEFINED,
    mentions_everyone: Union[bool, hikari.undefined.UndefinedType] = UNDEFINED,
    user_mentions: Union[Sequence[Union[hikari.users.PartialUser, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED,
    role_mentions: Union[Sequence[Union[hikari.guilds.PartialRole, hikari.snowflakes.Snowflake, int]], bool, hikari.undefined.UndefinedType] = UNDEFINED
) -&gt; Optional[hikari.messages.Message]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">respond</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ensure_result</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">delete_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">components</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">ComponentBuilder</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embed</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">embeds</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Embed</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">mentions_everyone</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">user_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialUser</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">role_mentions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span>
            <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialRole</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">]:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_responded</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_followup</span><span class="p">(</span>
                    <span class="n">content</span><span class="p">,</span>
                    <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                    <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                    <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                    <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                    <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                    <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                    <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                    <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_been_deferred</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">edit_initial_response</span><span class="p">(</span>
                    <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                    <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                    <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                    <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                    <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                    <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                    <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                    <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                    <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_initial_response</span><span class="p">(</span>
                <span class="n">delete_after</span><span class="o">=</span><span class="n">delete_after</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
                <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
                <span class="n">embed</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                <span class="n">embeds</span><span class="o">=</span><span class="n">embeds</span><span class="p">,</span>
                <span class="n">mentions_everyone</span><span class="o">=</span><span class="n">mentions_everyone</span><span class="p">,</span>
                <span class="n">user_mentions</span><span class="o">=</span><span class="n">user_mentions</span><span class="p">,</span>
                <span class="n">role_mentions</span><span class="o">=</span><span class="n">role_mentions</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">ensure_result</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">fetch_initial_response</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Respond to this context.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>content</strong> (hikari.UndefinedOr[typing.Any]):
The content to respond with.</p>

<p>If provided, the message contents. If
<code>hikari.UNDEFINED</code>, then nothing will be sent
in the content. Any other value here will be cast to a
<code>str</code>.</p>

<p>If this is a <code>hikari.Embed</code> and no <code>embed</code> nor <code>embeds</code> kwarg
is provided, then this will instead update the embed. This allows
for simpler syntax when sending an embed alone.</p>

<p>Likewise, if this is a <code>hikari.Resource</code>, then the
content is instead treated as an attachment if no <code>attachment</code> and
no <code>attachments</code> kwargs are provided.</p></li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>ensure_result</strong> (bool):
If provided and set to <code>True</code> then this will always return <code>hikari.Message</code>,
otherwise this will return <code>Optional[hikari.Message]</code>.</p>

<p>It's worth noting that, under certain scenarios within the slash
command flow, this may lead to an extre request being made.</p></li>
<li><p><strong>delete_after</strong> (typing.Union[datetime.timedelta, float, int, None]):
If provided, the seconds after which the response message should be delete.</p>

<p><em>Note:</em>
As of writing, this does not support ephemeral slash command responses.</p></li>
<li><strong>component</strong> (hikari.UndefinedOr[hikari.api.ComponentBuilder]):
If provided, builder object of the component to include in this response.</li>
<li><strong>components</strong> (hikari.UndefinedOr[collections.abc.Sequence[hikari.api.ComponentBuilder]]):
If provided, a sequence of the component builder objects to include
in this response.</li>
<li><strong>embed</strong> (hikari.UndefinedOr[hikari.Embed]):
An embed to respond with.</li>
<li><strong>embeds</strong> (hikari.UndefinedOr[collections.abc.Sequence[hikari.Embed]]):
A sequence of embeds to respond with.</li>
<li><strong>mentions_everyone</strong> (hikari.UndefinedOr[bool]):
If provided, whether the message should parse @everyone/@here
mentions.</li>
<li><p><strong>user_mentions</strong> (hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialUser], bool]]):
If provided, and <code>True</code>, all mentions will be parsed.
If provided, and <code>False</code>, no mentions will be parsed.</p>

<p>Alternatively this may be a collection of
<code>hikari.Snowflake</code>, or <code>hikari.PartialUser</code>
derivatives to enforce mentioning specific users.</p></li>
<li><p><strong>role_mentions</strong> (hikari.UndefinedOr[typing.Union[hikari.SnowflakeishSequence[hikari.PartialRole], bool]]):
If provided, and <code>True</code>, all mentions will be parsed.
If provided, and <code>False</code>, no mentions will be parsed.</p>

<p>Alternatively this may be a collection of
<code>hikari.Snowflake</code>, or
<code>hikari.PartialRole</code> derivatives to enforce mentioning
specific roles.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Optional[hikari.Message]</strong>: The message that has been created if it was immedieatly available or
<code>ensure_result</code> was set to <code>True</code>, else <code>None</code>.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If more than 100 unique objects/entities are passed for
<code>role_mentions</code> or <code>user_mentions</code>.</li>
<li><strong>TypeError</strong>: If both <code>attachment</code> and <code>attachments</code> are specified.</li>
<li><strong>hikari.BadRequestError</strong>: This may be raised in several discrete situations, such as messages
being empty with no attachments or embeds; messages with more than
2000 characters in them, embeds that exceed one of the many embed
limits; too many attachments; attachments that are too large;
invalid image URLs in embeds; if <code>reply</code> is not found or not in the
same channel as <code>channel</code>; too many components.</li>
<li><strong>hikari.UnauthorizedError</strong>: If you are unauthorized to make the request (invalid/missing token).</li>
<li><strong>hikari.ForbiddenError</strong>: If you are missing the <code>SEND_MESSAGES</code> in the channel or the
person you are trying to message has the DM's disabled.</li>
<li><strong>hikari.NotFoundError</strong>: If the channel is not found.</li>
<li><strong>hikari.RateLimitTooLongError</strong>: Raised in the event that a rate limit occurs that is
longer than <code>max_rate_limit</code> when making a request.</li>
<li><strong>hikari.RateLimitedError</strong>: Usually, Hikari will handle and retry on hitting
rate-limits automatically. This includes most bucket-specific
rate-limits and global rate-limits. In some rare edge cases,
however, Discord implements other undocumented rules for
rate-limiting, such as limits per attribute. These cannot be
detected or handled normally by Hikari due to their undocumented
nature, and will trigger this exception if they occur.</li>
<li><strong>hikari.InternalServerError</strong>: If an internal error occurs on Discord while handling the request.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="tanjun/context.html#BaseContext">tanjun.context.BaseContext</a></dt>
                                <dd id="SlashContext.cache" class="variable"><a href="tanjun/context.html#BaseContext.cache">cache</a></dd>
                <dd id="SlashContext.component" class="variable"><a href="tanjun/context.html#BaseContext.component">component</a></dd>
                <dd id="SlashContext.events" class="variable"><a href="tanjun/context.html#BaseContext.events">events</a></dd>
                <dd id="SlashContext.server" class="variable"><a href="tanjun/context.html#BaseContext.server">server</a></dd>
                <dd id="SlashContext.rest" class="variable"><a href="tanjun/context.html#BaseContext.rest">rest</a></dd>
                <dd id="SlashContext.shards" class="variable"><a href="tanjun/context.html#BaseContext.shards">shards</a></dd>
                <dd id="SlashContext.voice" class="variable"><a href="tanjun/context.html#BaseContext.voice">voice</a></dd>
                <dd id="SlashContext.finalise" class="function"><a href="tanjun/context.html#BaseContext.finalise">finalise</a></dd>
                <dd id="SlashContext.set_component" class="function"><a href="tanjun/context.html#BaseContext.set_component">set_component</a></dd>
                <dd id="SlashContext.get_channel" class="function"><a href="tanjun/context.html#BaseContext.get_channel">get_channel</a></dd>
                <dd id="SlashContext.get_guild" class="function"><a href="tanjun/context.html#BaseContext.get_guild">get_guild</a></dd>
                <dd id="SlashContext.fetch_channel" class="function"><a href="tanjun/context.html#BaseContext.fetch_channel">fetch_channel</a></dd>
                <dd id="SlashContext.fetch_guild" class="function"><a href="tanjun/context.html#BaseContext.fetch_guild">fetch_guild</a></dd>

            </div>
            <div><dt><a href="tanjun/injecting.html#BasicInjectionContext">tanjun.injecting.BasicInjectionContext</a></dt>
                                <dd id="SlashContext.injection_client" class="variable"><a href="tanjun/injecting.html#BasicInjectionContext.injection_client">injection_client</a></dd>
                <dd id="SlashContext.cache_result" class="function"><a href="tanjun/injecting.html#BasicInjectionContext.cache_result">cache_result</a></dd>
                <dd id="SlashContext.get_cached_result" class="function"><a href="tanjun/injecting.html#BasicInjectionContext.get_cached_result">get_cached_result</a></dd>
                <dd id="SlashContext.get_type_special_case" class="function"><a href="tanjun/injecting.html#BasicInjectionContext.get_type_special_case">get_type_special_case</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="SlashOption">
                                <div class="attr class">
        <a class="headerlink" href="#SlashOption">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">SlashOption</span><wbr>(<span class="base"><a href="tanjun/abc.html#SlashOption">tanjun.abc.SlashOption</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">SlashOption</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashOption</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_interaction&quot;</span><span class="p">,</span> <span class="s2">&quot;_option&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="n">option</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteractionOption</span><span class="p">,</span> <span class="o">/</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot build a slash option with a value-less API representation&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span> <span class="o">=</span> <span class="n">interaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_option</span> <span class="o">=</span> <span class="n">option</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="c1"># This is asserted in __init__</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">value</span>

    <span class="k">def</span> <span class="nf">resolve_value</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionChannel</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">CHANNEL</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_channel</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">ROLE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_role</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_user</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_mentionable</span><span class="p">()</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> isn&#39;t resolvable&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">resolve_to_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionChannel</span><span class="p">:</span>
        <span class="c1"># What does self.value being None mean?</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">CHANNEL</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)]</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot resolve non-channel option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> to a user&quot;</span><span class="p">)</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">resolve_to_member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">resolve_to_member</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">_T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">,</span> <span class="n">_T</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">resolve_to_member</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">_T</span> <span class="o">=</span> <span class="o">...</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">,</span> <span class="n">_T</span><span class="p">]:</span>
        <span class="c1"># What does self.value being None mean?</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">if</span> <span class="n">member</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)):</span>
                <span class="k">return</span> <span class="n">member</span>

            <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="o">...</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">default</span>

            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;User isn&#39;t in the current guild&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">:</span>
            <span class="n">target_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">if</span> <span class="n">member</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target_id</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">member</span>

            <span class="k">if</span> <span class="n">target_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="o">...</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">default</span>

                <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;User isn&#39;t in the current guild&quot;</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot resolve non-user option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> to a member&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">resolve_to_mentionable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Member</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">:</span>
            <span class="n">target_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">if</span> <span class="n">role</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target_id</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">role</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">target_id</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_user</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">ROLE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_role</span><span class="p">()</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot resolve non-mentionable option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> to a mentionable entity.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">resolve_to_role</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">ROLE</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">roles</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">if</span> <span class="n">role</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)):</span>
                <span class="k">return</span> <span class="n">role</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot resolve non-role option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> to a role&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">resolve_to_user</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Member</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="n">user_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">user_id</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="n">user_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="n">user_id</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="n">result</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot resolve non-user option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> to a user&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Interface of slash command option with extra logic to help resolve it.</p>
</div>


                            <div id="SlashOption.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashOption.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">SlashOption</span><span class="signature">(
    interaction: hikari.interactions.command_interactions.CommandInteraction,
    option: hikari.interactions.command_interactions.CommandInteractionOption,
    /
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="n">option</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteractionOption</span><span class="p">,</span> <span class="o">/</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot build a slash option with a value-less API representation&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span> <span class="o">=</span> <span class="n">interaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_option</span> <span class="o">=</span> <span class="n">option</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="SlashOption.name" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashOption.name">#&nbsp;&nbsp</a>

        <span class="name">name</span><span class="annotation">: str</span>
    </div>

            <div class="docstring"><p>Name of this option.</p>
</div>


                            </div>
                            <div id="SlashOption.type" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashOption.type">#&nbsp;&nbsp</a>

        <span class="name">type</span><span class="annotation">: Union[hikari.commands.OptionType, int]</span>
    </div>

            <div class="docstring"><p>Type of this option.</p>
</div>


                            </div>
                            <div id="SlashOption.value" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#SlashOption.value">#&nbsp;&nbsp</a>

        <span class="name">value</span><span class="annotation">: Union[str, int, bool, float]</span>
    </div>

            <div class="docstring"><p>Value provided for this option.</p>

<p><em>Note:</em>
For discord entity option types (e.g. user, member, channel and
role) this will be the entity's ID.</p>
</div>


                            </div>
                            <div id="SlashOption.resolve_value" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashOption.resolve_value">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">resolve_value</span><span class="signature">(
    self
) -&gt; Union[hikari.interactions.command_interactions.InteractionChannel, hikari.interactions.base_interactions.InteractionMember, hikari.guilds.Role, hikari.users.User]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">resolve_value</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionChannel</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">CHANNEL</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_channel</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">ROLE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_role</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_user</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_mentionable</span><span class="p">()</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> isn&#39;t resolvable&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Resolve this option to an object value.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Union[hikari.InteractionChannel, hikari.InteractionMember, hikari.Role, hikari.User]</strong>: The object value of this option.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>TypeError</strong>: If the option isn't resolvable.</li>
</ul>
</div>


                            </div>
                            <div id="SlashOption.resolve_to_channel" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashOption.resolve_to_channel">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">resolve_to_channel</span><span class="signature">(self) -&gt; hikari.interactions.command_interactions.InteractionChannel</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">resolve_to_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionChannel</span><span class="p">:</span>
        <span class="c1"># What does self.value being None mean?</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">CHANNEL</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)]</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot resolve non-channel option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> to a user&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Resolve this option to a channel object.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.InteractionChannel</strong>: The channel object.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>TypeError</strong>: If the option is not a channel and a <code>default</code> wasn't provided.</li>
</ul>
</div>


                            </div>
                            <div id="SlashOption.resolve_to_member" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashOption.resolve_to_member">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">resolve_to_member</span><span class="signature">(
    self,
    *,
    default: ~_T = Ellipsis
) -&gt; Union[hikari.interactions.base_interactions.InteractionMember, ~_T]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">resolve_to_member</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">_T</span> <span class="o">=</span> <span class="o">...</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionMember</span><span class="p">,</span> <span class="n">_T</span><span class="p">]:</span>
        <span class="c1"># What does self.value being None mean?</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">if</span> <span class="n">member</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)):</span>
                <span class="k">return</span> <span class="n">member</span>

            <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="o">...</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">default</span>

            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;User isn&#39;t in the current guild&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">:</span>
            <span class="n">target_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">if</span> <span class="n">member</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target_id</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">member</span>

            <span class="k">if</span> <span class="n">target_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="o">...</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">default</span>

                <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="s2">&quot;User isn&#39;t in the current guild&quot;</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot resolve non-user option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> to a member&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Resolve this option to a member object.</p>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>default:</strong>: The default value to return if this option cannot be resolved.</li>
</ul>

<p>If this is not provided, this method will raise a <code>TypeError</code> if
this option cannot be resolved.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Union[hikari.InteractionMember, _T]</strong>: The member object or <code>default</code> if it was provided and this option
was a user type but had no member.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>LookupError</strong>: If no member was found for this option and a <code>default</code> wasn't provided.</li>
</ul>

<p>This includes if the option is a mentionable type which targets a
member-less user.</p>

<p>This could happen if the user isn't in the current guild or if this
command was executed in a DM and this option should still be resolvable
to a user.</p>

<ul>
<li><strong>TypeError</strong>: If the option is not a user option and a <code>default</code> wasn't provided.</li>
</ul>

<p>This includes if the option is a mentionable type but doesn't
target a user.</p>
</div>


                            </div>
                            <div id="SlashOption.resolve_to_mentionable" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashOption.resolve_to_mentionable">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">resolve_to_mentionable</span><span class="signature">(
    self
) -&gt; Union[hikari.guilds.Role, hikari.users.User, hikari.guilds.Member]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">resolve_to_mentionable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Member</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">:</span>
            <span class="n">target_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">if</span> <span class="n">role</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target_id</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">role</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">target_id</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_user</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">ROLE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_to_role</span><span class="p">()</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot resolve non-mentionable option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> to a mentionable entity.&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Resolve this option to a mentionable object.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Union[hikari.Role, hikari.User, hikari.Member]</strong>: The mentionable object.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>TypeError</strong>: If the option is not a mentionable, user or role type.</li>
</ul>
</div>


                            </div>
                            <div id="SlashOption.resolve_to_role" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashOption.resolve_to_role">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">resolve_to_role</span><span class="signature">(self) -&gt; hikari.guilds.Role</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">resolve_to_role</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">ROLE</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">roles</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="k">if</span> <span class="n">role</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)):</span>
                <span class="k">return</span> <span class="n">role</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot resolve non-role option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> to a role&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Resolve this option to a role object.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.Role</strong>: The role object.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>TypeError</strong>: If the option is not a role.</li>
</ul>

<p>This includes mentionable options which point towards a user.</p>
</div>


                            </div>
                            <div id="SlashOption.resolve_to_user" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SlashOption.resolve_to_user">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">resolve_to_user</span><span class="signature">(self) -&gt; Union[hikari.users.User, hikari.guilds.Member]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">resolve_to_user</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Member</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">USER</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="n">user_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">user_id</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OptionType</span><span class="o">.</span><span class="n">MENTIONABLE</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span>
            <span class="n">user_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction</span><span class="o">.</span><span class="n">resolved</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="n">user_id</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="n">result</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot resolve non-user option type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_option</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> to a user&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Resolve this option to a user object.</p>

<p><em>Note:</em>
This will resolve to a <code>hikari.Member</code> first if the relevant
command was executed within a guild and the option targeted one of
the guild's members, otherwise it will resolve to <code>hikari.User</code>.</p>

<p>It's also worth noting that hikari.Member inherits from hikari.User
meaning that the return value of this can always be treated as a
user.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Union[hikari.User, hikari.Member]</strong>: The user object.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>TypeError</strong>: If the option is not a user.</li>
</ul>

<p>This includes mentionable options which point towards a role.</p>
</div>


                            </div>
                </section>
                <section id="conversion">
                                <div class="attr module"><a class="headerlink" href="#conversion">#&nbsp;&nbsp</a>
<span class="name"><a href="tanjun/conversion.html">tanjun.conversion</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;Functions and classes used to enable more Discord oriented argument converters.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;ArgumentT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;from_datetime&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parse_snowflake&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parse_channel_id&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parse_emoji_id&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parse_role_id&quot;</span><span class="p">,</span>
    <span class="s2">&quot;parse_user_id&quot;</span><span class="p">,</span>
    <span class="s2">&quot;search_snowflakes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;search_channel_ids&quot;</span><span class="p">,</span>
    <span class="s2">&quot;search_emoji_ids&quot;</span><span class="p">,</span>
    <span class="s2">&quot;search_role_ids&quot;</span><span class="p">,</span>
    <span class="s2">&quot;search_user_ids&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_bool&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_channel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_color&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_colour&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_datetime&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_emoji&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_guild&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_invite&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_invite_with_metadata&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_member&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_presence&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_role&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_snowflake&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_user&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_voice_state&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">import</span> <span class="nn">urllib.parse</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">collections</span>

<span class="kn">import</span> <span class="nn">hikari</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">tanjun_abc</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">errors</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">injecting</span>

<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">parsing</span>

<span class="n">ArgumentT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
<span class="n">_ValueT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_ValueT&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">BaseConverter</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">_ValueT</span><span class="p">],</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for the standard converters.</span>

<span class="sd">    This is detail of the standard implementation and isn&#39;t guaranteed to work</span>
<span class="sd">    between implementations but will work for implementations which provide</span>
<span class="sd">    the standard dependency injection or special cased support for these.</span>

<span class="sd">    While it isn&#39;t necessary to subclass this to implement your own converters</span>
<span class="sd">    since dependency injection can be used to access fields like the current Context,</span>
<span class="sd">    this class introduces some niceties around stuff like state warnings.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">)</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ValueT</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">cache_components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Cache component(s) the converter takes advantage of.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Unless `BaseConverter.requires_cache` is `True`, these cache components</span>
<span class="sd">            aren&#39;t necessary but simply avoid the converter from falling back to</span>
<span class="sd">            REST requests.</span>

<span class="sd">        This will be `hikari.CacheComponents.NONE` if the converter doesn&#39;t</span>
<span class="sd">        make cache calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">intents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Gateway intents this converter takes advantage of.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This field is supplementary to `BaseConverter.cache_components` and</span>
<span class="sd">            is used to detect when the relevant component might not actually be</span>
<span class="sd">            being kept up to date or filled by gateway events.</span>

<span class="sd">            Unless `BaseConverter.requires_cache` is `True`, these intents being</span>
<span class="sd">            disabled won&#39;t stop this converter from working as it&#39;ll still fall</span>
<span class="sd">            back to REST requests.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">requires_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether this converter relies on the relevant cache stores to work.</span>

<span class="sd">        If this is `True` then this converter will not function properly</span>
<span class="sd">        in an environment `BaseConverter.intents` or `BaseConverter.cache_components`</span>
<span class="sd">        isn&#39;t satisfied and will never fallback to REST requests.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ValueT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Convert an argument.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ArgumentT</span>
<span class="sd">            The argument to convert.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        _ValueT</span>
<span class="sd">            The resultant value.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the argument couldn&#39;t be converted.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">check_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="n">parent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Check that this converter will work with the given client.</span>

<span class="sd">        This never raises any errors but simply warns the user if the converter</span>
<span class="sd">        is not compatible with the given client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        client : tanjun.abc.Client</span>
<span class="sd">            The client to check against.</span>
<span class="sd">        parent_name : str</span>
<span class="sd">            The name of the converter&#39;s parent, used for warning messages.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">client</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">requires_cache</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Converter </span><span class="si">{</span><span class="bp">self</span><span class="si">!r}</span><span class="s2"> registered with </span><span class="si">{</span><span class="n">parent_name</span><span class="si">}</span><span class="s2"> will always fail with a stateless client.&quot;</span><span class="p">,</span>
                    <span class="n">category</span><span class="o">=</span><span class="n">errors</span><span class="o">.</span><span class="n">StateWarning</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_components</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Converter </span><span class="si">{</span><span class="bp">self</span><span class="si">!r}</span><span class="s2"> registered with </span><span class="si">{</span><span class="n">parent_name</span><span class="si">}</span><span class="s2"> may not perform optimally in a stateless client.&quot;</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="c1"># elif missing_components := (self.cache_components &amp; ~client.cache.components):</span>
        <span class="c1">#     warnings.warn(</span>

        <span class="k">if</span> <span class="n">client</span><span class="o">.</span><span class="n">shards</span> <span class="ow">and</span> <span class="p">(</span><span class="n">missing_intents</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">intents</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">client</span><span class="o">.</span><span class="n">shards</span><span class="o">.</span><span class="n">intents</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Converter </span><span class="si">{</span><span class="bp">self</span><span class="si">!r}</span><span class="s2"> registered with </span><span class="si">{</span><span class="n">parent_name</span><span class="si">}</span><span class="s2"> may not perform as expected &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;without the following intents: </span><span class="si">{</span><span class="n">missing_intents</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">category</span><span class="o">=</span><span class="n">errors</span><span class="o">.</span><span class="n">StateWarning</span><span class="p">,</span>
            <span class="p">)</span>


<span class="k">class</span> <span class="nc">InjectableConverter</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="n">_ValueT</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;A specialised injectable callback which accounts for special casing `BaseConverter`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    converter : typing.Union[tanjun.injecting.CallbackSig[_ValueT], BaseConverter[_ValueT]]</span>
<span class="sd">        The converter callback to use.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_is_base_converter&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackSig</span><span class="p">[</span><span class="n">_ValueT</span><span class="p">],</span> <span class="n">BaseConverter</span><span class="p">[</span><span class="n">_ValueT</span><span class="p">]],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_base_converter</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">BaseConverter</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ValueT</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_base_converter</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">,</span> <span class="n">BaseConverter</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">_ValueT</span><span class="p">,</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ctx</span><span class="p">))</span>

        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ChannelConverter</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialChannel</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Standard converter for channels mentions/IDs.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache_components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="o">.</span><span class="n">GUILD_CHANNELS</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">intents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="o">.</span><span class="n">GUILDS</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">requires_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">PartialChannel</span><span class="p">:</span>
        <span class="n">channel_id</span> <span class="o">=</span> <span class="n">parse_channel_id</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No valid channel mention or ID  found&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span> <span class="ow">and</span> <span class="p">(</span><span class="n">channel</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_guild_channel</span><span class="p">(</span><span class="n">channel_id</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">channel</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_channel</span><span class="p">(</span><span class="n">channel_id</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t find channel&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>


<span class="k">class</span> <span class="nc">EmojiConverter</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">KnownCustomEmoji</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Standard converter for custom emojis.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache_components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="o">.</span><span class="n">EMOJIS</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">intents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="o">.</span><span class="n">GUILD_EMOJIS</span> <span class="o">|</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="o">.</span><span class="n">GUILDS</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">requires_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">KnownCustomEmoji</span><span class="p">:</span>
        <span class="n">emoji_id</span> <span class="o">=</span> <span class="n">parse_emoji_id</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No valid emoji or emoji ID found&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span> <span class="ow">and</span> <span class="p">(</span><span class="n">emoji</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_emoji</span><span class="p">(</span><span class="n">emoji_id</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">emoji</span>

        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_emoji</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span><span class="p">,</span> <span class="n">emoji_id</span><span class="p">)</span>

            <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t find emoji&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">GuildConverter</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Guild</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Stanard converter for guilds.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache_components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="o">.</span><span class="n">GUILDS</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">intents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="o">.</span><span class="n">GUILDS</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">requires_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Guild</span><span class="p">:</span>
        <span class="n">guild_id</span> <span class="o">=</span> <span class="n">parse_snowflake</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No valid guild ID found&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">guild</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_guild</span><span class="p">(</span><span class="n">guild_id</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">guild</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_guild</span><span class="p">(</span><span class="n">guild_id</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t find guild&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">InviteConverter</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Invite</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Standard converter for invites.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache_components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="o">.</span><span class="n">INVITES</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">intents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="o">.</span><span class="n">GUILD_INVITES</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">requires_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Invite</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">argument</span><span class="si">}</span><span class="s2">` is not a valid invite code&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">invite</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_invite</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">invite</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_invite</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t find invite&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">InviteWithMetadataConverter</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">InviteWithMetadata</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Standard converter for invites with metadata.</span>

<span class="sd">    .. note::</span>
<span class="sd">        Unlike `InviteConverter`, this converter is cache dependent.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache_components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="o">.</span><span class="n">INVITES</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">intents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="o">.</span><span class="n">GUILD_INVITES</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">requires_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InviteWithMetadata</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">argument</span><span class="si">}</span><span class="s2">` is not a valid invite code&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">invite</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_invite</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">invite</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t find invite&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MemberConverter</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Member</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Standard converter for guild members.</span>

<span class="sd">    This converter allows both mentions, raw IDs and partial usernames/nicknames</span>
<span class="sd">    and only works within a guild context.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache_components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="o">.</span><span class="n">MEMBERS</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">intents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="o">.</span><span class="n">GUILD_MEMBERS</span> <span class="o">|</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="o">.</span><span class="n">GUILDS</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">requires_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Member</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot get a member from a DM channel&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">member_id</span> <span class="o">=</span> <span class="n">parse_user_id</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No valid user mention or ID found&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">(</span><span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">search_members</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span><span class="p">,</span> <span class="n">argument</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

                <span class="k">except</span> <span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
                    <span class="k">pass</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">member</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_member</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span><span class="p">,</span> <span class="n">member_id</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">member</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_member</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span><span class="p">,</span> <span class="n">member_id</span><span class="p">)</span>

            <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t find member in this guild&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">PresenceConverter</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">MemberPresence</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Standard converter for presences.</span>

<span class="sd">    This converter is cache dependent and only works in a guild context.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache_components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="o">.</span><span class="n">PRESENCES</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">intents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="o">.</span><span class="n">GUILD_PRESENCES</span> <span class="o">|</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="o">.</span><span class="n">GUILDS</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">requires_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MemberPresence</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot get a presence from a DM channel&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
            <span class="n">user_id</span> <span class="o">=</span> <span class="n">parse_user_id</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No valid member mention or ID  found&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">user</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_presence</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">user</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t find presence in current guild&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">RoleConverter</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Standard converter for guild roles.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache_components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="o">.</span><span class="n">ROLES</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">intents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="o">.</span><span class="n">GUILDS</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">requires_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">:</span>
        <span class="n">role_id</span> <span class="o">=</span> <span class="n">parse_role_id</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No valid role mention or ID  found&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">role</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_role</span><span class="p">(</span><span class="n">role_id</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">role</span>

        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_roles</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">role</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">role_id</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">role</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t find role&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">UserConverter</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Standard converter for users.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache_components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="o">.</span><span class="n">NONE</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">intents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="o">.</span><span class="n">GUILDS</span> <span class="o">|</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="o">.</span><span class="n">GUILD_MEMBERS</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">requires_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">:</span>
        <span class="c1"># TODO: search by name if this is a guild context</span>
        <span class="n">user_id</span> <span class="o">=</span> <span class="n">parse_user_id</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No valid user mention or ID  found&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">user</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">user</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">NotFoundError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t find user&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">VoiceStateConverter</span><span class="p">(</span><span class="n">BaseConverter</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">VoiceState</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Standard converter for voice states.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This converter is cache dependent and only works in a guild context.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache_components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CacheComponents</span><span class="o">.</span><span class="n">VOICE_STATES</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">intents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="o">.</span><span class="n">GUILD_VOICE_STATES</span> <span class="o">|</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Intents</span><span class="o">.</span><span class="n">GUILDS</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">requires_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">VoiceState</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot get a voice state from a DM channel&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
            <span class="n">user_id</span> <span class="o">=</span> <span class="n">parse_user_id</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No valid user mention or ID  found&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">user</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_voice_state</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">guild_id</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">user</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Voice state couldn&#39;t be found for current guild&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_IDMatcher</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Protocol</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;No valid mention or ID found&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>


<span class="k">def</span> <span class="nf">_make_snowflake_parser</span><span class="p">(</span><span class="n">regex</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">Pattern</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_IDMatcher</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;No valid mention or ID found&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Parse a snowflake from a string or int value.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This only allows the relevant entity&#39;s mention format if applicable.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value: typing.Union[str, int]</span>
<span class="sd">            The value to parse (this argument can only be passed positionally).</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        message: str</span>
<span class="sd">            The error message to raise if the value cannot be parsed.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.Snowflake</span>
<span class="sd">            The parsed snowflake.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the value cannot be parsed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">capture</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">regex</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">capture</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">capture</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                <span class="k">pass</span>

        <span class="c1"># We should also range check the provided ID.</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">_range_check</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>

    <span class="k">return</span> <span class="n">parse</span>


<span class="n">_IDSearcher</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ArgumentT</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]]</span>


<span class="k">def</span> <span class="nf">_range_check</span><span class="p">(</span><span class="n">snowflake</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">snowflake</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">snowflake</span> <span class="o">&lt;=</span> <span class="n">snowflake</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">_make_snowflake_searcher</span><span class="p">(</span><span class="n">regex</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">Pattern</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_IDSearcher</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Iterate over the snowflakes in a string.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This only allows the relevant entity&#39;s mention format if applicable.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value: typing.Union[str, int]</span>
<span class="sd">            The value to parse (this argument can only be passed positionally).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Iterator[hikari.Snowflake]</span>
<span class="sd">            An iterator over the IDs found in the string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">and</span> <span class="n">_range_check</span><span class="p">(</span><span class="n">result</span> <span class="o">:=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">value</span><span class="p">)):</span>
                <span class="k">yield</span> <span class="n">result</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield from</span> <span class="nb">filter</span><span class="p">(</span>
                    <span class="n">_range_check</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">regex</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">value</span><span class="p">)))</span>
                <span class="p">)</span>

                <span class="k">yield from</span> <span class="nb">filter</span><span class="p">(</span><span class="n">_range_check</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="nb">filter</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">isdigit</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">())))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                <span class="k">pass</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">_range_check</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
                    <span class="k">yield</span> <span class="n">result</span>

    <span class="k">return</span> <span class="n">parse</span>


<span class="n">_SNOWFLAKE_REGEX</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&lt;[@&amp;?!#a]{0,3}(?::\w+:)?(\d+)&gt;&quot;</span><span class="p">)</span>
<span class="n">parse_snowflake</span><span class="p">:</span> <span class="n">_IDMatcher</span> <span class="o">=</span> <span class="n">_make_snowflake_parser</span><span class="p">(</span><span class="n">_SNOWFLAKE_REGEX</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Parse a snowflake from a string or int value.</span>

<span class="sd">Parameters</span>
<span class="sd">----------</span>
<span class="sd">value: typing.Union[str, int]</span>
<span class="sd">    The value to parse (this argument can only be passed positionally).</span>

<span class="sd">Other Parameters</span>
<span class="sd">----------------</span>
<span class="sd">message: str</span>
<span class="sd">    The error message to raise if the value cannot be parsed.</span>

<span class="sd">Returns</span>
<span class="sd">-------</span>
<span class="sd">hikari.Snowflake</span>
<span class="sd">    The parsed snowflake.</span>

<span class="sd">Raises</span>
<span class="sd">------</span>
<span class="sd">ValueError</span>
<span class="sd">    If the value cannot be parsed.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">search_snowflakes</span> <span class="o">=</span> <span class="n">_make_snowflake_searcher</span><span class="p">(</span><span class="n">_SNOWFLAKE_REGEX</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Iterate over the snowflakes in a string.</span>

<span class="sd">Parameters</span>
<span class="sd">----------</span>
<span class="sd">value: typing.Union[str, int]</span>
<span class="sd">    The value to parse (this argument can only be passed positionally).</span>

<span class="sd">Returns</span>
<span class="sd">-------</span>
<span class="sd">collections.abc.Iterator[hikari.Snowflake]</span>
<span class="sd">    An iterator over the snowflakes in the string.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">_CHANNEL_ID_REGEX</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&lt;#(\d+)&gt;&quot;</span><span class="p">)</span>
<span class="n">parse_channel_id</span><span class="p">:</span> <span class="n">_IDMatcher</span> <span class="o">=</span> <span class="n">_make_snowflake_parser</span><span class="p">(</span><span class="n">_CHANNEL_ID_REGEX</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Parse a channel ID from a string or int value.</span>

<span class="sd">Parameters</span>
<span class="sd">----------</span>
<span class="sd">value: typing.Union[str, int]</span>
<span class="sd">    The value to parse (this argument can only be passed positionally).</span>

<span class="sd">Other Parameters</span>
<span class="sd">----------------</span>
<span class="sd">message: str</span>
<span class="sd">    The error message to raise if the value cannot be parsed.</span>

<span class="sd">Returns</span>
<span class="sd">-------</span>
<span class="sd">hikari.Snowflake</span>
<span class="sd">    The parsed channel ID.</span>

<span class="sd">Raises</span>
<span class="sd">------</span>
<span class="sd">ValueError</span>
<span class="sd">    If the value cannot be parsed.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">search_channel_ids</span> <span class="o">=</span> <span class="n">_make_snowflake_searcher</span><span class="p">(</span><span class="n">_CHANNEL_ID_REGEX</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Iterate over the channel IDs in a string.</span>

<span class="sd">Parameters</span>
<span class="sd">----------</span>
<span class="sd">value: typing.Union[str, int]</span>
<span class="sd">    The value to parse (this argument can only be passed positionally).</span>

<span class="sd">Returns</span>
<span class="sd">-------</span>
<span class="sd">collections.abc.Iterator[hikari.Snowflake]</span>
<span class="sd">    An iterator over the channel IDs in the string.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">_EMOJI_ID_REGEX</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&lt;a?:\w+:(\d+)&gt;&quot;</span><span class="p">)</span>
<span class="n">parse_emoji_id</span><span class="p">:</span> <span class="n">_IDMatcher</span> <span class="o">=</span> <span class="n">_make_snowflake_parser</span><span class="p">(</span><span class="n">_EMOJI_ID_REGEX</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Parse an Emoji ID from a string or int value.</span>

<span class="sd">Parameters</span>
<span class="sd">----------</span>
<span class="sd">value: typing.Union[str, int]</span>
<span class="sd">    The value to parse (this argument can only be passed positionally).</span>

<span class="sd">Other Parameters</span>
<span class="sd">----------------</span>
<span class="sd">message: str</span>
<span class="sd">    The error message to raise if the value cannot be parsed.</span>

<span class="sd">Returns</span>
<span class="sd">-------</span>
<span class="sd">hikari.Snowflake</span>
<span class="sd">    The parsed Emoji ID.</span>

<span class="sd">Raises</span>
<span class="sd">------</span>
<span class="sd">ValueError</span>
<span class="sd">    If the value cannot be parsed.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">search_emoji_ids</span> <span class="o">=</span> <span class="n">_make_snowflake_searcher</span><span class="p">(</span><span class="n">_EMOJI_ID_REGEX</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Iterate over the emoji IDs in a string.</span>

<span class="sd">Parameters</span>
<span class="sd">----------</span>
<span class="sd">value: typing.Union[str, int]</span>
<span class="sd">    The value to parse (this argument can only be passed positionally).</span>

<span class="sd">Returns</span>
<span class="sd">-------</span>
<span class="sd">collections.abc.Iterator[hikari.Snowflake]</span>
<span class="sd">    An iterator over the emoji IDs in the string.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">_ROLE_ID_REGEX</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&lt;@&amp;(\d+)&gt;&quot;</span><span class="p">)</span>
<span class="n">parse_role_id</span><span class="p">:</span> <span class="n">_IDMatcher</span> <span class="o">=</span> <span class="n">_make_snowflake_parser</span><span class="p">(</span><span class="n">_ROLE_ID_REGEX</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Parse a role ID from a string or int value.</span>

<span class="sd">Parameters</span>
<span class="sd">----------</span>
<span class="sd">value: typing.Union[str, int]</span>
<span class="sd">    The value to parse (this argument can only be passed positionally).</span>

<span class="sd">Other Parameters</span>
<span class="sd">----------------</span>
<span class="sd">message: str</span>
<span class="sd">    The error message to raise if the value cannot be parsed.</span>

<span class="sd">Returns</span>
<span class="sd">-------</span>
<span class="sd">hikari.Snowflake</span>
<span class="sd">    The parsed role ID.</span>

<span class="sd">Raises</span>
<span class="sd">------</span>
<span class="sd">ValueError</span>
<span class="sd">    If the value cannot be parsed.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">search_role_ids</span> <span class="o">=</span> <span class="n">_make_snowflake_searcher</span><span class="p">(</span><span class="n">_ROLE_ID_REGEX</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Iterate over the role IDs in a string.</span>

<span class="sd">Parameters</span>
<span class="sd">----------</span>
<span class="sd">value: typing.Union[str, int]</span>
<span class="sd">    The value to parse (this argument can only be passed positionally).</span>

<span class="sd">Returns</span>
<span class="sd">-------</span>
<span class="sd">collections.abc.Iterator[hikari.Snowflake]</span>
<span class="sd">    An iterator over the role IDs in the string.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">_USER_ID_REGEX</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&lt;@!?(\d+)&gt;&quot;</span><span class="p">)</span>
<span class="n">parse_user_id</span><span class="p">:</span> <span class="n">_IDMatcher</span> <span class="o">=</span> <span class="n">_make_snowflake_parser</span><span class="p">(</span><span class="n">_USER_ID_REGEX</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Parse a user ID from a string or int value.</span>

<span class="sd">Parameters</span>
<span class="sd">----------</span>
<span class="sd">value: typing.Union[str, int]</span>
<span class="sd">    The value to parse (this argument can only be passed positionally).</span>

<span class="sd">Other Parameters</span>
<span class="sd">----------------</span>
<span class="sd">message: str</span>
<span class="sd">    The error message to raise if the value cannot be parsed.</span>

<span class="sd">Returns</span>
<span class="sd">-------</span>
<span class="sd">hikari.Snowflake</span>
<span class="sd">    The parsed user ID.</span>

<span class="sd">Raises</span>
<span class="sd">------</span>
<span class="sd">ValueError</span>
<span class="sd">    If the value cannot be parsed.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">search_user_ids</span> <span class="o">=</span> <span class="n">_make_snowflake_searcher</span><span class="p">(</span><span class="n">_USER_ID_REGEX</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Iterate over the user IDs in a string.</span>

<span class="sd">Parameters</span>
<span class="sd">----------</span>
<span class="sd">value: typing.Union[str, int]</span>
<span class="sd">    The value to parse (this argument can only be passed positionally).</span>

<span class="sd">Returns</span>
<span class="sd">-------</span>
<span class="sd">collections.abc.Iterator[hikari.Snowflake]</span>
<span class="sd">    An iterator over the user IDs in the string.</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">_build_url_parser</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">_ValueT</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">_ValueT</span><span class="p">]:</span>
    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ValueT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Convert an argument to a `urlib.parse` type.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value: str</span>
<span class="sd">            The value to parse (this argument can only be passed positionally).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        _ValueT</span>
<span class="sd">            The parsed URL.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the argument couldn&#39;t be parsed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">callback</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">parse</span>


<span class="n">defragment_url</span> <span class="o">=</span> <span class="n">_build_url_parser</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urldefrag</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Convert an argument to a defragmented URL.</span>

<span class="sd">Parameters</span>
<span class="sd">----------</span>
<span class="sd">value: str</span>
<span class="sd">    The value to parse (this argument can only be passed positionally).</span>

<span class="sd">Returns</span>
<span class="sd">-------</span>
<span class="sd">urlib.parse.DefragResult</span>
<span class="sd">    The parsed URL.</span>

<span class="sd">Raises</span>
<span class="sd">------</span>
<span class="sd">ValueError</span>
<span class="sd">    If the argument couldn&#39;t be parsed.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">parse_url</span> <span class="o">=</span> <span class="n">_build_url_parser</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Convert an argument to a parsed URL.</span>

<span class="sd">Parameters</span>
<span class="sd">----------</span>
<span class="sd">value: str</span>
<span class="sd">    The value to parse (this argument can only be passed positionally).</span>

<span class="sd">Returns</span>
<span class="sd">-------</span>
<span class="sd">urlib.parse.ParseResult</span>
<span class="sd">    The parsed URL.</span>

<span class="sd">Raises</span>
<span class="sd">------</span>
<span class="sd">ValueError</span>
<span class="sd">    If the argument couldn&#39;t be parsed.</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="n">split_url</span> <span class="o">=</span> <span class="n">_build_url_parser</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlsplit</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Convert an argument to a split URL.</span>

<span class="sd">Parameters</span>
<span class="sd">----------</span>
<span class="sd">value: str</span>
<span class="sd">    The value to parse (this argument can only be passed positionally).</span>

<span class="sd">Returns</span>
<span class="sd">-------</span>
<span class="sd">urlib.parse.SplitResult</span>
<span class="sd">    The split URL.</span>

<span class="sd">Raises</span>
<span class="sd">------</span>
<span class="sd">ValueError</span>
<span class="sd">    If the argument couldn&#39;t be parsed.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">_DATETIME_REGEX</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&lt;-?t:(\d+)(?::\w)?&gt;&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">to_datetime</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Parse a datetime from Discord&#39;s datetime format.</span>

<span class="sd">    More information on this format can be found at</span>
<span class="sd">    https://discord.com/developers/docs/reference#message-formatting-timestamp-styles</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    value: str</span>
<span class="sd">        The value to parse.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    datetime.datetime</span>
<span class="sd">        The parsed datetime.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the value cannot be parsed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">_DATETIME_REGEX</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not a valid datetime&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>

    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>


<span class="n">_VALID_DATETIME_STYLES</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">((</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;R&quot;</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">from_datetime</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">style</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;f&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Format a datetime as Discord&#39;s datetime format.</span>

<span class="sd">    More information on this format can be found at</span>
<span class="sd">    https://discord.com/developers/docs/reference#message-formatting-timestamp-styles</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    value: datetime.datetime</span>
<span class="sd">        The datetime to format.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    style: str</span>
<span class="sd">        The style to use.</span>

<span class="sd">        The valid styles can be found at</span>
<span class="sd">        https://discord.com/developers/docs/reference#message-formatting-formats</span>
<span class="sd">        and this defaults to `&quot;f&quot;`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The formatted datetime.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the provided datetime is timezone naive.</span>
<span class="sd">        If an invalid style is provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">style</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_VALID_DATETIME_STYLES</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid style: </span><span class="si">{</span><span class="n">style</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">tzinfo</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot convert naive datetimes, please specify a timezone.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;t:</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">timestamp</span><span class="p">())</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">style</span><span class="si">}</span><span class="s2">&gt;&quot;</span>


<span class="n">_YES_VALUES</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">((</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span> <span class="s2">&quot;on&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">))</span>
<span class="n">_NO_VALUES</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">((</span><span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">,</span> <span class="s2">&quot;off&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">to_bool</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Convert user string input into a boolean value.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    value: str</span>
<span class="sd">        The value to convert.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        The converted value.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the value cannot be converted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">_YES_VALUES</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">_NO_VALUES</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid bool value `</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">to_color</span><span class="p">(</span><span class="n">argument</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Color</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Convert user input to a `hikari.colors.Color` object.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>


<span class="n">_TYPE_OVERRIDES</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nb">bool</span><span class="p">:</span> <span class="n">to_bool</span><span class="p">,</span>
    <span class="nb">bytes</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
    <span class="nb">bytearray</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
    <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span> <span class="n">to_datetime</span><span class="p">,</span>
    <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">:</span> <span class="n">parse_snowflake</span><span class="p">,</span>
    <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">DefragResult</span><span class="p">:</span> <span class="n">defragment_url</span><span class="p">,</span>
    <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">ParseResult</span><span class="p">:</span> <span class="n">parse_url</span><span class="p">,</span>
    <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">SplitResult</span><span class="p">:</span> <span class="n">split_url</span><span class="p">,</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">override_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">parsing</span><span class="o">.</span><span class="n">ConverterSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">parsing</span><span class="o">.</span><span class="n">ConverterSig</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">_TYPE_OVERRIDES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span>


<span class="n">to_channel</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">ChannelConverter</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChannelConverter</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Convert user input to a `hikari.channels.PartialChannel` object.&quot;&quot;&quot;</span>

<span class="n">to_colour</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ArgumentT</span><span class="p">],</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Color</span><span class="p">]]</span> <span class="o">=</span> <span class="n">to_color</span>
<span class="sd">&quot;&quot;&quot;Convert user input to a `hikari.colors.Color` object.&quot;&quot;&quot;</span>

<span class="n">to_emoji</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">EmojiConverter</span><span class="p">]</span> <span class="o">=</span> <span class="n">EmojiConverter</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Convert user input to a cached `hikari.emojis.KnownCustomEmoji` object.&quot;&quot;&quot;</span>

<span class="n">to_guild</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">GuildConverter</span><span class="p">]</span> <span class="o">=</span> <span class="n">GuildConverter</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Convert user input to a `hikari.guilds.Guild` object.&quot;&quot;&quot;</span>

<span class="n">to_invite</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">InviteConverter</span><span class="p">]</span> <span class="o">=</span> <span class="n">InviteConverter</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Convert user input to a cached `hikari.invites.InviteWithMetadata` object.&quot;&quot;&quot;</span>

<span class="n">to_invite_with_metadata</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">InviteWithMetadataConverter</span><span class="p">]</span> <span class="o">=</span> <span class="n">InviteWithMetadataConverter</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Convert user input to a `hikari.invites.Invite` object.&quot;&quot;&quot;</span>

<span class="n">to_member</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">MemberConverter</span><span class="p">]</span> <span class="o">=</span> <span class="n">MemberConverter</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Convert user input to a `hikari.guilds.Member` object.&quot;&quot;&quot;</span>

<span class="n">to_presence</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">PresenceConverter</span><span class="p">]</span> <span class="o">=</span> <span class="n">PresenceConverter</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Convert user input to a cached `hikari.presences.MemberPresence`.&quot;&quot;&quot;</span>

<span class="n">to_role</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">RoleConverter</span><span class="p">]</span> <span class="o">=</span> <span class="n">RoleConverter</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Convert user input to a `hikari.guilds.Role` object.&quot;&quot;&quot;</span>

<span class="n">to_snowflake</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ArgumentT</span><span class="p">],</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]]</span> <span class="o">=</span> <span class="n">parse_snowflake</span>
<span class="sd">&quot;&quot;&quot;Convert user input to a `hikari.snowflakes.Snowflake`.</span>

<span class="sd">.. note::</span>
<span class="sd">    This also range validates the input.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">to_user</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">UserConverter</span><span class="p">]</span> <span class="o">=</span> <span class="n">UserConverter</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Convert user input to a `hikari.users.User` object.&quot;&quot;&quot;</span>

<span class="n">to_voice_state</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">VoiceStateConverter</span><span class="p">]</span> <span class="o">=</span> <span class="n">VoiceStateConverter</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Convert user input to a cached `hikari.voices.VoiceState`.&quot;&quot;&quot;</span>
</pre></div>

        </details>

            <div class="docstring"><p>Functions and classes used to enable more Discord oriented argument converters.</p>
</div>


                </section>
                <section id="to_bool">
                            <div class="attr function"><a class="headerlink" href="#to_bool">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">to_bool</span><span class="signature">(value: str, /) -&gt; bool</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_bool</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Convert user string input into a boolean value.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    value: str</span>
<span class="sd">        The value to convert.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        The converted value.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the value cannot be converted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">_YES_VALUES</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">_NO_VALUES</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid bool value `</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Convert user string input into a boolean value.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>value</strong> (str):
The value to convert.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>bool</strong>: The converted value.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the value cannot be converted.</li>
</ul>
</div>


                </section>
                <section id="to_channel">
                                <div class="attr variable"><a class="headerlink" href="#to_channel">#&nbsp;&nbsp</a>

        <span class="name">to_channel</span><span class="default_value"> = &lt;<a href="tanjun/conversion.html#ChannelConverter">tanjun.conversion.ChannelConverter</a> object&gt;</span>
    </div>

    

                </section>
                <section id="to_color">
                            <div class="attr function"><a class="headerlink" href="#to_color">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">to_color</span><span class="signature">(argument: Union[str, int, float], /) -&gt; hikari.colors.Color</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_color</span><span class="p">(</span><span class="n">argument</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Color</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Convert user input to a `hikari.colors.Color` object.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Convert user input to a <code>hikari.colors.Color</code> object.</p>
</div>


                </section>
                <section id="to_colour">
                            <div class="attr function"><a class="headerlink" href="#to_colour">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">to_colour</span><span class="signature">(argument: Union[str, int, float], /) -&gt; hikari.colors.Color</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_color</span><span class="p">(</span><span class="n">argument</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Color</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Convert user input to a `hikari.colors.Color` object.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Convert user input to a <code>hikari.colors.Color</code> object.</p>
</div>


                </section>
                <section id="to_datetime">
                            <div class="attr function"><a class="headerlink" href="#to_datetime">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">to_datetime</span><span class="signature">(value: str, /) -&gt; datetime.datetime</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">to_datetime</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Parse a datetime from Discord&#39;s datetime format.</span>

<span class="sd">    More information on this format can be found at</span>
<span class="sd">    https://discord.com/developers/docs/reference#message-formatting-timestamp-styles</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    value: str</span>
<span class="sd">        The value to parse.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    datetime.datetime</span>
<span class="sd">        The parsed datetime.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the value cannot be parsed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">_DATETIME_REGEX</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not a valid datetime&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>

    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Parse a datetime from Discord's datetime format.</p>

<p>More information on this format can be found at
https://discord.com/developers/docs/reference#message-formatting-timestamp-styles</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>value</strong> (str):
The value to parse.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>datetime.datetime</strong>: The parsed datetime.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the value cannot be parsed.</li>
</ul>
</div>


                </section>
                <section id="to_emoji">
                                <div class="attr variable"><a class="headerlink" href="#to_emoji">#&nbsp;&nbsp</a>

        <span class="name">to_emoji</span><span class="default_value"> = &lt;<a href="tanjun/conversion.html#EmojiConverter">tanjun.conversion.EmojiConverter</a> object&gt;</span>
    </div>

    

                </section>
                <section id="to_guild">
                                <div class="attr variable"><a class="headerlink" href="#to_guild">#&nbsp;&nbsp</a>

        <span class="name">to_guild</span><span class="default_value"> = &lt;<a href="tanjun/conversion.html#GuildConverter">tanjun.conversion.GuildConverter</a> object&gt;</span>
    </div>

    

                </section>
                <section id="to_invite">
                                <div class="attr variable"><a class="headerlink" href="#to_invite">#&nbsp;&nbsp</a>

        <span class="name">to_invite</span><span class="default_value"> = &lt;<a href="tanjun/conversion.html#InviteConverter">tanjun.conversion.InviteConverter</a> object&gt;</span>
    </div>

    

                </section>
                <section id="to_invite_with_metadata">
                                <div class="attr variable"><a class="headerlink" href="#to_invite_with_metadata">#&nbsp;&nbsp</a>

        <span class="name">to_invite_with_metadata</span><span class="default_value"> = &lt;<a href="tanjun/conversion.html#InviteWithMetadataConverter">tanjun.conversion.InviteWithMetadataConverter</a> object&gt;</span>
    </div>

    

                </section>
                <section id="to_member">
                                <div class="attr variable"><a class="headerlink" href="#to_member">#&nbsp;&nbsp</a>

        <span class="name">to_member</span><span class="default_value"> = &lt;<a href="tanjun/conversion.html#MemberConverter">tanjun.conversion.MemberConverter</a> object&gt;</span>
    </div>

    

                </section>
                <section id="to_presence">
                                <div class="attr variable"><a class="headerlink" href="#to_presence">#&nbsp;&nbsp</a>

        <span class="name">to_presence</span><span class="default_value"> = &lt;<a href="tanjun/conversion.html#PresenceConverter">tanjun.conversion.PresenceConverter</a> object&gt;</span>
    </div>

    

                </section>
                <section id="to_role">
                                <div class="attr variable"><a class="headerlink" href="#to_role">#&nbsp;&nbsp</a>

        <span class="name">to_role</span><span class="default_value"> = &lt;<a href="tanjun/conversion.html#RoleConverter">tanjun.conversion.RoleConverter</a> object&gt;</span>
    </div>

    

                </section>
                <section id="to_snowflake">
                            <div class="attr function"><a class="headerlink" href="#to_snowflake">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">to_snowflake</span><span class="signature">(
    value: Union[str, int, float],
    /,
    *,
    message: str = &#39;No valid mention or ID found&#39;
) -&gt; hikari.snowflakes.Snowflake</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">ArgumentT</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;No valid mention or ID found&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Parse a snowflake from a string or int value.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This only allows the relevant entity&#39;s mention format if applicable.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value: typing.Union[str, int]</span>
<span class="sd">            The value to parse (this argument can only be passed positionally).</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        message: str</span>
<span class="sd">            The error message to raise if the value cannot be parsed.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.Snowflake</span>
<span class="sd">            The parsed snowflake.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the value cannot be parsed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">capture</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">regex</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">capture</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">capture</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                <span class="k">pass</span>

        <span class="c1"># We should also range check the provided ID.</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">_range_check</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>
</pre></div>

        </details>

            <div class="docstring"><p>Parse a snowflake from a string or int value.</p>

<p><em>Note:</em>
This only allows the relevant entity's mention format if applicable.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>value</strong> (typing.Union[str, int]):
The value to parse (this argument can only be passed positionally).</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>message</strong> (str):
The error message to raise if the value cannot be parsed.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.Snowflake</strong>: The parsed snowflake.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the value cannot be parsed.</li>
</ul>
</div>


                </section>
                <section id="to_user">
                                <div class="attr variable"><a class="headerlink" href="#to_user">#&nbsp;&nbsp</a>

        <span class="name">to_user</span><span class="default_value"> = &lt;<a href="tanjun/conversion.html#UserConverter">tanjun.conversion.UserConverter</a> object&gt;</span>
    </div>

    

                </section>
                <section id="to_voice_state">
                                <div class="attr variable"><a class="headerlink" href="#to_voice_state">#&nbsp;&nbsp</a>

        <span class="name">to_voice_state</span><span class="default_value"> = &lt;<a href="tanjun/conversion.html#VoiceStateConverter">tanjun.conversion.VoiceStateConverter</a> object&gt;</span>
    </div>

    

                </section>
                <section id="dependencies">
                                <div class="attr module"><a class="headerlink" href="#dependencies">#&nbsp;&nbsp</a>
<span class="name"><a href="tanjun/dependencies.html">tanjun.dependencies</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;Default dependency classes used within Tanjun and their abstract interfaces.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;AbstractOwnerCheck&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cache_callback&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cached_inject&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LazyConstant&quot;</span><span class="p">,</span>
    <span class="s2">&quot;inject_lc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;make_lc_resolver&quot;</span><span class="p">,</span>
    <span class="s2">&quot;OwnerCheck&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">import</span> <span class="nn">hikari</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">tanjun_abc</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">injecting</span>

<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">contextlib</span>
    <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">collections</span>

    <span class="n">_LazyConstantT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_LazyConstantT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;LazyConstant[typing.Any]&quot;</span><span class="p">)</span>

<span class="n">_T</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_T&quot;</span><span class="p">)</span>
<span class="n">_LOGGER</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">]</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;hikari.tanjun&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">AbstractOwnerCheck</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Interface used to check if a user is deemed to be the bot&#39;s &quot;owner&quot;.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">check_ownership</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Check whether this object is owned by the given object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        client : tanjun.abc.Client</span>
<span class="sd">            The Tanjun client this check is being called by.</span>
<span class="sd">        user : hikari.User</span>
<span class="sd">            The user to check ownership for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            Whether the bot is owned by the provided user.</span>
<span class="sd">        &quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">_CachedValue</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">_T</span><span class="p">]):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_expire_after&quot;</span><span class="p">,</span> <span class="s2">&quot;_last_called&quot;</span><span class="p">,</span> <span class="s2">&quot;_lock&quot;</span><span class="p">,</span> <span class="s2">&quot;_result&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">expire_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expire_after</span> <span class="o">=</span> <span class="n">expire_after</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="k">if</span> <span class="n">expire_after</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_called</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_T</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_has_expired</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expire_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_called</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expire_after</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_called</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">acquire</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="n">_T</span><span class="p">]],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_expired</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_expired</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">callback</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_called</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span>
            <span class="c1"># This is set to None afterwards to ensure that it isn&#39;t persisted between loops.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span>


<span class="k">class</span> <span class="nc">OwnerCheck</span><span class="p">(</span><span class="n">AbstractOwnerCheck</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Default implementation of the owner check interface.</span>

<span class="sd">    .. warning::</span>
<span class="sd">        `fallback_to_application` is only possible when the REST client</span>
<span class="sd">        is bound to a Bot token.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_expire_after&quot;</span><span class="p">,</span> <span class="s2">&quot;_fallback_to_application&quot;</span><span class="p">,</span> <span class="s2">&quot;_owner_ids&quot;</span><span class="p">,</span> <span class="s2">&quot;_value&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">expire_after</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
        <span class="n">fallback_to_application</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">owners</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initiate a new owner check dependency.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        expire_after : datetime.timedelta</span>
<span class="sd">            The amount of time to cache application owner data for.</span>

<span class="sd">            This defaults to 5 minutes and is only applicable if `rest` is also</span>
<span class="sd">            passed.</span>
<span class="sd">        fallback_to_application : bool</span>
<span class="sd">            Whether this check should fallback to checking the application&#39;s owners</span>
<span class="sd">            if the user isn&#39;t in `owners.</span>

<span class="sd">            This only works when the bot&#39;s rest client is bound to a Bot token.</span>
<span class="sd">        owners : typing.Optional[hikari.SnowflakeishSequence[hikari.User]]</span>
<span class="sd">            Sequence of objects and IDs of the users that are allowed to use the</span>
<span class="sd">            bot&#39;s &quot;owners&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expire_after</span> <span class="o">=</span> <span class="n">expire_after</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fallback_to_application</span> <span class="o">=</span> <span class="n">fallback_to_application</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_owner_ids</span> <span class="o">=</span> <span class="p">{</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">id_</span><span class="p">)</span> <span class="k">for</span> <span class="n">id_</span> <span class="ow">in</span> <span class="n">owners</span><span class="p">}</span> <span class="k">if</span> <span class="n">owners</span> <span class="k">else</span> <span class="nb">set</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">_CachedValue</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Application</span><span class="p">](</span><span class="n">expire_after</span><span class="o">=</span><span class="n">expire_after</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">check_ownership</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_owner_ids</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fallback_to_application</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">token_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">hikari</span><span class="o">.</span><span class="n">TokenType</span><span class="o">.</span><span class="n">BOT</span><span class="p">:</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Owner checks cannot fallback to application owners when bound to an OAuth2 &quot;</span>
                <span class="s2">&quot;client credentials token and may always fail unless bound to a Bot token.&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">application</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_application</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="n">application</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">members</span> <span class="k">if</span> <span class="n">application</span><span class="o">.</span><span class="n">team</span> <span class="k">else</span> <span class="n">user</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">application</span><span class="o">.</span><span class="n">owner</span><span class="o">.</span><span class="n">id</span>


<span class="k">class</span> <span class="nc">LazyConstant</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">_T</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Injected type used to hold and generate lazy constants.</span>

<span class="sd">    .. note::</span>
<span class="sd">        To easily resolve this type use `inject_lc`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_callback&quot;</span><span class="p">,</span> <span class="s2">&quot;_lock&quot;</span><span class="p">,</span> <span class="s2">&quot;_value&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MaybeAwaitableT</span><span class="p">[</span><span class="n">_T</span><span class="p">]],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initiate a new lazy constant.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : collections.abc.Callable[..., tanjun.abc.MaybeAwaitable[_T]]</span>
<span class="sd">            Callback used to resolve this to a constant value.</span>

<span class="sd">            This supports dependency injection and may either be sync or asynchronous.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_T</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Descriptor of the callback used to get this constant&#39;s initial value.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span>

    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the value of this constant if set, else `None`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_LazyConstantT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_LazyConstantT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clear the internally stored value.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_LazyConstantT</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_LazyConstantT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the constant value.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : _T</span>
<span class="sd">            The value to set.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the constant has already been set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Constant value already set.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">acquire</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">AbstractAsyncContextManager</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Acquire this lazy constant to&#39;s asynchronous lock.</span>

<span class="sd">        This is used to ensure that the value is only generated once</span>
<span class="sd">        and should be kept acquired until `LazyConstant.set_value` is called.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        contextlib.AbstractAsyncContextManager[typing.Any]</span>
<span class="sd">            Context manager that can be used to acquire the lock.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="c1"># Error if this is called outside of a running event loop.</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span>


<span class="k">def</span> <span class="nf">make_lc_resolver</span><span class="p">(</span><span class="n">type_</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="n">_T</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Make an injected callback which resolves a LazyConstant.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * This is internally used by `inject_lc`.</span>
<span class="sd">    * For this to work, a `LazyConstant` must&#39;ve been set as a type</span>
<span class="sd">      dependency for the passed `type_`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    type_ : type[_T]</span>
<span class="sd">        The type of the constant to resolve.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[..., collections.abc.Awaitable[_T]]</span>
<span class="sd">        An injected callback used to resolve the LazyConstant.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">resolve</span><span class="p">(</span>
        <span class="n">constant</span><span class="p">:</span> <span class="n">LazyConstant</span><span class="p">[</span><span class="n">_T</span><span class="p">]</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">LazyConstant</span><span class="p">[</span><span class="n">type_</span><span class="p">]),</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">AbstractInjectionContext</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">injecting</span><span class="o">.</span><span class="n">AbstractInjectionContext</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Resolve a lazy constant.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="o">:=</span> <span class="n">constant</span><span class="o">.</span><span class="n">get_value</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>

        <span class="k">async</span> <span class="k">with</span> <span class="n">constant</span><span class="o">.</span><span class="n">acquire</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="o">:=</span> <span class="n">constant</span><span class="o">.</span><span class="n">get_value</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">value</span>

            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">constant</span><span class="o">.</span><span class="n">callback</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
            <span class="n">constant</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

    <span class="k">return</span> <span class="n">resolve</span>


<span class="k">def</span> <span class="nf">inject_lc</span><span class="p">(</span><span class="n">type_</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Make a LazyConstant injector.</span>

<span class="sd">    This acts like `tanjun.injecting.inject` and the result of it</span>
<span class="sd">    should also be assigned to a parameter&#39;s default to be used.</span>

<span class="sd">    .. note::</span>
<span class="sd">        For this to work, a `LazyConstant` must&#39;ve been set as a type</span>
<span class="sd">        dependency for the passed `type_`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    type_ : type[_T]</span>
<span class="sd">        The type of the constant to resolve.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tanjun.injecting.Injected[_T]</span>
<span class="sd">        Injector used to resolve the LazyConstant.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    ```py</span>
<span class="sd">    @component.with_command</span>
<span class="sd">    @tanjun.as_message_command</span>
<span class="sd">    async def command(</span>
<span class="sd">        ctx: tanjun.abc.MessageCommand,</span>
<span class="sd">        application: hikari.Application = tanjun.inject_lc(hikari.Application)</span>
<span class="sd">    ) -&gt; None:</span>
<span class="sd">        raise NotImplementedError</span>

<span class="sd">    ...</span>

<span class="sd">    async def resolve_app(</span>
<span class="sd">        client: tanjun.abc.Client = tanjun.inject(type=tanjun.abc.Client)</span>
<span class="sd">    ) -&gt; hikari.Application:</span>
<span class="sd">        raise NotImplementedError</span>

<span class="sd">    tanjun.Client.from_gateway_bot(...).set_type_dependency(</span>
<span class="sd">        tanjun.LazyConstant[hikari.Application] = tanjun.LazyConstant(resolve_app)</span>
<span class="sd">    )</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">injecting</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="n">make_lc_resolver</span><span class="p">(</span><span class="n">type_</span><span class="p">))</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_my_user</span><span class="p">(</span>
    <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">OwnUser</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Fetch the current user from the client&#39;s cache or rest client.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This is used in the standard `LazyConstant[hikari.OwnUser]`</span>
<span class="sd">        dependency.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    client : tanjun.abc.Client</span>
<span class="sd">        The client to use to fetch the user.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    hikari.OwnUser</span>
<span class="sd">        The current user.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    RuntimeError</span>
<span class="sd">        If the cache couldn&#39;t be used to get the current user and the REST</span>
<span class="sd">        client is not bound to a Bot token.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">client</span><span class="o">.</span><span class="n">cache</span> <span class="ow">and</span> <span class="p">(</span><span class="n">user</span> <span class="o">:=</span> <span class="n">client</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_me</span><span class="p">()):</span>
        <span class="k">return</span> <span class="n">user</span>

    <span class="k">if</span> <span class="n">client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">token_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">hikari</span><span class="o">.</span><span class="n">TokenType</span><span class="o">.</span><span class="n">BOT</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot fetch current user with a REST client that&#39;s bound to a client credentials token&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_my_user</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">set_standard_dependencies</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">InjectorClient</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Set the standard dependencies for Tanjun.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    client: tanjun.injecting.InjectorClient</span>
<span class="sd">        The injector client to set the standard dependencies on.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">(</span>
        <span class="n">client</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">AbstractOwnerCheck</span><span class="p">,</span> <span class="n">OwnerCheck</span><span class="p">())</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span>
            <span class="n">LazyConstant</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">OwnUser</span><span class="p">],</span> <span class="n">LazyConstant</span><span class="p">(</span><span class="n">fetch_my_user</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>


<span class="k">class</span> <span class="nc">_CacheCallback</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">_T</span><span class="p">]):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_callback&quot;</span><span class="p">,</span> <span class="s2">&quot;_expire_after&quot;</span><span class="p">,</span> <span class="s2">&quot;_last_called&quot;</span><span class="p">,</span> <span class="s2">&quot;_lock&quot;</span><span class="p">,</span> <span class="s2">&quot;_result&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">expire_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expire_after</span> <span class="o">=</span> <span class="n">expire_after</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="k">if</span> <span class="n">expire_after</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_called</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">_T</span><span class="p">,</span> <span class="n">injecting</span><span class="o">.</span><span class="n">Undefined</span><span class="p">]</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">UNDEFINED</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_has_expired</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expire_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_called</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expire_after</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_called</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="c1"># Positional arg(s) may be guaranteed under some contexts so we want to pass those through.</span>
        <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">AbstractInjectionContext</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">injecting</span><span class="o">.</span><span class="n">AbstractInjectionContext</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">injecting</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_expired</span><span class="p">:</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">,</span> <span class="n">injecting</span><span class="o">.</span><span class="n">Undefined</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">injecting</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_expired</span><span class="p">:</span>
                <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_result</span><span class="p">,</span> <span class="n">injecting</span><span class="o">.</span><span class="n">Undefined</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_called</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span>
            <span class="c1"># This is set to None afterwards to ensure that it isn&#39;t persisted between loops.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result</span>


<span class="k">def</span> <span class="nf">cache_callback</span><span class="p">(</span>
    <span class="n">callback</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">expire_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="n">_T</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Cache the result of a callback within a dependency injection context.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This is internally used by `cached_inject`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    callback : CallbackSig[_T]</span>
<span class="sd">        The callback to cache the result of.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    expire_after : typing.Optional[datetime.timedelta]</span>
<span class="sd">        The amount of time to cache the result for.</span>

<span class="sd">        Leave this as `None` to cache for the runtime of the application.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Callable[..., Awaitable[_T]]</span>
<span class="sd">        A callback which will cache the result of the given callback after the</span>
<span class="sd">        first call.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_CacheCallback</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">expire_after</span><span class="o">=</span><span class="n">expire_after</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">cached_inject</span><span class="p">(</span>
    <span class="n">callback</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">expire_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Inject a callback with caching.</span>

<span class="sd">    This acts like `tanjun.injecting.inject` and the result of it</span>
<span class="sd">    should also be assigned to a parameter&#39;s default to be used.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    callback : CallbackSig[_T]</span>
<span class="sd">        The callback to inject.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    expire_after : typing.Optional[datetime.timedelta]</span>
<span class="sd">        The amount of time to cache the result for.</span>

<span class="sd">        Leave this as `None` to cache for the runtime of the application.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tanjun.injecting.Injected[_T]</span>
<span class="sd">        Injector used to resolve the cached callback.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    ```py</span>
<span class="sd">    async def resolve_database(</span>
<span class="sd">        client: tanjun.abc.Client = tanjun.inject(type=tanjun.abc.Client)</span>
<span class="sd">    ) -&gt; Database:</span>
<span class="sd">        raise NotImplementedError</span>

<span class="sd">    @tanjun.as_message_command(&quot;command name&quot;)</span>
<span class="sd">    async def command(</span>
<span class="sd">        ctx: tanjun.abc.Context, db: Database = tanjun.cached_inject(resolve_database)</span>
<span class="sd">    ) -&gt; None:</span>
<span class="sd">        raise NotImplementedError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">injecting</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="n">cache_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">expire_after</span><span class="o">=</span><span class="n">expire_after</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Default dependency classes used within Tanjun and their abstract interfaces.</p>
</div>


                </section>
                <section id="cached_inject">
                            <div class="attr function"><a class="headerlink" href="#cached_inject">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">cached_inject</span><span class="signature">(
    callback: collections.abc.Callable[..., typing.Union[~_T, collections.abc.Awaitable[~_T]]],
    /,
    *,
    expire_after: Optional[datetime.timedelta] = None
) -&gt; ~_T</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cached_inject</span><span class="p">(</span>
    <span class="n">callback</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">expire_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Inject a callback with caching.</span>

<span class="sd">    This acts like `tanjun.injecting.inject` and the result of it</span>
<span class="sd">    should also be assigned to a parameter&#39;s default to be used.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    callback : CallbackSig[_T]</span>
<span class="sd">        The callback to inject.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    expire_after : typing.Optional[datetime.timedelta]</span>
<span class="sd">        The amount of time to cache the result for.</span>

<span class="sd">        Leave this as `None` to cache for the runtime of the application.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tanjun.injecting.Injected[_T]</span>
<span class="sd">        Injector used to resolve the cached callback.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    ```py</span>
<span class="sd">    async def resolve_database(</span>
<span class="sd">        client: tanjun.abc.Client = tanjun.inject(type=tanjun.abc.Client)</span>
<span class="sd">    ) -&gt; Database:</span>
<span class="sd">        raise NotImplementedError</span>

<span class="sd">    @tanjun.as_message_command(&quot;command name&quot;)</span>
<span class="sd">    async def command(</span>
<span class="sd">        ctx: tanjun.abc.Context, db: Database = tanjun.cached_inject(resolve_database)</span>
<span class="sd">    ) -&gt; None:</span>
<span class="sd">        raise NotImplementedError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">injecting</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="n">cache_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">expire_after</span><span class="o">=</span><span class="n">expire_after</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Inject a callback with caching.</p>

<p>This acts like <code><a href="tanjun/injecting.html#inject">tanjun.injecting.inject</a></code> and the result of it
should also be assigned to a parameter's default to be used.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>callback</strong> (CallbackSig[_T]):
The callback to inject.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>expire_after</strong> (typing.Optional[datetime.timedelta]):
The amount of time to cache the result for.</p>

<p>Leave this as <code>None</code> to cache for the runtime of the application.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong><a href="tanjun/injecting.html#Injected">tanjun.injecting.Injected</a>[_T]</strong>: Injector used to resolve the cached callback.</li>
</ul>

<h6 id="example">Example</h6>

<p>```py
async def resolve_database(
    client: <a href="tanjun/abc.html#Client">tanjun.abc.Client</a> = <a href="#inject">tanjun.inject</a>(type=<a href="tanjun/abc.html#Client">tanjun.abc.Client</a>)
) -> Database:
    raise NotImplementedError</p>

<p>@<a href="#as_message_command">tanjun.as_message_command</a>("command name")
async def command(
    ctx: <a href="tanjun/abc.html#Context">tanjun.abc.Context</a>, db: Database = <a href="#cached_inject">tanjun.cached_inject</a>(resolve_database)
) -> None:
    raise NotImplementedError</p>
</div>


                </section>
                <section id="inject_lc">
                            <div class="attr function"><a class="headerlink" href="#inject_lc">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">inject_lc</span><span class="signature">(type_: type[~_T], /) -&gt; ~_T</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">inject_lc</span><span class="p">(</span><span class="n">type_</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Make a LazyConstant injector.</span>

<span class="sd">    This acts like `tanjun.injecting.inject` and the result of it</span>
<span class="sd">    should also be assigned to a parameter&#39;s default to be used.</span>

<span class="sd">    .. note::</span>
<span class="sd">        For this to work, a `LazyConstant` must&#39;ve been set as a type</span>
<span class="sd">        dependency for the passed `type_`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    type_ : type[_T]</span>
<span class="sd">        The type of the constant to resolve.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tanjun.injecting.Injected[_T]</span>
<span class="sd">        Injector used to resolve the LazyConstant.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    ```py</span>
<span class="sd">    @component.with_command</span>
<span class="sd">    @tanjun.as_message_command</span>
<span class="sd">    async def command(</span>
<span class="sd">        ctx: tanjun.abc.MessageCommand,</span>
<span class="sd">        application: hikari.Application = tanjun.inject_lc(hikari.Application)</span>
<span class="sd">    ) -&gt; None:</span>
<span class="sd">        raise NotImplementedError</span>

<span class="sd">    ...</span>

<span class="sd">    async def resolve_app(</span>
<span class="sd">        client: tanjun.abc.Client = tanjun.inject(type=tanjun.abc.Client)</span>
<span class="sd">    ) -&gt; hikari.Application:</span>
<span class="sd">        raise NotImplementedError</span>

<span class="sd">    tanjun.Client.from_gateway_bot(...).set_type_dependency(</span>
<span class="sd">        tanjun.LazyConstant[hikari.Application] = tanjun.LazyConstant(resolve_app)</span>
<span class="sd">    )</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">injecting</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="n">make_lc_resolver</span><span class="p">(</span><span class="n">type_</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Make a LazyConstant injector.</p>

<p>This acts like <code><a href="tanjun/injecting.html#inject">tanjun.injecting.inject</a></code> and the result of it
should also be assigned to a parameter's default to be used.</p>

<p><em>Note:</em>
For this to work, a <code><a href="#LazyConstant">LazyConstant</a></code> must've been set as a type
dependency for the passed <code>type_</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>type_</strong> (type[_T]):
The type of the constant to resolve.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong><a href="tanjun/injecting.html#Injected">tanjun.injecting.Injected</a>[_T]</strong>: Injector used to resolve the LazyConstant.</li>
</ul>

<h6 id="example">Example</h6>

<div class="codehilite"><pre><span></span><code><span class="nd">@component</span><span class="o">.</span><span class="n">with_command</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">as_message_command</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">command</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">,</span>
    <span class="n">application</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Application</span> <span class="o">=</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">inject_lc</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Application</span><span class="p">)</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>

<span class="o">...</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">resolve_app</span><span class="p">(</span>
    <span class="n">client</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Client</span> <span class="o">=</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">)</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Application</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>

<span class="n">tanjun</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">from_gateway_bot</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span>
    <span class="n">tanjun</span><span class="o">.</span><span class="n">LazyConstant</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Application</span><span class="p">]</span> <span class="o">=</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">LazyConstant</span><span class="p">(</span><span class="n">resolve_app</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
</div>


                </section>
                <section id="LazyConstant">
                                <div class="attr class">
        <a class="headerlink" href="#LazyConstant">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">LazyConstant</span><wbr>(<span class="base">typing.Generic[~_T]</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">LazyConstant</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">_T</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Injected type used to hold and generate lazy constants.</span>

<span class="sd">    .. note::</span>
<span class="sd">        To easily resolve this type use `inject_lc`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_callback&quot;</span><span class="p">,</span> <span class="s2">&quot;_lock&quot;</span><span class="p">,</span> <span class="s2">&quot;_value&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MaybeAwaitableT</span><span class="p">[</span><span class="n">_T</span><span class="p">]],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initiate a new lazy constant.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : collections.abc.Callable[..., tanjun.abc.MaybeAwaitable[_T]]</span>
<span class="sd">            Callback used to resolve this to a constant value.</span>

<span class="sd">            This supports dependency injection and may either be sync or asynchronous.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_T</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Descriptor of the callback used to get this constant&#39;s initial value.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span>

    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the value of this constant if set, else `None`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_LazyConstantT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_LazyConstantT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clear the internally stored value.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_LazyConstantT</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_LazyConstantT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the constant value.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : _T</span>
<span class="sd">            The value to set.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the constant has already been set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Constant value already set.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">acquire</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">AbstractAsyncContextManager</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Acquire this lazy constant to&#39;s asynchronous lock.</span>

<span class="sd">        This is used to ensure that the value is only generated once</span>
<span class="sd">        and should be kept acquired until `LazyConstant.set_value` is called.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        contextlib.AbstractAsyncContextManager[typing.Any]</span>
<span class="sd">            Context manager that can be used to acquire the lock.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="c1"># Error if this is called outside of a running event loop.</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span>
</pre></div>

        </details>

            <div class="docstring"><p>Injected type used to hold and generate lazy constants.</p>

<p><em>Note:</em>
To easily resolve this type use <code><a href="#inject_lc">inject_lc</a></code>.</p>
</div>


                            <div id="LazyConstant.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#LazyConstant.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">LazyConstant</span><span class="signature">(
    callback: collections.abc.Callable[..., typing.Union[~_T, collections.abc.Awaitable[~_T]]],
    /
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MaybeAwaitableT</span><span class="p">[</span><span class="n">_T</span><span class="p">]],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initiate a new lazy constant.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : collections.abc.Callable[..., tanjun.abc.MaybeAwaitable[_T]]</span>
<span class="sd">            Callback used to resolve this to a constant value.</span>

<span class="sd">            This supports dependency injection and may either be sync or asynchronous.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_T</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>

        </details>

            <div class="docstring"><p>Initiate a new lazy constant.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>callback</strong> (collections.abc.Callable[..., <a href="tanjun/abc.html#MaybeAwaitable">tanjun.abc.MaybeAwaitable</a>[_T]]):
Callback used to resolve this to a constant value.</p>

<p>This supports dependency injection and may either be sync or asynchronous.</p></li>
</ul>
</div>


                            </div>
                            <div id="LazyConstant.callback" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#LazyConstant.callback">#&nbsp;&nbsp</a>

        <span class="name">callback</span><span class="annotation">: <a href="tanjun/injecting.html#CallbackDescriptor">tanjun.injecting.CallbackDescriptor</a>[~_T]</span>
    </div>

            <div class="docstring"><p>Descriptor of the callback used to get this constant's initial value.</p>
</div>


                            </div>
                            <div id="LazyConstant.get_value" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#LazyConstant.get_value">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_value</span><span class="signature">(self) -&gt; Optional[~_T]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the value of this constant if set, else `None`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>
</pre></div>

        </details>

            <div class="docstring"><p>Get the value of this constant if set, else <code>None</code>.</p>
</div>


                            </div>
                            <div id="LazyConstant.reset" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#LazyConstant.reset">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">reset</span><span class="signature">(self: ~_LazyConstantT) -&gt; ~_LazyConstantT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_LazyConstantT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_LazyConstantT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clear the internally stored value.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Clear the internally stored value.</p>
</div>


                            </div>
                            <div id="LazyConstant.set_value" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#LazyConstant.set_value">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_value</span><span class="signature">(self: ~_LazyConstantT, value: ~_T, /) -&gt; ~_LazyConstantT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_LazyConstantT</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_LazyConstantT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the constant value.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : _T</span>
<span class="sd">            The value to set.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the constant has already been set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Constant value already set.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the constant value.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>value</strong> (_T):
The value to set.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>RuntimeError</strong>: If the constant has already been set.</li>
</ul>
</div>


                            </div>
                            <div id="LazyConstant.acquire" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#LazyConstant.acquire">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">acquire</span><span class="signature">(self) -&gt; contextlib.AbstractAsyncContextManager[typing.Any]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">acquire</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">AbstractAsyncContextManager</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Acquire this lazy constant to&#39;s asynchronous lock.</span>

<span class="sd">        This is used to ensure that the value is only generated once</span>
<span class="sd">        and should be kept acquired until `LazyConstant.set_value` is called.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        contextlib.AbstractAsyncContextManager[typing.Any]</span>
<span class="sd">            Context manager that can be used to acquire the lock.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="c1"># Error if this is called outside of a running event loop.</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span>
</pre></div>

        </details>

            <div class="docstring"><p>Acquire this lazy constant to's asynchronous lock.</p>

<p>This is used to ensure that the value is only generated once
and should be kept acquired until <code><a href="#LazyConstant.set_value">LazyConstant.set_value</a></code> is called.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>contextlib.AbstractAsyncContextManager[typing.Any]</strong>: Context manager that can be used to acquire the lock.</li>
</ul>
</div>


                            </div>
                </section>
                <section id="errors">
                                <div class="attr module"><a class="headerlink" href="#errors">#&nbsp;&nbsp</a>
<span class="name"><a href="tanjun/errors.html">tanjun.errors</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;The errors and warnings raised within and by Tanjun.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;CommandError&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ConversionError&quot;</span><span class="p">,</span>
    <span class="s2">&quot;HaltExecution&quot;</span><span class="p">,</span>
    <span class="s2">&quot;FailedCheck&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MissingDependencyError&quot;</span><span class="p">,</span>
    <span class="s2">&quot;NotEnoughArgumentsError&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TooManyArgumentsError&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ParserError&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TanjunError&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TanjunWarning&quot;</span><span class="p">,</span>
    <span class="s2">&quot;StateWarning&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">typing</span>

<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">collections</span>


<span class="k">class</span> <span class="nc">TanjunError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The base class for all errors raised by Tanjun.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>


<span class="k">class</span> <span class="nc">TanjunWarning</span><span class="p">(</span><span class="ne">RuntimeWarning</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The base class for all warnings raised by Tanjun.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>


<span class="k">class</span> <span class="nc">HaltExecution</span><span class="p">(</span><span class="n">TanjunError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Error raised while looking for a command in-order to end-execution early.</span>

<span class="sd">    For the most part, this will be raised during checks in-order to prevent</span>
<span class="sd">    other commands from being tried.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>


<span class="k">class</span> <span class="nc">MissingDependencyError</span><span class="p">(</span><span class="n">TanjunError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Error raised when a dependency couldn&#39;t be found.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>


<span class="k">class</span> <span class="nc">CommandError</span><span class="p">(</span><span class="n">TanjunError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Error raised to end command execution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    message : str</span>
<span class="sd">        String message which will be sent as a response to the message</span>
<span class="sd">        that triggered the current command.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raised when the message is over 2000 characters long or empty.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">,)</span>

    <span class="c1"># None or empty string == no response</span>
    <span class="n">message</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;The response error message.</span>

<span class="sd">    If this is an empty string or `None` then this will silently end</span>
<span class="sd">    command execution otherwise Tanjun will try to send the string message in</span>
<span class="sd">    response.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2000</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error message cannot be over 2_000 characters long.&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="n">message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Response message must have at least 1 character.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>


<span class="c1"># TODO: use this</span>
<span class="k">class</span> <span class="nc">InvalidCheck</span><span class="p">(</span><span class="n">TanjunError</span><span class="p">,</span> <span class="ne">RuntimeError</span><span class="p">):</span>  <span class="c1"># TODO: or/and warning?  # TODO: InvalidCheckError</span>
    <span class="sd">&quot;&quot;&quot;Error raised as an assertion that a check will never pass in the current environment.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>


<span class="k">class</span> <span class="nc">FailedCheck</span><span class="p">(</span><span class="n">TanjunError</span><span class="p">,</span> <span class="ne">RuntimeError</span><span class="p">):</span>  <span class="c1"># TODO: FailedCheckError</span>
    <span class="sd">&quot;&quot;&quot;Error raised as an alternative to returning `False` in a check.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>


<span class="k">class</span> <span class="nc">ParserError</span><span class="p">(</span><span class="n">TanjunError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base error raised by a parser or parameter during parsing.</span>

<span class="sd">    .. note::</span>
<span class="sd">        Expected errors raised by the parser will subclass this error.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    message : str</span>
<span class="sd">        String message for this error.</span>
<span class="sd">    parameter : typing.Optional[str]</span>
<span class="sd">        Name of the parameter which caused this error, should be `None` if not</span>
<span class="sd">        applicable.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">,</span> <span class="s2">&quot;parameter&quot;</span><span class="p">)</span>

    <span class="n">message</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;String message for this error.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This may be used as a command response message.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">parameter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="sd">&quot;&quot;&quot;Name of the this was raised for.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This will be `builtin.None` if it was raised while parsing the provided</span>
<span class="sd">        message content.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">parameter</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">message</span>


<span class="k">class</span> <span class="nc">ConversionError</span><span class="p">(</span><span class="n">ParserError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Error raised by a parser parameter when it failed to converter a value.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parameter : tanjun.abc.Parameter</span>
<span class="sd">        The parameter this was raised by.</span>
<span class="sd">    errors : collections.abc.Iterable[ValueError]</span>
<span class="sd">        An iterable of the source value errors which were raised during conversion/</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;errors&quot;</span><span class="p">,)</span>

    <span class="n">errors</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="ne">ValueError</span><span class="p">]</span>
    <span class="sd">&quot;&quot;&quot;Sequence of the errors that were caught during conversion for this parameter.&quot;&quot;&quot;</span>

    <span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;Name of the parameter this error was raised for.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="n">errors</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="ne">ValueError</span><span class="p">]</span> <span class="o">=</span> <span class="p">())</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">parameter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">NotEnoughArgumentsError</span><span class="p">(</span><span class="n">ParserError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Error raised by the parser when not enough arguments are found for a parameter.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parameter : tanjun.abc.Parameter</span>
<span class="sd">        The parameter this error was raised for</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;Name of the parameter this error was raised for.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">parameter</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">TooManyArgumentsError</span><span class="p">(</span><span class="n">ParserError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Error raised by the parser when too many arguments are found for a parameter.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parameter : tanjun.abc.Parameter</span>
<span class="sd">        The parameter this error was raised for</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;Name of the parameter this error was raised for.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">parameter</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">StateWarning</span><span class="p">(</span><span class="ne">RuntimeWarning</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Warning raised when a utility is loaded without access to state stores it depends on.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>The errors and warnings raised within and by Tanjun.</p>
</div>


                </section>
                <section id="CommandError">
                                <div class="attr class">
        <a class="headerlink" href="#CommandError">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">CommandError</span><wbr>(<span class="base"><a href="#TanjunError">tanjun.TanjunError</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">CommandError</span><span class="p">(</span><span class="n">TanjunError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Error raised to end command execution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    message : str</span>
<span class="sd">        String message which will be sent as a response to the message</span>
<span class="sd">        that triggered the current command.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raised when the message is over 2000 characters long or empty.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">,)</span>

    <span class="c1"># None or empty string == no response</span>
    <span class="n">message</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;The response error message.</span>

<span class="sd">    If this is an empty string or `None` then this will silently end</span>
<span class="sd">    command execution otherwise Tanjun will try to send the string message in</span>
<span class="sd">    response.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2000</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error message cannot be over 2_000 characters long.&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="n">message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Response message must have at least 1 character.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
</pre></div>

        </details>

            <div class="docstring"><p>Error raised to end command execution.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>message</strong> (str):
String message which will be sent as a response to the message
that triggered the current command.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: Raised when the message is over 2000 characters long or empty.</li>
</ul>
</div>


                            <div id="CommandError.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#CommandError.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">CommandError</span><span class="signature">(message: str, /)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2000</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error message cannot be over 2_000 characters long.&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="n">message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Response message must have at least 1 character.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="CommandError.message" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#CommandError.message">#&nbsp;&nbsp</a>

        <span class="name">message</span><span class="annotation">: str</span><span class="default_value"> = &lt;member &#39;message&#39; of &#39;CommandError&#39; objects&gt;</span>
    </div>

            <div class="docstring"><p>The response error message.</p>

<p>If this is an empty string or <code>None</code> then this will silently end
command execution otherwise Tanjun will try to send the string message in
response.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.BaseException</dt>
                                <dd id="CommandError.with_traceback" class="function">with_traceback</dd>
                <dd id="CommandError.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ConversionError">
                                <div class="attr class">
        <a class="headerlink" href="#ConversionError">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ConversionError</span><wbr>(<span class="base"><a href="#ParserError">tanjun.ParserError</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ConversionError</span><span class="p">(</span><span class="n">ParserError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Error raised by a parser parameter when it failed to converter a value.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parameter : tanjun.abc.Parameter</span>
<span class="sd">        The parameter this was raised by.</span>
<span class="sd">    errors : collections.abc.Iterable[ValueError]</span>
<span class="sd">        An iterable of the source value errors which were raised during conversion/</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;errors&quot;</span><span class="p">,)</span>

    <span class="n">errors</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="ne">ValueError</span><span class="p">]</span>
    <span class="sd">&quot;&quot;&quot;Sequence of the errors that were caught during conversion for this parameter.&quot;&quot;&quot;</span>

    <span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;Name of the parameter this error was raised for.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="n">errors</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="ne">ValueError</span><span class="p">]</span> <span class="o">=</span> <span class="p">())</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">parameter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Error raised by a parser parameter when it failed to converter a value.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>parameter</strong> (<a href="tanjun/abc.html#Parameter">tanjun.abc.Parameter</a>):
The parameter this was raised by.</li>
<li><strong>errors</strong> (collections.abc.Iterable[ValueError]):
An iterable of the source value errors which were raised during conversion/</li>
</ul>
</div>


                            <div id="ConversionError.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ConversionError.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">ConversionError</span><span class="signature">(
    message: str,
    parameter: str,
    /,
    errors: collections.abc.Iterable[ValueError] = ()
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="n">errors</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="ne">ValueError</span><span class="p">]</span> <span class="o">=</span> <span class="p">())</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">parameter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ConversionError.errors" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ConversionError.errors">#&nbsp;&nbsp</a>

        <span class="name">errors</span><span class="annotation">: collections.abc.Sequence[ValueError]</span><span class="default_value"> = &lt;member &#39;errors&#39; of &#39;ConversionError&#39; objects&gt;</span>
    </div>

            <div class="docstring"><p>Sequence of the errors that were caught during conversion for this parameter.</p>
</div>


                            </div>
                            <div id="ConversionError.parameter" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ConversionError.parameter">#&nbsp;&nbsp</a>

        <span class="name">parameter</span><span class="annotation">: str</span><span class="default_value"> = &lt;member &#39;parameter&#39; of &#39;ParserError&#39; objects&gt;</span>
    </div>

            <div class="docstring"><p>Name of the parameter this error was raised for.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#ParserError">ParserError</a></dt>
                                <dd id="ConversionError.message" class="variable"><a href="#ParserError.message">message</a></dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="ConversionError.with_traceback" class="function">with_traceback</dd>
                <dd id="ConversionError.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="HaltExecution">
                                <div class="attr class">
        <a class="headerlink" href="#HaltExecution">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">HaltExecution</span><wbr>(<span class="base"><a href="#TanjunError">tanjun.TanjunError</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">HaltExecution</span><span class="p">(</span><span class="n">TanjunError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Error raised while looking for a command in-order to end-execution early.</span>

<span class="sd">    For the most part, this will be raised during checks in-order to prevent</span>
<span class="sd">    other commands from being tried.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Error raised while looking for a command in-order to end-execution early.</p>

<p>For the most part, this will be raised during checks in-order to prevent
other commands from being tried.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.Exception</dt>
                                <dd id="HaltExecution.__init__" class="function">Exception</dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="HaltExecution.with_traceback" class="function">with_traceback</dd>
                <dd id="HaltExecution.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="FailedCheck">
                                <div class="attr class">
        <a class="headerlink" href="#FailedCheck">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">FailedCheck</span><wbr>(<span class="base"><a href="#TanjunError">tanjun.TanjunError</a></span>, <span class="base">builtins.RuntimeError</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">FailedCheck</span><span class="p">(</span><span class="n">TanjunError</span><span class="p">,</span> <span class="ne">RuntimeError</span><span class="p">):</span>  <span class="c1"># TODO: FailedCheckError</span>
    <span class="sd">&quot;&quot;&quot;Error raised as an alternative to returning `False` in a check.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Error raised as an alternative to returning <code>False</code> in a check.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.RuntimeError</dt>
                                <dd id="FailedCheck.__init__" class="function">RuntimeError</dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="FailedCheck.with_traceback" class="function">with_traceback</dd>
                <dd id="FailedCheck.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MissingDependencyError">
                                <div class="attr class">
        <a class="headerlink" href="#MissingDependencyError">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">MissingDependencyError</span><wbr>(<span class="base"><a href="#TanjunError">tanjun.TanjunError</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MissingDependencyError</span><span class="p">(</span><span class="n">TanjunError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Error raised when a dependency couldn&#39;t be found.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>
</pre></div>

        </details>

            <div class="docstring"><p>Error raised when a dependency couldn't be found.</p>
</div>


                            <div id="MissingDependencyError.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MissingDependencyError.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">MissingDependencyError</span><span class="signature">(message: str)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="MissingDependencyError.message" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MissingDependencyError.message">#&nbsp;&nbsp</a>

        <span class="name">message</span>
    </div>

    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.BaseException</dt>
                                <dd id="MissingDependencyError.with_traceback" class="function">with_traceback</dd>
                <dd id="MissingDependencyError.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="NotEnoughArgumentsError">
                                <div class="attr class">
        <a class="headerlink" href="#NotEnoughArgumentsError">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">NotEnoughArgumentsError</span><wbr>(<span class="base"><a href="#ParserError">tanjun.ParserError</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">NotEnoughArgumentsError</span><span class="p">(</span><span class="n">ParserError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Error raised by the parser when not enough arguments are found for a parameter.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parameter : tanjun.abc.Parameter</span>
<span class="sd">        The parameter this error was raised for</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;Name of the parameter this error was raised for.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">parameter</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Error raised by the parser when not enough arguments are found for a parameter.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>parameter</strong> (<a href="tanjun/abc.html#Parameter">tanjun.abc.Parameter</a>):
The parameter this error was raised for</li>
</ul>
</div>


                            <div id="NotEnoughArgumentsError.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NotEnoughArgumentsError.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">NotEnoughArgumentsError</span><span class="signature">(message: str, parameter: str, /)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">parameter</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="NotEnoughArgumentsError.parameter" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#NotEnoughArgumentsError.parameter">#&nbsp;&nbsp</a>

        <span class="name">parameter</span><span class="annotation">: str</span><span class="default_value"> = &lt;member &#39;parameter&#39; of &#39;ParserError&#39; objects&gt;</span>
    </div>

            <div class="docstring"><p>Name of the parameter this error was raised for.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#ParserError">ParserError</a></dt>
                                <dd id="NotEnoughArgumentsError.message" class="variable"><a href="#ParserError.message">message</a></dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="NotEnoughArgumentsError.with_traceback" class="function">with_traceback</dd>
                <dd id="NotEnoughArgumentsError.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="TooManyArgumentsError">
                                <div class="attr class">
        <a class="headerlink" href="#TooManyArgumentsError">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">TooManyArgumentsError</span><wbr>(<span class="base"><a href="#ParserError">tanjun.ParserError</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">TooManyArgumentsError</span><span class="p">(</span><span class="n">ParserError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Error raised by the parser when too many arguments are found for a parameter.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parameter : tanjun.abc.Parameter</span>
<span class="sd">        The parameter this error was raised for</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;Name of the parameter this error was raised for.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">parameter</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Error raised by the parser when too many arguments are found for a parameter.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>parameter</strong> (<a href="tanjun/abc.html#Parameter">tanjun.abc.Parameter</a>):
The parameter this error was raised for</li>
</ul>
</div>


                            <div id="TooManyArgumentsError.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#TooManyArgumentsError.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">TooManyArgumentsError</span><span class="signature">(message: str, parameter: str, /)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">parameter</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="TooManyArgumentsError.parameter" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#TooManyArgumentsError.parameter">#&nbsp;&nbsp</a>

        <span class="name">parameter</span><span class="annotation">: str</span><span class="default_value"> = &lt;member &#39;parameter&#39; of &#39;ParserError&#39; objects&gt;</span>
    </div>

            <div class="docstring"><p>Name of the parameter this error was raised for.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#ParserError">ParserError</a></dt>
                                <dd id="TooManyArgumentsError.message" class="variable"><a href="#ParserError.message">message</a></dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="TooManyArgumentsError.with_traceback" class="function">with_traceback</dd>
                <dd id="TooManyArgumentsError.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ParserError">
                                <div class="attr class">
        <a class="headerlink" href="#ParserError">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ParserError</span><wbr>(<span class="base"><a href="#TanjunError">tanjun.TanjunError</a></span>, <span class="base">builtins.ValueError</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ParserError</span><span class="p">(</span><span class="n">TanjunError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base error raised by a parser or parameter during parsing.</span>

<span class="sd">    .. note::</span>
<span class="sd">        Expected errors raised by the parser will subclass this error.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    message : str</span>
<span class="sd">        String message for this error.</span>
<span class="sd">    parameter : typing.Optional[str]</span>
<span class="sd">        Name of the parameter which caused this error, should be `None` if not</span>
<span class="sd">        applicable.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">,</span> <span class="s2">&quot;parameter&quot;</span><span class="p">)</span>

    <span class="n">message</span><span class="p">:</span> <span class="nb">str</span>
    <span class="sd">&quot;&quot;&quot;String message for this error.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This may be used as a command response message.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">parameter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="sd">&quot;&quot;&quot;Name of the this was raised for.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This will be `builtin.None` if it was raised while parsing the provided</span>
<span class="sd">        message content.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">parameter</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">message</span>
</pre></div>

        </details>

            <div class="docstring"><p>Base error raised by a parser or parameter during parsing.</p>

<p><em>Note:</em>
Expected errors raised by the parser will subclass this error.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>message</strong> (str):
String message for this error.</li>
<li><strong>parameter</strong> (typing.Optional[str]):
Name of the parameter which caused this error, should be <code>None</code> if not
applicable.</li>
</ul>
</div>


                            <div id="ParserError.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ParserError.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">ParserError</span><span class="signature">(message: str, parameter: Optional[str], /)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">parameter</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ParserError.message" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ParserError.message">#&nbsp;&nbsp</a>

        <span class="name">message</span><span class="annotation">: str</span><span class="default_value"> = &lt;member &#39;message&#39; of &#39;ParserError&#39; objects&gt;</span>
    </div>

            <div class="docstring"><p>String message for this error.</p>

<p><em>Note:</em>
This may be used as a command response message.</p>
</div>


                            </div>
                            <div id="ParserError.parameter" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ParserError.parameter">#&nbsp;&nbsp</a>

        <span class="name">parameter</span><span class="annotation">: Optional[str]</span><span class="default_value"> = &lt;member &#39;parameter&#39; of &#39;ParserError&#39; objects&gt;</span>
    </div>

            <div class="docstring"><p>Name of the this was raised for.</p>

<p><em>Note:</em>
This will be <code>builtin.None</code> if it was raised while parsing the provided
message content.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.BaseException</dt>
                                <dd id="ParserError.with_traceback" class="function">with_traceback</dd>
                <dd id="ParserError.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="TanjunError">
                                <div class="attr class">
        <a class="headerlink" href="#TanjunError">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">TanjunError</span><wbr>(<span class="base">builtins.Exception</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">TanjunError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The base class for all errors raised by Tanjun.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>The base class for all errors raised by Tanjun.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.Exception</dt>
                                <dd id="TanjunError.__init__" class="function">Exception</dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="TanjunError.with_traceback" class="function">with_traceback</dd>
                <dd id="TanjunError.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="TanjunWarning">
                                <div class="attr class">
        <a class="headerlink" href="#TanjunWarning">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">TanjunWarning</span><wbr>(<span class="base">builtins.RuntimeWarning</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">TanjunWarning</span><span class="p">(</span><span class="ne">RuntimeWarning</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The base class for all warnings raised by Tanjun.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>The base class for all warnings raised by Tanjun.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.RuntimeWarning</dt>
                                <dd id="TanjunWarning.__init__" class="function">RuntimeWarning</dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="TanjunWarning.with_traceback" class="function">with_traceback</dd>
                <dd id="TanjunWarning.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="StateWarning">
                                <div class="attr class">
        <a class="headerlink" href="#StateWarning">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">StateWarning</span><wbr>(<span class="base">builtins.RuntimeWarning</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">StateWarning</span><span class="p">(</span><span class="ne">RuntimeWarning</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Warning raised when a utility is loaded without access to state stores it depends on.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Warning raised when a utility is loaded without access to state stores it depends on.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.RuntimeWarning</dt>
                                <dd id="StateWarning.__init__" class="function">RuntimeWarning</dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="StateWarning.with_traceback" class="function">with_traceback</dd>
                <dd id="StateWarning.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="hooks">
                                <div class="attr module"><a class="headerlink" href="#hooks">#&nbsp;&nbsp</a>
<span class="name"><a href="tanjun/hooks.html">tanjun.hooks</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;Standard implementation of Tanjun&#39;s command execution hook models.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AnyHooks&quot;</span><span class="p">,</span> <span class="s2">&quot;Hooks&quot;</span><span class="p">,</span> <span class="s2">&quot;MessageHooks&quot;</span><span class="p">,</span> <span class="s2">&quot;SlashHooks&quot;</span><span class="p">]</span>

<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">collections</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">abc</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">errors</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">injecting</span>

<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">:</span>
    <span class="n">_HooksT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_HooksT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;Hooks[typing.Any]&quot;</span><span class="p">)</span>

<span class="n">CommandT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;CommandT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">])</span>


<span class="k">class</span> <span class="nc">Hooks</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Standard implementation of `tanjun.abc.Hooks` used for command execution.</span>

<span class="sd">    `tanjun.abc.ContextT_contra` will either be `tanjun.abc.Context`,</span>
<span class="sd">    `tanjun.abc.MessageContext` or `tanjun.abc.SlashContext`.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This implementation adds a concept of parser errors which won&#39;t be</span>
<span class="sd">        dispatched to general &quot;error&quot; hooks and do not share the error</span>
<span class="sd">        suppression semantics as they favour to always suppress the error</span>
<span class="sd">        if a registered handler is found.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_error_callbacks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_parser_error_callbacks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_pre_execution_callbacks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_post_execution_callbacks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_success_callbacks&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_error_callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser_error_callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pre_execution_callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_execution_callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_success_callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">add_to_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">CommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add this hook object to a command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will likely override any previously added hooks.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        This method may be used as a command decorator:</span>

<span class="sd">        ```py</span>
<span class="sd">        @standard_hooks.add_to_command</span>
<span class="sd">        @as_message_command(&quot;command&quot;)</span>
<span class="sd">        async def command_command(ctx: tanjun.abc.Context) -&gt; None:</span>
<span class="sd">            await ctx.respond(&quot;You&#39;ve called a command!&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.ExecutableCommand[typing.Any]</span>
<span class="sd">            The command to add the hooks to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun.abc.ExecutableCommand[typing.Any]</span>
<span class="sd">            The command with the hooks added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">set_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">command</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Copy this hook object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># TODO: maybe don&#39;t</span>

    <span class="k">def</span> <span class="nf">add_on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ErrorHookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_error_callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ErrorHookSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the error callback for this hook object.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will not be called for `tanjun.errors.ParserError`s as these</span>
<span class="sd">            are generally speaking expected. To handle those see</span>
<span class="sd">            `Hooks.set_on_parser_error`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Optional[tanjun.abc.ErrorHookSig]</span>
<span class="sd">            The callback to set for this hook. This will remove any previously</span>
<span class="sd">            set callbacks.</span>

<span class="sd">            This callback should take two positional arguments (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra` and `Exception`) and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">            Returning `True` indicates that the error should be suppressed,</span>
<span class="sd">            `False` that it should be re-raised and `None` that no decision</span>
<span class="sd">            has been made. This will be accounted for along with the decisions</span>
<span class="sd">            other error hooks make by majority rule.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_error_callbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_on_error</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="n">callback</span> <span class="k">else</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ErrorHookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">ErrorHookSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_on_error</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">callback</span>

    <span class="k">def</span> <span class="nf">add_on_parser_error</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser_error_callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_on_parser_error</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the parser error callback for this hook object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Optional[tanjun.abc.HookSig]</span>
<span class="sd">            The callback to set for this hook. This will remove any previously</span>
<span class="sd">            set callbacks.</span>

<span class="sd">            This callback should take two positional arguments (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra` and `tanjun.errors.ParserError`),</span>
<span class="sd">            return `None` and may be either synchronous or asynchronous.</span>

<span class="sd">            It&#39;s worth noting that, unlike general error handlers, this will</span>
<span class="sd">            always suppress the error.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser_error_callbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_on_parser_error</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="n">callback</span> <span class="k">else</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_on_parser_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_on_parser_error</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">callback</span>

    <span class="k">def</span> <span class="nf">add_post_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_execution_callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_post_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the post-execution callback for this hook object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Optional[tanjun.abc.HookSig]</span>
<span class="sd">            The callback to set for this hook. This will remove any previously</span>
<span class="sd">            set callbacks.</span>

<span class="sd">            This callback should take one positional argument (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra`), return `None` and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_execution_callbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_post_execution</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="n">callback</span> <span class="k">else</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_post_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_post_execution</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">callback</span>

    <span class="k">def</span> <span class="nf">add_pre_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pre_execution_callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_pre_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the pre-execution callback for this hook object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Optional[tanjun.abc.HookSig]</span>
<span class="sd">            The callback to set for this hook. This will remove any previously</span>
<span class="sd">            set callbacks.</span>

<span class="sd">            This callback should take one positional argument (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra`), return `None` and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pre_execution_callbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_pre_execution</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="n">callback</span> <span class="k">else</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_pre_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_pre_execution</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">callback</span>

    <span class="k">def</span> <span class="nf">add_on_success</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_success_callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_on_success</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the success callback for this hook object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Optional[HookSig[tanjun.abc.HookSig]]</span>
<span class="sd">            The callback to set for this hook. This will remove any previously</span>
<span class="sd">            set callbacks.</span>

<span class="sd">            This callback should take one positional argument (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra`), return `None` and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_success_callbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_on_success</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="n">callback</span> <span class="k">else</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_on_success</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_on_success</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">callback</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">trigger_error</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">exception</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="n">level</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exception</span><span class="p">,</span> <span class="n">errors</span><span class="o">.</span><span class="n">ParserError</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser_error_callbacks</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
                    <span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser_error_callbacks</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">level</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># We don&#39;t want to re-raise a parser error if it was caught</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_error_callbacks</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
                <span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_error_callbacks</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">level</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">-</span> <span class="n">results</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hooks</span><span class="p">:</span>
            <span class="n">level</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">hook</span><span class="o">.</span><span class="n">trigger_error</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span> <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="n">hooks</span><span class="p">)))</span>

        <span class="k">return</span> <span class="n">level</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">trigger_post_execution</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_execution_callbacks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_execution_callbacks</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">hooks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">hook</span><span class="o">.</span><span class="n">trigger_post_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="n">hooks</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">trigger_pre_execution</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pre_execution_callbacks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pre_execution_callbacks</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">hooks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">hook</span><span class="o">.</span><span class="n">trigger_pre_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="n">hooks</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">trigger_success</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_success_callbacks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_success_callbacks</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">hooks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">hook</span><span class="o">.</span><span class="n">trigger_success</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="n">hooks</span><span class="p">))</span>


<span class="n">AnyHooks</span> <span class="o">=</span> <span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">]</span>
<span class="sd">&quot;&quot;&quot;Hooks that can be used with any context.</span>

<span class="sd">.. note::</span>
<span class="sd">    This is shorthand for Hooks[tanjun.abc.Context].</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">MessageHooks</span> <span class="o">=</span> <span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">]</span>
<span class="sd">&quot;&quot;&quot;Hooks that can be used with a message context.</span>

<span class="sd">.. note::</span>
<span class="sd">    This is shorthand for Hooks[tanjun.abc.MessageContext].</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">SlashHooks</span> <span class="o">=</span> <span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">]</span>
<span class="sd">&quot;&quot;&quot;Hooks that can be used with a slash context.</span>

<span class="sd">.. note::</span>
<span class="sd">    This is shorthand for Hooks[tanjun.abc.SlashContext].</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>

        </details>

            <div class="docstring"><p>Standard implementation of Tanjun's command execution hook models.</p>
</div>


                </section>
                <section id="AnyHooks">
                                <div class="attr variable"><a class="headerlink" href="#AnyHooks">#&nbsp;&nbsp</a>

        <span class="name">AnyHooks</span><span class="default_value"> = <a href="tanjun/hooks.html#Hooks">tanjun.hooks.Hooks</a>[<a href="tanjun/abc.html#Context">tanjun.abc.Context</a>]</span>
    </div>

    

                </section>
                <section id="Hooks">
                                <div class="attr class">
        <a class="headerlink" href="#Hooks">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">Hooks</span><wbr>(<span class="base"><a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks[-ContextT_contra]</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Hooks</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Standard implementation of `tanjun.abc.Hooks` used for command execution.</span>

<span class="sd">    `tanjun.abc.ContextT_contra` will either be `tanjun.abc.Context`,</span>
<span class="sd">    `tanjun.abc.MessageContext` or `tanjun.abc.SlashContext`.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This implementation adds a concept of parser errors which won&#39;t be</span>
<span class="sd">        dispatched to general &quot;error&quot; hooks and do not share the error</span>
<span class="sd">        suppression semantics as they favour to always suppress the error</span>
<span class="sd">        if a registered handler is found.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_error_callbacks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_parser_error_callbacks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_pre_execution_callbacks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_post_execution_callbacks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_success_callbacks&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_error_callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser_error_callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pre_execution_callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_execution_callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_success_callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">add_to_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">CommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add this hook object to a command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will likely override any previously added hooks.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        This method may be used as a command decorator:</span>

<span class="sd">        ```py</span>
<span class="sd">        @standard_hooks.add_to_command</span>
<span class="sd">        @as_message_command(&quot;command&quot;)</span>
<span class="sd">        async def command_command(ctx: tanjun.abc.Context) -&gt; None:</span>
<span class="sd">            await ctx.respond(&quot;You&#39;ve called a command!&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.ExecutableCommand[typing.Any]</span>
<span class="sd">            The command to add the hooks to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun.abc.ExecutableCommand[typing.Any]</span>
<span class="sd">            The command with the hooks added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">set_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">command</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Copy this hook object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># TODO: maybe don&#39;t</span>

    <span class="k">def</span> <span class="nf">add_on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ErrorHookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_error_callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ErrorHookSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the error callback for this hook object.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will not be called for `tanjun.errors.ParserError`s as these</span>
<span class="sd">            are generally speaking expected. To handle those see</span>
<span class="sd">            `Hooks.set_on_parser_error`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Optional[tanjun.abc.ErrorHookSig]</span>
<span class="sd">            The callback to set for this hook. This will remove any previously</span>
<span class="sd">            set callbacks.</span>

<span class="sd">            This callback should take two positional arguments (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra` and `Exception`) and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">            Returning `True` indicates that the error should be suppressed,</span>
<span class="sd">            `False` that it should be re-raised and `None` that no decision</span>
<span class="sd">            has been made. This will be accounted for along with the decisions</span>
<span class="sd">            other error hooks make by majority rule.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_error_callbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_on_error</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="n">callback</span> <span class="k">else</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ErrorHookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">ErrorHookSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_on_error</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">callback</span>

    <span class="k">def</span> <span class="nf">add_on_parser_error</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser_error_callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_on_parser_error</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the parser error callback for this hook object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Optional[tanjun.abc.HookSig]</span>
<span class="sd">            The callback to set for this hook. This will remove any previously</span>
<span class="sd">            set callbacks.</span>

<span class="sd">            This callback should take two positional arguments (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra` and `tanjun.errors.ParserError`),</span>
<span class="sd">            return `None` and may be either synchronous or asynchronous.</span>

<span class="sd">            It&#39;s worth noting that, unlike general error handlers, this will</span>
<span class="sd">            always suppress the error.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser_error_callbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_on_parser_error</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="n">callback</span> <span class="k">else</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_on_parser_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_on_parser_error</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">callback</span>

    <span class="k">def</span> <span class="nf">add_post_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_execution_callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_post_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the post-execution callback for this hook object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Optional[tanjun.abc.HookSig]</span>
<span class="sd">            The callback to set for this hook. This will remove any previously</span>
<span class="sd">            set callbacks.</span>

<span class="sd">            This callback should take one positional argument (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra`), return `None` and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_execution_callbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_post_execution</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="n">callback</span> <span class="k">else</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_post_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_post_execution</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">callback</span>

    <span class="k">def</span> <span class="nf">add_pre_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pre_execution_callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_pre_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the pre-execution callback for this hook object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Optional[tanjun.abc.HookSig]</span>
<span class="sd">            The callback to set for this hook. This will remove any previously</span>
<span class="sd">            set callbacks.</span>

<span class="sd">            This callback should take one positional argument (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra`), return `None` and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pre_execution_callbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_pre_execution</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="n">callback</span> <span class="k">else</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_pre_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_pre_execution</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">callback</span>

    <span class="k">def</span> <span class="nf">add_on_success</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_success_callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_on_success</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the success callback for this hook object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Optional[HookSig[tanjun.abc.HookSig]]</span>
<span class="sd">            The callback to set for this hook. This will remove any previously</span>
<span class="sd">            set callbacks.</span>

<span class="sd">            This callback should take one positional argument (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra`), return `None` and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_success_callbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_on_success</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="n">callback</span> <span class="k">else</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_on_success</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_on_success</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">callback</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">trigger_error</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">exception</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="n">level</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exception</span><span class="p">,</span> <span class="n">errors</span><span class="o">.</span><span class="n">ParserError</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser_error_callbacks</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
                    <span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser_error_callbacks</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">level</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># We don&#39;t want to re-raise a parser error if it was caught</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_error_callbacks</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
                <span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_error_callbacks</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">level</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">-</span> <span class="n">results</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hooks</span><span class="p">:</span>
            <span class="n">level</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">hook</span><span class="o">.</span><span class="n">trigger_error</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span> <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="n">hooks</span><span class="p">)))</span>

        <span class="k">return</span> <span class="n">level</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">trigger_post_execution</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_execution_callbacks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_execution_callbacks</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">hooks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">hook</span><span class="o">.</span><span class="n">trigger_post_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="n">hooks</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">trigger_pre_execution</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pre_execution_callbacks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pre_execution_callbacks</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">hooks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">hook</span><span class="o">.</span><span class="n">trigger_pre_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="n">hooks</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">trigger_success</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_success_callbacks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_success_callbacks</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">hooks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">hook</span><span class="o">.</span><span class="n">trigger_success</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="n">hooks</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Standard implementation of <code><a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a></code> used for command execution.</p>

<p><code><a href="tanjun/abc.html#ContextT_contra">tanjun.abc.ContextT_contra</a></code> will either be <code><a href="tanjun/abc.html#Context">tanjun.abc.Context</a></code>,
<code><a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a></code> or <code><a href="tanjun/abc.html#SlashContext">tanjun.abc.SlashContext</a></code>.</p>

<p><em>Note:</em>
This implementation adds a concept of parser errors which won't be
dispatched to general "error" hooks and do not share the error
suppression semantics as they favour to always suppress the error
if a registered handler is found.</p>
</div>


                            <div id="Hooks.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">Hooks</span><span class="signature">()</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_error_callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser_error_callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pre_execution_callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_execution_callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_success_callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Hooks.add_to_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.add_to_command">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_to_command</span><span class="signature">(self, command: ~CommandT, /) -&gt; ~CommandT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_to_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">CommandT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add this hook object to a command.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will likely override any previously added hooks.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        This method may be used as a command decorator:</span>

<span class="sd">        ```py</span>
<span class="sd">        @standard_hooks.add_to_command</span>
<span class="sd">        @as_message_command(&quot;command&quot;)</span>
<span class="sd">        async def command_command(ctx: tanjun.abc.Context) -&gt; None:</span>
<span class="sd">            await ctx.respond(&quot;You&#39;ve called a command!&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.ExecutableCommand[typing.Any]</span>
<span class="sd">            The command to add the hooks to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun.abc.ExecutableCommand[typing.Any]</span>
<span class="sd">            The command with the hooks added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">command</span><span class="o">.</span><span class="n">set_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">command</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add this hook object to a command.</p>

<p><em>Note:</em>
This will likely override any previously added hooks.</p>

<h6 id="examples">Examples</h6>

<p>This method may be used as a command decorator:</p>

<div class="codehilite"><pre><span></span><code><span class="nd">@standard_hooks</span><span class="o">.</span><span class="n">add_to_command</span>
<span class="nd">@as_message_command</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">command_command</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s2">&quot;You&#39;ve called a command!&quot;</span><span class="p">)</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (<a href="tanjun/abc.html#ExecutableCommand">tanjun.abc.ExecutableCommand</a>[typing.Any]):
The command to add the hooks to.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong><a href="tanjun/abc.html#ExecutableCommand">tanjun.abc.ExecutableCommand</a>[typing.Any]</strong>: The command with the hooks added.</li>
</ul>
</div>


                            </div>
                            <div id="Hooks.copy" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.copy">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">copy</span><span class="signature">(self: ~_HooksT) -&gt; ~_HooksT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Copy this hook object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># TODO: maybe don&#39;t</span>
</pre></div>

        </details>

            <div class="docstring"><p>Copy this hook object.</p>
</div>


                            </div>
                            <div id="Hooks.add_on_error" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.add_on_error">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_on_error</span><span class="signature">(
    self: ~_HooksT,
    callback: collections.abc.Callable[..., typing.Union[bool, NoneType, collections.abc.Awaitable[typing.Optional[bool]]]],
    /
) -&gt; ~_HooksT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ErrorHookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_error_callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add an error callback to this hook object.</p>

<p><em>Note:</em>
This won't be called for expected <code><a href="#TanjunError">tanjun.TanjunError</a></code> derived errors.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>callback</strong> (ErrorHookSig):
The callback to add to this hook.</p>

<p>This callback should take two positional arguments (of type
<code><a href="tanjun/abc.html#ContextT_contra">tanjun.abc.ContextT_contra</a></code> and <code>Exception</code>) and may be either
synchronous or asynchronous.</p>

<p>Returning <code>True</code> indicates that the error should be suppressed,
<code>False</code> that it should be re-raised and <code>None</code> that no decision has
been made. This will be accounted for along with the decisions
other error hooks make by majority rule.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The hook object to enable method chaining.</li>
</ul>
</div>


                            </div>
                            <div id="Hooks.set_on_error" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.set_on_error">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_on_error</span><span class="signature">(
    self: ~_HooksT,
    callback: Optional[collections.abc.Callable[..., Union[bool, NoneType, collections.abc.Awaitable[Optional[bool]]]]],
    /
) -&gt; ~_HooksT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ErrorHookSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the error callback for this hook object.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will not be called for `tanjun.errors.ParserError`s as these</span>
<span class="sd">            are generally speaking expected. To handle those see</span>
<span class="sd">            `Hooks.set_on_parser_error`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Optional[tanjun.abc.ErrorHookSig]</span>
<span class="sd">            The callback to set for this hook. This will remove any previously</span>
<span class="sd">            set callbacks.</span>

<span class="sd">            This callback should take two positional arguments (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra` and `Exception`) and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">            Returning `True` indicates that the error should be suppressed,</span>
<span class="sd">            `False` that it should be re-raised and `None` that no decision</span>
<span class="sd">            has been made. This will be accounted for along with the decisions</span>
<span class="sd">            other error hooks make by majority rule.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_error_callbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_on_error</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="n">callback</span> <span class="k">else</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the error callback for this hook object.</p>

<p><em>Note:</em>
This will not be called for <code><a href="tanjun/errors.html#ParserError">tanjun.errors.ParserError</a></code>s as these
are generally speaking expected. To handle those see
<code><a href="#Hooks.set_on_parser_error">Hooks.set_on_parser_error</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>callback</strong> (typing.Optional[<a href="tanjun/abc.html#ErrorHookSig">tanjun.abc.ErrorHookSig</a>]):
The callback to set for this hook. This will remove any previously
set callbacks.</p>

<p>This callback should take two positional arguments (of type
<code><a href="tanjun/abc.html#ContextT_contra">tanjun.abc.ContextT_contra</a></code> and <code>Exception</code>) and may be either
synchronous or asynchronous.</p>

<p>Returning <code>True</code> indicates that the error should be suppressed,
<code>False</code> that it should be re-raised and <code>None</code> that no decision
has been made. This will be accounted for along with the decisions
other error hooks make by majority rule.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The hook object to enable method chaining.</li>
</ul>
</div>


                            </div>
                            <div id="Hooks.with_on_error" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.with_on_error">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_on_error</span><span class="signature">(self, callback: ~ErrorHookSigT, /) -&gt; ~ErrorHookSigT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_on_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ErrorHookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">ErrorHookSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_on_error</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">callback</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add an error callback to this hook object through a decorator call.</p>

<p><em>Note:</em>
This won't be called for expected <code><a href="#TanjunError">tanjun.TanjunError</a></code> derived errors.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="n">hooks</span> <span class="o">=</span> <span class="n">AnyHooks</span><span class="p">()</span>

<span class="nd">@hooks</span><span class="o">.</span><span class="n">with_on_error</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">on_error</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">SomeExpectedType</span><span class="p">):</span>
        <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s2">&quot;You dun goofed&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># Indicating that it should be suppressed.</span>

    <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># Indicating that it should be re-raised</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>callback</strong> (ErrorHookSigT):
The callback to add to this hook.</p>

<p>This callback should take two positional arguments (of type
<code><a href="tanjun/abc.html#ContextT_contra">tanjun.abc.ContextT_contra</a></code> and <code>Exception</code>) and may be either
synchronous or asynchronous.</p>

<p>Returning <code>True</code> indicates that the error shoul be suppressed,
<code>False</code> that it should be re-raised and <code>None</code> that no decision
has been made. This will be accounted for along with the decisions
other error hooks make by majority rule.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ErrorHookSigT</strong>: The hook callback which was added.</li>
</ul>
</div>


                            </div>
                            <div id="Hooks.add_on_parser_error" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.add_on_parser_error">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_on_parser_error</span><span class="signature">(
    self: ~_HooksT,
    callback: collections.abc.Callable[..., typing.Optional[collections.abc.Awaitable[NoneType]]],
    /
) -&gt; ~_HooksT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_on_parser_error</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser_error_callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a parser error callback to this hook object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>callback</strong> (HookSig):
The callback to add to this hook.</p>

<p>This callback should take two positional arguments (of type
<code><a href="tanjun/abc.html#ContextT_contra">tanjun.abc.ContextT_contra</a></code> and <code><a href="tanjun/errors.html#ParserError">tanjun.errors.ParserError</a></code>),
return <code>None</code> and may be either synchronous or asynchronous.</p>

<p>It's worth noting that this unlike general error handlers, this will
always suppress the error.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The hook object to enable method chaining.</li>
</ul>
</div>


                            </div>
                            <div id="Hooks.set_on_parser_error" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.set_on_parser_error">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_on_parser_error</span><span class="signature">(
    self: ~_HooksT,
    callback: Optional[collections.abc.Callable[..., Optional[collections.abc.Awaitable[NoneType]]]],
    /
) -&gt; ~_HooksT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_on_parser_error</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the parser error callback for this hook object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Optional[tanjun.abc.HookSig]</span>
<span class="sd">            The callback to set for this hook. This will remove any previously</span>
<span class="sd">            set callbacks.</span>

<span class="sd">            This callback should take two positional arguments (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra` and `tanjun.errors.ParserError`),</span>
<span class="sd">            return `None` and may be either synchronous or asynchronous.</span>

<span class="sd">            It&#39;s worth noting that, unlike general error handlers, this will</span>
<span class="sd">            always suppress the error.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parser_error_callbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_on_parser_error</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="n">callback</span> <span class="k">else</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the parser error callback for this hook object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>callback</strong> (typing.Optional[<a href="tanjun/abc.html#HookSig">tanjun.abc.HookSig</a>]):
The callback to set for this hook. This will remove any previously
set callbacks.</p>

<p>This callback should take two positional arguments (of type
<code><a href="tanjun/abc.html#ContextT_contra">tanjun.abc.ContextT_contra</a></code> and <code><a href="tanjun/errors.html#ParserError">tanjun.errors.ParserError</a></code>),
return <code>None</code> and may be either synchronous or asynchronous.</p>

<p>It's worth noting that, unlike general error handlers, this will
always suppress the error.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The hook object to enable method chaining.</li>
</ul>
</div>


                            </div>
                            <div id="Hooks.with_on_parser_error" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.with_on_parser_error">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_on_parser_error</span><span class="signature">(self, callback: ~HookSigT, /) -&gt; ~HookSigT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_on_parser_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_on_parser_error</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">callback</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a parser error callback to this hook object through a decorator call.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="n">hooks</span> <span class="o">=</span> <span class="n">AnyHooks</span><span class="p">()</span>

<span class="nd">@hooks</span><span class="o">.</span><span class="n">with_on_parser_error</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">on_parser_error</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">ParserError</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You gave invalid input: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>callback</strong> (HookSigT):
The parser error callback to add to this hook.</p>

<p>This callback should take two positional arguments (of type
<code><a href="tanjun/abc.html#ContextT_contra">tanjun.abc.ContextT_contra</a></code> and <code><a href="tanjun/errors.html#ParserError">tanjun.errors.ParserError</a></code>),
return <code>None</code> and may be either synchronous or asynchronous.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>HookSigT</strong>: The callback which was added.</li>
</ul>
</div>


                            </div>
                            <div id="Hooks.add_post_execution" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.add_post_execution">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_post_execution</span><span class="signature">(
    self: ~_HooksT,
    callback: collections.abc.Callable[..., typing.Optional[collections.abc.Awaitable[NoneType]]],
    /
) -&gt; ~_HooksT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_post_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_execution_callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a post-execution callback to this hook object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>callback</strong> (HookSig):
The callback to add to this hook.</p>

<p>This callback should take one positional argument (of type
<code><a href="tanjun/abc.html#ContextT_contra">tanjun.abc.ContextT_contra</a></code>), return <code>None</code> and may be either
synchronous or asynchronous.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The hook object to enable method chaining.</li>
</ul>
</div>


                            </div>
                            <div id="Hooks.set_post_execution" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.set_post_execution">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_post_execution</span><span class="signature">(
    self: ~_HooksT,
    callback: Optional[collections.abc.Callable[..., Optional[collections.abc.Awaitable[NoneType]]]],
    /
) -&gt; ~_HooksT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_post_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the post-execution callback for this hook object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Optional[tanjun.abc.HookSig]</span>
<span class="sd">            The callback to set for this hook. This will remove any previously</span>
<span class="sd">            set callbacks.</span>

<span class="sd">            This callback should take one positional argument (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra`), return `None` and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_execution_callbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_post_execution</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="n">callback</span> <span class="k">else</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the post-execution callback for this hook object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>callback</strong> (typing.Optional[<a href="tanjun/abc.html#HookSig">tanjun.abc.HookSig</a>]):
The callback to set for this hook. This will remove any previously
set callbacks.</p>

<p>This callback should take one positional argument (of type
<code><a href="tanjun/abc.html#ContextT_contra">tanjun.abc.ContextT_contra</a></code>), return <code>None</code> and may be either
synchronous or asynchronous.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The hook object to enable method chaining.</li>
</ul>
</div>


                            </div>
                            <div id="Hooks.with_post_execution" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.with_post_execution">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_post_execution</span><span class="signature">(self, callback: ~HookSigT, /) -&gt; ~HookSigT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_post_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_post_execution</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">callback</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a post-execution callback to this hook object through a decorator call.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="n">hooks</span> <span class="o">=</span> <span class="n">AnyHooks</span><span class="p">()</span>

<span class="nd">@hooks</span><span class="o">.</span><span class="n">with_post_execution</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">post_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s2">&quot;You did something&quot;</span><span class="p">)</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>callback</strong> (HookSigT):
The post-execution callback to add to this hook.</p>

<p>This callback should take one positional argument (of type
<code><a href="tanjun/abc.html#ContextT_contra">tanjun.abc.ContextT_contra</a></code>), return <code>None</code> and may be either
synchronous or asynchronous.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>HookSigT</strong>: The post-execution callback which was seaddedt.</li>
</ul>
</div>


                            </div>
                            <div id="Hooks.add_pre_execution" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.add_pre_execution">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_pre_execution</span><span class="signature">(
    self: ~_HooksT,
    callback: collections.abc.Callable[..., typing.Optional[collections.abc.Awaitable[NoneType]]],
    /
) -&gt; ~_HooksT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_pre_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pre_execution_callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a pre-execution callback for this hook object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>callback</strong> (HookSig):
The callback to add to this hook.</p>

<p>This callback should take one positional argument (of type
<code><a href="tanjun/abc.html#ContextT_contra">tanjun.abc.ContextT_contra</a></code>), return <code>None</code> and may be either
synchronous or asynchronous.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The hook object to enable method chaining.</li>
</ul>
</div>


                            </div>
                            <div id="Hooks.set_pre_execution" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.set_pre_execution">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_pre_execution</span><span class="signature">(
    self: ~_HooksT,
    callback: Optional[collections.abc.Callable[..., Optional[collections.abc.Awaitable[NoneType]]]],
    /
) -&gt; ~_HooksT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_pre_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the pre-execution callback for this hook object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Optional[tanjun.abc.HookSig]</span>
<span class="sd">            The callback to set for this hook. This will remove any previously</span>
<span class="sd">            set callbacks.</span>

<span class="sd">            This callback should take one positional argument (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra`), return `None` and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pre_execution_callbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_pre_execution</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="n">callback</span> <span class="k">else</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the pre-execution callback for this hook object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>callback</strong> (typing.Optional[<a href="tanjun/abc.html#HookSig">tanjun.abc.HookSig</a>]):
The callback to set for this hook. This will remove any previously
set callbacks.</p>

<p>This callback should take one positional argument (of type
<code><a href="tanjun/abc.html#ContextT_contra">tanjun.abc.ContextT_contra</a></code>), return <code>None</code> and may be either
synchronous or asynchronous.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The hook object to enable method chaining.</li>
</ul>
</div>


                            </div>
                            <div id="Hooks.with_pre_execution" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.with_pre_execution">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_pre_execution</span><span class="signature">(self, callback: ~HookSigT, /) -&gt; ~HookSigT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_pre_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_pre_execution</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">callback</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a pre-execution callback to this hook object through a decorator call.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="n">hooks</span> <span class="o">=</span> <span class="n">AnyHooks</span><span class="p">()</span>

<span class="nd">@hooks</span><span class="o">.</span><span class="n">with_pre_execution</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">pre_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s2">&quot;You did something&quot;</span><span class="p">)</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>callback</strong> (HookSigT):
The pre-execution callback to add to this hook.</p>

<p>This callback should take one positional argument (of type
<code><a href="tanjun/abc.html#ContextT_contra">tanjun.abc.ContextT_contra</a></code>), return <code>None</code> and may be either
synchronous or asynchronous.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>HookSigT</strong>: The pre-execution callback which was added.</li>
</ul>
</div>


                            </div>
                            <div id="Hooks.add_on_success" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.add_on_success">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_on_success</span><span class="signature">(
    self: ~_HooksT,
    callback: collections.abc.Callable[..., typing.Optional[collections.abc.Awaitable[NoneType]]],
    /
) -&gt; ~_HooksT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_on_success</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_success_callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a success callback to this hook object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>callback</strong> (HookSig):
The callback to add to this hook.</p>

<p>This callback should take one positional argument (of type
<code><a href="tanjun/abc.html#ContextT_contra">tanjun.abc.ContextT_contra</a></code>), return <code>None</code> and may be either
synchronous or asynchronous.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The hook object to enable method chaining.</li>
</ul>
</div>


                            </div>
                            <div id="Hooks.set_on_success" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.set_on_success">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_on_success</span><span class="signature">(
    self: ~_HooksT,
    callback: Optional[collections.abc.Callable[..., Optional[collections.abc.Awaitable[NoneType]]]],
    /
) -&gt; ~_HooksT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_on_success</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_HooksT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">HookSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_HooksT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the success callback for this hook object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : typing.Optional[HookSig[tanjun.abc.HookSig]]</span>
<span class="sd">            The callback to set for this hook. This will remove any previously</span>
<span class="sd">            set callbacks.</span>

<span class="sd">            This callback should take one positional argument (of type</span>
<span class="sd">            `tanjun.abc.ContextT_contra`), return `None` and may be either</span>
<span class="sd">            synchronous or asynchronous.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The hook object to enable method chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_success_callbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_on_success</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">if</span> <span class="n">callback</span> <span class="k">else</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the success callback for this hook object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>callback</strong> (typing.Optional[HookSig[<a href="tanjun/abc.html#HookSig">tanjun.abc.HookSig</a>]]):
The callback to set for this hook. This will remove any previously
set callbacks.</p>

<p>This callback should take one positional argument (of type
<code><a href="tanjun/abc.html#ContextT_contra">tanjun.abc.ContextT_contra</a></code>), return <code>None</code> and may be either
synchronous or asynchronous.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The hook object to enable method chaining.</li>
</ul>
</div>


                            </div>
                            <div id="Hooks.with_on_success" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.with_on_success">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_on_success</span><span class="signature">(self, callback: ~HookSigT, /) -&gt; ~HookSigT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_on_success</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abc</span><span class="o">.</span><span class="n">HookSigT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_on_success</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">callback</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a success callback to this hook object through a decorator call.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="n">hooks</span> <span class="o">=</span> <span class="n">AnyHooks</span><span class="p">()</span>

<span class="nd">@hooks</span><span class="o">.</span><span class="n">with_on_success</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">on_success</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s2">&quot;You did something&quot;</span><span class="p">)</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>callback</strong> (HookSigT):
The success callback to add to this hook.</p>

<p>This callback should take one positional argument (of type
<code><a href="tanjun/abc.html#ContextT_contra">tanjun.abc.ContextT_contra</a></code>), return <code>None</code> and may be either
synchronous or asynchronous.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>HookSigT</strong>: The success callback which was added.</li>
</ul>
</div>


                            </div>
                            <div id="Hooks.trigger_error" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.trigger_error">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">trigger_error</span><span class="signature">(
    self,
    ctx: -ContextT_contra,
    /,
    exception: Exception,
    *,
    hooks: Optional[collections.abc.Set[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[-ContextT_contra]]] = None
) -&gt; int</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">trigger_error</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">exception</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="n">level</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exception</span><span class="p">,</span> <span class="n">errors</span><span class="o">.</span><span class="n">ParserError</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser_error_callbacks</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
                    <span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parser_error_callbacks</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">level</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># We don&#39;t want to re-raise a parser error if it was caught</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_error_callbacks</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
                <span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_error_callbacks</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">level</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">-</span> <span class="n">results</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hooks</span><span class="p">:</span>
            <span class="n">level</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">hook</span><span class="o">.</span><span class="n">trigger_error</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span> <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="n">hooks</span><span class="p">)))</span>

        <span class="k">return</span> <span class="n">level</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Hooks.trigger_post_execution" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.trigger_post_execution">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">trigger_post_execution</span><span class="signature">(
    self,
    ctx: -ContextT_contra,
    /,
    *,
    hooks: Optional[collections.abc.Set[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[-ContextT_contra]]] = None
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">trigger_post_execution</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_execution_callbacks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_execution_callbacks</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">hooks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">hook</span><span class="o">.</span><span class="n">trigger_post_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="n">hooks</span><span class="p">))</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Hooks.trigger_pre_execution" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.trigger_pre_execution">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">trigger_pre_execution</span><span class="signature">(
    self,
    ctx: -ContextT_contra,
    /,
    *,
    hooks: Optional[collections.abc.Set[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[-ContextT_contra]]] = None
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">trigger_pre_execution</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pre_execution_callbacks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pre_execution_callbacks</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">hooks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">hook</span><span class="o">.</span><span class="n">trigger_pre_execution</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="n">hooks</span><span class="p">))</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Hooks.trigger_success" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Hooks.trigger_success">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">trigger_success</span><span class="signature">(
    self,
    ctx: -ContextT_contra,
    /,
    *,
    hooks: Optional[collections.abc.Set[<a href="tanjun/abc.html#Hooks">tanjun.abc.Hooks</a>[-ContextT_contra]]] = None
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">trigger_success</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Hooks</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">ContextT_contra</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Hooks&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_success_callbacks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_success_callbacks</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">hooks</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">hook</span><span class="o">.</span><span class="n">trigger_success</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="n">hooks</span><span class="p">))</span>
</pre></div>

        </details>

    

                            </div>
                </section>
                <section id="MessageHooks">
                                <div class="attr variable"><a class="headerlink" href="#MessageHooks">#&nbsp;&nbsp</a>

        <span class="name">MessageHooks</span><span class="default_value"> = <a href="tanjun/hooks.html#Hooks">tanjun.hooks.Hooks</a>[<a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a>]</span>
    </div>

    

                </section>
                <section id="SlashHooks">
                                <div class="attr variable"><a class="headerlink" href="#SlashHooks">#&nbsp;&nbsp</a>

        <span class="name">SlashHooks</span><span class="default_value"> = <a href="tanjun/hooks.html#Hooks">tanjun.hooks.Hooks</a>[<a href="tanjun/abc.html#SlashContext">tanjun.abc.SlashContext</a>]</span>
    </div>

    

                </section>
                <section id="injecting">
                                <div class="attr module"><a class="headerlink" href="#injecting">#&nbsp;&nbsp</a>
<span class="name"><a href="tanjun/injecting.html">tanjun.injecting</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;Logic and data classes used within the standard Tanjun implementation to enable dependency injection.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;AbstractInjectionContext&quot;</span><span class="p">,</span>
    <span class="s2">&quot;as_self_injecting&quot;</span><span class="p">,</span>
    <span class="s2">&quot;BasicInjectionContext&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CallbackDescriptor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Descriptor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CallbackSig&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Undefined&quot;</span><span class="p">,</span>
    <span class="s2">&quot;UNDEFINED&quot;</span><span class="p">,</span>
    <span class="s2">&quot;UndefinedOr&quot;</span><span class="p">,</span>
    <span class="s2">&quot;inject&quot;</span><span class="p">,</span>
    <span class="s2">&quot;injected&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Injected&quot;</span><span class="p">,</span>
    <span class="s2">&quot;InjectorClient&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SelfInjectingCallback&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TypeDescriptor&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">collections.abc</span> <span class="k">as</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">tanjun_abc</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">errors</span>

<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="n">_BasicInjectionContextT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_BasicInjectionContextT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;BasicInjectionContext&quot;</span><span class="p">)</span>
    <span class="n">_CallbackDescriptorT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_CallbackDescriptorT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;CallbackDescriptor[typing.Any]&quot;</span><span class="p">)</span>
    <span class="n">_InjectorClientT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_InjectorClientT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;InjectorClient&quot;</span><span class="p">)</span>

<span class="n">_T</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_T&quot;</span><span class="p">)</span>
<span class="n">CallbackSig</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MaybeAwaitableT</span><span class="p">[</span><span class="n">_T</span><span class="p">]]</span>
<span class="sd">&quot;&quot;&quot;Type-hint of a injector callback.</span>

<span class="sd">.. note::</span>
<span class="sd">    Dependency dependency injection is recursively supported, meaning that the</span>
<span class="sd">    keyword arguments for a dependency callback may also ask for dependencies</span>
<span class="sd">    themselves.</span>

<span class="sd">This may either be a synchronous or asynchronous function with dependency</span>
<span class="sd">injection being available for the callback&#39;s keyword arguments but dynamically</span>
<span class="sd">returning either an awaitable or raw value may lead to errors.</span>

<span class="sd">Dependent on the context positional arguments may also be proivded.</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">Undefined</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class/type of `UNDEFINED`.&quot;&quot;&quot;</span>

    <span class="n">__instance</span><span class="p">:</span> <span class="n">Undefined</span>

    <span class="k">def</span> <span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Undefined</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__instance</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">new</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">Undefined</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">__instance</span> <span class="o">=</span> <span class="n">new</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__instance</span>


<span class="n">UNDEFINED</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">Undefined</span><span class="p">]</span> <span class="o">=</span> <span class="n">Undefined</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;Singleton value used within dependency injection to indicate that a value is undefined.&quot;&quot;&quot;</span>
<span class="n">UndefinedOr</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Undefined</span><span class="p">,</span> <span class="n">_T</span><span class="p">]</span>
<span class="sd">&quot;&quot;&quot;Type-hint generic union used to indicate that a value may be undefined or `_T`.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">AbstractInjectionContext</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Abstract interface of an injection context.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">injection_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InjectorClient</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Injection client this context is bound to.&quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">cache_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="n">value</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Cache the result of a callback within the scope of this context.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : CallbackSig[_T]</span>
<span class="sd">            The callback to cache the result of.</span>
<span class="sd">        value : _T</span>
<span class="sd">            The value to cache.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_cached_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">UndefinedOr</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the cached result of a callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : CallbackSig[_T]</span>
<span class="sd">            The callback to get the cached result of.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        UndefinedOr[_T]</span>
<span class="sd">            The cached result of the callback, or `UNDEFINED` if the callback</span>
<span class="sd">            has not been cached within this context.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_type_special_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">UndefinedOr</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get a special-case value for a type.</span>

<span class="sd">        .. note:</span>
<span class="sd">            Client set types should override this.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        type_ : type[_T]</span>
<span class="sd">            The type to get a special-case value for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        UndefinedOr[_T]</span>
<span class="sd">            The special-case value, or `UNDEFINED` if the type is not supported</span>
<span class="sd">            by this context.</span>
<span class="sd">        &quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">BasicInjectionContext</span><span class="p">(</span><span class="n">AbstractInjectionContext</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Basic implementation of a `AbstractInjectionContext`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    client : InjectorClient</span>
<span class="sd">        The injection client this context is bound to.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_injection_client&quot;</span><span class="p">,</span> <span class="s2">&quot;_result_cache&quot;</span><span class="p">,</span> <span class="s2">&quot;_special_case_types&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">InjectorClient</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_injection_client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_result_cache</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="n">CallbackSig</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_special_case_types</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">AbstractInjectionContext</span><span class="p">:</span> <span class="bp">self</span><span class="p">,</span>
            <span class="n">BasicInjectionContext</span><span class="p">:</span> <span class="bp">self</span><span class="p">,</span>
            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="bp">self</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">injection_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InjectorClient</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.injecting.AbstractInjectionContext&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_injection_client</span>

    <span class="k">def</span> <span class="nf">cache_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="n">value</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.injecting.AbstractInjectionContext&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result_cache</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_result_cache</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_result_cache</span><span class="p">[</span><span class="n">callback</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">get_cached_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">UndefinedOr</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.injecting.AbstractInjectionContext&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result_cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">UNDEFINED</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result_cache</span> <span class="k">else</span> <span class="n">UNDEFINED</span>

    <span class="k">def</span> <span class="nf">get_type_special_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">UndefinedOr</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.injecting.AbstractInjectionContext&gt;&gt;.</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_special_case_types</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="n">UNDEFINED</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>

        <span class="k">return</span> <span class="n">UNDEFINED</span>

    <span class="k">def</span> <span class="nf">_set_type_special_case</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_BasicInjectionContextT</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="n">value</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_BasicInjectionContextT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_special_case_types</span><span class="p">[</span><span class="n">type_</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">_remove_type_special_case</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_BasicInjectionContextT</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_BasicInjectionContextT</span><span class="p">:</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_special_case_types</span><span class="p">[</span><span class="n">type_</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>


<span class="k">class</span> <span class="nc">CallbackDescriptor</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">_T</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Descriptor of a callback taking advantage of dependency injection.</span>

<span class="sd">    This holds metadata and logic necessary for callback injection.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    callback : CallbackSig[_T]</span>
<span class="sd">        The callback to wrap with dependency injection.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If `callback` has any injected arguments which can only be passed</span>
<span class="sd">        positionally.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_callback&quot;</span><span class="p">,</span> <span class="s2">&quot;_descriptors&quot;</span><span class="p">,</span> <span class="s2">&quot;_is_async&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_async</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_descriptors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_descriptors</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>

    <span class="c1"># This is delegated to the callback in-order to delegate set/list behaviour for this class to the callback.</span>
    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">==</span> <span class="n">other</span><span class="p">)</span>

    <span class="c1"># This is delegated to the callback in-order to delegate set/list behaviour for this class to the callback.</span>
    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;The descriptor&#39;s callback.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">needs_injector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether the descriptor&#39;s callback requires a dependency injection client to be resolved.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_descriptors</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_parse_descriptors</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Descriptor</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># If we can&#39;t inspect it then we have to assume this is a NO</span>
            <span class="c1"># As a note, this fails on some &quot;signature-less&quot; builtin functions/types like str.</span>
            <span class="k">return</span> <span class="p">{}</span>

        <span class="n">descriptors</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Descriptor</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">parameter</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="n">parameter</span><span class="o">.</span><span class="n">empty</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameter</span><span class="o">.</span><span class="n">default</span><span class="p">,</span> <span class="n">Injected</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">parameter</span><span class="o">.</span><span class="n">kind</span> <span class="ow">is</span> <span class="n">parameter</span><span class="o">.</span><span class="n">POSITIONAL_ONLY</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Injected positional only arguments are not supported&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">parameter</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">descriptors</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">Descriptor</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="n">parameter</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">parameter</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="n">descriptors</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">Descriptor</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">parameter</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">descriptors</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_CallbackDescriptorT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_CallbackDescriptorT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a copy of this descriptor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        CallbackDescriptor[_T]</span>
<span class="sd">            A copy of this descriptor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">overwrite_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Overwrite the callback of this descriptor.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback : CallbackSig[_T]</span>
<span class="sd">            The new callback to overwrite with.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If `callback` has any injected arguments which can only be passed</span>
<span class="sd">            positionally.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_async</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_descriptors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_descriptors</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">resolve_with_command_context</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Try to resolve the callback with the given command context.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ctx : tanjun.abc.Context</span>
<span class="sd">            The context to resolve the callback with.</span>
<span class="sd">        *args : typing.Any</span>
<span class="sd">            The positional arguments to pass to the callback.</span>
<span class="sd">        **kwargs : typing.Any</span>
<span class="sd">            The keyword arguments to pass to the callback.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        _T</span>
<span class="sd">            The callback&#39;s result.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the callback needs a dependency injection client but the</span>
<span class="sd">            context does not have one.</span>
<span class="sd">        tanjun.errors.MissingDependencyError</span>
<span class="sd">            If the callback needs an injected type which isn&#39;t present in the</span>
<span class="sd">            context or client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">needs_injector</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">AbstractInjectionContext</span><span class="p">):</span>
                <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_without_injector</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">resolve_without_injector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Try to resolve the callback without a dependency injection client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args : typing.Any</span>
<span class="sd">            The positional arguments to pass to the callback.</span>
<span class="sd">        **kwargs : typing.Any</span>
<span class="sd">            The keyword arguments to pass to the callback.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        _T</span>
<span class="sd">            The callback&#39;s result.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the callback needs a dependency injection client present.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">needs_injector</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This callback cannot be called without dependency injection&quot;</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_async</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_async</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_async</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">_T</span><span class="p">,</span> <span class="k">await</span> <span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">_T</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">AbstractInjectionContext</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Resolve the callback with the given dependency injection context.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ctx : AbstractInjectionContext</span>
<span class="sd">            The context to resolve the callback with.</span>
<span class="sd">        *args : typing.Any</span>
<span class="sd">            The positional arguments to pass to the callback.</span>
<span class="sd">        **kwargs : typing.Any</span>
<span class="sd">            The keyword arguments to pass to the callback.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        _T</span>
<span class="sd">            The callback&#39;s result.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        tanjun.errors.MissingDependencyError</span>
<span class="sd">            If the callback needs an injected type which isn&#39;t present in the</span>
<span class="sd">            context or client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">override</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">injection_client</span><span class="o">.</span><span class="n">get_callback_override</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">):</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">override</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_cached_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Undefined</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">needs_injector</span><span class="p">:</span>
            <span class="n">sub_results</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="k">await</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">descriptor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descriptors</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">sub_results</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_async</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_is_async</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_async</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">result</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_without_injector</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># TODO: should we avoid caching the result if args/kwargs are passed?</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">cache_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">_T</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">SelfInjectingCallback</span><span class="p">(</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="n">_T</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Class used to make a callback self-injecting by linking it to a client.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    async def callback(database: Database = tanjun.inject(type=Database)) -&gt; None:</span>
<span class="sd">        await database.do_something()</span>

<span class="sd">    ...</span>

<span class="sd">    client = tanjun.Client.from_gateway_bot(bot)</span>
<span class="sd">    injecting_callback = tanjun.SelfInjectingCallback(callback, client)</span>
<span class="sd">    await injecting_callback()</span>
<span class="sd">    ```</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    injector : InjectorClient</span>
<span class="sd">        The injection client to use to resolve dependencies.</span>
<span class="sd">    callback : CallbackSig[_T]</span>
<span class="sd">        The callback to make self-injecting.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If `callback` has any injected arguments which can only be passed</span>
<span class="sd">        positionally.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_client&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">injector_client</span><span class="p">:</span> <span class="n">InjectorClient</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="n">injector_client</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call this callback with the provided arguments + injected arguments.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args : typing.Any</span>
<span class="sd">            The positional arguments to pass to the callback.</span>
<span class="sd">        **kwargs : typing.Any</span>
<span class="sd">            The keyword arguments to pass to the callback.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        _T</span>
<span class="sd">            The callback&#39;s result.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="n">BasicInjectionContext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">as_self_injecting</span><span class="p">(</span>
    <span class="n">injector_client</span><span class="p">:</span> <span class="n">InjectorClient</span><span class="p">,</span> <span class="o">/</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">]],</span> <span class="n">SelfInjectingCallback</span><span class="p">[</span><span class="n">_T</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Make a callback self-inecting by linking it to a client through a decorator call.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    def make_callback(client: tanjun.Client) -&gt; typing.Callable[[], int]:</span>
<span class="sd">        @tanjun.as_self_injected(client)</span>
<span class="sd">        async def get_int_value(</span>
<span class="sd">            redis: redis.Client = tanjun.inject(type=redis.Client)</span>
<span class="sd">        ) -&gt; int:</span>
<span class="sd">            return int(await redis.get(&#39;key&#39;))</span>

<span class="sd">        return get_int_value</span>
<span class="sd">    ```</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    injector_client : InjectorClient</span>
<span class="sd">        The injection client to use to resolve dependencies.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[CallbackSig[_T]], SelfInjectingCallback[_T]]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SelfInjectingCallback</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">SelfInjectingCallback</span><span class="p">(</span><span class="n">injector_client</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">decorator</span>


<span class="k">class</span> <span class="nc">TypeDescriptor</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">_T</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Descriptor of an injected type.</span>

<span class="sd">    This class holds all the logic for resolving a type with dependency</span>
<span class="sd">    injection.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    type_ : type[_T]</span>
<span class="sd">        The type to resolve.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_type&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="n">_TypeT</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">type_</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_TypeT</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;The type being injected.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>  <span class="c1"># type: ignore  # pyright bug?</span>

    <span class="k">def</span> <span class="nf">resolve_with_command_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Try to resolve the type with the given command context.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ctx : tanjun.abc.Context</span>
<span class="sd">            The context to resolve the type with.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        _T</span>
<span class="sd">            The injected implementation of the type.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the command context does not have a dependency injection client.</span>
<span class="sd">        tanjun.errors.MissingDependencyError</span>
<span class="sd">            If the client does not have an implementation of the type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">AbstractInjectionContext</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Type injector cannot be resolved without anm injection client&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">AbstractInjectionContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Resolve the type with the given dependency injection context.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ctx : AbstractInjectionContext</span>
<span class="sd">            The context to resolve the type with.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        _T</span>
<span class="sd">            The injected implementation of the type.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        tanjun.errors.MissingDependencyError</span>
<span class="sd">            If the client does not have an implementation of the type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">injection_client</span><span class="o">.</span><span class="n">get_type_dependency</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Undefined</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">:=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_type_special_case</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">UNDEFINED</span><span class="p">:</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Undefined</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">MissingDependencyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Couldn&#39;t resolve injected type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="si">}</span><span class="s2"> to actual value&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>


<span class="k">class</span> <span class="nc">Descriptor</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">_T</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Descriptor of an injected type or callback.</span>

<span class="sd">    This class holds all the logic for resolving a type or callback with</span>
<span class="sd">    dependency injection.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    type_ : typing.Optional[type[_T]]</span>
<span class="sd">        The type to resolve.</span>
<span class="sd">    callback : typing.Optional[CallbackSig[_T]]</span>
<span class="sd">        The callback to resolve.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If `callback` has any injected arguments which can only be passed</span>
<span class="sd">        positionally.</span>
<span class="sd">        If both `type_` and `callback` are given.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_callback&quot;</span><span class="p">,</span> <span class="s2">&quot;_type&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="nb">type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_TypeT</span><span class="p">[</span><span class="n">_T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa A002</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">callback</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either callback or type must be specified&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="n">_T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">TypeDescriptor</span><span class="p">[</span><span class="n">_T</span><span class="p">]]</span> <span class="o">=</span> <span class="n">TypeDescriptor</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="nb">type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only one of type or callback should be passed&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;The callback being injected if this is an injected callback.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">callback</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">needs_injector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether this injector will only run with dependency injection.&quot;&quot;&quot;</span>
        <span class="c1"># Type injectors always need the injector as of present</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">needs_injector</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="k">else</span> <span class="kc">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_TypeT</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;The type being injected if this is an injected type.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="o">.</span><span class="n">type</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">resolve_with_command_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Try to resolve the type or callback with the given command context.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ctx : tanjun.abc.Context</span>
<span class="sd">            The context to resolve the type or callback with.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        _T</span>
<span class="sd">            The result to be injected.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the command context does not have a dependency injection client when</span>
<span class="sd">            dependency injection is required.</span>
<span class="sd">        tanjun.errors.MissingDependencyError</span>
<span class="sd">            If the client does not have an implementation of the type dependency.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">resolve_without_injector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Try to resolve this type or callback without dependency injection.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        _T</span>
<span class="sd">            The result to be injected.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If dependency injection is required.</span>
<span class="sd">        tanjun.errors.MissingDependencyError</span>
<span class="sd">            If the client does not have an implementation of the type dependency.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Type injector cannot be resolved without an injector present&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">resolve_without_injector</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">AbstractInjectionContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Resolve the type or callback with the given dependency injection context.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ctx : tanjun.abc.AbstractInjectionContext</span>
<span class="sd">            The context to resolve the type or callback with.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        _T</span>
<span class="sd">            The result to be injected.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        tanjun.errors.MissingDependencyError</span>
<span class="sd">            If the client does not have an implementation of the type dependency.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>


<span class="n">_TypeT</span> <span class="o">=</span> <span class="nb">type</span><span class="p">[</span><span class="n">_T</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">Injected</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">_T</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Decare a keyword-argument as requiring an injected dependency.</span>

<span class="sd">    This is the type returned by `inject`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    callback : typing.Optional[CallbackSig[_T]]</span>
<span class="sd">        The callback to use to resolve the dependency.</span>

<span class="sd">        If this callback has no type dependencies then this will still work</span>
<span class="sd">        without an injection context but this can be overridden using</span>
<span class="sd">        `InjectionClient.set_callback_override`.</span>
<span class="sd">    type : typing.Optional[type[_T]]</span>
<span class="sd">        The type of the dependency to resolve.</span>

<span class="sd">        Unlike `callback`, `type` is resolved using the injection client and</span>
<span class="sd">        therefore requires that dependency injection is implemented on a context</span>
<span class="sd">        level.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If both `callback` and `type` are specified or if neither is specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;callback&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="nb">type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_TypeT</span><span class="p">[</span><span class="n">_T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa: A002</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># TODO: add default/factory to this?</span>
        <span class="k">if</span> <span class="n">callback</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must specify one of `callback` or `type`&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only one of `callback` or `type` can be specified&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">callback</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>


<span class="k">def</span> <span class="nf">inject</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_TypeT</span><span class="p">[</span><span class="n">_T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa: A002</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Injected</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Decare a keyword-argument as requiring an injected dependency.</span>

<span class="sd">    This should be assigned to an arugment&#39;s default value.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @tanjun.as_slash_command(&quot;name&quot;, &quot;description&quot;)</span>
<span class="sd">    async def command_callback(</span>
<span class="sd">        ctx: tanjun.abc.Context,</span>
<span class="sd">        # Here we take advantage of scope based special casing which allows</span>
<span class="sd">        # us to inject the `Component` type.</span>
<span class="sd">        injected_type: tanjun.abc.Component = tanjun.inject(type=tanjun.abc.Component)</span>
<span class="sd">        # Here we inject an out-of-scope callback which itself is taking</span>
<span class="sd">        # advantage of type injection.</span>
<span class="sd">        callback_result: ResultT = tanjun.inject(callback=injected_callback)</span>
<span class="sd">    ) -&gt; None:</span>
<span class="sd">        raise NotImplementedError</span>
<span class="sd">    ```</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    callback : typing.Optional[CallbackSig[_T]]</span>
<span class="sd">        The callback to use to resolve the dependency.</span>

<span class="sd">        If this callback has no type dependencies then this will still work</span>
<span class="sd">        without an injection context but this can be overridden using</span>
<span class="sd">        `InjectionClient.set_callback_override`.</span>
<span class="sd">    type : typing.Optional[type[_T]]</span>
<span class="sd">        The type of the dependency to resolve.</span>

<span class="sd">        Unlike `callback`, `type` is resolved using the injection client and</span>
<span class="sd">        therefore requires that dependency injection is implemented on a context</span>
<span class="sd">        level.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If both `callback` and `type` are specified or if neither is specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Injected</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">type</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">injected</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_TypeT</span><span class="p">[</span><span class="n">_T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa: A002</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Injected</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Alias of `inject`.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">inject</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">type</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">InjectorClient</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Dependency injection client used by Tanjun&#39;s standard implementation.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_callback_overrides&quot;</span><span class="p">,</span> <span class="s2">&quot;_type_dependencies&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback_overrides</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">CallbackSig</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">CallbackDescriptor</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_type_dependencies</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">InjectorClient</span><span class="p">:</span> <span class="bp">self</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">set_type_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_InjectorClientT</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="n">value</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_InjectorClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set a callback to be called to resolve a injected type.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback: CallbackSig[_T]</span>
<span class="sd">            The callback to use to resolve the dependency.</span>

<span class="sd">            If this callback has no type dependencies then this will still work</span>
<span class="sd">            without an injection context but this can be overridden using</span>
<span class="sd">            `InjectionClient.set_callback_override`.</span>
<span class="sd">        type_: type[_T]</span>
<span class="sd">            The type of the dependency to resolve.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to allow chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If both `callback` and `type` are specified or if neither is specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_type_dependencies</span><span class="p">[</span><span class="n">type_</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">get_type_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">UndefinedOr</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the callback associated with an injected type.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        type_: type[_T]</span>
<span class="sd">            The associated type.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        UndefinedOr[_T]</span>
<span class="sd">            The resolved type if found, else `Undefined`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type_dependencies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="n">UNDEFINED</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove_type_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_InjectorClientT</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_InjectorClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a type dependency.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        type_: type[_T]</span>
<span class="sd">            The associated type.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to allow chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If `type_` is not registered.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type_dependencies</span><span class="p">[</span><span class="n">type_</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_callback_override</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_InjectorClientT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="n">override</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_InjectorClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Override a specific injected callback.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This does not effect the callbacks set for type injectors.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback: CallbackSig[_T]</span>
<span class="sd">            The injected callback to override.</span>
<span class="sd">        override: CallbackSig[_T]</span>
<span class="sd">            The callback to use instead.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to allow chaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback_overrides</span><span class="p">[</span><span class="n">callback</span><span class="p">]</span> <span class="o">=</span> <span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">override</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">get_callback_override</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="n">_T</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Get the set override for a specific injected callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback: CallbackSig[_T]</span>
<span class="sd">            The injected callback to get the override for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[CallbackDescriptor[_T]]</span>
<span class="sd">            The override if found, else `None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback_overrides</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove_callback_override</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_InjectorClientT</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_InjectorClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a callback override.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        callback: CallbackSig[_T]</span>
<span class="sd">            The injected callback to remove the override for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to allow chaining.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        KeyError</span>
<span class="sd">            If no override is found for the callback.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback_overrides</span><span class="p">[</span><span class="n">callback</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Logic and data classes used within the standard Tanjun implementation to enable dependency injection.</p>
</div>


                </section>
                <section id="as_self_injecting">
                            <div class="attr function"><a class="headerlink" href="#as_self_injecting">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">as_self_injecting</span><span class="signature">(
    injector_client: <a href="tanjun/injecting.html#InjectorClient">tanjun.injecting.InjectorClient</a>,
    /
) -&gt; collections.abc.Callable[[collections.abc.Callable[..., typing.Union[~_T, collections.abc.Awaitable[~_T]]]], <a href="tanjun/injecting.html#SelfInjectingCallback">tanjun.injecting.SelfInjectingCallback</a>[~_T]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">as_self_injecting</span><span class="p">(</span>
    <span class="n">injector_client</span><span class="p">:</span> <span class="n">InjectorClient</span><span class="p">,</span> <span class="o">/</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">]],</span> <span class="n">SelfInjectingCallback</span><span class="p">[</span><span class="n">_T</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Make a callback self-inecting by linking it to a client through a decorator call.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    def make_callback(client: tanjun.Client) -&gt; typing.Callable[[], int]:</span>
<span class="sd">        @tanjun.as_self_injected(client)</span>
<span class="sd">        async def get_int_value(</span>
<span class="sd">            redis: redis.Client = tanjun.inject(type=redis.Client)</span>
<span class="sd">        ) -&gt; int:</span>
<span class="sd">            return int(await redis.get(&#39;key&#39;))</span>

<span class="sd">        return get_int_value</span>
<span class="sd">    ```</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    injector_client : InjectorClient</span>
<span class="sd">        The injection client to use to resolve dependencies.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[CallbackSig[_T]], SelfInjectingCallback[_T]]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SelfInjectingCallback</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">SelfInjectingCallback</span><span class="p">(</span><span class="n">injector_client</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">decorator</span>
</pre></div>

        </details>

            <div class="docstring"><p>Make a callback self-inecting by linking it to a client through a decorator call.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">make_callback</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">Client</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="nb">int</span><span class="p">]:</span>
    <span class="nd">@tanjun</span><span class="o">.</span><span class="n">as_self_injected</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_int_value</span><span class="p">(</span>
        <span class="n">redis</span><span class="p">:</span> <span class="n">redis</span><span class="o">.</span><span class="n">Client</span> <span class="o">=</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">redis</span><span class="o">.</span><span class="n">Client</span><span class="p">)</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="k">await</span> <span class="n">redis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">get_int_value</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>injector_client</strong> (InjectorClient):
The injection client to use to resolve dependencies.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[CallbackSig[_T]], SelfInjectingCallback[_T]]</strong></li>
</ul>
</div>


                </section>
                <section id="inject">
                            <div class="attr function"><a class="headerlink" href="#inject">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">inject</span><span class="signature">(
    *,
    callback: Optional[collections.abc.Callable[..., Union[~_T, collections.abc.Awaitable[~_T]]]] = None,
    type: Optional[type[~_T]] = None
) -&gt; <a href="tanjun/injecting.html#Injected">tanjun.injecting.Injected</a>[~_T]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">inject</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">callback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">CallbackSig</span><span class="p">[</span><span class="n">_T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_TypeT</span><span class="p">[</span><span class="n">_T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa: A002</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Injected</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Decare a keyword-argument as requiring an injected dependency.</span>

<span class="sd">    This should be assigned to an arugment&#39;s default value.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```py</span>
<span class="sd">    @tanjun.as_slash_command(&quot;name&quot;, &quot;description&quot;)</span>
<span class="sd">    async def command_callback(</span>
<span class="sd">        ctx: tanjun.abc.Context,</span>
<span class="sd">        # Here we take advantage of scope based special casing which allows</span>
<span class="sd">        # us to inject the `Component` type.</span>
<span class="sd">        injected_type: tanjun.abc.Component = tanjun.inject(type=tanjun.abc.Component)</span>
<span class="sd">        # Here we inject an out-of-scope callback which itself is taking</span>
<span class="sd">        # advantage of type injection.</span>
<span class="sd">        callback_result: ResultT = tanjun.inject(callback=injected_callback)</span>
<span class="sd">    ) -&gt; None:</span>
<span class="sd">        raise NotImplementedError</span>
<span class="sd">    ```</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    callback : typing.Optional[CallbackSig[_T]]</span>
<span class="sd">        The callback to use to resolve the dependency.</span>

<span class="sd">        If this callback has no type dependencies then this will still work</span>
<span class="sd">        without an injection context but this can be overridden using</span>
<span class="sd">        `InjectionClient.set_callback_override`.</span>
<span class="sd">    type : typing.Optional[type[_T]]</span>
<span class="sd">        The type of the dependency to resolve.</span>

<span class="sd">        Unlike `callback`, `type` is resolved using the injection client and</span>
<span class="sd">        therefore requires that dependency injection is implemented on a context</span>
<span class="sd">        level.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If both `callback` and `type` are specified or if neither is specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Injected</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">type</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Decare a keyword-argument as requiring an injected dependency.</p>

<p>This should be assigned to an arugment's default value.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="nd">@tanjun</span><span class="o">.</span><span class="n">as_slash_command</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">command_callback</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
    <span class="c1"># Here we take advantage of scope based special casing which allows</span>
    <span class="c1"># us to inject the `Component` type.</span>
    <span class="n">injected_type</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Component</span> <span class="o">=</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Component</span><span class="p">)</span>
    <span class="c1"># Here we inject an out-of-scope callback which itself is taking</span>
    <span class="c1"># advantage of type injection.</span>
    <span class="n">callback_result</span><span class="p">:</span> <span class="n">ResultT</span> <span class="o">=</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="n">injected_callback</span><span class="p">)</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>callback</strong> (typing.Optional[CallbackSig[_T]]):
The callback to use to resolve the dependency.</p>

<p>If this callback has no type dependencies then this will still work
without an injection context but this can be overridden using
<code>InjectionClient.set_callback_override</code>.</p></li>
<li><p><strong>type</strong> (typing.Optional[type[_T]]):
The type of the dependency to resolve.</p>

<p>Unlike <code>callback</code>, <code>type</code> is resolved using the injection client and
therefore requires that dependency injection is implemented on a context
level.</p></li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If both <code>callback</code> and <code>type</code> are specified or if neither is specified.</li>
</ul>
</div>


                </section>
                <section id="parsing">
                                <div class="attr module"><a class="headerlink" href="#parsing">#&nbsp;&nbsp</a>
<span class="name"><a href="tanjun/parsing.html">tanjun.parsing</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;Standard implementation of message command argument parsing.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;AbstractParser&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Argument&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ConverterSig&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Parameter&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ParseableProto&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ParseableProtoT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ShlexParser&quot;</span><span class="p">,</span>
    <span class="s2">&quot;UndefinedDefaultT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;UNDEFINED_DEFAULT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_argument&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_greedy_argument&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_multi_argument&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_multi_option&quot;</span><span class="p">,</span>
    <span class="s2">&quot;with_parser&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">shlex</span>
<span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">collections</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">tanjun_abc</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">conversion</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">errors</span>

<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="n">_ParameterT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_ParameterT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;Parameter&quot;</span><span class="p">)</span>
    <span class="n">_ShlexParserT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_ShlexParserT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;ShlexParser&quot;</span><span class="p">)</span>
    <span class="n">_T</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_T&quot;</span><span class="p">)</span>


<span class="n">ParseableProtoT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;ParseableProtoT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;ParseableProto&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Generic type hint of `ParseableProto`.&quot;&quot;&quot;</span>

<span class="n">ConverterSig</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MaybeAwaitableT</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span>
<span class="sd">&quot;&quot;&quot;Type hint of a converter used within a parser instance.</span>

<span class="sd">This must be a callable or asynchronous callable which takes one position</span>
<span class="sd">`str`, argument and returns the resultant value.</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="nd">@typing</span><span class="o">.</span><span class="n">runtime_checkable</span>
<span class="k">class</span> <span class="nc">ParseableProto</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Protocol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Protocol of a command which supports this parser interface.&quot;&quot;&quot;</span>

    <span class="c1"># This fucks with MyPy even though at runtime python just straight out ignores slots when considering protocol</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>  <span class="c1"># compatibility.</span>
        <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CommandCallbackSig</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">parser</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">AbstractParser</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">set_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">AbstractParser</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>


<span class="k">class</span> <span class="nc">UndefinedDefaultT</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Type of the singleton value used for indicating an empty default.&quot;&quot;&quot;</span>

    <span class="n">__singleton</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">UndefinedDefaultT</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__singleton</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">__singleton</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">__singleton</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__singleton</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;UNDEFINED_DEFAULT&quot;</span>

    <span class="k">def</span> <span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]:</span>
        <span class="k">return</span> <span class="kc">False</span>


<span class="n">UNDEFINED_DEFAULT</span> <span class="o">=</span> <span class="n">UndefinedDefaultT</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;A singleton used to represent no default for a parameter.&quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">AbstractParser</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Abstract interface of a message content parser.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Parameter</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>  <span class="c1"># TODO: these lol</span>
    <span class="k">def</span> <span class="nf">add_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Argument</span><span class="p">,</span> <span class="n">Option</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">remove_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Argument</span><span class="p">,</span> <span class="n">Option</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Argument</span><span class="p">,</span> <span class="n">Option</span><span class="p">]],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>


<span class="k">class</span> <span class="nc">ShlexTokenizer</span><span class="p">:</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;__arg_buffer&quot;</span><span class="p">,</span> <span class="s2">&quot;__last_name&quot;</span><span class="p">,</span> <span class="s2">&quot;__options_buffer&quot;</span><span class="p">,</span> <span class="s2">&quot;__shlex&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__arg_buffer</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__last_name</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__options_buffer</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__shlex</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">shlex</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">posix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__shlex</span><span class="o">.</span><span class="n">commenters</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__shlex</span><span class="o">.</span><span class="n">whitespace</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__shlex</span><span class="o">.</span><span class="n">whitespace_split</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">collect_raw_options</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]:</span>
        <span class="n">results</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">while</span> <span class="p">(</span><span class="n">option</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_raw_option</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">option</span>

            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">results</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span> <span class="nf">iter_raw_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">argument</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_raw_argument</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">argument</span>

    <span class="k">def</span> <span class="nf">next_raw_argument</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__arg_buffer</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__arg_buffer</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># TODO: this is probably slow</span>
        <span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__seek_shlex</span><span class="p">(),</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__options_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">next_raw_option</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__options_buffer</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__options_buffer</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># TODO: this is probably slow</span>
        <span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__seek_shlex</span><span class="p">(),</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__arg_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__seek_shlex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="n">option_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__last_name</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__shlex</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">option_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__last_name</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">option_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">ParserError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>

        <span class="n">is_option</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_option</span> <span class="ow">and</span> <span class="n">option_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__last_name</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">option_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_option</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__last_name</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__seek_shlex</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">option_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__last_name</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">option_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">value</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">_covert_option_or_empty</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="n">option</span><span class="p">:</span> <span class="n">Option</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="o">/</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">option</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">empty_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">option</span><span class="o">.</span><span class="n">empty_value</span>

    <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">NotEnoughArgumentsError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Option &#39;</span><span class="si">{</span><span class="n">option</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> cannot be empty.&quot;</span><span class="p">,</span> <span class="n">option</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">SemanticShlex</span><span class="p">(</span><span class="n">ShlexTokenizer</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;__ctx&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ctx</span> <span class="o">=</span> <span class="n">ctx</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Argument</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="n">results</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">__process_argument</span><span class="p">(</span><span class="n">argument</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">argument</span><span class="o">.</span><span class="n">is_greedy</span> <span class="ow">or</span> <span class="n">argument</span><span class="o">.</span><span class="n">is_multi</span><span class="p">:</span>
                <span class="k">break</span>  <span class="c1"># Multi and Greedy parameters should always be the last parameter.</span>

        <span class="k">return</span> <span class="n">results</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Option</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="n">raw_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_raw_options</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">option</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__process_option</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">raw_options</span><span class="p">),</span> <span class="n">options</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">((</span><span class="n">option</span><span class="o">.</span><span class="n">key</span> <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">options</span><span class="p">),</span> <span class="k">await</span> <span class="n">results</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">__process_argument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">argument</span><span class="o">.</span><span class="n">is_greedy</span> <span class="ow">and</span> <span class="p">(</span><span class="n">value</span> <span class="o">:=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter_raw_arguments</span><span class="p">())):</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">argument</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__ctx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">argument</span><span class="o">.</span><span class="n">is_multi</span> <span class="ow">and</span> <span class="p">(</span><span class="n">values</span> <span class="o">:=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter_raw_arguments</span><span class="p">())):</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">argument</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__ctx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">))</span>

        <span class="c1"># If the previous two statements failed on getting raw arguments then this will as well.</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">optional_value</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_raw_argument</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">argument</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__ctx</span><span class="p">,</span> <span class="n">optional_value</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">argument</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">argument</span><span class="o">.</span><span class="n">default</span>

        <span class="c1"># If this is reached then no value was found.</span>
        <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">NotEnoughArgumentsError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing value for required argument &#39;</span><span class="si">{</span><span class="n">argument</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="n">argument</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">__process_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">:</span> <span class="n">Option</span><span class="p">,</span> <span class="n">raw_options</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
        <span class="n">values_iter</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">raw_options</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">option</span><span class="o">.</span><span class="n">names</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">raw_options</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">is_multi</span> <span class="ow">and</span> <span class="p">(</span><span class="n">values</span> <span class="o">:=</span> <span class="nb">list</span><span class="p">(</span><span class="n">values_iter</span><span class="p">)):</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">_covert_option_or_empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__ctx</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">option</span><span class="o">.</span><span class="n">is_multi</span> <span class="ow">and</span> <span class="p">(</span><span class="n">value</span> <span class="o">:=</span> <span class="nb">next</span><span class="p">(</span><span class="n">values_iter</span><span class="p">,</span> <span class="o">...</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="o">...</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">next</span><span class="p">(</span><span class="n">values_iter</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="o">...</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">TooManyArgumentsError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Option `</span><span class="si">{</span><span class="n">option</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">` can only take a single value&quot;</span><span class="p">,</span> <span class="n">option</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>

            <span class="k">return</span> <span class="k">await</span> <span class="n">_covert_option_or_empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__ctx</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">option</span><span class="o">.</span><span class="n">default</span>

        <span class="c1"># If this is reached then no value was found.</span>
        <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">NotEnoughArgumentsError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing required option `</span><span class="si">{</span><span class="n">option</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">,</span> <span class="n">option</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">with_argument</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
    <span class="n">greedy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">multi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ParseableProtoT</span><span class="p">],</span> <span class="n">ParseableProtoT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add an argument to a parsable command through a decorator call.</span>

<span class="sd">    .. note::</span>
<span class="sd">        Order matters for positional arguments and since decorator execution</span>
<span class="sd">        starts at the decorator closest to the command and goes upwards this</span>
<span class="sd">        will decide where a positional argument is located in a command&#39;s</span>
<span class="sd">        signature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    key : str</span>
<span class="sd">        The string identifier of this argument (may be used to pass the result</span>
<span class="sd">        of this argument to the command&#39;s callback during execution).</span>
<span class="sd">    converters : typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]</span>
<span class="sd">        The converter(s) this argument should use to handle values passed to it</span>
<span class="sd">        during parsing.</span>

<span class="sd">        If no converters are provided then the raw string value will be passed.</span>

<span class="sd">        Only the first converter to pass will be used.</span>
<span class="sd">    default : typing.Any</span>
<span class="sd">        The default value of this argument, if left as</span>
<span class="sd">        `UNDEFINED_DEFAULT` then this will have no default.</span>
<span class="sd">    greedy : bool</span>
<span class="sd">        Whether or not this argument should be greedy (meaning that it</span>
<span class="sd">        takes in the remaining argument values).</span>
<span class="sd">    multi : bool</span>
<span class="sd">        Whether this argument can be passed multiple times.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[ParseableProtoT], ParseableProtoT]:</span>
<span class="sd">        Decorator function for the parsable command this argument is being added to.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```python</span>
<span class="sd">    import tanjun</span>

<span class="sd">    @tanjun.parsing.with_argument(&quot;command&quot;, converters=int, default=42)</span>
<span class="sd">    @tanjun.parsing.with_parser</span>
<span class="sd">    @tanjun.component.as_message_command(&quot;command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.Context, /, argument: int):</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">command</span><span class="p">:</span> <span class="n">ParseableProtoT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParseableProtoT</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">parser</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot add a parameter to a command client without a parser.&quot;</span><span class="p">)</span>

        <span class="n">argument</span> <span class="o">=</span> <span class="n">Argument</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">greedy</span><span class="o">=</span><span class="n">greedy</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="n">multi</span><span class="p">)</span>
        <span class="n">command</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">command</span>

    <span class="k">return</span> <span class="n">decorator</span>


<span class="k">def</span> <span class="nf">with_greedy_argument</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ParseableProtoT</span><span class="p">],</span> <span class="n">ParseableProtoT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a greedy argument to a parsable command through a decorator call.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * A greedy argument will consume the remaining positional arguments and pass</span>
<span class="sd">      them through to the converters as one joined string while also requiring</span>
<span class="sd">      that at least one more positional argument is remaining unless a</span>
<span class="sd">      default is set.</span>
<span class="sd">    * Order matters for positional arguments and since decorator execution</span>
<span class="sd">      starts at the decorator closest to the command and goes upwards this</span>
<span class="sd">      will decide where a positional argument is located in a command&#39;s</span>
<span class="sd">      signature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    key : str</span>
<span class="sd">        The string identifier of this argument (may be used to pass the result</span>
<span class="sd">        of this argument to the command&#39;s callback during execution).</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    converters : typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]</span>
<span class="sd">        The converter(s) this argument should use to handle values passed to it</span>
<span class="sd">        during parsing.</span>

<span class="sd">        If no converters are provided then the raw string value will be passed.</span>

<span class="sd">        Only the first converter to pass will be used.</span>
<span class="sd">    default : typing.Any</span>
<span class="sd">        The default value of this argument, if left as</span>
<span class="sd">        `UNDEFINED_DEFAULT` then this will have no default.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[ParseableProtoT], ParseableProtoT]:</span>
<span class="sd">        Decorator function for the parsable command this argument is being added to.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```python</span>
<span class="sd">    import tanjun</span>

<span class="sd">    @tanjun.parsing.with_greedy_argument(&quot;command&quot;, converters=StringView)</span>
<span class="sd">    @tanjun.parsing.with_parser</span>
<span class="sd">    @tanjun.component.as_message_command(&quot;command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.Context, /, argument: StringView):</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">with_argument</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">greedy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">with_multi_argument</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ParseableProtoT</span><span class="p">],</span> <span class="n">ParseableProtoT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a multi-argument to a parsable command through a decorator call.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * A multi argument will consume the remaining positional arguments and pass</span>
<span class="sd">      them to the converters through multiple calls while also requiring that</span>
<span class="sd">      at least one more positional argument is remaining unless a default is</span>
<span class="sd">      set and passing through the results to the command&#39;s callback as a</span>
<span class="sd">      sequence.</span>
<span class="sd">    * Order matters for positional arguments and since decorator execution</span>
<span class="sd">      starts at the decorator closest to the command and goes upwards this</span>
<span class="sd">      will decide where a positional argument is located in a command&#39;s</span>
<span class="sd">      signature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    key : str</span>
<span class="sd">        The string identifier of this argument (may be used to pass the result</span>
<span class="sd">        of this argument to the command&#39;s callback during execution).</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    converters : typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]</span>
<span class="sd">        The converter(s) this argument should use to handle values passed to it</span>
<span class="sd">        during parsing.</span>

<span class="sd">        If no converters are provided then the raw string value will be passed.</span>

<span class="sd">        Only the first converter to pass will be used.</span>
<span class="sd">    default : typing.Any</span>
<span class="sd">        The default value of this argument, if left as</span>
<span class="sd">        `UNDEFINED_DEFAULT` then this will have no default.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[ParseableProtoT], ParseableProtoT]:</span>
<span class="sd">        Decorator function for the parsable command this argument is being added to.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```python</span>
<span class="sd">    import tanjun</span>

<span class="sd">    @tanjun.parsing.with_multi_argument(&quot;command&quot;, converters=int)</span>
<span class="sd">    @tanjun.parsing.with_parser</span>
<span class="sd">    @tanjun.component.as_message_command(&quot;command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.Context, /, argument: collections.abc.Sequence[int]):</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">with_argument</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="c1"># TODO: add default getter</span>
<span class="k">def</span> <span class="nf">with_option</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="n">empty_value</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
    <span class="n">multi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ParseableProtoT</span><span class="p">],</span> <span class="n">ParseableProtoT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add an option to a parsable command through a decorator call.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    key : str</span>
<span class="sd">        The string identifier of this option which will be used to pass the</span>
<span class="sd">        result of this argument to the command&#39;s callback during execution as</span>
<span class="sd">        a keyword argument.</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of this option used for identifying it in the parsed content.</span>
<span class="sd">    default : typing.Any</span>
<span class="sd">        The default value of this argument, unlike arguments this is required</span>
<span class="sd">        for options.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    *names : str</span>
<span class="sd">        Other names of this option used for identifying it in the parsed content.</span>
<span class="sd">    converters : typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]</span>
<span class="sd">        The converter(s) this argument should use to handle values passed to it</span>
<span class="sd">        during parsing.</span>

<span class="sd">        If no converters are provided then the raw string value will be passed.</span>

<span class="sd">        Only the first converter to pass will be used.</span>
<span class="sd">    empty_value : typing.Any</span>
<span class="sd">        The value to use if this option is provided without a value. If left as</span>
<span class="sd">        `UNDEFINED_DEFAULT` then this option will error if it&#39;s</span>
<span class="sd">        provided without a value.</span>
<span class="sd">    multi : bool</span>
<span class="sd">        If this option can be provided multiple times.</span>
<span class="sd">        Defaults to `False`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[ParseableProtoT], ParseableProtoT]:</span>
<span class="sd">        Decorator function for the parsable command this option is being added to.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```python</span>
<span class="sd">    import tanjun</span>

<span class="sd">    @tanjun.parsing.with_option(&quot;command&quot;, converters=int, default=42)</span>
<span class="sd">    @tanjun.parsing.with_parser</span>
<span class="sd">    @tanjun.component.as_message_command(&quot;command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.Context, /, argument: int):</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">command</span><span class="p">:</span> <span class="n">ParseableProtoT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParseableProtoT</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">parser</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot add an option to a command client without a parser.&quot;</span><span class="p">)</span>

        <span class="n">option</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">empty_value</span><span class="o">=</span><span class="n">empty_value</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="n">multi</span><span class="p">)</span>
        <span class="n">command</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">command</span>

    <span class="k">return</span> <span class="n">decorator</span>


<span class="k">def</span> <span class="nf">with_multi_option</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="n">empty_value</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ParseableProtoT</span><span class="p">],</span> <span class="n">ParseableProtoT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add an multi-option to a command&#39;s parser through a decorator call.</span>

<span class="sd">    .. note::</span>
<span class="sd">        A multi option will consume all the values provided for an option and</span>
<span class="sd">        pass them through to the converters as an array of strings while also</span>
<span class="sd">        requiring that at least one value is provided for the option unless</span>
<span class="sd">        a default is set.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    key : str</span>
<span class="sd">        The string identifier of this option which will be used to pass the</span>
<span class="sd">        result of this argument to the command&#39;s callback during execution as</span>
<span class="sd">        a keyword argument.</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of this option used for identifying it in the parsed content.</span>
<span class="sd">    default : typing.Any</span>
<span class="sd">        The default value of this argument, unlike arguments this is required</span>
<span class="sd">        for options.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    *names : str</span>
<span class="sd">        Other names of this option used for identifying it in the parsed content.</span>
<span class="sd">    converters : typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]</span>
<span class="sd">        The converter(s) this argument should use to handle values passed to it</span>
<span class="sd">        during parsing.</span>

<span class="sd">        If no converters are provided then the raw string value will be passed.</span>

<span class="sd">        Only the first converter to pass will be used.</span>
<span class="sd">    empty_value : typing.Any</span>
<span class="sd">        The value to use if this option is provided without a value. If left as</span>
<span class="sd">        `UNDEFINED_DEFAULT` then this option will error if it&#39;s</span>
<span class="sd">        provided without a value.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[ParseableProtoT], ParseableProtoT]:</span>
<span class="sd">        Decorator function for the parsable command this option is being added to.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```python</span>
<span class="sd">    import tanjun</span>

<span class="sd">    @tanjun.parsing.with_multi_option(&quot;command&quot;, converters=int, default=())</span>
<span class="sd">    @tanjun.parsing.with_parser</span>
<span class="sd">    @tanjun.component.as_message_command(&quot;command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.Context, /, argument: collections.abc.Sequence[int]):</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">with_option</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">empty_value</span><span class="o">=</span><span class="n">empty_value</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Parameter</span><span class="p">:</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_client&quot;</span><span class="p">,</span> <span class="s2">&quot;_component&quot;</span><span class="p">,</span> <span class="s2">&quot;_converters&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="s2">&quot;is_greedy&quot;</span><span class="p">,</span> <span class="s2">&quot;is_multi&quot;</span><span class="p">,</span> <span class="s2">&quot;_key&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">greedy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">multi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_converters</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">conversion</span><span class="o">.</span><span class="n">InjectableConverter</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="n">default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_greedy</span> <span class="o">=</span> <span class="n">greedy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_multi</span> <span class="o">=</span> <span class="n">multi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_key</span> <span class="o">=</span> <span class="n">key</span>

        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;parameter key cannot start with `-`&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">converters</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">converter</span> <span class="ow">in</span> <span class="n">converters</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_converter</span><span class="p">(</span><span class="n">converter</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_converter</span><span class="p">(</span><span class="n">converters</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> &lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_key</span><span class="si">}</span><span class="s2">&gt;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">converters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">converter</span><span class="o">.</span><span class="n">callback</span> <span class="k">for</span> <span class="n">converter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_converters</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">key</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">needs_injector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># TODO: cache this value?</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">converter</span><span class="o">.</span><span class="n">needs_injector</span> <span class="k">for</span> <span class="n">converter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_converters</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_converter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">converter</span><span class="p">:</span> <span class="n">ConverterSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">converter</span><span class="p">,</span> <span class="n">conversion</span><span class="o">.</span><span class="n">BaseConverter</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
                <span class="n">converter</span><span class="o">.</span><span class="n">check_client</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_key</span><span class="si">}</span><span class="s2"> parameter&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">converter</span><span class="p">,</span> <span class="n">conversion</span><span class="o">.</span><span class="n">InjectableConverter</span><span class="p">):</span>
            <span class="c1"># Some types like `bool` and `bytes` are overridden here for the sake of convenience.</span>
            <span class="n">converter</span> <span class="o">=</span> <span class="n">conversion</span><span class="o">.</span><span class="n">override_type</span><span class="p">(</span><span class="n">converter</span><span class="p">)</span>
            <span class="n">converter</span> <span class="o">=</span> <span class="n">conversion</span><span class="o">.</span><span class="n">InjectableConverter</span><span class="p">(</span><span class="n">converter</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_converters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">converter</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="k">for</span> <span class="n">converter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_converters</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">converter</span><span class="o">.</span><span class="n">callback</span><span class="p">,</span> <span class="n">conversion</span><span class="o">.</span><span class="n">BaseConverter</span><span class="p">):</span>
                <span class="n">converter</span><span class="o">.</span><span class="n">callback</span><span class="o">.</span><span class="n">check_client</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_key</span><span class="si">}</span><span class="s2"> parameter&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_component</span> <span class="o">=</span> <span class="n">component</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_converters</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>

        <span class="n">sources</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="ne">ValueError</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">converter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_converters</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">await</span> <span class="n">converter</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="n">sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>

        <span class="n">parameter_type</span> <span class="o">=</span> <span class="s2">&quot;option&quot;</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Option</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;argument&quot;</span>
        <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">ConversionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Couldn&#39;t convert </span><span class="si">{</span><span class="n">parameter_type</span><span class="si">}</span><span class="s2"> &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">sources</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ParameterT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ParameterT</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_converters</span> <span class="o">=</span> <span class="p">[</span><span class="n">converter</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">converter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_converters</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>


<span class="k">class</span> <span class="nc">Argument</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">greedy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">multi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">greedy</span> <span class="ow">and</span> <span class="n">multi</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Argument cannot be both greed and multi.&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">greedy</span><span class="o">=</span><span class="n">greedy</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="n">multi</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Option</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_empty_value&quot;</span><span class="p">,</span> <span class="s2">&quot;is_multi&quot;</span><span class="p">,</span> <span class="s2">&quot;_names&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">empty_value</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">multi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">names</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All option names must start with `-`&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_empty_value</span> <span class="o">=</span> <span class="n">empty_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">]</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="n">multi</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">empty_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_empty_value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> &lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_names</span><span class="si">}</span><span class="s2">&gt;&quot;</span>


<span class="k">class</span> <span class="nc">ShlexParser</span><span class="p">(</span><span class="n">AbstractParser</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A shlex based `tanjun.abc.Parser` implementation.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_arguments&quot;</span><span class="p">,</span> <span class="s2">&quot;_client&quot;</span><span class="p">,</span> <span class="s2">&quot;_component&quot;</span><span class="p">,</span> <span class="s2">&quot;_options&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Argument</span><span class="p">,</span> <span class="n">Option</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Argument</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Option</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">needs_injector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># TODO: cache this value?</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">parameter</span><span class="o">.</span><span class="n">needs_injector</span> <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Parameter</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractParser&gt;&gt;.</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span> <span class="o">=</span> <span class="p">[</span><span class="n">argument</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="p">[</span><span class="n">option</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Argument</span><span class="p">,</span> <span class="n">Option</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractParser&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="n">parameter</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_component</span><span class="p">:</span>
            <span class="n">parameter</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_component</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">Option</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>
            <span class="n">found_final_argument</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">found_final_argument</span><span class="p">:</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Multi or greedy argument must be the last argument&quot;</span><span class="p">)</span>

                <span class="n">found_final_argument</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">is_multi</span> <span class="ow">or</span> <span class="n">argument</span><span class="o">.</span><span class="n">is_greedy</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Argument</span><span class="p">,</span> <span class="n">Option</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring AbstractParser&gt;&gt;.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">Option</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_argument</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">greedy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">multi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add an argument type parameter to the parser..</span>

<span class="sd">        .. note::</span>
<span class="sd">            Order matters for positional arguments.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str</span>
<span class="sd">            The string identifier of this argument (may be used to pass the result</span>
<span class="sd">            of this argument to the command&#39;s callback during execution).</span>
<span class="sd">        converters : typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]</span>
<span class="sd">            The converter(s) this argument should use to handle values passed to it</span>
<span class="sd">            during parsing.</span>

<span class="sd">            If no converters are provided then the raw string value will be passed.</span>

<span class="sd">            Only the first converter to pass will be used.</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The default value of this argument, if left as</span>
<span class="sd">            `UNDEFINED_DEFAULT` then this will have no default.</span>
<span class="sd">        greedy : bool</span>
<span class="sd">            Whether or not this argument should be greedy (meaning that it</span>
<span class="sd">            takes in the remaining argument values).</span>
<span class="sd">        multi : bool</span>
<span class="sd">            Whether this argument can be passed multiple times.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This parser to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">Argument</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="n">multi</span><span class="p">,</span> <span class="n">greedy</span><span class="o">=</span><span class="n">greedy</span><span class="p">))</span>

    <span class="c1"># TODO: add default getter</span>
    <span class="k">def</span> <span class="nf">add_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
        <span class="n">empty_value</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">multi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add an option type parameter to this parser.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str</span>
<span class="sd">            The string identifier of this option which will be used to pass the</span>
<span class="sd">            result of this argument to the command&#39;s callback during execution as</span>
<span class="sd">            a keyword argument.</span>
<span class="sd">        name : str</span>
<span class="sd">            The name of this option used for identifying it in the parsed content.</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The default value of this argument, unlike arguments this is required</span>
<span class="sd">            for options.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        *names : str</span>
<span class="sd">            Other names of this option used for identifying it in the parsed content.</span>
<span class="sd">        converters : typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]</span>
<span class="sd">            The converter(s) this argument should use to handle values passed to it</span>
<span class="sd">            during parsing.</span>

<span class="sd">            If no converters are provided then the raw string value will be passed.</span>

<span class="sd">            Only the first converter to pass will be used.</span>
<span class="sd">        empty_value : typing.Any</span>
<span class="sd">            The value to use if this option is provided without a value. If left as</span>
<span class="sd">            `UNDEFINED_DEFAULT` then this option will error if it&#39;s</span>
<span class="sd">            provided without a value.</span>
<span class="sd">        multi : bool</span>
<span class="sd">            If this option can be provided multiple times.</span>
<span class="sd">            Defaults to `False`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This parser to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">Option</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">empty_value</span><span class="o">=</span><span class="n">empty_value</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="n">multi</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Argument</span><span class="p">,</span> <span class="n">Option</span><span class="p">]],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractParser&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractParser&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">):</span>
            <span class="n">parameter</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractParser&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_component</span> <span class="o">=</span> <span class="n">component</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">):</span>
            <span class="n">parameter</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractParser&gt;&gt;.</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">SemanticShlex</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="k">await</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_arguments</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">)</span>
        <span class="n">options</span> <span class="o">=</span> <span class="k">await</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_options</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">arguments</span><span class="p">,</span> <span class="n">options</span>


<span class="k">def</span> <span class="nf">with_parser</span><span class="p">(</span><span class="n">command</span><span class="p">:</span> <span class="n">ParseableProtoT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParseableProtoT</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Add a shlex parser command parser to a supported command.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">command</span><span class="o">.</span><span class="n">set_parser</span><span class="p">(</span><span class="n">ShlexParser</span><span class="p">())</span>
</pre></div>

        </details>

            <div class="docstring"><p>Standard implementation of message command argument parsing.</p>
</div>


                </section>
                <section id="ShlexParser">
                                <div class="attr class">
        <a class="headerlink" href="#ShlexParser">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ShlexParser</span><wbr>(<span class="base"><a href="tanjun/parsing.html#AbstractParser">tanjun.parsing.AbstractParser</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ShlexParser</span><span class="p">(</span><span class="n">AbstractParser</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A shlex based `tanjun.abc.Parser` implementation.&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_arguments&quot;</span><span class="p">,</span> <span class="s2">&quot;_client&quot;</span><span class="p">,</span> <span class="s2">&quot;_component&quot;</span><span class="p">,</span> <span class="s2">&quot;_options&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Argument</span><span class="p">,</span> <span class="n">Option</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Argument</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Option</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">needs_injector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># TODO: cache this value?</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">parameter</span><span class="o">.</span><span class="n">needs_injector</span> <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Parameter</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractParser&gt;&gt;.</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span> <span class="o">=</span> <span class="p">[</span><span class="n">argument</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="p">[</span><span class="n">option</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Argument</span><span class="p">,</span> <span class="n">Option</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractParser&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="n">parameter</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_component</span><span class="p">:</span>
            <span class="n">parameter</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_component</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">Option</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>
            <span class="n">found_final_argument</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">found_final_argument</span><span class="p">:</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Multi or greedy argument must be the last argument&quot;</span><span class="p">)</span>

                <span class="n">found_final_argument</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">is_multi</span> <span class="ow">or</span> <span class="n">argument</span><span class="o">.</span><span class="n">is_greedy</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Argument</span><span class="p">,</span> <span class="n">Option</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring AbstractParser&gt;&gt;.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">Option</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_argument</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">greedy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">multi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add an argument type parameter to the parser..</span>

<span class="sd">        .. note::</span>
<span class="sd">            Order matters for positional arguments.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str</span>
<span class="sd">            The string identifier of this argument (may be used to pass the result</span>
<span class="sd">            of this argument to the command&#39;s callback during execution).</span>
<span class="sd">        converters : typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]</span>
<span class="sd">            The converter(s) this argument should use to handle values passed to it</span>
<span class="sd">            during parsing.</span>

<span class="sd">            If no converters are provided then the raw string value will be passed.</span>

<span class="sd">            Only the first converter to pass will be used.</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The default value of this argument, if left as</span>
<span class="sd">            `UNDEFINED_DEFAULT` then this will have no default.</span>
<span class="sd">        greedy : bool</span>
<span class="sd">            Whether or not this argument should be greedy (meaning that it</span>
<span class="sd">            takes in the remaining argument values).</span>
<span class="sd">        multi : bool</span>
<span class="sd">            Whether this argument can be passed multiple times.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This parser to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">Argument</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="n">multi</span><span class="p">,</span> <span class="n">greedy</span><span class="o">=</span><span class="n">greedy</span><span class="p">))</span>

    <span class="c1"># TODO: add default getter</span>
    <span class="k">def</span> <span class="nf">add_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
        <span class="n">empty_value</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">multi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add an option type parameter to this parser.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str</span>
<span class="sd">            The string identifier of this option which will be used to pass the</span>
<span class="sd">            result of this argument to the command&#39;s callback during execution as</span>
<span class="sd">            a keyword argument.</span>
<span class="sd">        name : str</span>
<span class="sd">            The name of this option used for identifying it in the parsed content.</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The default value of this argument, unlike arguments this is required</span>
<span class="sd">            for options.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        *names : str</span>
<span class="sd">            Other names of this option used for identifying it in the parsed content.</span>
<span class="sd">        converters : typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]</span>
<span class="sd">            The converter(s) this argument should use to handle values passed to it</span>
<span class="sd">            during parsing.</span>

<span class="sd">            If no converters are provided then the raw string value will be passed.</span>

<span class="sd">            Only the first converter to pass will be used.</span>
<span class="sd">        empty_value : typing.Any</span>
<span class="sd">            The value to use if this option is provided without a value. If left as</span>
<span class="sd">            `UNDEFINED_DEFAULT` then this option will error if it&#39;s</span>
<span class="sd">            provided without a value.</span>
<span class="sd">        multi : bool</span>
<span class="sd">            If this option can be provided multiple times.</span>
<span class="sd">            Defaults to `False`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This parser to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">Option</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">empty_value</span><span class="o">=</span><span class="n">empty_value</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="n">multi</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Argument</span><span class="p">,</span> <span class="n">Option</span><span class="p">]],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractParser&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractParser&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">):</span>
            <span class="n">parameter</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractParser&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_component</span> <span class="o">=</span> <span class="n">component</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">):</span>
            <span class="n">parameter</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractParser&gt;&gt;.</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">SemanticShlex</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="k">await</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_arguments</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">)</span>
        <span class="n">options</span> <span class="o">=</span> <span class="k">await</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_options</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">arguments</span><span class="p">,</span> <span class="n">options</span>
</pre></div>

        </details>

            <div class="docstring"><p>A shlex based <code><a href="tanjun/abc.html#Parser">tanjun.abc.Parser</a></code> implementation.</p>
</div>


                            <div id="ShlexParser.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ShlexParser.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">ShlexParser</span><span class="signature">(
    *,
    parameters: Optional[collections.abc.Iterable[Union[<a href="tanjun/parsing.html#Argument">tanjun.parsing.Argument</a>, <a href="tanjun/parsing.html#Option">tanjun.parsing.Option</a>]]] = None
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Argument</span><span class="p">,</span> <span class="n">Option</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Argument</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Option</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ShlexParser.needs_injector" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ShlexParser.needs_injector">#&nbsp;&nbsp</a>

        <span class="name">needs_injector</span><span class="annotation">: bool</span>
    </div>

    

                            </div>
                            <div id="ShlexParser.parameters" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ShlexParser.parameters">#&nbsp;&nbsp</a>

        <span class="name">parameters</span><span class="annotation">: collections.abc.Sequence[<a href="tanjun/parsing.html#Parameter">tanjun.parsing.Parameter</a>]</span>
    </div>

    

                            </div>
                            <div id="ShlexParser.copy" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ShlexParser.copy">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">copy</span><span class="signature">(self: ~_ShlexParserT, *, _new: bool = True) -&gt; ~_ShlexParserT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">_new</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_new</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span> <span class="o">=</span> <span class="p">[</span><span class="n">argument</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="p">[</span><span class="n">option</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ShlexParser.add_parameter" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ShlexParser.add_parameter">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_parameter</span><span class="signature">(
    self: ~_ShlexParserT,
    parameter: Union[<a href="tanjun/parsing.html#Argument">tanjun.parsing.Argument</a>, <a href="tanjun/parsing.html#Option">tanjun.parsing.Option</a>],
    /
) -&gt; ~_ShlexParserT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Argument</span><span class="p">,</span> <span class="n">Option</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractParser&gt;&gt;.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">:</span>
            <span class="n">parameter</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_component</span><span class="p">:</span>
            <span class="n">parameter</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_component</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">Option</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>
            <span class="n">found_final_argument</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">found_final_argument</span><span class="p">:</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Multi or greedy argument must be the last argument&quot;</span><span class="p">)</span>

                <span class="n">found_final_argument</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">is_multi</span> <span class="ow">or</span> <span class="n">argument</span><span class="o">.</span><span class="n">is_greedy</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ShlexParser.remove_parameter" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ShlexParser.remove_parameter">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_parameter</span><span class="signature">(
    self: ~_ShlexParserT,
    parameter: Union[<a href="tanjun/parsing.html#Argument">tanjun.parsing.Argument</a>, <a href="tanjun/parsing.html#Option">tanjun.parsing.Option</a>],
    /
) -&gt; ~_ShlexParserT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Argument</span><span class="p">,</span> <span class="n">Option</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring AbstractParser&gt;&gt;.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">Option</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ShlexParser.add_argument" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ShlexParser.add_argument">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_argument</span><span class="signature">(
    self: ~_ShlexParserT,
    key: str,
    /,
    converters: Union[collections.abc.Iterable[collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]], collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]] = (),
    *,
    default: Union[Any, <a href="tanjun/parsing.html#UndefinedDefaultT">tanjun.parsing.UndefinedDefaultT</a>] = UNDEFINED_DEFAULT,
    greedy: bool = False,
    multi: bool = False
) -&gt; ~_ShlexParserT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_argument</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">greedy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">multi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add an argument type parameter to the parser..</span>

<span class="sd">        .. note::</span>
<span class="sd">            Order matters for positional arguments.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str</span>
<span class="sd">            The string identifier of this argument (may be used to pass the result</span>
<span class="sd">            of this argument to the command&#39;s callback during execution).</span>
<span class="sd">        converters : typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]</span>
<span class="sd">            The converter(s) this argument should use to handle values passed to it</span>
<span class="sd">            during parsing.</span>

<span class="sd">            If no converters are provided then the raw string value will be passed.</span>

<span class="sd">            Only the first converter to pass will be used.</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The default value of this argument, if left as</span>
<span class="sd">            `UNDEFINED_DEFAULT` then this will have no default.</span>
<span class="sd">        greedy : bool</span>
<span class="sd">            Whether or not this argument should be greedy (meaning that it</span>
<span class="sd">            takes in the remaining argument values).</span>
<span class="sd">        multi : bool</span>
<span class="sd">            Whether this argument can be passed multiple times.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This parser to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">Argument</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="n">multi</span><span class="p">,</span> <span class="n">greedy</span><span class="o">=</span><span class="n">greedy</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add an argument type parameter to the parser..</p>

<p><em>Note:</em>
Order matters for positional arguments.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>key</strong> (str):
The string identifier of this argument (may be used to pass the result
of this argument to the command's callback during execution).</li>
<li><p><strong>converters</strong> (typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]):
The converter(s) this argument should use to handle values passed to it
during parsing.</p>

<p>If no converters are provided then the raw string value will be passed.</p>

<p>Only the first converter to pass will be used.</p></li>
<li><strong>default</strong> (typing.Any):
The default value of this argument, if left as
<code>UNDEFINED_DEFAULT</code> then this will have no default.</li>
<li><strong>greedy</strong> (bool):
Whether or not this argument should be greedy (meaning that it
takes in the remaining argument values).</li>
<li><strong>multi</strong> (bool):
Whether this argument can be passed multiple times.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>SelfT</strong>: This parser to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="ShlexParser.add_option" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ShlexParser.add_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_option</span><span class="signature">(
    self: ~_ShlexParserT,
    key: str,
    name: str,
    /,
    *names: str,
    converters: Union[collections.abc.Iterable[collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]], collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]] = (),
    default: Any,
    empty_value: Union[Any, <a href="tanjun/parsing.html#UndefinedDefaultT">tanjun.parsing.UndefinedDefaultT</a>] = UNDEFINED_DEFAULT,
    multi: bool = False
) -&gt; ~_ShlexParserT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
        <span class="n">empty_value</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
        <span class="n">multi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add an option type parameter to this parser.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str</span>
<span class="sd">            The string identifier of this option which will be used to pass the</span>
<span class="sd">            result of this argument to the command&#39;s callback during execution as</span>
<span class="sd">            a keyword argument.</span>
<span class="sd">        name : str</span>
<span class="sd">            The name of this option used for identifying it in the parsed content.</span>
<span class="sd">        default : typing.Any</span>
<span class="sd">            The default value of this argument, unlike arguments this is required</span>
<span class="sd">            for options.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        *names : str</span>
<span class="sd">            Other names of this option used for identifying it in the parsed content.</span>
<span class="sd">        converters : typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]</span>
<span class="sd">            The converter(s) this argument should use to handle values passed to it</span>
<span class="sd">            during parsing.</span>

<span class="sd">            If no converters are provided then the raw string value will be passed.</span>

<span class="sd">            Only the first converter to pass will be used.</span>
<span class="sd">        empty_value : typing.Any</span>
<span class="sd">            The value to use if this option is provided without a value. If left as</span>
<span class="sd">            `UNDEFINED_DEFAULT` then this option will error if it&#39;s</span>
<span class="sd">            provided without a value.</span>
<span class="sd">        multi : bool</span>
<span class="sd">            If this option can be provided multiple times.</span>
<span class="sd">            Defaults to `False`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SelfT</span>
<span class="sd">            This parser to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span>
            <span class="n">Option</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">empty_value</span><span class="o">=</span><span class="n">empty_value</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="n">multi</span><span class="p">)</span>
        <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add an option type parameter to this parser.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>key</strong> (str):
The string identifier of this option which will be used to pass the
result of this argument to the command's callback during execution as
a keyword argument.</li>
<li><strong>name</strong> (str):
The name of this option used for identifying it in the parsed content.</li>
<li><strong>default</strong> (typing.Any):
The default value of this argument, unlike arguments this is required
for options.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>*names</strong> (str):
Other names of this option used for identifying it in the parsed content.</li>
<li><p><strong>converters</strong> (typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]):
The converter(s) this argument should use to handle values passed to it
during parsing.</p>

<p>If no converters are provided then the raw string value will be passed.</p>

<p>Only the first converter to pass will be used.</p></li>
<li><strong>empty_value</strong> (typing.Any):
The value to use if this option is provided without a value. If left as
<code>UNDEFINED_DEFAULT</code> then this option will error if it's
provided without a value.</li>
<li><strong>multi</strong> (bool):
If this option can be provided multiple times.
Defaults to <code>False</code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>SelfT</strong>: This parser to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="ShlexParser.set_parameters" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ShlexParser.set_parameters">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_parameters</span><span class="signature">(
    self: ~_ShlexParserT,
    parameters: collections.abc.Iterable[typing.Union[<a href="tanjun/parsing.html#Argument">tanjun.parsing.Argument</a>, <a href="tanjun/parsing.html#Option">tanjun.parsing.Option</a>]],
    /
) -&gt; ~_ShlexParserT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ShlexParserT</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Argument</span><span class="p">,</span> <span class="n">Option</span><span class="p">]],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ShlexParserT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractParser&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ShlexParser.bind_client" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ShlexParser.bind_client">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">bind_client</span><span class="signature">(self, client: <a href="tanjun/abc.html#Client">tanjun.abc.Client</a>, /) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractParser&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">):</span>
            <span class="n">parameter</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ShlexParser.bind_component" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ShlexParser.bind_component">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">bind_component</span><span class="signature">(self, component: <a href="tanjun/abc.html#Component">tanjun.abc.Component</a>, /) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractParser&gt;&gt;.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_component</span> <span class="o">=</span> <span class="n">component</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">):</span>
            <span class="n">parameter</span><span class="o">.</span><span class="n">bind_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="ShlexParser.parse" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ShlexParser.parse">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">parse</span><span class="signature">(
    self,
    ctx: <a href="tanjun/abc.html#MessageContext">tanjun.abc.MessageContext</a>,
    /
) -&gt; tuple[list[typing.Any], dict[str, typing.Any]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from AbstractParser&gt;&gt;.</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">SemanticShlex</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="k">await</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_arguments</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">)</span>
        <span class="n">options</span> <span class="o">=</span> <span class="k">await</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_options</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">arguments</span><span class="p">,</span> <span class="n">options</span>
</pre></div>

        </details>

    

                            </div>
                </section>
                <section id="with_argument">
                            <div class="attr function"><a class="headerlink" href="#with_argument">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_argument</span><span class="signature">(
    key: str,
    /,
    converters: Union[collections.abc.Iterable[collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]], collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]] = (),
    *,
    default: Union[Any, <a href="tanjun/parsing.html#UndefinedDefaultT">tanjun.parsing.UndefinedDefaultT</a>] = UNDEFINED_DEFAULT,
    greedy: bool = False,
    multi: bool = False
) -&gt; collections.abc.Callable[[~ParseableProtoT], ~ParseableProtoT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_argument</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
    <span class="n">greedy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">multi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ParseableProtoT</span><span class="p">],</span> <span class="n">ParseableProtoT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add an argument to a parsable command through a decorator call.</span>

<span class="sd">    .. note::</span>
<span class="sd">        Order matters for positional arguments and since decorator execution</span>
<span class="sd">        starts at the decorator closest to the command and goes upwards this</span>
<span class="sd">        will decide where a positional argument is located in a command&#39;s</span>
<span class="sd">        signature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    key : str</span>
<span class="sd">        The string identifier of this argument (may be used to pass the result</span>
<span class="sd">        of this argument to the command&#39;s callback during execution).</span>
<span class="sd">    converters : typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]</span>
<span class="sd">        The converter(s) this argument should use to handle values passed to it</span>
<span class="sd">        during parsing.</span>

<span class="sd">        If no converters are provided then the raw string value will be passed.</span>

<span class="sd">        Only the first converter to pass will be used.</span>
<span class="sd">    default : typing.Any</span>
<span class="sd">        The default value of this argument, if left as</span>
<span class="sd">        `UNDEFINED_DEFAULT` then this will have no default.</span>
<span class="sd">    greedy : bool</span>
<span class="sd">        Whether or not this argument should be greedy (meaning that it</span>
<span class="sd">        takes in the remaining argument values).</span>
<span class="sd">    multi : bool</span>
<span class="sd">        Whether this argument can be passed multiple times.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[ParseableProtoT], ParseableProtoT]:</span>
<span class="sd">        Decorator function for the parsable command this argument is being added to.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```python</span>
<span class="sd">    import tanjun</span>

<span class="sd">    @tanjun.parsing.with_argument(&quot;command&quot;, converters=int, default=42)</span>
<span class="sd">    @tanjun.parsing.with_parser</span>
<span class="sd">    @tanjun.component.as_message_command(&quot;command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.Context, /, argument: int):</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">command</span><span class="p">:</span> <span class="n">ParseableProtoT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParseableProtoT</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">parser</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot add a parameter to a command client without a parser.&quot;</span><span class="p">)</span>

        <span class="n">argument</span> <span class="o">=</span> <span class="n">Argument</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">greedy</span><span class="o">=</span><span class="n">greedy</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="n">multi</span><span class="p">)</span>
        <span class="n">command</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">command</span>

    <span class="k">return</span> <span class="n">decorator</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add an argument to a parsable command through a decorator call.</p>

<p><em>Note:</em>
Order matters for positional arguments and since decorator execution
starts at the decorator closest to the command and goes upwards this
will decide where a positional argument is located in a command's
signature.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>key</strong> (str):
The string identifier of this argument (may be used to pass the result
of this argument to the command's callback during execution).</li>
<li><p><strong>converters</strong> (typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]):
The converter(s) this argument should use to handle values passed to it
during parsing.</p>

<p>If no converters are provided then the raw string value will be passed.</p>

<p>Only the first converter to pass will be used.</p></li>
<li><strong>default</strong> (typing.Any):
The default value of this argument, if left as
<code>UNDEFINED_DEFAULT</code> then this will have no default.</li>
<li><strong>greedy</strong> (bool):
Whether or not this argument should be greedy (meaning that it
takes in the remaining argument values).</li>
<li><strong>multi</strong> (bool):
Whether this argument can be passed multiple times.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[ParseableProtoT], ParseableProtoT]:</strong>: Decorator function for the parsable command this argument is being added to.</li>
</ul>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">tanjun</span>

<span class="nd">@tanjun</span><span class="o">.</span><span class="n">parsing</span><span class="o">.</span><span class="n">with_argument</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">parsing</span><span class="o">.</span><span class="n">with_parser</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">component</span><span class="o">.</span><span class="n">as_message_command</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="o">...</span>
</code></pre></div>
</div>


                </section>
                <section id="with_greedy_argument">
                            <div class="attr function"><a class="headerlink" href="#with_greedy_argument">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_greedy_argument</span><span class="signature">(
    key: str,
    /,
    converters: Union[collections.abc.Iterable[collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]], collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]] = (),
    *,
    default: Union[Any, <a href="tanjun/parsing.html#UndefinedDefaultT">tanjun.parsing.UndefinedDefaultT</a>] = UNDEFINED_DEFAULT
) -&gt; collections.abc.Callable[[~ParseableProtoT], ~ParseableProtoT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_greedy_argument</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ParseableProtoT</span><span class="p">],</span> <span class="n">ParseableProtoT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a greedy argument to a parsable command through a decorator call.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * A greedy argument will consume the remaining positional arguments and pass</span>
<span class="sd">      them through to the converters as one joined string while also requiring</span>
<span class="sd">      that at least one more positional argument is remaining unless a</span>
<span class="sd">      default is set.</span>
<span class="sd">    * Order matters for positional arguments and since decorator execution</span>
<span class="sd">      starts at the decorator closest to the command and goes upwards this</span>
<span class="sd">      will decide where a positional argument is located in a command&#39;s</span>
<span class="sd">      signature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    key : str</span>
<span class="sd">        The string identifier of this argument (may be used to pass the result</span>
<span class="sd">        of this argument to the command&#39;s callback during execution).</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    converters : typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]</span>
<span class="sd">        The converter(s) this argument should use to handle values passed to it</span>
<span class="sd">        during parsing.</span>

<span class="sd">        If no converters are provided then the raw string value will be passed.</span>

<span class="sd">        Only the first converter to pass will be used.</span>
<span class="sd">    default : typing.Any</span>
<span class="sd">        The default value of this argument, if left as</span>
<span class="sd">        `UNDEFINED_DEFAULT` then this will have no default.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[ParseableProtoT], ParseableProtoT]:</span>
<span class="sd">        Decorator function for the parsable command this argument is being added to.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```python</span>
<span class="sd">    import tanjun</span>

<span class="sd">    @tanjun.parsing.with_greedy_argument(&quot;command&quot;, converters=StringView)</span>
<span class="sd">    @tanjun.parsing.with_parser</span>
<span class="sd">    @tanjun.component.as_message_command(&quot;command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.Context, /, argument: StringView):</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">with_argument</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">greedy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a greedy argument to a parsable command through a decorator call.</p>

<h6 id="notes">Notes</h6>

<ul>
<li>A greedy argument will consume the remaining positional arguments and pass
them through to the converters as one joined string while also requiring
that at least one more positional argument is remaining unless a
default is set.</li>
<li>Order matters for positional arguments and since decorator execution
starts at the decorator closest to the command and goes upwards this
will decide where a positional argument is located in a command's
signature.</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>key</strong> (str):
The string identifier of this argument (may be used to pass the result
of this argument to the command's callback during execution).</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>converters</strong> (typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]):
The converter(s) this argument should use to handle values passed to it
during parsing.</p>

<p>If no converters are provided then the raw string value will be passed.</p>

<p>Only the first converter to pass will be used.</p></li>
<li><strong>default</strong> (typing.Any):
The default value of this argument, if left as
<code>UNDEFINED_DEFAULT</code> then this will have no default.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[ParseableProtoT], ParseableProtoT]:</strong>: Decorator function for the parsable command this argument is being added to.</li>
</ul>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">tanjun</span>

<span class="nd">@tanjun</span><span class="o">.</span><span class="n">parsing</span><span class="o">.</span><span class="n">with_greedy_argument</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">StringView</span><span class="p">)</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">parsing</span><span class="o">.</span><span class="n">with_parser</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">component</span><span class="o">.</span><span class="n">as_message_command</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">StringView</span><span class="p">):</span>
    <span class="o">...</span>
</code></pre></div>
</div>


                </section>
                <section id="with_multi_argument">
                            <div class="attr function"><a class="headerlink" href="#with_multi_argument">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_multi_argument</span><span class="signature">(
    key: str,
    /,
    converters: Union[collections.abc.Iterable[collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]], collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]] = (),
    *,
    default: Union[Any, <a href="tanjun/parsing.html#UndefinedDefaultT">tanjun.parsing.UndefinedDefaultT</a>] = UNDEFINED_DEFAULT
) -&gt; collections.abc.Callable[[~ParseableProtoT], ~ParseableProtoT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_multi_argument</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ParseableProtoT</span><span class="p">],</span> <span class="n">ParseableProtoT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add a multi-argument to a parsable command through a decorator call.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * A multi argument will consume the remaining positional arguments and pass</span>
<span class="sd">      them to the converters through multiple calls while also requiring that</span>
<span class="sd">      at least one more positional argument is remaining unless a default is</span>
<span class="sd">      set and passing through the results to the command&#39;s callback as a</span>
<span class="sd">      sequence.</span>
<span class="sd">    * Order matters for positional arguments and since decorator execution</span>
<span class="sd">      starts at the decorator closest to the command and goes upwards this</span>
<span class="sd">      will decide where a positional argument is located in a command&#39;s</span>
<span class="sd">      signature.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    key : str</span>
<span class="sd">        The string identifier of this argument (may be used to pass the result</span>
<span class="sd">        of this argument to the command&#39;s callback during execution).</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    converters : typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]</span>
<span class="sd">        The converter(s) this argument should use to handle values passed to it</span>
<span class="sd">        during parsing.</span>

<span class="sd">        If no converters are provided then the raw string value will be passed.</span>

<span class="sd">        Only the first converter to pass will be used.</span>
<span class="sd">    default : typing.Any</span>
<span class="sd">        The default value of this argument, if left as</span>
<span class="sd">        `UNDEFINED_DEFAULT` then this will have no default.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[ParseableProtoT], ParseableProtoT]:</span>
<span class="sd">        Decorator function for the parsable command this argument is being added to.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```python</span>
<span class="sd">    import tanjun</span>

<span class="sd">    @tanjun.parsing.with_multi_argument(&quot;command&quot;, converters=int)</span>
<span class="sd">    @tanjun.parsing.with_parser</span>
<span class="sd">    @tanjun.component.as_message_command(&quot;command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.Context, /, argument: collections.abc.Sequence[int]):</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">with_argument</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a multi-argument to a parsable command through a decorator call.</p>

<h6 id="notes">Notes</h6>

<ul>
<li>A multi argument will consume the remaining positional arguments and pass
them to the converters through multiple calls while also requiring that
at least one more positional argument is remaining unless a default is
set and passing through the results to the command's callback as a
sequence.</li>
<li>Order matters for positional arguments and since decorator execution
starts at the decorator closest to the command and goes upwards this
will decide where a positional argument is located in a command's
signature.</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>key</strong> (str):
The string identifier of this argument (may be used to pass the result
of this argument to the command's callback during execution).</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>converters</strong> (typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]):
The converter(s) this argument should use to handle values passed to it
during parsing.</p>

<p>If no converters are provided then the raw string value will be passed.</p>

<p>Only the first converter to pass will be used.</p></li>
<li><strong>default</strong> (typing.Any):
The default value of this argument, if left as
<code>UNDEFINED_DEFAULT</code> then this will have no default.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[ParseableProtoT], ParseableProtoT]:</strong>: Decorator function for the parsable command this argument is being added to.</li>
</ul>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">tanjun</span>

<span class="nd">@tanjun</span><span class="o">.</span><span class="n">parsing</span><span class="o">.</span><span class="n">with_multi_argument</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">parsing</span><span class="o">.</span><span class="n">with_parser</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">component</span><span class="o">.</span><span class="n">as_message_command</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
    <span class="o">...</span>
</code></pre></div>
</div>


                </section>
                <section id="with_option">
                            <div class="attr function"><a class="headerlink" href="#with_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_option</span><span class="signature">(
    key: str,
    name: str,
    /,
    *names: str,
    converters: Union[collections.abc.Iterable[collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]], collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]] = (),
    default: Any,
    empty_value: Union[Any, <a href="tanjun/parsing.html#UndefinedDefaultT">tanjun.parsing.UndefinedDefaultT</a>] = UNDEFINED_DEFAULT,
    multi: bool = False
) -&gt; collections.abc.Callable[[~ParseableProtoT], ~ParseableProtoT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_option</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="n">empty_value</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
    <span class="n">multi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ParseableProtoT</span><span class="p">],</span> <span class="n">ParseableProtoT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add an option to a parsable command through a decorator call.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    key : str</span>
<span class="sd">        The string identifier of this option which will be used to pass the</span>
<span class="sd">        result of this argument to the command&#39;s callback during execution as</span>
<span class="sd">        a keyword argument.</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of this option used for identifying it in the parsed content.</span>
<span class="sd">    default : typing.Any</span>
<span class="sd">        The default value of this argument, unlike arguments this is required</span>
<span class="sd">        for options.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    *names : str</span>
<span class="sd">        Other names of this option used for identifying it in the parsed content.</span>
<span class="sd">    converters : typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]</span>
<span class="sd">        The converter(s) this argument should use to handle values passed to it</span>
<span class="sd">        during parsing.</span>

<span class="sd">        If no converters are provided then the raw string value will be passed.</span>

<span class="sd">        Only the first converter to pass will be used.</span>
<span class="sd">    empty_value : typing.Any</span>
<span class="sd">        The value to use if this option is provided without a value. If left as</span>
<span class="sd">        `UNDEFINED_DEFAULT` then this option will error if it&#39;s</span>
<span class="sd">        provided without a value.</span>
<span class="sd">    multi : bool</span>
<span class="sd">        If this option can be provided multiple times.</span>
<span class="sd">        Defaults to `False`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[ParseableProtoT], ParseableProtoT]:</span>
<span class="sd">        Decorator function for the parsable command this option is being added to.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```python</span>
<span class="sd">    import tanjun</span>

<span class="sd">    @tanjun.parsing.with_option(&quot;command&quot;, converters=int, default=42)</span>
<span class="sd">    @tanjun.parsing.with_parser</span>
<span class="sd">    @tanjun.component.as_message_command(&quot;command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.Context, /, argument: int):</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">command</span><span class="p">:</span> <span class="n">ParseableProtoT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParseableProtoT</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">parser</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot add an option to a command client without a parser.&quot;</span><span class="p">)</span>

        <span class="n">option</span> <span class="o">=</span> <span class="n">Option</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">empty_value</span><span class="o">=</span><span class="n">empty_value</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="n">multi</span><span class="p">)</span>
        <span class="n">command</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">command</span>

    <span class="k">return</span> <span class="n">decorator</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add an option to a parsable command through a decorator call.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>key</strong> (str):
The string identifier of this option which will be used to pass the
result of this argument to the command's callback during execution as
a keyword argument.</li>
<li><strong>name</strong> (str):
The name of this option used for identifying it in the parsed content.</li>
<li><strong>default</strong> (typing.Any):
The default value of this argument, unlike arguments this is required
for options.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>*names</strong> (str):
Other names of this option used for identifying it in the parsed content.</li>
<li><p><strong>converters</strong> (typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]):
The converter(s) this argument should use to handle values passed to it
during parsing.</p>

<p>If no converters are provided then the raw string value will be passed.</p>

<p>Only the first converter to pass will be used.</p></li>
<li><strong>empty_value</strong> (typing.Any):
The value to use if this option is provided without a value. If left as
<code>UNDEFINED_DEFAULT</code> then this option will error if it's
provided without a value.</li>
<li><strong>multi</strong> (bool):
If this option can be provided multiple times.
Defaults to <code>False</code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[ParseableProtoT], ParseableProtoT]:</strong>: Decorator function for the parsable command this option is being added to.</li>
</ul>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">tanjun</span>

<span class="nd">@tanjun</span><span class="o">.</span><span class="n">parsing</span><span class="o">.</span><span class="n">with_option</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">parsing</span><span class="o">.</span><span class="n">with_parser</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">component</span><span class="o">.</span><span class="n">as_message_command</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="o">...</span>
</code></pre></div>
</div>


                </section>
                <section id="with_multi_option">
                            <div class="attr function"><a class="headerlink" href="#with_multi_option">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_multi_option</span><span class="signature">(
    key: str,
    name: str,
    /,
    *names: str,
    converters: Union[collections.abc.Iterable[collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]], collections.abc.Callable[..., Union[Any, collections.abc.Awaitable[Any]]]] = (),
    default: Any,
    empty_value: Union[Any, <a href="tanjun/parsing.html#UndefinedDefaultT">tanjun.parsing.UndefinedDefaultT</a>] = UNDEFINED_DEFAULT
) -&gt; collections.abc.Callable[[~ParseableProtoT], ~ParseableProtoT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_multi_option</span><span class="p">(</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">converters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">ConverterSig</span><span class="p">],</span> <span class="n">ConverterSig</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">default</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="n">empty_value</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">UndefinedDefaultT</span><span class="p">]</span> <span class="o">=</span> <span class="n">UNDEFINED_DEFAULT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">ParseableProtoT</span><span class="p">],</span> <span class="n">ParseableProtoT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Add an multi-option to a command&#39;s parser through a decorator call.</span>

<span class="sd">    .. note::</span>
<span class="sd">        A multi option will consume all the values provided for an option and</span>
<span class="sd">        pass them through to the converters as an array of strings while also</span>
<span class="sd">        requiring that at least one value is provided for the option unless</span>
<span class="sd">        a default is set.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    key : str</span>
<span class="sd">        The string identifier of this option which will be used to pass the</span>
<span class="sd">        result of this argument to the command&#39;s callback during execution as</span>
<span class="sd">        a keyword argument.</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of this option used for identifying it in the parsed content.</span>
<span class="sd">    default : typing.Any</span>
<span class="sd">        The default value of this argument, unlike arguments this is required</span>
<span class="sd">        for options.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    *names : str</span>
<span class="sd">        Other names of this option used for identifying it in the parsed content.</span>
<span class="sd">    converters : typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]</span>
<span class="sd">        The converter(s) this argument should use to handle values passed to it</span>
<span class="sd">        during parsing.</span>

<span class="sd">        If no converters are provided then the raw string value will be passed.</span>

<span class="sd">        Only the first converter to pass will be used.</span>
<span class="sd">    empty_value : typing.Any</span>
<span class="sd">        The value to use if this option is provided without a value. If left as</span>
<span class="sd">        `UNDEFINED_DEFAULT` then this option will error if it&#39;s</span>
<span class="sd">        provided without a value.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    collections.abc.Callable[[ParseableProtoT], ParseableProtoT]:</span>
<span class="sd">        Decorator function for the parsable command this option is being added to.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ```python</span>
<span class="sd">    import tanjun</span>

<span class="sd">    @tanjun.parsing.with_multi_option(&quot;command&quot;, converters=int, default=())</span>
<span class="sd">    @tanjun.parsing.with_parser</span>
<span class="sd">    @tanjun.component.as_message_command(&quot;command&quot;)</span>
<span class="sd">    async def command(self, ctx: tanjun.abc.Context, /, argument: collections.abc.Sequence[int]):</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">with_option</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="n">converters</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">empty_value</span><span class="o">=</span><span class="n">empty_value</span><span class="p">,</span> <span class="n">multi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add an multi-option to a command's parser through a decorator call.</p>

<p><em>Note:</em>
A multi option will consume all the values provided for an option and
pass them through to the converters as an array of strings while also
requiring that at least one value is provided for the option unless
a default is set.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>key</strong> (str):
The string identifier of this option which will be used to pass the
result of this argument to the command's callback during execution as
a keyword argument.</li>
<li><strong>name</strong> (str):
The name of this option used for identifying it in the parsed content.</li>
<li><strong>default</strong> (typing.Any):
The default value of this argument, unlike arguments this is required
for options.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>*names</strong> (str):
Other names of this option used for identifying it in the parsed content.</li>
<li><p><strong>converters</strong> (typing.Union[ConverterSig, collections.abc.Iterable[ConverterSig]]):
The converter(s) this argument should use to handle values passed to it
during parsing.</p>

<p>If no converters are provided then the raw string value will be passed.</p>

<p>Only the first converter to pass will be used.</p></li>
<li><strong>empty_value</strong> (typing.Any):
The value to use if this option is provided without a value. If left as
<code>UNDEFINED_DEFAULT</code> then this option will error if it's
provided without a value.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[ParseableProtoT], ParseableProtoT]:</strong>: Decorator function for the parsable command this option is being added to.</li>
</ul>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">tanjun</span>

<span class="nd">@tanjun</span><span class="o">.</span><span class="n">parsing</span><span class="o">.</span><span class="n">with_multi_option</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="n">converters</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">())</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">parsing</span><span class="o">.</span><span class="n">with_parser</span>
<span class="nd">@tanjun</span><span class="o">.</span><span class="n">component</span><span class="o">.</span><span class="n">as_message_command</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
    <span class="o">...</span>
</code></pre></div>
</div>


                </section>
                <section id="with_parser">
                            <div class="attr function"><a class="headerlink" href="#with_parser">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_parser</span><span class="signature">(command: ~ParseableProtoT, /) -&gt; ~ParseableProtoT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">with_parser</span><span class="p">(</span><span class="n">command</span><span class="p">:</span> <span class="n">ParseableProtoT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParseableProtoT</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Add a shlex parser command parser to a supported command.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">command</span><span class="o">.</span><span class="n">set_parser</span><span class="p">(</span><span class="n">ShlexParser</span><span class="p">())</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a shlex parser command parser to a supported command.</p>
</div>


                </section>
                <section id="utilities">
                                <div class="attr module"><a class="headerlink" href="#utilities">#&nbsp;&nbsp</a>
<span class="name"><a href="tanjun/utilities.html">tanjun.utilities</a></span></div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;Collection of utility functions used within Tanjun.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;async_chain&quot;</span><span class="p">,</span>
    <span class="s2">&quot;gather_checks&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ALL_PERMISSIONS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CastedView&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DM_PERMISSIONS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;calculate_everyone_permissions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;calculate_permissions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;fetch_everyone_permissions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;fetch_permissions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;match_prefix_names&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">collections</span>

<span class="kn">import</span> <span class="nn">hikari</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">errors</span>

<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">abc</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">checks</span>


<span class="n">_KeyT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_KeyT&quot;</span><span class="p">)</span>
<span class="n">_ValueT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_ValueT&quot;</span><span class="p">)</span>
<span class="n">_OtherValueT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_OtherValueT&quot;</span><span class="p">)</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">async_chain</span><span class="p">(</span>
    <span class="n">iterable</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">AsyncIterable</span><span class="p">[</span><span class="n">_ValueT</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">[</span><span class="n">_ValueT</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Make an asynchronous iterator of the elements within multiple asynchronous iterators.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">async_iterable</span> <span class="ow">in</span> <span class="n">iterable</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">async_iterable</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">value</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">gather_checks</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">checks_</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">checks</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Gather a collection of checks.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ctx : tanjun.abc.Context</span>
<span class="sd">        The context to check.</span>
<span class="sd">    checks : collections.abc.Iterable[tanjun.injecting.InjectableCheck]</span>
<span class="sd">        An iterable of injectable checks.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        Whether all the checks passed or not.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="n">checks_</span><span class="p">))</span>
        <span class="c1"># InjectableCheck will raise FailedCheck if a false is received so if</span>
        <span class="c1"># we get this far then it&#39;s True.</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">FailedCheck</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>


<span class="k">def</span> <span class="nf">match_prefix_names</span><span class="p">(</span><span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Search for a matching name in a string.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    content : str</span>
<span class="sd">        The string to match names against.</span>
<span class="sd">    names : collections.abc.Iterable[str]</span>
<span class="sd">        The names to search for.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    typing.Optional[str]</span>
<span class="sd">        The name that matched or None if no name matched.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
        <span class="c1"># Here we enforce that a name must either be at the end of content or be followed by a space. This helps</span>
        <span class="c1"># avoid issues with ambiguous naming where a command with the names &quot;name&quot; and &quot;names&quot; may sometimes hit</span>
        <span class="c1"># the former before the latter when triggered with the latter, leading to the command potentially being</span>
        <span class="c1"># inconsistently parsed.</span>
        <span class="k">if</span> <span class="n">content</span> <span class="o">==</span> <span class="n">name</span> <span class="ow">or</span> <span class="n">content</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">content</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)]</span> <span class="o">==</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">name</span>


<span class="n">ALL_PERMISSIONS</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="p">]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="o">.</span><span class="n">all_permissions</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;All of all the known permissions based on the linked version of Hikari.&quot;&quot;&quot;</span>

<span class="n">DM_PERMISSIONS</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="o">.</span><span class="n">ADD_REACTIONS</span>
    <span class="o">|</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="o">.</span><span class="n">VIEW_CHANNEL</span>
    <span class="o">|</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="o">.</span><span class="n">SEND_MESSAGES</span>
    <span class="o">|</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="o">.</span><span class="n">EMBED_LINKS</span>
    <span class="o">|</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="o">.</span><span class="n">ATTACH_FILES</span>
    <span class="o">|</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="o">.</span><span class="n">READ_MESSAGE_HISTORY</span>
    <span class="o">|</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="o">.</span><span class="n">USE_EXTERNAL_EMOJIS</span>
    <span class="o">|</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="o">.</span><span class="n">USE_EXTERNAL_STICKERS</span>
    <span class="o">|</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="o">.</span><span class="n">USE_APPLICATION_COMMANDS</span>
<span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Bitfield of the permissions which are accessibly within DM channels.&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">_calculate_channel_overwrites</span><span class="p">(</span>
    <span class="n">channel</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">GuildChannel</span><span class="p">,</span> <span class="n">member</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Member</span><span class="p">,</span> <span class="n">permissions</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">everyone_overwrite</span> <span class="o">:=</span> <span class="n">channel</span><span class="o">.</span><span class="n">permission_overwrites</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">member</span><span class="o">.</span><span class="n">guild_id</span><span class="p">):</span>
        <span class="n">permissions</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">everyone_overwrite</span><span class="o">.</span><span class="n">deny</span>
        <span class="n">permissions</span> <span class="o">|=</span> <span class="n">everyone_overwrite</span><span class="o">.</span><span class="n">allow</span>

    <span class="n">deny</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="o">.</span><span class="n">NONE</span>
    <span class="n">allow</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="o">.</span><span class="n">NONE</span>

    <span class="k">for</span> <span class="n">overwrite</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="n">channel</span><span class="o">.</span><span class="n">permission_overwrites</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">member</span><span class="o">.</span><span class="n">role_ids</span><span class="p">)):</span>
        <span class="n">deny</span> <span class="o">|=</span> <span class="n">overwrite</span><span class="o">.</span><span class="n">deny</span>
        <span class="n">allow</span> <span class="o">|=</span> <span class="n">overwrite</span><span class="o">.</span><span class="n">allow</span>

    <span class="n">permissions</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">deny</span>
    <span class="n">permissions</span> <span class="o">|=</span> <span class="n">allow</span>

    <span class="k">if</span> <span class="n">member_overwrite</span> <span class="o">:=</span> <span class="n">channel</span><span class="o">.</span><span class="n">permission_overwrites</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">member</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">):</span>
        <span class="n">permissions</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">member_overwrite</span><span class="o">.</span><span class="n">deny</span>
        <span class="n">permissions</span> <span class="o">|=</span> <span class="n">member_overwrite</span><span class="o">.</span><span class="n">allow</span>

    <span class="k">return</span> <span class="n">permissions</span>


<span class="k">def</span> <span class="nf">_calculate_role_permissions</span><span class="p">(</span>
    <span class="n">roles</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">],</span> <span class="n">member</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Member</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="p">:</span>
    <span class="n">permissions</span> <span class="o">=</span> <span class="n">roles</span><span class="p">[</span><span class="n">member</span><span class="o">.</span><span class="n">guild_id</span><span class="p">]</span><span class="o">.</span><span class="n">permissions</span>

    <span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="n">roles</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">member</span><span class="o">.</span><span class="n">role_ids</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">role</span> <span class="ow">and</span> <span class="n">role</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">member</span><span class="o">.</span><span class="n">guild_id</span><span class="p">:</span>
            <span class="n">permissions</span> <span class="o">|=</span> <span class="n">role</span><span class="o">.</span><span class="n">permissions</span>

    <span class="k">return</span> <span class="n">permissions</span>


<span class="c1"># TODO: implicitly handle more special cases?</span>
<span class="k">def</span> <span class="nf">calculate_permissions</span><span class="p">(</span>
    <span class="n">member</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Member</span><span class="p">,</span>
    <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Guild</span><span class="p">,</span>
    <span class="n">roles</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">channel</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">GuildChannel</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Calculate the permissions a member has within a guild.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    member : hikari.guilds.Member</span>
<span class="sd">        Object of the member to calculate the permissions for.</span>
<span class="sd">    guild : hikari.guilds.Guild</span>
<span class="sd">        Object of the guild to calculate their permissions within.</span>
<span class="sd">    roles : collections.abc.Mapping[hikari.snowflakes.Snowflake, hikari.guilds.Role]</span>
<span class="sd">        Mapping of snowflake IDs to objects of the roles within the target</span>
<span class="sd">        guild.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    channel : typing.Optional[hikari.channels.GuildChannel]</span>
<span class="sd">        Object of the channel to calculate the member&#39;s permissions in.</span>

<span class="sd">        If this is left as `None` then this will just calculate their</span>
<span class="sd">        permissions on a guild level.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    hikari.permissions.Permission</span>
<span class="sd">        Value of the member&#39;s permissions either within the guild or specified</span>
<span class="sd">        guild channel.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">member</span><span class="o">.</span><span class="n">guild_id</span> <span class="o">!=</span> <span class="n">guild</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Member object isn&#39;t from the provided guild&quot;</span><span class="p">)</span>

    <span class="c1"># Guild owners are implicitly admins.</span>
    <span class="k">if</span> <span class="n">guild</span><span class="o">.</span><span class="n">owner_id</span> <span class="o">==</span> <span class="n">member</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ALL_PERMISSIONS</span>

    <span class="c1"># Admin permission overrides all overwrites and is only applicable to roles.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">permissions</span> <span class="o">:=</span> <span class="n">_calculate_role_permissions</span><span class="p">(</span><span class="n">roles</span><span class="p">,</span> <span class="n">member</span><span class="p">))</span> <span class="o">&amp;</span> <span class="n">permissions</span><span class="o">.</span><span class="n">ADMINISTRATOR</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ALL_PERMISSIONS</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">channel</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">permissions</span>

    <span class="k">return</span> <span class="n">_calculate_channel_overwrites</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">member</span><span class="p">,</span> <span class="n">permissions</span><span class="p">)</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">_fetch_channel</span><span class="p">(</span>
    <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="n">channel</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialChannel</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">GuildChannel</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">GuildChannel</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">channel</span>

    <span class="n">found_channel</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">client</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
        <span class="n">found_channel</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_guild_channel</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">channel</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">found_channel</span><span class="p">:</span>
        <span class="n">raw_channel</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_channel</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_channel</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">GuildChannel</span><span class="p">),</span> <span class="s2">&quot;Cannot perform operation on a DM channel.&quot;</span>
        <span class="n">found_channel</span> <span class="o">=</span> <span class="n">raw_channel</span>

    <span class="k">return</span> <span class="n">found_channel</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_permissions</span><span class="p">(</span>
    <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span>
    <span class="n">member</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Member</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">channel</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialChannel</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Calculate the permissions a member has within a guild.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This callback will fallback to REST requests if cache lookups fail or</span>
<span class="sd">        are not possible.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    client : tanjun.abc.Client</span>
<span class="sd">        The Tanjun client to use for lookups.</span>
<span class="sd">    member : hikari.guilds.Member</span>
<span class="sd">        The object of the member to calculate the permissions for.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    channel : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.channels.GuildChannel]]</span>
<span class="sd">        The object of ID of the channel to get their permissions in.</span>
<span class="sd">        If left as `None` then this will return their base guild</span>
<span class="sd">        permissions.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    hikari.permissions.Permissions</span>
<span class="sd">        The calculated permissions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># The ordering of how this adds and removes permissions does matter.</span>
    <span class="c1"># For more information see https://discord.com/developers/docs/topics/permissions#permission-hierarchy.</span>
    <span class="n">guild</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Guild</span><span class="p">]</span>
    <span class="n">roles</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">guild</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_guild</span><span class="p">(</span><span class="n">member</span><span class="o">.</span><span class="n">guild_id</span><span class="p">)</span> <span class="k">if</span> <span class="n">client</span><span class="o">.</span><span class="n">cache</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">guild</span><span class="p">:</span>
        <span class="n">guild</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_guild</span><span class="p">(</span><span class="n">member</span><span class="o">.</span><span class="n">guild_id</span><span class="p">)</span>
        <span class="n">roles</span> <span class="o">=</span> <span class="n">guild</span><span class="o">.</span><span class="n">roles</span>

    <span class="c1"># Guild owners are implicitly admins.</span>
    <span class="k">if</span> <span class="n">guild</span><span class="o">.</span><span class="n">owner_id</span> <span class="o">==</span> <span class="n">member</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ALL_PERMISSIONS</span>

    <span class="n">roles</span> <span class="o">=</span> <span class="n">roles</span> <span class="ow">or</span> <span class="n">client</span><span class="o">.</span><span class="n">cache</span> <span class="ow">and</span> <span class="n">client</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_roles_view_for_guild</span><span class="p">(</span><span class="n">member</span><span class="o">.</span><span class="n">guild_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">roles</span><span class="p">:</span>
        <span class="n">raw_roles</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_roles</span><span class="p">(</span><span class="n">member</span><span class="o">.</span><span class="n">guild_id</span><span class="p">)</span>
        <span class="n">roles</span> <span class="o">=</span> <span class="p">{</span><span class="n">role</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="n">role</span> <span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">raw_roles</span><span class="p">}</span>

    <span class="c1"># Admin permission overrides all overwrites and is only applicable to roles.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">permissions</span> <span class="o">:=</span> <span class="n">_calculate_role_permissions</span><span class="p">(</span><span class="n">roles</span><span class="p">,</span> <span class="n">member</span><span class="p">))</span> <span class="o">&amp;</span> <span class="n">permissions</span><span class="o">.</span><span class="n">ADMINISTRATOR</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ALL_PERMISSIONS</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">channel</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">permissions</span>

    <span class="n">channel</span> <span class="o">=</span> <span class="k">await</span> <span class="n">_fetch_channel</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">channel</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">channel</span><span class="o">.</span><span class="n">guild_id</span> <span class="o">!=</span> <span class="n">guild</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Channel doesn&#39;t match up with the member&#39;s guild&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_calculate_channel_overwrites</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">member</span><span class="p">,</span> <span class="n">permissions</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">calculate_everyone_permissions</span><span class="p">(</span>
    <span class="n">everyone_role</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">channel</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">GuildChannel</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Calculate a guild&#39;s default permissions within the guild or for a specific channel.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    everyone_role : hikari.guilds.Role</span>
<span class="sd">        The guild&#39;s default @everyone role.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    channel : typing.Optional[hikari.channels.GuildChannel]</span>
<span class="sd">        The channel to calculate the permissions for.</span>

<span class="sd">        If this is left as `None` then this will just calculate the default</span>
<span class="sd">        permissions on a guild level.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    hikari.permissions.Permissions</span>
<span class="sd">        The calculated permissions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># The ordering of how this adds and removes permissions does matter.</span>
    <span class="c1"># For more information see https://discord.com/developers/docs/topics/permissions#permission-hierarchy.</span>
    <span class="n">permissions</span> <span class="o">=</span> <span class="n">everyone_role</span><span class="o">.</span><span class="n">permissions</span>
    <span class="c1"># Admin permission overrides all overwrites and is only applicable to roles.</span>
    <span class="k">if</span> <span class="n">permissions</span> <span class="o">&amp;</span> <span class="n">permissions</span><span class="o">.</span><span class="n">ADMINISTRATOR</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ALL_PERMISSIONS</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">channel</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">permissions</span>

    <span class="k">if</span> <span class="n">everyone_overwrite</span> <span class="o">:=</span> <span class="n">channel</span><span class="o">.</span><span class="n">permission_overwrites</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">everyone_role</span><span class="o">.</span><span class="n">guild_id</span><span class="p">):</span>
        <span class="n">permissions</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">everyone_overwrite</span><span class="o">.</span><span class="n">deny</span>
        <span class="n">permissions</span> <span class="o">|=</span> <span class="n">everyone_overwrite</span><span class="o">.</span><span class="n">allow</span>

    <span class="k">return</span> <span class="n">permissions</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_everyone_permissions</span><span class="p">(</span>
    <span class="n">client</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span>
    <span class="n">guild_id</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">channel</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialChannel</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Permissions</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Calculate the permissions a guild&#39;s default @everyone role has within a guild or for a specific channel.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This callback will fallback to REST requests if cache lookups fail or</span>
<span class="sd">        are not possible.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    client : tanjun.abc.Client</span>
<span class="sd">        The Tanjun client to use for lookups.</span>
<span class="sd">    guild_id : hikari.snowflakes.Snowflake</span>
<span class="sd">        ID of the guild to calculate the default permissions for.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    channel : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.channels.PartialChannel]]</span>
<span class="sd">        The channel to calculate the permissions for.</span>

<span class="sd">        If this is left as `None` then this will just calculate the default</span>
<span class="sd">        permissions on a guild level.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    hikari.permissions.Permissions</span>
<span class="sd">        The calculated permissions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># The ordering of how this adds and removes permissions does matter.</span>
    <span class="c1"># For more information see https://discord.com/developers/docs/topics/permissions#permission-hierarchy.</span>
    <span class="n">role</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get_role</span><span class="p">(</span><span class="n">guild_id</span><span class="p">)</span> <span class="k">if</span> <span class="n">client</span><span class="o">.</span><span class="n">cache</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">role</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">fetch_roles</span><span class="p">(</span><span class="n">guild_id</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">role</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">guild_id</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Failed to find guild&#39;s @everyone role&quot;</span><span class="p">)</span>

    <span class="n">permissions</span> <span class="o">=</span> <span class="n">role</span><span class="o">.</span><span class="n">permissions</span>
    <span class="c1"># Admin permission overrides all overwrites and is only applicable to roles.</span>
    <span class="k">if</span> <span class="n">permissions</span> <span class="o">&amp;</span> <span class="n">permissions</span><span class="o">.</span><span class="n">ADMINISTRATOR</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ALL_PERMISSIONS</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">channel</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">permissions</span>

    <span class="n">channel</span> <span class="o">=</span> <span class="k">await</span> <span class="n">_fetch_channel</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">channel</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">everyone_overwrite</span> <span class="o">:=</span> <span class="n">channel</span><span class="o">.</span><span class="n">permission_overwrites</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">guild_id</span><span class="p">):</span>
        <span class="n">permissions</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">everyone_overwrite</span><span class="o">.</span><span class="n">deny</span>
        <span class="n">permissions</span> <span class="o">|=</span> <span class="n">everyone_overwrite</span><span class="o">.</span><span class="n">allow</span>

    <span class="k">return</span> <span class="n">permissions</span>


<span class="k">class</span> <span class="nc">CastedView</span><span class="p">(</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="n">_KeyT</span><span class="p">,</span> <span class="n">_OtherValueT</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">_KeyT</span><span class="p">,</span> <span class="n">_ValueT</span><span class="p">,</span> <span class="n">_OtherValueT</span><span class="p">]):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_buffer&quot;</span><span class="p">,</span> <span class="s2">&quot;_cast&quot;</span><span class="p">,</span> <span class="s2">&quot;_raw_data&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">_KeyT</span><span class="p">,</span> <span class="n">_ValueT</span><span class="p">],</span> <span class="n">cast</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">_ValueT</span><span class="p">],</span> <span class="n">_OtherValueT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">_KeyT</span><span class="p">,</span> <span class="n">_OtherValueT</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cast</span> <span class="o">=</span> <span class="n">cast</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_raw_data</span> <span class="o">=</span> <span class="n">raw_data</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">_KeyT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_OtherValueT</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_raw_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cast</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">_KeyT</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_raw_data</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_raw_data</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Collection of utility functions used within Tanjun.</p>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span><span class="signature">(${doc.parameters.join(", ")})</span>`;
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>