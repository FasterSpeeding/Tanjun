<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 8.0.0" />
    <title>tanjun.clients API documentation</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2264%22%20height%3D%2264%22%20viewBox%3D%2244.5%202.5%2015%2015%22%3E%3Cpath%20d%3D%22M49.351%2021.041c-.233-.721-.546-2.408-.772-4.076-.042-.09-.067-.187-.046-.288-.166-1.347-.277-2.625-.241-3.351-1.378-1.008-2.271-2.586-2.271-4.362%200-.976.272-1.935.788-2.774.057-.094.122-.18.184-.268-.033-.167-.052-.339-.052-.516%200-1.477%201.202-2.679%202.679-2.679.791%200%201.496.352%201.987.9a6.3%206.3%200%200%201%201.001.029c.492-.564%201.207-.929%202.012-.929%201.477%200%202.679%201.202%202.679%202.679a2.65%202.65%200%200%201-.269%201.148c.383.747.595%201.572.595%202.41%200%202.311-1.507%204.29-3.635%205.107.037.699.147%202.27.423%203.294l.137.461c.156%202.136-4.612%205.166-5.199%203.215zm.127-4.919a4.78%204.78%200%200%200%20.775-.584c-.172-.115-.505-.254-.88-.378zm.331%202.302l.828-.502c-.202-.143-.576-.328-.984-.49zm.45%202.157l.701-.403c-.214-.115-.536-.249-.891-.376l.19.779zM49.13%204.141c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm.735-.389a1.15%201.15%200%200%201%20.314.783%201.16%201.16%200%200%201-1.162%201.162c-.457%200-.842-.27-1.032-.653-.026.117-.042.238-.042.362a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.843-.626-1.535-1.436-1.654zm3.076%201.654a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.037-.009-.072-.011-.109-.21.3-.541.508-.935.508a1.16%201.16%200%200%201-1.162-1.162%201.14%201.14%200%200%201%20.474-.912c-.015%200-.03-.005-.045-.005-.926.001-1.679.754-1.679%201.68zm1.861-1.265c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm1.823%204.823c0-.52-.103-1.035-.288-1.52-.466.394-1.06.64-1.717.64-1.144%200-2.116-.725-2.499-1.738-.383%201.012-1.355%201.738-2.499%201.738-.867%200-1.631-.421-2.121-1.062-.307.605-.478%201.267-.478%201.942%200%202.486%202.153%204.51%204.801%204.51s4.801-2.023%204.801-4.51zm-3.032%209.156l-.146-.492c-.276-1.02-.395-2.457-.444-3.268a6.11%206.11%200%200%201-1.18.115%206.01%206.01%200%200%201-2.536-.562l.006.175c.802.215%201.848.612%202.021%201.25.079.295-.021.601-.274.837l-.598.501c.667.304%201.243.698%201.311%201.179.02.144.022.507-.393.787l-.564.365c1.285.521%201.361.96%201.381%201.126.018.142.011.496-.427.746l-.854.489c.064-1.19%201.985-2.585%202.697-3.248zM49.34%209.925c0-.667%201-.667%201%200%200%20.653.818%201.205%201.787%201.205s1.787-.552%201.787-1.205c0-.667%201-.667%201%200%200%201.216-1.25%202.205-2.787%202.205s-2.787-.989-2.787-2.205zm-.887-7.633c-.093.077-.205.114-.317.114a.5.5%200%200%201-.318-.886L49.183.397a.5.5%200%200%201%20.703.068.5.5%200%200%201-.069.703zm7.661-.065c-.086%200-.173-.022-.253-.068l-1.523-.893c-.575-.337-.069-1.2.506-.863l1.523.892a.5.5%200%200%201%20.179.685c-.094.158-.261.247-.432.247z%22%20fill%3D%22%233bb300%22/%3E%3C/svg%3E"/>


<style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
<style>pre{line-height:125%;}td.linenos pre{color:#ff5555;background-color:#282a36;padding-left:5px;padding-right:5px;}span.linenos{color:#ff5555;background-color:#282a36;padding-left:5px;padding-right:5px;}td.linenos pre.special{color:#ff5555;background-color:#ffffc0;padding-left:5px;padding-right:5px;}span.linenos.special{color:#ff5555;background-color:#ffffc0;padding-left:5px;padding-right:5px;}.pdoc .hll{background-color:#282a36;}.pdoc{background:#282a36;color:#ff5555;}.pdoc .c{color:#6a7aaa;}.pdoc .err{color:#ff5555;background-color:#1e0010;}.pdoc .k{color:#ff79c6;}.pdoc .l{color:#ae81ff;}.pdoc .n{color:#f8f8f2;}.pdoc .o{color:#ff79c6;}.pdoc .p{color:#f8f8f2;}.pdoc .ch{color:#6a7aaa;}.pdoc .cm{color:#6a7aaa;}.pdoc .cp{color:#6a7aaa;}.pdoc .cpf{color:#6a7aaa;}.pdoc .c1{color:#6a7aaa;}.pdoc .cs{color:#6a7aaa;}.pdoc .gd{color:#6a7aaa;}.pdoc .ge{font-style:italic;}.pdoc .gi{color:#a6e22e;}.pdoc .go{color:#ff79c6;}.pdoc .gp{color:#f92672;font-weight:bold;}.pdoc .gs{font-weight:bold;}.pdoc .gu{color:#75715e;}.pdoc .kc{color:#ff79c6;}.pdoc .kd{color:#bd93f9;}.pdoc .kn{color:#ff79c6;}.pdoc .kp{color:#bd93f9;}.pdoc .kr{color:#ff79c6;}.pdoc .kt{color:#ff79c6;}.pdoc .ld{color:#e6db74;}.pdoc .m{color:#ae81ff;}.pdoc .s{color:#e6db74;}.pdoc .na{color:#a6e22e;}.pdoc .nb{color:#8be9fd;}.pdoc .nc{color:#8be9fd;}.pdoc .no{color:#ff79c6;}.pdoc .nd{color:#8be9fd;}.pdoc .ni{color:#ff79c6;}.pdoc .ne{color:#8be9fd;}.pdoc .nf{color:#50fa7b;}.pdoc .nl{color:#f8f8f2;}.pdoc .nn{color:#f8f8f2;}.pdoc .nx{color:#a6e22e;}.pdoc .py{color:#f8f8f2;}.pdoc .nt{color:#f92672;}.pdoc .nv{color:#f8f8f2;}.pdoc .ow{color:#ff79c6;}.pdoc .w{color:#f8f8f2;}.pdoc .mb{color:#ae81ff;}.pdoc .mf{color:#ae81ff;}.pdoc .mh{color:#ae81ff;}.pdoc .mi{color:#ae81ff;}.pdoc .mo{color:#ae81ff;}.pdoc .sa{color:#ff79c6;}.pdoc .sb{color:#e6db74;}.pdoc .sc{color:#e6db74;}.pdoc .dl{color:#e6db74;}.pdoc .sd{color:#6272a4;}.pdoc .s2{color:#e6db74;}.pdoc .se{color:#ae81ff;}.pdoc .sh{color:#e6db74;}.pdoc .si{color:#bd93f9;}.pdoc .sx{color:#e6db74;}.pdoc .sr{color:#e6db74;}.pdoc .s1{color:#e6db74;}.pdoc .ss{color:#e6db74;}.pdoc .bp{color:#bd93f9;}.pdoc .fm{color:#bd93f9;}.pdoc .vc{color:#bd93f9;}.pdoc .vg{color:#f8f8f2;}.pdoc .vi{color:#ffffff;}.pdoc .vm{color:#bd93f9;}.pdoc .il{color:#ae81ff;}.pdoc .nd{color:#50fa7b;}*{font-family:SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}.pdoc .classattr{color:#fff;}.pdoc p{color:#fff;font-weight:300;}.pdoc .modulename{color:#fff;font-weight:0;margin:0.3em 0;padding:0.2em 0;}.pdoc h5{color:white;font-style:italic;}nav.pdoc a.function{color:#4dec75;}nav.pdoc a.variable{color:white;}nav.pdoc a.class{color:#8be9fd;}nav.pdoc a.class:hover{color:#fff;}nav.pdoc li a{color:#bd93f9;}.pdoc span.default_value{color:#e6db74;}.pdoc .attr{color:white;}.pdoc h6#attributes{color:#fff;font-size:23px;}.pdoc h6#example{color:#fff;font-size:29px;}.pdoc h6#examples{color:#fff;font-size:29px;}.pdoc h6#notes{font-size:23px;color:orange;}.pdoc h6#returns{font-size:23px;color:white;}.pdoc h6#parameters{font-size:23px;color:white;}.pdoc h6#raises{font-size:23px;color:#ff6666;}.pdoc .kc{color:#bd93f9;}.pdoc li{color:white;}.pdoc div.decorator{color:#50fa7b;}.pdoc strong,b{color:rgb(244, 90, 177);font-weight:normal;}.pdoc em{color:orange;}.pdoc span.name{color:#8be9fd;}.pdoc span.base{color:#8be9fd;}.pdoc span.def{font-weight:normal;}.pdoc .inherited dt,.pdoc .inherited dt::before{color:#8be9fd;}.pdoc .inherited dd,.pdoc .inherited dd{color:#fff;}.pdoc .inherited dd:not(:last-child)::after{color:#fff;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;margin-bottom:1rem;color:white;border-color:white;}nav.pdoc .module-list-button:hover{border-color:white;color:white;}.pdoc h1,.pdoc h2,.pdoc h3{font-weight:300;margin:0.3em 0;padding:0.2em 0;color:white;}</style>
<style>/*! pdoc */:root{--pdoc-background:#272935;}.pdoc{--text:white;--muted:#9d9d9d;--link:#bd93f9;--link-hover:white;--active:#555;--code:#232627;--accent:#232627;--accent2:#FFF;--nav-hover:rgba(0, 0, 0, 0.1);--name:#50fa7b;--def:rgb(244, 90, 177);--annotation:white;}body{background-color:var(--pdoc-background);}html, body{width:100%;height:100%;}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}.git-button{display:none !important;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}#navtoggle{display:none;}}#togglestate{display:none;}nav.pdoc{--pad:1.75rem;--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc li{display:block;margin:0;padding:.2rem 0 .2rem var(--indent);transition:all 100ms;}nav.pdoc > div > ul > li{padding-left:0;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}html, main{scroll-behavior:smooth;}.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{background-color:var(--code);border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.pdoc details{--shift:-40px;text-align:right;margin-top:var(--shift);margin-bottom:calc(0px - var(--shift));clear:both;filter:opacity(1);}.pdoc details:not([open]){height:0;overflow:visible;}.pdoc details > summary{font-size:.75rem;cursor:pointer;color:var(--muted);border-width:0;padding:0 .7em;display:inline-block;display:inline list-item;user-select:none;}.pdoc details > summary:focus{outline:0;}.pdoc details > div{margin-top:calc(0px - var(--shift) / 2);text-align:left;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc > section:first-of-type > .docstring{margin-bottom:3rem;}.pdoc .docstring pre{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc .headerlink{position:absolute;width:0;margin-left:-1.5rem;line-height:1.4rem;font-size:1.5rem;font-weight:normal;transition:all 100ms ease-in-out;opacity:0;}.pdoc .attr > .headerlink{margin-left:-2.5rem;}.pdoc *:hover > .headerlink,.pdoc *:target > .attr > .headerlink{opacity:1;}.pdoc .attr{display:block;color:var(--text);margin:1rem 0 .5rem;padding:.4rem 5rem .4rem 1rem;background-color:var(--accent);}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{white-space:pre-wrap;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}</style>
</head>
<body>        <nav class="pdoc">
            <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
            <input id="togglestate" type="checkbox">
            <div>
                        <a class="pdoc-button module-list-button" href="../tanjun.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                            &nbsp;tanjun</a>


                        <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                               pattern=".+" required>



                    <h2>API Documentation</h2>
                        <ul class="memberlist">
            <li>
                    <a class="function" href="#as_loader">as_loader</a>
            </li>
            <li>
                    <a class="function" href="#as_unloader">as_unloader</a>
            </li>
            <li>
                    <a class="class" href="#Client">Client</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Client.__init__">Client</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.from_gateway_bot">from_gateway_bot</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.from_rest_bot">from_rest_bot</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.message_accepts">message_accepts</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.is_human_only">is_human_only</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.cache">cache</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.checks">checks</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.components">components</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.events">events</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.listeners">listeners</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.hooks">hooks</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.slash_hooks">slash_hooks</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.is_alive">is_alive</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.message_hooks">message_hooks</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.metadata">metadata</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.prefix_getter">prefix_getter</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.prefixes">prefixes</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.rest">rest</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.server">server</a>
                        </li>
                        <li>
                                <a class="variable" href="#Client.shards">shards</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.declare_slash_command">declare_slash_command</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.declare_slash_commands">declare_slash_commands</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_auto_defer_after">set_auto_defer_after</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_hikari_trait_injectors">set_hikari_trait_injectors</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_interaction_not_found">set_interaction_not_found</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_message_accepts">set_message_accepts</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_message_ctx_maker">set_message_ctx_maker</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_slash_ctx_maker">set_slash_ctx_maker</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_human_only">set_human_only</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.clear_commands">clear_commands</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_global_commands">set_global_commands</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.declare_global_commands">declare_global_commands</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.add_check">add_check</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.remove_check">remove_check</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.with_check">with_check</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.check">check</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.add_component">add_component</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.get_component_by_name">get_component_by_name</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.remove_component">remove_component</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.remove_component_by_name">remove_component_by_name</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.add_client_callback">add_client_callback</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.dispatch_client_callback">dispatch_client_callback</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.get_client_callbacks">get_client_callbacks</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.remove_client_callback">remove_client_callback</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.with_client_callback">with_client_callback</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.add_listener">add_listener</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.remove_listener">remove_listener</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.with_listener">with_listener</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.add_prefix">add_prefix</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.remove_prefix">remove_prefix</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_prefix_getter">set_prefix_getter</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.with_prefix_getter">with_prefix_getter</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.iter_commands">iter_commands</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.iter_message_commands">iter_message_commands</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.iter_slash_commands">iter_slash_commands</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.check_message_name">check_message_name</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.check_slash_name">check_slash_name</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.close">close</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.open">open</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.fetch_rest_application_id">fetch_rest_application_id</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_hooks">set_hooks</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_slash_hooks">set_slash_hooks</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.set_message_hooks">set_message_hooks</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.load_modules">load_modules</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.unload_modules">unload_modules</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.reload_modules">reload_modules</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.on_message_create_event">on_message_create_event</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.on_interaction_create_event">on_interaction_create_event</a>
                        </li>
                        <li>
                                <a class="function" href="#Client.on_interaction_create_request">on_interaction_create_request</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ClientCallbackNames">ClientCallbackNames</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#ClientCallbackNames.CLOSED">CLOSED</a>
                        </li>
                        <li>
                                <a class="variable" href="#ClientCallbackNames.CLOSING">CLOSING</a>
                        </li>
                        <li>
                                <a class="variable" href="#ClientCallbackNames.COMPONENT_ADDED">COMPONENT_ADDED</a>
                        </li>
                        <li>
                                <a class="variable" href="#ClientCallbackNames.COMPONENT_REMOVED">COMPONENT_REMOVED</a>
                        </li>
                        <li>
                                <a class="variable" href="#ClientCallbackNames.MESSAGE_COMMAND_NOT_FOUND">MESSAGE_COMMAND_NOT_FOUND</a>
                        </li>
                        <li>
                                <a class="variable" href="#ClientCallbackNames.SLASH_COMMAND_NOT_FOUND">SLASH_COMMAND_NOT_FOUND</a>
                        </li>
                        <li>
                                <a class="variable" href="#ClientCallbackNames.STARTED">STARTED</a>
                        </li>
                        <li>
                                <a class="variable" href="#ClientCallbackNames.STARTING">STARTING</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#LoaderSig">LoaderSig</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#MessageAcceptsEnum">MessageAcceptsEnum</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#MessageAcceptsEnum.ALL">ALL</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageAcceptsEnum.DM_ONLY">DM_ONLY</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageAcceptsEnum.GUILD_ONLY">GUILD_ONLY</a>
                        </li>
                        <li>
                                <a class="variable" href="#MessageAcceptsEnum.NONE">NONE</a>
                        </li>
                        <li>
                                <a class="function" href="#MessageAcceptsEnum.get_event_type">get_event_type</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PrefixGetterSig">PrefixGetterSig</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="variable" href="#PrefixGetterSigT">PrefixGetterSigT</a>
            </li>
    </ul>



                    <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev">
                        built with <span class="visually-hidden">pdoc</span><img
                            alt="pdoc logo"
                            src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
                    </a>
            </div>
        </nav>
    <main class="pdoc">
            <section>
                    <h1 class="modulename">
<a href="./../tanjun.html">tanjun</a><wbr>.clients    </h1>

                        <div class="docstring"><p>Standard Tanjun client.</p>
</div>

                        <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># cython: language_level=3</span>
<span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020-2021, Faster Speeding</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   list of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># * Neither the name of the copyright holder nor the names of its</span>
<span class="c1">#   contributors may be used to endorse or promote products derived from</span>
<span class="c1">#   this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="sd">&quot;&quot;&quot;Standard Tanjun client.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="n">__all__</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;as_loader&quot;</span><span class="p">,</span>
    <span class="s2">&quot;as_unloader&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Client&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ClientCallbackNames&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LoaderSig&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MessageAcceptsEnum&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PrefixGetterSig&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PrefixGetterSigT&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">enum</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">importlib</span>
<span class="kn">import</span> <span class="nn">importlib.abc</span> <span class="k">as</span> <span class="nn">importlib_abc</span>
<span class="kn">import</span> <span class="nn">importlib.util</span> <span class="k">as</span> <span class="nn">importlib_util</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">collections</span>

<span class="kn">import</span> <span class="nn">hikari</span>
<span class="kn">from</span> <span class="nn">hikari</span> <span class="kn">import</span> <span class="n">traits</span> <span class="k">as</span> <span class="n">hikari_traits</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_backoff</span> <span class="k">as</span> <span class="n">backoff</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">abc</span> <span class="k">as</span> <span class="n">tanjun_abc</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">checks</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">context</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">errors</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">hooks</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">injecting</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">utilities</span>

<span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pathlib</span>
    <span class="kn">import</span> <span class="nn">types</span>

    <span class="n">_ClientT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_ClientT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;Client&quot;</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">_MessageContextMakerProto</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Protocol</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span>
            <span class="n">injection_client</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">InjectorClient</span><span class="p">,</span>
            <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">message</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Message</span><span class="p">,</span>
            <span class="o">*</span><span class="p">,</span>
            <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">triggering_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">triggering_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">class</span> <span class="nc">_SlashContextMakerProto</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">Protocol</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">client</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span>
            <span class="n">injection_client</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">InjectorClient</span><span class="p">,</span>
            <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span>
            <span class="o">*</span><span class="p">,</span>
            <span class="n">command</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">component</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">default_to_ephemeral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">not_found_message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span>


<span class="n">LoaderSig</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="s2">&quot;Client&quot;</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span>
<span class="sd">&quot;&quot;&quot;Type hint of the callback used to load resources into a Tanjun client.</span>

<span class="sd">This should take one positional argument of type `Client` and return nothing.</span>
<span class="sd">This will be expected to initiate and resources like components to the client</span>
<span class="sd">through the use of it&#39;s protocol methods.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">PrefixGetterSig</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Awaitable</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span>
<span class="sd">&quot;&quot;&quot;Type hint of a callable used to get the prefix(es) for a specific guild.</span>

<span class="sd">This should be an asynchronous callable which returns an iterable of strings.</span>

<span class="sd">.. note::</span>
<span class="sd">    While dependency injection is supported for this, the first positional</span>
<span class="sd">    argument will always be a `tanjun.abc.MessageContext`.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">PrefixGetterSigT</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;PrefixGetterSigT&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;PrefixGetterSig&quot;</span><span class="p">)</span>

<span class="n">_LOGGER</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Final</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">]</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;hikari.tanjun.clients&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_LoaderDescriptor</span><span class="p">:</span>  <span class="c1"># Slots mess with functools.update_wrapper</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">LoaderSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">update_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_UnloaderDescriptor</span><span class="p">:</span>  <span class="c1"># Slots mess with functools.update_wrapper</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">LoaderSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">update_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">as_loader</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">LoaderSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoaderSig</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Mark a callback as being used to load Tanjun components from a module.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This is only necessary if you wish to use `tanjun.Client.load_modules`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    callback : LoaderSig</span>
<span class="sd">        The callback used to load Tanjun components from a module. This</span>
<span class="sd">        should take one argument of type `tanjun.Client`, return nothing</span>
<span class="sd">        and will be expected to initiate and add utilities such as components</span>
<span class="sd">        to the provided client using it&#39;s abstract methods.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    LoaderSig</span>
<span class="sd">        The decorated load callback.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_LoaderDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">as_unloader</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">LoaderSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoaderSig</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Mark a callback as being used to unload a module&#39;s utilities from a client.</span>

<span class="sd">    ... note::</span>
<span class="sd">        This is the inverse of `as_loader` and is only necessary if you wish</span>
<span class="sd">        to use the `tanjun.Client.unload_module` or</span>
<span class="sd">        `tanjun.Client.reload_module`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    callback : LoaderSig</span>
<span class="sd">        The callback used to unload Tanjun utilities from a module. This</span>
<span class="sd">        should take one argument of type `tanjun.Client`, return nothing</span>
<span class="sd">        and will be expected to remove utilities such as components</span>
<span class="sd">        from the provided client using it&#39;s abstract methods.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    LoaderSig</span>
<span class="sd">        The decorated unload callback.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_UnloaderDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ClientCallbackNames</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Enum of the client callback names dispatched by the standard `Client`.&quot;&quot;&quot;</span>

    <span class="n">CLOSED</span> <span class="o">=</span> <span class="s2">&quot;closed&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when the client has finished closing.</span>

<span class="sd">    No positional arguments are provided for this event.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CLOSING</span> <span class="o">=</span> <span class="s2">&quot;closing&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when the client is initially instructed to close.</span>

<span class="sd">    No positional arguments are provided for this event.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">COMPONENT_ADDED</span> <span class="o">=</span> <span class="s2">&quot;component_added&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when a component is added to an active client.</span>

<span class="sd">    .. warning::</span>
<span class="sd">        This event isn&#39;t dispatched for components which were registered while</span>
<span class="sd">        the client is inactive.</span>

<span class="sd">    The first positional argument is the `tanjun.abc.Component` being added.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">COMPONENT_REMOVED</span> <span class="o">=</span> <span class="s2">&quot;component_removed&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when a component is added to an active client.</span>

<span class="sd">    .. warning::</span>
<span class="sd">        This event isn&#39;t dispatched for components which were removed while</span>
<span class="sd">        the client is inactive.</span>

<span class="sd">    The first positional argument is the `tanjun.abc.Component` being removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">MESSAGE_COMMAND_NOT_FOUND</span> <span class="o">=</span> <span class="s2">&quot;message_command_not_found&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when a message command is not found.</span>

<span class="sd">    `tanjun.abc.MessageContext` is provided as the first positional argument.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SLASH_COMMAND_NOT_FOUND</span> <span class="o">=</span> <span class="s2">&quot;slash_command_not_found&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when a slash command is not found.</span>

<span class="sd">    `tanjun.abc.MessageContext` is provided as the first positional argument.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">STARTED</span> <span class="o">=</span> <span class="s2">&quot;started&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when the client has finished starting.</span>

<span class="sd">    No positional arguments are provided for this event.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">STARTING</span> <span class="o">=</span> <span class="s2">&quot;starting&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when the client is initially instructed to start.</span>

<span class="sd">    No positional arguments are provided for this event.</span>
<span class="sd">    &quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">MessageAcceptsEnum</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The possible configurations for which events `Client` should execute commands based on.&quot;&quot;&quot;</span>

    <span class="n">ALL</span> <span class="o">=</span> <span class="s2">&quot;ALL&quot;</span>
    <span class="sd">&quot;&quot;&quot;Set the client to execute commands based on both DM and guild message create events.&quot;&quot;&quot;</span>

    <span class="n">DM_ONLY</span> <span class="o">=</span> <span class="s2">&quot;DM_ONLY&quot;</span>
    <span class="sd">&quot;&quot;&quot;Set the client to execute commands based only DM message create events.&quot;&quot;&quot;</span>

    <span class="n">GUILD_ONLY</span> <span class="o">=</span> <span class="s2">&quot;GUILD_ONLY&quot;</span>
    <span class="sd">&quot;&quot;&quot;Set the client to execute commands based only guild message create events.&quot;&quot;&quot;</span>

    <span class="n">NONE</span> <span class="o">=</span> <span class="s2">&quot;NONE&quot;</span>
    <span class="sd">&quot;&quot;&quot;Set the client to not execute commands based on message create events.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_event_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Get the base event type this mode listens to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[type[hikari.message_events.MessageCreateEvent]]</span>
<span class="sd">            The type object of the MessageCreateEvent class this mode will</span>
<span class="sd">            register a listener for.</span>

<span class="sd">            This will be `None` if this mode disables listening to</span>
<span class="sd">            message create events.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_ACCEPTS_EVENT_TYPE_MAPPING</span><span class="p">[</span><span class="bp">self</span><span class="p">]</span>


<span class="n">_ACCEPTS_EVENT_TYPE_MAPPING</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">MessageAcceptsEnum</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">ALL</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">,</span>
    <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">DM_ONLY</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">DMMessageCreateEvent</span><span class="p">,</span>
    <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">GUILD_ONLY</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">GuildMessageCreateEvent</span><span class="p">,</span>
    <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">NONE</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">_check_human</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">ctx</span><span class="o">.</span><span class="n">is_human</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">_wrap_client_callback</span><span class="p">(</span>
    <span class="n">callback</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">],</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">AbstractInjectionContext</span><span class="p">,</span>
    <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
    <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">callback</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Client callback raised exception&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="n">exc</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_InjectablePrefixGetter</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">BaseInjectableCallback</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">PrefixGetterSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptor</span><span class="o">.</span><span class="n">resolve_with_command_context</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PrefixGetterSig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">PrefixGetterSig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptor</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_InjectableListener</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">BaseInjectableCallback</span><span class="p">[</span><span class="kc">None</span><span class="p">]):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_injector_client&quot;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">injector_client</span><span class="p">:</span> <span class="n">injecting</span><span class="o">.</span><span class="n">InjectorClient</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_injector_client</span> <span class="o">=</span> <span class="n">injector_client</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">BasicInjectionContext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_injector_client</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptor</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">on_parser_error</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="n">errors</span><span class="o">.</span><span class="n">ParserError</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Handle message parser errors.</span>

<span class="sd">    This is the default message parser error hook included by `Client`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">error</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_cmp_command</span><span class="p">(</span><span class="n">builder</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">CommandBuilder</span><span class="p">],</span> <span class="n">command</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">builder</span> <span class="ow">or</span> <span class="n">builder</span><span class="o">.</span><span class="n">id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="ow">and</span> <span class="n">builder</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">command</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">builder</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="n">command</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="n">builder</span><span class="o">.</span><span class="n">description</span> <span class="o">!=</span> <span class="n">command</span><span class="o">.</span><span class="n">description</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">default_perm</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">default_permission</span> <span class="k">if</span> <span class="n">builder</span><span class="o">.</span><span class="n">default_permission</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="k">else</span> <span class="kc">True</span>
    <span class="n">command_options</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">options</span> <span class="ow">or</span> <span class="p">()</span>
    <span class="k">if</span> <span class="n">default_perm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">command</span><span class="o">.</span><span class="n">default_permission</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">builder</span><span class="o">.</span><span class="n">options</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">command_options</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">builder_option</span> <span class="o">==</span> <span class="n">option</span> <span class="k">for</span> <span class="n">builder_option</span><span class="p">,</span> <span class="n">option</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">builder</span><span class="o">.</span><span class="n">options</span><span class="p">,</span> <span class="n">command_options</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">_StartDeclarer</span><span class="p">:</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;client&quot;</span><span class="p">,</span> <span class="s2">&quot;command_ids&quot;</span><span class="p">,</span> <span class="s2">&quot;guild_id&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">client</span><span class="p">:</span> <span class="n">Client</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]],</span>
        <span class="n">guild_id</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command_ids</span> <span class="o">=</span> <span class="n">command_ids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">guild_id</span> <span class="o">=</span> <span class="n">guild_id</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">declare_global_commands</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">command_ids</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">guild_id</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">remove_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Client</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">InjectorClient</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tanjun&#39;s standard `tanjun.abc.Client` implementation.</span>

<span class="sd">    This implementation supports dependency injection for checks, command</span>
<span class="sd">    callbacks, prefix getters and event listeners. For more information on how</span>
<span class="sd">    this works see `tanjun.injecting`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * For a quicker way to initiate this client around a standard bot aware</span>
<span class="sd">      client, see `Client.from_gateway_bot` and `Client.from_rest_bot`.</span>
<span class="sd">    * The endpoint used by `declare_global_commands` has a strict ratelimit which,</span>
<span class="sd">      as of writing, only allows for 2 requests per minute (with that ratelimit</span>
<span class="sd">      either being per-guild if targeting a specific guild otherwise globally).</span>
<span class="sd">    * `event_manager` is necessary for message command dispatch and will also</span>
<span class="sd">      be necessary for interaction command dispatch if `server` isn&#39;t</span>
<span class="sd">      provided.</span>
<span class="sd">    * `server` is used for interaction command dispatch if interaction</span>
<span class="sd">      events aren&#39;t being received from the event manager.</span>
<span class="sd">    * By default this client includes a parser error handling hook which will</span>
<span class="sd">      by overwritten if you call `Client.set_hooks`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rest : hikari.api.rest.RestClient</span>
<span class="sd">        The Hikari REST client this will use.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    cache : hikari.api.cache.CacheClient</span>
<span class="sd">        The Hikari cache client this will use if applicable.</span>
<span class="sd">    event_manager : hikari.api.event_manager.EventManagerClient</span>
<span class="sd">        The Hikari event manager client this will use if applicable.</span>
<span class="sd">    server : hikari.api.interaction_server.InteractionServer</span>
<span class="sd">        The Hikari interaction server client this will use if applicable.</span>
<span class="sd">    shards : hikari.traits.ShardAware</span>
<span class="sd">        The Hikari shard aware client this will use if applicable.</span>
<span class="sd">    event_managed : bool</span>
<span class="sd">        Whether or not this client is managed by the event manager.</span>

<span class="sd">        An event managed client will be automatically started and closed based</span>
<span class="sd">        on Hikari&#39;s lifetime events.</span>

<span class="sd">        Defaults to `False` and can only be passed as `True` if `event_manager`</span>
<span class="sd">        is also provided.</span>
<span class="sd">    mention_prefix : bool</span>
<span class="sd">        Whether or not mention prefixes should be automatically set when this</span>
<span class="sd">        client is first started.</span>

<span class="sd">        Defaults to `False` and it should be noted that this only applies to</span>
<span class="sd">        message commands.</span>
<span class="sd">    declare_global_commands : typing.Union[hikari.SnowflakeishSequenceOr[hikari.PartialGuild], hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">        Whether or not to automatically set global slash commands when this</span>
<span class="sd">        client is first started. Defaults to `False`.</span>

<span class="sd">        If a guild object or ID is passed here then the global commands will be</span>
<span class="sd">        set on this specific guild at startup rather than globally. This</span>
<span class="sd">        can be useful for testing/debug purposes as slash commands may take</span>
<span class="sd">        up to an hour to propagate globally but will immediately propagate</span>
<span class="sd">        when set on a specific guild.</span>
<span class="sd">    set_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">        Deprecated as of v2.1.1a1 alias of `declare_global_commands`.</span>
<span class="sd">    command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">        If provided, a mapping of top level command names to IDs of the commands to update.</span>

<span class="sd">        This field is complementary to `declare_global_commands` and, while it</span>
<span class="sd">        isn&#39;t necessarily required, this will in some situations help avoid</span>
<span class="sd">        permissions which were previously set for a command from being lost</span>
<span class="sd">        after a rename.</span>

<span class="sd">        This currently isn&#39;t supported when multiple guild IDs are passed for</span>
<span class="sd">        `declare_global_commands`.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raises for the following reasons:</span>
<span class="sd">        * If `event_managed` is `True` when `event_manager` is `None`.</span>
<span class="sd">        * If `command_ids` is passed when multiple guild ids are provided for `declare_global_commands`.</span>
<span class="sd">        * If `command_ids` is passed when `declare_global_commands` is `False`.</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501 - line too long</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_accepts&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_auto_defer_after&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_cache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_cached_application_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_checks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_client_callbacks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_components&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_make_message_context&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_make_slash_context&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_events&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_grab_mention_prefix&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_hooks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_interaction_not_found&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_slash_hooks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_is_alive&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_is_closing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_listeners&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_message_hooks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_metadata&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_modules&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_path_modules&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_prefix_getter&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_prefixes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_rest&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_server&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_shards&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rest</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">cache</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">events</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">server</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">shards</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mention_prefix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span>
            <span class="nb">bool</span><span class="p">,</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># InjectorClient.__init__</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># TODO: logging or something to indicate this is running statelessly rather than statefully.</span>
        <span class="c1"># TODO: warn if server and dispatch both None but don&#39;t error</span>

        <span class="c1"># TODO: separate slash and gateway checks?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span> <span class="o">=</span> <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">ALL</span> <span class="k">if</span> <span class="n">events</span> <span class="k">else</span> <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">NONE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="n">cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">checks</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span><span class="p">:</span> <span class="n">_MessageContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">MessageContext</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">:</span> <span class="n">_SlashContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">SlashContext</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_events</span> <span class="o">=</span> <span class="n">events</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span> <span class="o">=</span> <span class="n">mention_prefix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">]</span> <span class="o">=</span> <span class="n">hooks</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">()</span><span class="o">.</span><span class="n">set_on_parser_error</span><span class="p">(</span><span class="n">on_parser_error</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command not found&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">_InjectableListener</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_InjectablePrefixGetter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span> <span class="o">=</span> <span class="n">rest</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_server</span> <span class="o">=</span> <span class="n">server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shards</span> <span class="o">=</span> <span class="n">shards</span>

        <span class="k">if</span> <span class="n">event_managed</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Client cannot be event managed without an event manager&quot;</span><span class="p">)</span>

            <span class="n">events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_starting_event</span><span class="p">)</span>
            <span class="n">events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_stopping_event</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">set_global_commands</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;The `set_global_commands` argument is deprecated and will be removed in v2.1.1a1. &quot;</span>
                <span class="s2">&quot;Use `declare_global_commands` instead.&quot;</span><span class="p">,</span>
                <span class="ne">DeprecationWarning</span><span class="p">,</span>
                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">_stack_level</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">declare_global_commands</span> <span class="o">=</span> <span class="n">declare_global_commands</span> <span class="ow">or</span> <span class="n">set_global_commands</span>
        <span class="n">command_ids</span> <span class="o">=</span> <span class="n">command_ids</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">declare_global_commands</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">command_ids</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">command_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot declare global guilds in multiple-guilds and pass command IDs&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">guild</span> <span class="ow">in</span> <span class="n">declare_global_commands</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">guild</span><span class="p">))</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">declare_global_commands</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">declare_global_commands</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span>
                    <span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="n">command_ids</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot pass command IDs when not declaring global commands&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span>
                <span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">declare_global_commands</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">Client</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span> <span class="n">rest</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">rest</span><span class="p">),</span> <span class="n">rest</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cache</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">cache</span><span class="p">),</span> <span class="n">cache</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">,</span> <span class="n">events</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">events</span><span class="p">),</span> <span class="n">events</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">,</span> <span class="n">server</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">server</span><span class="p">),</span> <span class="n">server</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">shards</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">,</span> <span class="n">shards</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">shards</span><span class="p">),</span> <span class="n">shards</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_gateway_bot</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">GatewayBotAware</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">mention_prefix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a `Client` from a `hikari.traits.GatewayBotAware` instance.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This implicitly defaults the client to human only mode.</span>
<span class="sd">        * This sets type dependency injectors for the hikari traits present in</span>
<span class="sd">          `bot` (including `hikari.traits.GatewayBotaWARE`).</span>
<span class="sd">        * The endpoint used by `declare_global_commands` has a strict ratelimit</span>
<span class="sd">          which, as of writing, only allows for 2 requests per minute (with that</span>
<span class="sd">          ratelimit either being per-guild if targeting a specific guild</span>
<span class="sd">          otherwise globally).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.GatewayBotAware</span>
<span class="sd">            The bot client to build from.</span>

<span class="sd">            This will be used to infer the relevant Hikari clients to use.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        event_managed : bool</span>
<span class="sd">            Whether or not this client is managed by the event manager.</span>

<span class="sd">            An event managed client will be automatically started and closed</span>
<span class="sd">            based on Hikari&#39;s lifetime events.</span>

<span class="sd">            Defaults to `True`.</span>
<span class="sd">        mention_prefix : bool</span>
<span class="sd">            Whether or not mention prefixes should be automatically set when this</span>
<span class="sd">            client is first started.</span>

<span class="sd">            Defaults to `False` and it should be noted that this only applies to</span>
<span class="sd">            message commands.</span>
<span class="sd">        declare_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Whether or not to automatically set global slash commands when this</span>
<span class="sd">            client is first started. Defaults to `False`.</span>

<span class="sd">            If a guild object or ID is passed here then the global commands will be</span>
<span class="sd">            set on this specific guild at startup rather than globally. This</span>
<span class="sd">            can be useful for testing/debug purposes as slash commands may take</span>
<span class="sd">            up to an hour to propagate globally but will immediately propagate</span>
<span class="sd">            when set on a specific guild.</span>
<span class="sd">        set_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Deprecated as of v2.1.1a1 alias of `declare_global_commands`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">cls</span><span class="p">(</span>
                <span class="n">rest</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span>
                <span class="n">cache</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span>
                <span class="n">events</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">event_manager</span><span class="p">,</span>
                <span class="n">shards</span><span class="o">=</span><span class="n">bot</span><span class="p">,</span>
                <span class="n">event_managed</span><span class="o">=</span><span class="n">event_managed</span><span class="p">,</span>
                <span class="n">mention_prefix</span><span class="o">=</span><span class="n">mention_prefix</span><span class="p">,</span>
                <span class="n">declare_global_commands</span><span class="o">=</span><span class="n">declare_global_commands</span><span class="p">,</span>
                <span class="n">set_global_commands</span><span class="o">=</span><span class="n">set_global_commands</span><span class="p">,</span>
                <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">set_human_only</span><span class="p">()</span>
            <span class="o">.</span><span class="n">set_hikari_trait_injectors</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_rest_bot</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">RESTBotAware</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a `Client` from a `hikari.traits.RESTBotAware` instance.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This sets type dependency injectors for the hikari traits present in</span>
<span class="sd">          `bot` (including `hikari.traits.RESTBotAware`).</span>
<span class="sd">        * The endpoint used by `declare_global_commands` has a strict ratelimit</span>
<span class="sd">          which, as of writing, only allows for 2 requests per minute (with that</span>
<span class="sd">          ratelimit either being per-guild if targeting a specific guild</span>
<span class="sd">          otherwise globally).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.RESTBotAware</span>
<span class="sd">            The bot client to build from.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        declare_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Whether or not to automatically set global slash commands when this</span>
<span class="sd">            client is first started. Defaults to `False`.</span>

<span class="sd">            If a guild object or ID is passed here then the global commands will be</span>
<span class="sd">            set on this specific guild at startup rather than globally. This</span>
<span class="sd">            can be useful for testing/debug purposes as slash commands may take</span>
<span class="sd">            up to an hour to propagate globally but will immediately propagate</span>
<span class="sd">            when set on a specific guild.</span>
<span class="sd">        set_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Deprecated as of v2.1.1a1 alias of `declare_global_commands`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">rest</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span>
            <span class="n">server</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">interaction_server</span><span class="p">,</span>
            <span class="n">declare_global_commands</span><span class="o">=</span><span class="n">declare_global_commands</span><span class="p">,</span>
            <span class="n">set_global_commands</span><span class="o">=</span><span class="n">set_global_commands</span><span class="p">,</span>
            <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">set_hikari_trait_injectors</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__aenter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__aexit__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">exception_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span>
        <span class="n">exception</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span>
        <span class="n">exception_traceback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">types</span><span class="o">.</span><span class="n">TracebackType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;CommandClient &lt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">!r}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">)</span><span class="si">}</span><span class="s2"> components, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="si">}</span><span class="s2">&gt;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">message_accepts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MessageAcceptsEnum</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Type of message create events this command client accepts for execution.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_human_only</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether this client is only executing for non-bot/webhook users messages.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_check_human</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span>  <span class="c1"># type: ignore[comparison-overlap]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">checks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return a collcetion of the level `tanjun.abc.Context` checks registered to this client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Collection[tanjun.abc.CheckSig]</span>
<span class="sd">            Colleciton of the `tanjun.abc.Context` based checks registered for</span>
<span class="sd">            this client.</span>

<span class="sd">            These may be taking advantage of the standard dependency injection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">check</span><span class="o">.</span><span class="n">callback</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">events</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">listeners</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">]]:</span>
        <span class="k">return</span> <span class="n">utilities</span><span class="o">.</span><span class="n">CastedView</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Top level `tanjun.abc.AnyHooks` set for this client.</span>

<span class="sd">        These are called during both message and interaction command execution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[tanjun.abc.AnyHooks]</span>
<span class="sd">            The top level `tanjun.abc.Context` based hooks set for this</span>
<span class="sd">            client if applicable, else `None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Top level `tanjun.abc.SlashHooks` set for this client.</span>

<span class="sd">        These are only called during interaction command execution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[tanjun.abc.SlashHooks]</span>
<span class="sd">            The top level `tanjun.abc.SlashContext` based hooks set</span>
<span class="sd">            for this client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_alive</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether this client is alive.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">message_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the top level `tanjun.abc.MessageHooks` set for this client.</span>

<span class="sd">        These are only called during both message command execution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[tanjun.abc.MessageHooks]</span>
<span class="sd">            The top level `tanjun.abc.MessageContext` based hooks set for</span>
<span class="sd">            this client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">prefix_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">PrefixGetterSig</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the prefix getter method set for this client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[PrefixGetterSig]</span>
<span class="sd">            The prefix getter method set for this client if applicable,</span>
<span class="sd">            else `None`.</span>

<span class="sd">            For more information on this callback&#39;s signature see `PrefixGetter`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="o">.</span><span class="n">callback</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">prefixes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Set of the standard prefixes set for this client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Collection[str]</span>
<span class="sd">            The standard prefixes set for this client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rest</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">server</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shards</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shards</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_starting_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_stopping_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_slash_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflakeish</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Declare a single slash command for a bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.BaseSlashCommand</span>
<span class="sd">            The command to register.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        application : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]</span>
<span class="sd">            The application to register the command with.</span>

<span class="sd">            If left as `None` then this will be inferred from the authorization</span>
<span class="sd">            being used by `Client.rest`.</span>
<span class="sd">        command_id : typing.Optional[hikari.snowflakes.Snowflakeish]</span>
<span class="sd">            ID of the command to update.</span>
<span class="sd">        guild : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]</span>
<span class="sd">            Object or ID of the guild to register the command with.</span>

<span class="sd">            If left as `None` then the command will be registered globally.</span>

<span class="sd">        Warnings</span>
<span class="sd">        --------</span>
<span class="sd">        * This ignores any ID that&#39;s been set on `tanjun.abc.BaseSlashCommand`.</span>
<span class="sd">        * Providing `command_id` when updating a command helps avoid any</span>
<span class="sd">          permissions set for the command being lose (e.g. when changing the</span>
<span class="sd">          command&#39;s name).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.Command</span>
<span class="sd">            API representation of the command that was registered.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">builder</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">command_id</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">edit_application_command</span><span class="p">(</span>
                <span class="n">application</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">(),</span>
                <span class="n">command_id</span><span class="p">,</span>
                <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">create_application_command</span><span class="p">(</span>
                <span class="n">application</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">(),</span>
                <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">guild</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">set_tracked_command</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>  <span class="c1"># TODO: is this fine?</span>

        <span class="k">return</span> <span class="n">response</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_slash_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">commands</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">],</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Declare a collection of slash commands for a bot.</span>

<span class="sd">        .. note::</span>
<span class="sd">            The endpoint this uses has a strict ratelimit which, as of writing,</span>
<span class="sd">            only allows for 2 requests per minute (with that ratelimit either</span>
<span class="sd">            being per-guild if targeting a specific guild otherwise globally).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        commands : collections.abc.Iterable[tanjun.abc.BaseSlashCommand]</span>
<span class="sd">            Iterable of the commands to register.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">            If provided, a mapping of top level command names to IDs of the existing commands to update.</span>

<span class="sd">            While optional, this can be helpful when updating commands as</span>
<span class="sd">            providing the current IDs will prevent changes such as renames from</span>
<span class="sd">            leading to other state set for commands (e.g. permissions) from</span>
<span class="sd">            being lost.</span>
<span class="sd">        application : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]</span>
<span class="sd">            The application to register the commands with.</span>

<span class="sd">            If left as `None` then this will be inferred from the authorization</span>
<span class="sd">            being used by `Client.rest`.</span>
<span class="sd">        guild : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]</span>
<span class="sd">            Object or ID of the guild to register the commands with.</span>

<span class="sd">            If left as `None` then the commands will be registered globally.</span>
<span class="sd">        force : bool</span>
<span class="sd">            Force this to declare the commands regardless of whether or not</span>
<span class="sd">            they match the current state of the declared commands.</span>

<span class="sd">            Defaults to `False`. This default behaviour helps avoid issues with the</span>
<span class="sd">            2 request per minute (per-guild or globally) ratelimit and the other limit</span>
<span class="sd">            of only 200 application command creates per day (per guild or globally).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Sequence[hikari.Command]</span>
<span class="sd">            API representations of the commands which were registered.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If conflicting command names are found (multiple commanbds have the same top-level name).</span>
<span class="sd">            * If more than 100 top-level commands are passed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">command_ids</span> <span class="o">=</span> <span class="n">command_ids</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">names_to_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">conflicts</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">builders</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">CommandBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">commands</span><span class="p">:</span>
            <span class="n">names_to_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">command</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">builders</span><span class="p">:</span>
                <span class="n">conflicts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

            <span class="n">builder</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">command_id</span> <span class="o">:=</span> <span class="n">command_ids</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                <span class="n">builder</span><span class="o">.</span><span class="n">set_id</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">command_id</span><span class="p">))</span>

            <span class="n">builders</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">builder</span>

        <span class="k">if</span> <span class="n">conflicts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Couldn&#39;t declare commands due to conflicts. The following command names have more than one command &quot;</span>
                <span class="s2">&quot;registered for them &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conflicts</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You can only declare up to 100 top level commands in a guild or globally&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">application</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">()</span>

        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;global&quot;</span> <span class="k">if</span> <span class="n">guild</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;guild </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">guild</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
            <span class="n">registered_commands</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">registered_commands</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span>
                <span class="n">_cmp_command</span><span class="p">(</span><span class="n">builders</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">command</span><span class="p">)</span> <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">registered_commands</span>
            <span class="p">):</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Skipping bulk declare for </span><span class="si">%s</span><span class="s2"> slash commands due to them already being set&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">registered_commands</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Bulk declaring </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> slash commands&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">),</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">responses</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">set_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">builders</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">responses</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">guild</span><span class="p">:</span>
                <span class="n">names_to_commands</span><span class="p">[</span><span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">set_tracked_command</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>  <span class="c1"># TODO: is this fine?</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">expected_id</span> <span class="o">:=</span> <span class="n">command_ids</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="ow">and</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">expected_id</span><span class="p">)</span> <span class="o">!=</span> <span class="n">response</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;ID mismatch found for </span><span class="si">%s</span><span class="s2"> command </span><span class="si">%s</span><span class="s2">, expected </span><span class="si">%s</span><span class="s2"> but got </span><span class="si">%s</span><span class="s2">. &quot;</span>
                    <span class="s2">&quot;This suggests that any previous permissions set for this command will have been lost.&quot;</span><span class="p">,</span>
                    <span class="n">name</span><span class="p">,</span>
                    <span class="n">expected_id</span><span class="p">,</span>
                    <span class="n">response</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Successfully declared </span><span class="si">%s</span><span class="s2"> (top-level) </span><span class="si">%s</span><span class="s2"> commands&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">responses</span><span class="p">),</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;declared </span><span class="si">%s</span><span class="s2"> command ids: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">response</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">responses</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">responses</span>

    <span class="k">def</span> <span class="nf">set_auto_defer_after</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set when this client should automatically defer execution of commands.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            If `time` is set to `None` then automatic deferrals will be disabled.</span>
<span class="sd">            This may lead to unexpected behaviour.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        time : typing.Optional[float]</span>
<span class="sd">            The time in seconds to defer interaction command responses after.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="k">if</span> <span class="n">time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_hikari_trait_injectors</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">RESTAware</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set type based dependency injection based on the hikari traits found in `bot`.</span>

<span class="sd">        This is a short hand for calling `Client.add_type_dependency` for all</span>
<span class="sd">        the hikari trait types `bot` is valid for with bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari_traits.RESTAware</span>
<span class="sd">            The hikari client to set dependency injectors for.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">hikari_traits</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">member</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bot</span><span class="p">,</span> <span class="n">member</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">bot</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_interaction_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the response message for when an interaction command is not found.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            Setting this to `None` may lead to unexpected behaviour (especially</span>
<span class="sd">            when the client is still set to auto-defer interactions) and should</span>
<span class="sd">            only be done if you know what you&#39;re doing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : typing.Optional[str]</span>
<span class="sd">            The message to respond with when an interaction command isn&#39;t found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span> <span class="o">=</span> <span class="n">message</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_message_accepts</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">accepts</span><span class="p">:</span> <span class="n">MessageAcceptsEnum</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the kind of messages commands should be executed based on.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        accepts : MessageAcceptsEnum</span>
<span class="sd">            The type of messages commands should be executed based on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot set accepts level on a client with no event manager&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span> <span class="o">=</span> <span class="n">accepts</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_message_ctx_maker</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">maker</span><span class="p">:</span> <span class="n">_MessageContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the message context maker to use when creating context for a message.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            The caller must return an instance of `tanjun.context.MessageContext`</span>
<span class="sd">            rather than just any implementation of the MessageContext abc due to</span>
<span class="sd">            this client relying on implementation detail of</span>
<span class="sd">            `tanjun.context.MessageContext`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        maker : _MessageContextMakerProto</span>
<span class="sd">            The message context maker to use.</span>

<span class="sd">            This is a callback which should match the signature of</span>
<span class="sd">            `tanjun.context.MessageContext.__init__` and return an instance</span>
<span class="sd">            of `tanjun.context.MessageContext`.</span>

<span class="sd">            This defaults to `tanjun.context.MessageContext`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span> <span class="o">=</span> <span class="n">maker</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_slash_ctx_maker</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">maker</span><span class="p">:</span> <span class="n">_SlashContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the slash context maker to use when creating context for a slash command.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            The caller must return an instance of `tanjun.context.SlashContext`</span>
<span class="sd">            rather than just any implementation of the SlashContext abc due to</span>
<span class="sd">            this client relying on implementation detail of</span>
<span class="sd">            `tanjun.context.SlashContext`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        maker : _SlashContextMakerProto</span>
<span class="sd">            The slash context maker to use.</span>

<span class="sd">            This is a callback which should match the signature of</span>
<span class="sd">            `tanjun.context.SlashContext.__init__` and return an instance</span>
<span class="sd">            of `tanjun.context.SlashContext`.</span>

<span class="sd">            This defaults to `tanjun.context.SlashContext`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span> <span class="o">=</span> <span class="n">maker</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_human_only</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set whether or not message commands execution should be limited to &quot;human&quot; users.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This doesn&#39;t apply to interaction commands as these can only be</span>
<span class="sd">            triggered by a &quot;human&quot; (normal user account).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether or not message commands execution should be limited to &quot;human&quot; users.</span>

<span class="sd">            Passing `True` here will prevent message commands from being executed</span>
<span class="sd">            based on webhook and bot messages.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">checks</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">(</span><span class="n">_check_human</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_check</span><span class="p">(</span><span class="n">_check_human</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">clear_commands</span><span class="p">(</span>  <span class="c1"># TODO: better name?</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clear the commands declared either globally or for a specific guild.</span>

<span class="sd">        .. note::</span>
<span class="sd">            The endpoint this uses has a strict ratelimit which, as of writing,</span>
<span class="sd">            only allows for 2 requests per minute (with that ratelimit either</span>
<span class="sd">            being per-guild if targeting a specific guild otherwise globally).</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        application : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]</span>
<span class="sd">            The application to clear commands for.</span>

<span class="sd">            If left as `None` then this will be inferred from the authorization</span>
<span class="sd">            being used by `Client.rest`.</span>
<span class="sd">        guild : hikari.UndefinedOr[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]</span>
<span class="sd">            Object or ID of the guild to clear commands for.</span>

<span class="sd">            If left as `None` global commands will be cleared.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">application</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">()</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">set_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="p">(),</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">set_global_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Alias of `Client.declare_global_commands`.</span>

<span class="sd">        .. deprecated:: v2.1.1a1</span>
<span class="sd">            Use `Client.declare_global_commands` instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">declare_global_commands</span><span class="p">(</span><span class="n">application</span><span class="o">=</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_global_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Set the global application commands for a bot based on the loaded components.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            This will overwrite any previously set application commands and</span>
<span class="sd">            only targets commands marked as global.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * The endpoint this uses has a strict ratelimit which, as of writing,</span>
<span class="sd">          only allows for 2 requests per minute (with that ratelimit either</span>
<span class="sd">          being per-guild if targeting a specific guild otherwise globally).</span>
<span class="sd">        * Setting a specific `guild` can be useful for testing/debug purposes</span>
<span class="sd">          as slash commands may take up to an hour to propagate globally but</span>
<span class="sd">          will immediately propagate when set on a specific guild.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">            If provided, a mapping of top level command names to IDs of the existing commands to update.</span>
<span class="sd">        application : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]</span>
<span class="sd">            Object or ID of the application to set the global commands for.</span>

<span class="sd">            If left as `None` then this will be inferred from the authorization</span>
<span class="sd">            being used by `Client.rest`.</span>
<span class="sd">        guild : hikari.UndefinedOr[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]</span>
<span class="sd">            Object or ID of the guild to set the global commands to.</span>

<span class="sd">            If left as `None` global commands will be set.</span>
<span class="sd">        force : bool</span>
<span class="sd">            Force this to declare the commands regardless of whether or not</span>
<span class="sd">            they match the current state of the declared commands.</span>

<span class="sd">            Defaults to `False`. This default behaviour helps avoid issues with the</span>
<span class="sd">            2 request per minute (per-guild or globally) ratelimit and the other limit</span>
<span class="sd">            of only 200 application command creates per day (per guild or globally).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Sequence[hikari..Command]</span>
<span class="sd">            API representations of the set commands.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">commands</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">command</span>
            <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
                <span class="n">component</span><span class="o">.</span><span class="n">slash_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">is_global</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">declare_slash_commands</span><span class="p">(</span>
            <span class="n">commands</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">application</span><span class="o">=</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a generic check to this client.</span>

<span class="sd">        This will be applied to both message and slash command execution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to add. This may be either synchronous or asynchronous</span>
<span class="sd">            and must take one positional argument of type `tanjun.abc.Context`</span>
<span class="sd">            with dependency injection being supported for its keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">check</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span>  <span class="c1"># type: ignore[arg-type]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checks</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">(</span><span class="n">check</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a check from the client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the check was not previously added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a check to this client through a decorator call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to add. This may be either synchronous or asynchronous</span>
<span class="sd">            and must take one positional argument of type `tanjun.abc.Context`</span>
<span class="sd">            with dependency injection being supported for its keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun_abc.CheckSig</span>
<span class="sd">            The added check.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">check</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">gather_checks</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">add_injector</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a component to this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        component: Component</span>
<span class="sd">            The component to move to this client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to allow chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the component&#39;s name is already registered.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">component</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A component named </span><span class="si">{</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="si">!r}</span><span class="s2"> is already registered.&quot;</span><span class="p">)</span>

        <span class="n">component</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">component</span>

        <span class="k">if</span> <span class="n">add_injector</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">component</span><span class="p">),</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">component</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">COMPONENT_ADDED</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">get_component_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">stored_component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">stored_component</span> <span class="ow">or</span> <span class="n">stored_component</span> <span class="o">!=</span> <span class="n">component</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The component </span><span class="si">{</span><span class="n">component</span><span class="si">!r}</span><span class="s2"> is not registered.&quot;</span><span class="p">)</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="n">stored_component</span><span class="o">.</span><span class="n">unbind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">COMPONENT_REMOVED</span><span class="p">,</span> <span class="n">stored_component</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_component_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">add_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">descriptor</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">descriptor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">descriptor</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">descriptor</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">dispatch_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Dispatch a client callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The name of the callback to dispatch.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        *args : typing.Any</span>
<span class="sd">            Positional arguments to pass to the callback(s).</span>
<span class="sd">        **kwargs : typing.Any</span>
<span class="sd">            Keyword arguments to pass to the callback(s).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        KeyError</span>
<span class="sd">            If no callbacks are registered for the given name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">callbacks</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="n">calls</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">_wrap_client_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">injecting</span><span class="o">.</span><span class="n">BasicInjectionContext</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">calls</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_client_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">callback</span><span class="o">.</span><span class="n">callback</span> <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">()</span>

    <span class="k">def</span> <span class="nf">remove_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_client_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">],</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="k">def</span> <span class="nf">add_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">injected</span> <span class="o">=</span> <span class="n">_InjectableListener</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injected</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">injected</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">injected</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">registered_callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">registered_callback</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">],</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_listener</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="k">def</span> <span class="nf">add_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">prefixes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a prefix used to filter message command calls.</span>

<span class="sd">        This will be matched against the first character(s) in a message&#39;s</span>
<span class="sd">        content to determine whether the message command search stage of</span>
<span class="sd">        execution should be initiated.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        prefixes : typing.Union[collections.abc.Iterable[str], str]</span>
<span class="sd">            Either a single string or an iterable of strings to be used as</span>
<span class="sd">            prefixes.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prefixes</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">prefixes</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefixes</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">prefix</span> <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">prefixes</span> <span class="k">if</span> <span class="n">prefix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a message content prefix from the client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        prefix : str</span>
<span class="sd">            The prefix to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the prefix is not registered with the client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_prefix_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">getter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">PrefixGetterSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the callback used to retrieve message prefixes set for the relevant guild.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        getter : typing.Optional[PrefixGetterSig]</span>
<span class="sd">            The callback which&#39;ll be  to retrieve prefixes for the guild a</span>
<span class="sd">            message event is from. If `None` is passed here then the callback</span>
<span class="sd">            will be unset.</span>

<span class="sd">            This should be an async callback which one argument of type</span>
<span class="sd">            `tanjun.abc.MessageContext` and returns an iterable of string prefixes.</span>
<span class="sd">            Dependency injection is supported for this callback&#39;s keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span> <span class="o">=</span> <span class="n">_InjectablePrefixGetter</span><span class="p">(</span><span class="n">getter</span><span class="p">)</span> <span class="k">if</span> <span class="n">getter</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_prefix_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">getter</span><span class="p">:</span> <span class="n">PrefixGetterSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PrefixGetterSigT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the prefix getter callback for this client through decorator call.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ```py</span>
<span class="sd">        client = tanjun.Client.from_rest_bot(bot)</span>

<span class="sd">        @client.with_prefix_getter</span>
<span class="sd">        async def prefix_getter(ctx: tanjun.abc.MessageContext) -&gt; collections.abc.Iterable[str]:</span>
<span class="sd">            raise NotImplementedError</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        getter : PrefixGetterSig</span>
<span class="sd">            The callback which&#39;ll be  to retrieve prefixes for the guild a</span>
<span class="sd">            message event is from.</span>

<span class="sd">            This should be an async callback which one argument of type</span>
<span class="sd">            `tanjun.abc.MessageContext` and returns an iterable of string prefixes.</span>
<span class="sd">            Dependency injection is supported for this callback&#39;s keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PrefixGetterSigT</span>
<span class="sd">            The registered callback.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_prefix_getter</span><span class="p">(</span><span class="n">getter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">getter</span>

    <span class="k">def</span> <span class="nf">iter_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">]]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">slash_commands</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_slash_commands</span><span class="p">(</span><span class="n">global_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_message_commands</span><span class="p">()</span>
        <span class="k">yield from</span> <span class="n">slash_commands</span>

    <span class="k">def</span> <span class="nf">iter_message_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">message_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">iter_slash_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">global_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">if</span> <span class="n">global_only</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">is_global</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_slash_commands</span><span class="p">(</span><span class="n">global_only</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">slash_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_message_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="n">component</span><span class="o">.</span><span class="n">check_message_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_slash_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="n">component</span><span class="o">.</span><span class="n">check_slash_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_check_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">prefix</span>

        <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">prefix</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_try_unsubscribe</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event_manager</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">,</span>
        <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">event_manager</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">LookupError</span><span class="p">):</span>
            <span class="c1"># TODO: add logging here</span>
            <span class="k">pass</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">deregister_listeners</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close the client.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the client isn&#39;t running.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Client isn&#39;t active&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span><span class="p">:</span>
            <span class="n">event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSING</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deregister_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event_type</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">event_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_message_create_event</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_event</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listener</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">deregister_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">register_listeners</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Start the client.</span>

<span class="sd">        If `mention_prefix` was passed to `Client.__init__` or</span>
<span class="sd">        `Client.from_gateway_bot` then this function may make a fetch request</span>
<span class="sd">        to Discord if it cannot get the current user from the cache.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the client is already active.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Client is already alive&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span><span class="p">:</span>
            <span class="n">user</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">:</span>
                <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">get_me</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
                <span class="n">retry</span> <span class="o">=</span> <span class="n">backoff</span><span class="o">.</span><span class="n">Backoff</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

                <span class="k">async</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">retry</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_my_user</span><span class="p">()</span>
                        <span class="k">break</span>

                    <span class="k">except</span> <span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitedError</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitTooLongError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
                            <span class="k">raise</span>

                        <span class="n">retry</span><span class="o">.</span><span class="n">set_next_backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">)</span>

                    <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">:</span>
                        <span class="k">continue</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_my_user</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="sa">f</span><span class="s2">&quot;&lt;@</span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&gt;&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;&lt;@!</span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&gt;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">prefix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">register_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event_type</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_message_create_event</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_event</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">listener</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">register_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_request</span><span class="p">)</span>

        <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTED</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_rest_application_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Fetch the application ID of the application this client is linked to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.Snowflake</span>
<span class="sd">            The application ID of the application this client is linked to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">token_type</span> <span class="o">==</span> <span class="n">hikari</span><span class="o">.</span><span class="n">TokenType</span><span class="o">.</span><span class="n">BOT</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_application</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_authorization</span><span class="p">())</span><span class="o">.</span><span class="n">application</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">application</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span>

    <span class="k">def</span> <span class="nf">set_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the general command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every slash and message</span>
<span class="sd">        command execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.AnyHooks]</span>
<span class="sd">            The general command execution hooks to set for this client.</span>

<span class="sd">            Passing `None` will remove all hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the slash command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every slash command</span>
<span class="sd">        execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.SlashHooks]</span>
<span class="sd">            The slash context specific command execution hooks to set for this</span>
<span class="sd">            client.</span>

<span class="sd">            Passing `None` will remove the hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_message_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the message command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every message command</span>
<span class="sd">        execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.MessageHooks]</span>
<span class="sd">            The message context specific command execution hooks to set for this</span>
<span class="sd">            client.</span>

<span class="sd">            Passing `None` will remove all hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_iter_module_members</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="n">exported</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;__all__&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">exported</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exported</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">):</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Scanning </span><span class="si">%s</span><span class="s2"> module based on its declared __all__)&quot;</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">exported</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">))</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Scanning all public members on </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">member</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_load_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iter_module_members</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">_LoaderDescriptor</span><span class="p">):</span>
                <span class="n">member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Didn&#39;t find any loader descriptors in </span><span class="si">{</span><span class="n">module_repr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">_log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load entities into this client from modules based on loader descriptors.</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find loaders.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_loader`</span>
<span class="sd">        decorated top level function which takes one positional argument</span>
<span class="sd">        of type `Client`.</span>

<span class="sd">        ```py</span>
<span class="sd">        @tanjun.as_loader</span>
<span class="sd">        def load_module(client: tanjun.Client) -&gt; None:</span>
<span class="sd">            client.add_component(component.copy())</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules : typing.Union[str, pathlib.Path]</span>
<span class="sd">            Path(s) of the modules to load from.</span>

<span class="sd">            When `str` this will be treated as a normal import path which is</span>
<span class="sd">            absolute (`&quot;foo.bar.baz&quot;`). It&#39;s worth noting that absolute module</span>
<span class="sd">            paths may be imported from the current location if the top level</span>
<span class="sd">            module is a valid module file or module directory in the current</span>
<span class="sd">            working directory.</span>

<span class="sd">            When `pathlib.Path` the module will be imported directly from</span>
<span class="sd">            the given path. In this mode any relative imports in the target</span>
<span class="sd">            module will fail to resolve.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module is already loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no loader descriptors are found in the module.</span>
<span class="sd">        ModuleNotFoundError</span>
<span class="sd">            If the module is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> already loaded&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                    <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">[</span><span class="n">module_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">module_path_abs</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">module_path_abs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module at </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> already loaded&quot;</span><span class="p">)</span>

                <span class="n">module_name</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="n">importlib_util</span><span class="o">.</span><span class="n">spec_from_file_location</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">module_path_abs</span><span class="p">)</span>

                <span class="c1"># https://github.com/python/typeshed/issues/2793</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">spec</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="p">,</span> <span class="n">importlib_abc</span><span class="o">.</span><span class="n">Loader</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ModuleNotFoundError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Module not found at </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">module_name</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                    <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib_util</span><span class="o">.</span><span class="n">module_from_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
                <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">exec_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">[</span><span class="n">module_path_abs</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">_unload_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iter_module_members</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">_UnloaderDescriptor</span><span class="p">):</span>
                <span class="n">member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Didn&#39;t find any unloaders in </span><span class="si">{</span><span class="n">module_repr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">unload_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">_log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Unload entities from this client based on unloader descriptors in one or more modules.</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find unloaders.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_unloader`</span>
<span class="sd">        decorated top level function which takes one positional argument</span>
<span class="sd">        of type `Client`.</span>

<span class="sd">        ```py</span>
<span class="sd">        @tanjun.as_unloader</span>
<span class="sd">        def unload_component(client: tanjun.Client) -&gt; None:</span>
<span class="sd">            client.remove_component_by_name(component.name)</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules: typing.Union[str, pathlib.Path]</span>
<span class="sd">            Path of one or more modules to unload.</span>

<span class="sd">            These should be the same path(s) which were passed to `load_module`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module hasn&#39;t been loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no unloader descriptors are found in the module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">module_path</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module </span><span class="si">{</span><span class="n">module_path</span><span class="si">!s}</span><span class="s2"> not loaded&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Unloading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_unload_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">reload_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Reload entities in this client based on the descriptors in loaded module(s).</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find descriptors.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_loader` and</span>
<span class="sd">        one `as_unloader` decorated top level function which each take one</span>
<span class="sd">        positional argument of type `Client`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules: typing.Union[str, pathlib.Path]</span>
<span class="sd">            Paths of one or more module to unload.</span>

<span class="sd">            These  should be the same paths which were passed to `load_module`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module hasn&#39;t been loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no unloader descriptors are found in the current state of the module.</span>
<span class="sd">            If no loader descriptors are found in the new state of the module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> not loaded&quot;</span><span class="p">)</span>

                <span class="n">module_repr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Reloading </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unload_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">[</span><span class="n">module_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Reloading </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unload_modules</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="n">_log</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">load_modules</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="n">_log</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_message_create_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a message command based on a gateway event.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hikari.events.message_events.MessageCreateEvent</span>
<span class="sd">            The event to handle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">message</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">prefix</span> <span class="o">:=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_prefix</span><span class="p">(</span><span class="n">ctx</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">ctx</span><span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="p">:]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span><span class="o">.</span><span class="n">set_triggering_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_message</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">return</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">MESSAGE_COMMAND_NOT_FOUND</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]:</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">}</span>

        <span class="k">return</span> <span class="n">hooks</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_interaction_create_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a slash command based on Gateway events.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Any event where `event.interaction` is not</span>
<span class="sd">            `hikari.CommandInteraction` will be ignored.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : hikari.events.interaction_events.InteractionCreateEvent</span>
<span class="sd">            The event to execute commands based on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">interaction</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">,</span>
            <span class="n">not_found_message</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slash_hooks</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">start_defer_timer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">future</span> <span class="o">:=</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_interaction</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">await</span> <span class="n">future</span>
                        <span class="k">return</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">SLASH_COMMAND_NOT_FOUND</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">()</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">cancel_defer</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_interaction_create_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">ResponseTypeT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a slash command based on received REST requests.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        interaction : hikari.CommandInteraction</span>
<span class="sd">            The interaction to execute a command based on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun.context.ResponseType</span>
<span class="sd">            The initial response to send back to Discord.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="o">=</span><span class="n">interaction</span><span class="p">,</span> <span class="n">not_found_message</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">start_defer_timer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">)</span>

        <span class="n">hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slash_hooks</span><span class="p">()</span>
        <span class="n">future</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_response_future</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_interaction</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="c1"># Under very specific timing there may be another future which could set a result while we await</span>
            <span class="c1"># ctx.respond therefore we create a task to avoid any erroneous behaviour from this trying to create</span>
            <span class="c1"># another response before it&#39;s returned the initial response.</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interaction</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> command error responder&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>

        <span class="k">async</span> <span class="k">def</span> <span class="nf">callback</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">SLASH_COMMAND_NOT_FOUND</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">()</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">cancel_defer</span><span class="p">()</span>

        <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">callback</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interaction</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>
</pre></div>

        </details>

            </section>
                <section id="as_loader">
                            <div class="attr function"><a class="headerlink" href="#as_loader">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">as_loader</span><span class="signature">(
    callback: collections.abc.Callable,
    /
) -&gt; collections.abc.Callable[<a href="#Client">tanjun.clients.Client</a>, None]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">as_loader</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">LoaderSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoaderSig</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Mark a callback as being used to load Tanjun components from a module.</span>

<span class="sd">    .. note::</span>
<span class="sd">        This is only necessary if you wish to use `tanjun.Client.load_modules`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    callback : LoaderSig</span>
<span class="sd">        The callback used to load Tanjun components from a module. This</span>
<span class="sd">        should take one argument of type `tanjun.Client`, return nothing</span>
<span class="sd">        and will be expected to initiate and add utilities such as components</span>
<span class="sd">        to the provided client using it&#39;s abstract methods.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    LoaderSig</span>
<span class="sd">        The decorated load callback.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_LoaderDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Mark a callback as being used to load Tanjun components from a module.</p>

<p><em>Note:</em>
This is only necessary if you wish to use <code><a href="../tanjun.html#Client.load_modules">tanjun.Client.load_modules</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>callback</strong> (LoaderSig):
The callback used to load Tanjun components from a module. This
should take one argument of type <code><a href="../tanjun.html#Client">tanjun.Client</a></code>, return nothing
and will be expected to initiate and add utilities such as components
to the provided client using it's abstract methods.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>LoaderSig</strong>: The decorated load callback.</li>
</ul>
</div>


                </section>
                <section id="as_unloader">
                            <div class="attr function"><a class="headerlink" href="#as_unloader">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">as_unloader</span><span class="signature">(
    callback: collections.abc.Callable,
    /
) -&gt; collections.abc.Callable[<a href="#Client">tanjun.clients.Client</a>, None]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">as_unloader</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">LoaderSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LoaderSig</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Mark a callback as being used to unload a module&#39;s utilities from a client.</span>

<span class="sd">    ... note::</span>
<span class="sd">        This is the inverse of `as_loader` and is only necessary if you wish</span>
<span class="sd">        to use the `tanjun.Client.unload_module` or</span>
<span class="sd">        `tanjun.Client.reload_module`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    callback : LoaderSig</span>
<span class="sd">        The callback used to unload Tanjun utilities from a module. This</span>
<span class="sd">        should take one argument of type `tanjun.Client`, return nothing</span>
<span class="sd">        and will be expected to remove utilities such as components</span>
<span class="sd">        from the provided client using it&#39;s abstract methods.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    LoaderSig</span>
<span class="sd">        The decorated unload callback.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_UnloaderDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Mark a callback as being used to unload a module's utilities from a client.</p>

<p>... note::
    This is the inverse of <code><a href="#as_loader">as_loader</a></code> and is only necessary if you wish
    to use the <code><a href="../tanjun.html#Client.unload_module">tanjun.Client.unload_module</a></code> or
    <code><a href="../tanjun.html#Client.reload_module">tanjun.Client.reload_module</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>callback</strong> (LoaderSig):
The callback used to unload Tanjun utilities from a module. This
should take one argument of type <code><a href="../tanjun.html#Client">tanjun.Client</a></code>, return nothing
and will be expected to remove utilities such as components
from the provided client using it's abstract methods.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>LoaderSig</strong>: The decorated unload callback.</li>
</ul>
</div>


                </section>
                <section id="Client">
                                <div class="attr class">
        <a class="headerlink" href="#Client">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">Client</span><wbr>(<span class="base"><a href="injecting.html#InjectorClient">tanjun.injecting.InjectorClient</a></span>, <span class="base"><a href="abc.html#Client">tanjun.abc.Client</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Client</span><span class="p">(</span><span class="n">injecting</span><span class="o">.</span><span class="n">InjectorClient</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tanjun&#39;s standard `tanjun.abc.Client` implementation.</span>

<span class="sd">    This implementation supports dependency injection for checks, command</span>
<span class="sd">    callbacks, prefix getters and event listeners. For more information on how</span>
<span class="sd">    this works see `tanjun.injecting`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    * For a quicker way to initiate this client around a standard bot aware</span>
<span class="sd">      client, see `Client.from_gateway_bot` and `Client.from_rest_bot`.</span>
<span class="sd">    * The endpoint used by `declare_global_commands` has a strict ratelimit which,</span>
<span class="sd">      as of writing, only allows for 2 requests per minute (with that ratelimit</span>
<span class="sd">      either being per-guild if targeting a specific guild otherwise globally).</span>
<span class="sd">    * `event_manager` is necessary for message command dispatch and will also</span>
<span class="sd">      be necessary for interaction command dispatch if `server` isn&#39;t</span>
<span class="sd">      provided.</span>
<span class="sd">    * `server` is used for interaction command dispatch if interaction</span>
<span class="sd">      events aren&#39;t being received from the event manager.</span>
<span class="sd">    * By default this client includes a parser error handling hook which will</span>
<span class="sd">      by overwritten if you call `Client.set_hooks`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rest : hikari.api.rest.RestClient</span>
<span class="sd">        The Hikari REST client this will use.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    cache : hikari.api.cache.CacheClient</span>
<span class="sd">        The Hikari cache client this will use if applicable.</span>
<span class="sd">    event_manager : hikari.api.event_manager.EventManagerClient</span>
<span class="sd">        The Hikari event manager client this will use if applicable.</span>
<span class="sd">    server : hikari.api.interaction_server.InteractionServer</span>
<span class="sd">        The Hikari interaction server client this will use if applicable.</span>
<span class="sd">    shards : hikari.traits.ShardAware</span>
<span class="sd">        The Hikari shard aware client this will use if applicable.</span>
<span class="sd">    event_managed : bool</span>
<span class="sd">        Whether or not this client is managed by the event manager.</span>

<span class="sd">        An event managed client will be automatically started and closed based</span>
<span class="sd">        on Hikari&#39;s lifetime events.</span>

<span class="sd">        Defaults to `False` and can only be passed as `True` if `event_manager`</span>
<span class="sd">        is also provided.</span>
<span class="sd">    mention_prefix : bool</span>
<span class="sd">        Whether or not mention prefixes should be automatically set when this</span>
<span class="sd">        client is first started.</span>

<span class="sd">        Defaults to `False` and it should be noted that this only applies to</span>
<span class="sd">        message commands.</span>
<span class="sd">    declare_global_commands : typing.Union[hikari.SnowflakeishSequenceOr[hikari.PartialGuild], hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">        Whether or not to automatically set global slash commands when this</span>
<span class="sd">        client is first started. Defaults to `False`.</span>

<span class="sd">        If a guild object or ID is passed here then the global commands will be</span>
<span class="sd">        set on this specific guild at startup rather than globally. This</span>
<span class="sd">        can be useful for testing/debug purposes as slash commands may take</span>
<span class="sd">        up to an hour to propagate globally but will immediately propagate</span>
<span class="sd">        when set on a specific guild.</span>
<span class="sd">    set_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">        Deprecated as of v2.1.1a1 alias of `declare_global_commands`.</span>
<span class="sd">    command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">        If provided, a mapping of top level command names to IDs of the commands to update.</span>

<span class="sd">        This field is complementary to `declare_global_commands` and, while it</span>
<span class="sd">        isn&#39;t necessarily required, this will in some situations help avoid</span>
<span class="sd">        permissions which were previously set for a command from being lost</span>
<span class="sd">        after a rename.</span>

<span class="sd">        This currently isn&#39;t supported when multiple guild IDs are passed for</span>
<span class="sd">        `declare_global_commands`.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raises for the following reasons:</span>
<span class="sd">        * If `event_managed` is `True` when `event_manager` is `None`.</span>
<span class="sd">        * If `command_ids` is passed when multiple guild ids are provided for `declare_global_commands`.</span>
<span class="sd">        * If `command_ids` is passed when `declare_global_commands` is `False`.</span>
<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501 - line too long</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_accepts&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_auto_defer_after&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_cache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_cached_application_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_checks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_client_callbacks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_components&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_make_message_context&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_make_slash_context&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_events&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_grab_mention_prefix&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_hooks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_interaction_not_found&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_slash_hooks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_is_alive&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_is_closing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_listeners&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_message_hooks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_metadata&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_modules&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_path_modules&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_prefix_getter&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_prefixes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_rest&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_server&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_shards&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rest</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">cache</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">events</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">server</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">shards</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mention_prefix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span>
            <span class="nb">bool</span><span class="p">,</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># InjectorClient.__init__</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># TODO: logging or something to indicate this is running statelessly rather than statefully.</span>
        <span class="c1"># TODO: warn if server and dispatch both None but don&#39;t error</span>

        <span class="c1"># TODO: separate slash and gateway checks?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span> <span class="o">=</span> <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">ALL</span> <span class="k">if</span> <span class="n">events</span> <span class="k">else</span> <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">NONE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="n">cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">checks</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span><span class="p">:</span> <span class="n">_MessageContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">MessageContext</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">:</span> <span class="n">_SlashContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">SlashContext</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_events</span> <span class="o">=</span> <span class="n">events</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span> <span class="o">=</span> <span class="n">mention_prefix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">]</span> <span class="o">=</span> <span class="n">hooks</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">()</span><span class="o">.</span><span class="n">set_on_parser_error</span><span class="p">(</span><span class="n">on_parser_error</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command not found&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">_InjectableListener</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_InjectablePrefixGetter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span> <span class="o">=</span> <span class="n">rest</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_server</span> <span class="o">=</span> <span class="n">server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shards</span> <span class="o">=</span> <span class="n">shards</span>

        <span class="k">if</span> <span class="n">event_managed</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Client cannot be event managed without an event manager&quot;</span><span class="p">)</span>

            <span class="n">events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_starting_event</span><span class="p">)</span>
            <span class="n">events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_stopping_event</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">set_global_commands</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;The `set_global_commands` argument is deprecated and will be removed in v2.1.1a1. &quot;</span>
                <span class="s2">&quot;Use `declare_global_commands` instead.&quot;</span><span class="p">,</span>
                <span class="ne">DeprecationWarning</span><span class="p">,</span>
                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">_stack_level</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">declare_global_commands</span> <span class="o">=</span> <span class="n">declare_global_commands</span> <span class="ow">or</span> <span class="n">set_global_commands</span>
        <span class="n">command_ids</span> <span class="o">=</span> <span class="n">command_ids</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">declare_global_commands</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">command_ids</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">command_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot declare global guilds in multiple-guilds and pass command IDs&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">guild</span> <span class="ow">in</span> <span class="n">declare_global_commands</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">guild</span><span class="p">))</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">declare_global_commands</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">declare_global_commands</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span>
                    <span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="n">command_ids</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot pass command IDs when not declaring global commands&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span>
                <span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">declare_global_commands</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">Client</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span> <span class="n">rest</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">rest</span><span class="p">),</span> <span class="n">rest</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cache</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">cache</span><span class="p">),</span> <span class="n">cache</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">,</span> <span class="n">events</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">events</span><span class="p">),</span> <span class="n">events</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">,</span> <span class="n">server</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">server</span><span class="p">),</span> <span class="n">server</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">shards</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">,</span> <span class="n">shards</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">shards</span><span class="p">),</span> <span class="n">shards</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_gateway_bot</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">GatewayBotAware</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">mention_prefix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a `Client` from a `hikari.traits.GatewayBotAware` instance.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This implicitly defaults the client to human only mode.</span>
<span class="sd">        * This sets type dependency injectors for the hikari traits present in</span>
<span class="sd">          `bot` (including `hikari.traits.GatewayBotaWARE`).</span>
<span class="sd">        * The endpoint used by `declare_global_commands` has a strict ratelimit</span>
<span class="sd">          which, as of writing, only allows for 2 requests per minute (with that</span>
<span class="sd">          ratelimit either being per-guild if targeting a specific guild</span>
<span class="sd">          otherwise globally).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.GatewayBotAware</span>
<span class="sd">            The bot client to build from.</span>

<span class="sd">            This will be used to infer the relevant Hikari clients to use.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        event_managed : bool</span>
<span class="sd">            Whether or not this client is managed by the event manager.</span>

<span class="sd">            An event managed client will be automatically started and closed</span>
<span class="sd">            based on Hikari&#39;s lifetime events.</span>

<span class="sd">            Defaults to `True`.</span>
<span class="sd">        mention_prefix : bool</span>
<span class="sd">            Whether or not mention prefixes should be automatically set when this</span>
<span class="sd">            client is first started.</span>

<span class="sd">            Defaults to `False` and it should be noted that this only applies to</span>
<span class="sd">            message commands.</span>
<span class="sd">        declare_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Whether or not to automatically set global slash commands when this</span>
<span class="sd">            client is first started. Defaults to `False`.</span>

<span class="sd">            If a guild object or ID is passed here then the global commands will be</span>
<span class="sd">            set on this specific guild at startup rather than globally. This</span>
<span class="sd">            can be useful for testing/debug purposes as slash commands may take</span>
<span class="sd">            up to an hour to propagate globally but will immediately propagate</span>
<span class="sd">            when set on a specific guild.</span>
<span class="sd">        set_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Deprecated as of v2.1.1a1 alias of `declare_global_commands`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">cls</span><span class="p">(</span>
                <span class="n">rest</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span>
                <span class="n">cache</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span>
                <span class="n">events</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">event_manager</span><span class="p">,</span>
                <span class="n">shards</span><span class="o">=</span><span class="n">bot</span><span class="p">,</span>
                <span class="n">event_managed</span><span class="o">=</span><span class="n">event_managed</span><span class="p">,</span>
                <span class="n">mention_prefix</span><span class="o">=</span><span class="n">mention_prefix</span><span class="p">,</span>
                <span class="n">declare_global_commands</span><span class="o">=</span><span class="n">declare_global_commands</span><span class="p">,</span>
                <span class="n">set_global_commands</span><span class="o">=</span><span class="n">set_global_commands</span><span class="p">,</span>
                <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">set_human_only</span><span class="p">()</span>
            <span class="o">.</span><span class="n">set_hikari_trait_injectors</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_rest_bot</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">RESTBotAware</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a `Client` from a `hikari.traits.RESTBotAware` instance.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This sets type dependency injectors for the hikari traits present in</span>
<span class="sd">          `bot` (including `hikari.traits.RESTBotAware`).</span>
<span class="sd">        * The endpoint used by `declare_global_commands` has a strict ratelimit</span>
<span class="sd">          which, as of writing, only allows for 2 requests per minute (with that</span>
<span class="sd">          ratelimit either being per-guild if targeting a specific guild</span>
<span class="sd">          otherwise globally).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.RESTBotAware</span>
<span class="sd">            The bot client to build from.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        declare_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Whether or not to automatically set global slash commands when this</span>
<span class="sd">            client is first started. Defaults to `False`.</span>

<span class="sd">            If a guild object or ID is passed here then the global commands will be</span>
<span class="sd">            set on this specific guild at startup rather than globally. This</span>
<span class="sd">            can be useful for testing/debug purposes as slash commands may take</span>
<span class="sd">            up to an hour to propagate globally but will immediately propagate</span>
<span class="sd">            when set on a specific guild.</span>
<span class="sd">        set_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Deprecated as of v2.1.1a1 alias of `declare_global_commands`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">rest</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span>
            <span class="n">server</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">interaction_server</span><span class="p">,</span>
            <span class="n">declare_global_commands</span><span class="o">=</span><span class="n">declare_global_commands</span><span class="p">,</span>
            <span class="n">set_global_commands</span><span class="o">=</span><span class="n">set_global_commands</span><span class="p">,</span>
            <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">set_hikari_trait_injectors</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__aenter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__aexit__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">exception_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span>
        <span class="n">exception</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span>
        <span class="n">exception_traceback</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">types</span><span class="o">.</span><span class="n">TracebackType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;CommandClient &lt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">!r}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">)</span><span class="si">}</span><span class="s2"> components, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="si">}</span><span class="s2">&gt;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">message_accepts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MessageAcceptsEnum</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Type of message create events this command client accepts for execution.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_human_only</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether this client is only executing for non-bot/webhook users messages.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_check_human</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span>  <span class="c1"># type: ignore[comparison-overlap]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">checks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return a collcetion of the level `tanjun.abc.Context` checks registered to this client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Collection[tanjun.abc.CheckSig]</span>
<span class="sd">            Colleciton of the `tanjun.abc.Context` based checks registered for</span>
<span class="sd">            this client.</span>

<span class="sd">            These may be taking advantage of the standard dependency injection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">check</span><span class="o">.</span><span class="n">callback</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">events</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">listeners</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">]]:</span>
        <span class="k">return</span> <span class="n">utilities</span><span class="o">.</span><span class="n">CastedView</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Top level `tanjun.abc.AnyHooks` set for this client.</span>

<span class="sd">        These are called during both message and interaction command execution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[tanjun.abc.AnyHooks]</span>
<span class="sd">            The top level `tanjun.abc.Context` based hooks set for this</span>
<span class="sd">            client if applicable, else `None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Top level `tanjun.abc.SlashHooks` set for this client.</span>

<span class="sd">        These are only called during interaction command execution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[tanjun.abc.SlashHooks]</span>
<span class="sd">            The top level `tanjun.abc.SlashContext` based hooks set</span>
<span class="sd">            for this client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_alive</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Whether this client is alive.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">message_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the top level `tanjun.abc.MessageHooks` set for this client.</span>

<span class="sd">        These are only called during both message command execution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[tanjun.abc.MessageHooks]</span>
<span class="sd">            The top level `tanjun.abc.MessageContext` based hooks set for</span>
<span class="sd">            this client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">prefix_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">PrefixGetterSig</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the prefix getter method set for this client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[PrefixGetterSig]</span>
<span class="sd">            The prefix getter method set for this client if applicable,</span>
<span class="sd">            else `None`.</span>

<span class="sd">            For more information on this callback&#39;s signature see `PrefixGetter`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="o">.</span><span class="n">callback</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">prefixes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Set of the standard prefixes set for this client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Collection[str]</span>
<span class="sd">            The standard prefixes set for this client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rest</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">server</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shards</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shards</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_starting_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_on_stopping_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_slash_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflakeish</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Declare a single slash command for a bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.BaseSlashCommand</span>
<span class="sd">            The command to register.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        application : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]</span>
<span class="sd">            The application to register the command with.</span>

<span class="sd">            If left as `None` then this will be inferred from the authorization</span>
<span class="sd">            being used by `Client.rest`.</span>
<span class="sd">        command_id : typing.Optional[hikari.snowflakes.Snowflakeish]</span>
<span class="sd">            ID of the command to update.</span>
<span class="sd">        guild : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]</span>
<span class="sd">            Object or ID of the guild to register the command with.</span>

<span class="sd">            If left as `None` then the command will be registered globally.</span>

<span class="sd">        Warnings</span>
<span class="sd">        --------</span>
<span class="sd">        * This ignores any ID that&#39;s been set on `tanjun.abc.BaseSlashCommand`.</span>
<span class="sd">        * Providing `command_id` when updating a command helps avoid any</span>
<span class="sd">          permissions set for the command being lose (e.g. when changing the</span>
<span class="sd">          command&#39;s name).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.Command</span>
<span class="sd">            API representation of the command that was registered.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">builder</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">command_id</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">edit_application_command</span><span class="p">(</span>
                <span class="n">application</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">(),</span>
                <span class="n">command_id</span><span class="p">,</span>
                <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">create_application_command</span><span class="p">(</span>
                <span class="n">application</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">(),</span>
                <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">guild</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">set_tracked_command</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>  <span class="c1"># TODO: is this fine?</span>

        <span class="k">return</span> <span class="n">response</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_slash_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">commands</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">],</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Declare a collection of slash commands for a bot.</span>

<span class="sd">        .. note::</span>
<span class="sd">            The endpoint this uses has a strict ratelimit which, as of writing,</span>
<span class="sd">            only allows for 2 requests per minute (with that ratelimit either</span>
<span class="sd">            being per-guild if targeting a specific guild otherwise globally).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        commands : collections.abc.Iterable[tanjun.abc.BaseSlashCommand]</span>
<span class="sd">            Iterable of the commands to register.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">            If provided, a mapping of top level command names to IDs of the existing commands to update.</span>

<span class="sd">            While optional, this can be helpful when updating commands as</span>
<span class="sd">            providing the current IDs will prevent changes such as renames from</span>
<span class="sd">            leading to other state set for commands (e.g. permissions) from</span>
<span class="sd">            being lost.</span>
<span class="sd">        application : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]</span>
<span class="sd">            The application to register the commands with.</span>

<span class="sd">            If left as `None` then this will be inferred from the authorization</span>
<span class="sd">            being used by `Client.rest`.</span>
<span class="sd">        guild : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]</span>
<span class="sd">            Object or ID of the guild to register the commands with.</span>

<span class="sd">            If left as `None` then the commands will be registered globally.</span>
<span class="sd">        force : bool</span>
<span class="sd">            Force this to declare the commands regardless of whether or not</span>
<span class="sd">            they match the current state of the declared commands.</span>

<span class="sd">            Defaults to `False`. This default behaviour helps avoid issues with the</span>
<span class="sd">            2 request per minute (per-guild or globally) ratelimit and the other limit</span>
<span class="sd">            of only 200 application command creates per day (per guild or globally).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Sequence[hikari.Command]</span>
<span class="sd">            API representations of the commands which were registered.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If conflicting command names are found (multiple commanbds have the same top-level name).</span>
<span class="sd">            * If more than 100 top-level commands are passed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">command_ids</span> <span class="o">=</span> <span class="n">command_ids</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">names_to_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">conflicts</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">builders</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">CommandBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">commands</span><span class="p">:</span>
            <span class="n">names_to_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">command</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">builders</span><span class="p">:</span>
                <span class="n">conflicts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

            <span class="n">builder</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">command_id</span> <span class="o">:=</span> <span class="n">command_ids</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                <span class="n">builder</span><span class="o">.</span><span class="n">set_id</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">command_id</span><span class="p">))</span>

            <span class="n">builders</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">builder</span>

        <span class="k">if</span> <span class="n">conflicts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Couldn&#39;t declare commands due to conflicts. The following command names have more than one command &quot;</span>
                <span class="s2">&quot;registered for them &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conflicts</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You can only declare up to 100 top level commands in a guild or globally&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">application</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">()</span>

        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;global&quot;</span> <span class="k">if</span> <span class="n">guild</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;guild </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">guild</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
            <span class="n">registered_commands</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">registered_commands</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span>
                <span class="n">_cmp_command</span><span class="p">(</span><span class="n">builders</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">command</span><span class="p">)</span> <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">registered_commands</span>
            <span class="p">):</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Skipping bulk declare for </span><span class="si">%s</span><span class="s2"> slash commands due to them already being set&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">registered_commands</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Bulk declaring </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> slash commands&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">),</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">responses</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">set_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">builders</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">responses</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">guild</span><span class="p">:</span>
                <span class="n">names_to_commands</span><span class="p">[</span><span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">set_tracked_command</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>  <span class="c1"># TODO: is this fine?</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">expected_id</span> <span class="o">:=</span> <span class="n">command_ids</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="ow">and</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">expected_id</span><span class="p">)</span> <span class="o">!=</span> <span class="n">response</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;ID mismatch found for </span><span class="si">%s</span><span class="s2"> command </span><span class="si">%s</span><span class="s2">, expected </span><span class="si">%s</span><span class="s2"> but got </span><span class="si">%s</span><span class="s2">. &quot;</span>
                    <span class="s2">&quot;This suggests that any previous permissions set for this command will have been lost.&quot;</span><span class="p">,</span>
                    <span class="n">name</span><span class="p">,</span>
                    <span class="n">expected_id</span><span class="p">,</span>
                    <span class="n">response</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Successfully declared </span><span class="si">%s</span><span class="s2"> (top-level) </span><span class="si">%s</span><span class="s2"> commands&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">responses</span><span class="p">),</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;declared </span><span class="si">%s</span><span class="s2"> command ids: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">response</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">responses</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">responses</span>

    <span class="k">def</span> <span class="nf">set_auto_defer_after</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set when this client should automatically defer execution of commands.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            If `time` is set to `None` then automatic deferrals will be disabled.</span>
<span class="sd">            This may lead to unexpected behaviour.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        time : typing.Optional[float]</span>
<span class="sd">            The time in seconds to defer interaction command responses after.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="k">if</span> <span class="n">time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_hikari_trait_injectors</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">RESTAware</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set type based dependency injection based on the hikari traits found in `bot`.</span>

<span class="sd">        This is a short hand for calling `Client.add_type_dependency` for all</span>
<span class="sd">        the hikari trait types `bot` is valid for with bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari_traits.RESTAware</span>
<span class="sd">            The hikari client to set dependency injectors for.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">hikari_traits</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">member</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bot</span><span class="p">,</span> <span class="n">member</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">bot</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_interaction_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the response message for when an interaction command is not found.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            Setting this to `None` may lead to unexpected behaviour (especially</span>
<span class="sd">            when the client is still set to auto-defer interactions) and should</span>
<span class="sd">            only be done if you know what you&#39;re doing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : typing.Optional[str]</span>
<span class="sd">            The message to respond with when an interaction command isn&#39;t found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span> <span class="o">=</span> <span class="n">message</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_message_accepts</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">accepts</span><span class="p">:</span> <span class="n">MessageAcceptsEnum</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the kind of messages commands should be executed based on.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        accepts : MessageAcceptsEnum</span>
<span class="sd">            The type of messages commands should be executed based on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot set accepts level on a client with no event manager&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span> <span class="o">=</span> <span class="n">accepts</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_message_ctx_maker</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">maker</span><span class="p">:</span> <span class="n">_MessageContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the message context maker to use when creating context for a message.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            The caller must return an instance of `tanjun.context.MessageContext`</span>
<span class="sd">            rather than just any implementation of the MessageContext abc due to</span>
<span class="sd">            this client relying on implementation detail of</span>
<span class="sd">            `tanjun.context.MessageContext`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        maker : _MessageContextMakerProto</span>
<span class="sd">            The message context maker to use.</span>

<span class="sd">            This is a callback which should match the signature of</span>
<span class="sd">            `tanjun.context.MessageContext.__init__` and return an instance</span>
<span class="sd">            of `tanjun.context.MessageContext`.</span>

<span class="sd">            This defaults to `tanjun.context.MessageContext`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span> <span class="o">=</span> <span class="n">maker</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_slash_ctx_maker</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">maker</span><span class="p">:</span> <span class="n">_SlashContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the slash context maker to use when creating context for a slash command.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            The caller must return an instance of `tanjun.context.SlashContext`</span>
<span class="sd">            rather than just any implementation of the SlashContext abc due to</span>
<span class="sd">            this client relying on implementation detail of</span>
<span class="sd">            `tanjun.context.SlashContext`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        maker : _SlashContextMakerProto</span>
<span class="sd">            The slash context maker to use.</span>

<span class="sd">            This is a callback which should match the signature of</span>
<span class="sd">            `tanjun.context.SlashContext.__init__` and return an instance</span>
<span class="sd">            of `tanjun.context.SlashContext`.</span>

<span class="sd">            This defaults to `tanjun.context.SlashContext`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span> <span class="o">=</span> <span class="n">maker</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_human_only</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set whether or not message commands execution should be limited to &quot;human&quot; users.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This doesn&#39;t apply to interaction commands as these can only be</span>
<span class="sd">            triggered by a &quot;human&quot; (normal user account).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether or not message commands execution should be limited to &quot;human&quot; users.</span>

<span class="sd">            Passing `True` here will prevent message commands from being executed</span>
<span class="sd">            based on webhook and bot messages.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">checks</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">(</span><span class="n">_check_human</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_check</span><span class="p">(</span><span class="n">_check_human</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">clear_commands</span><span class="p">(</span>  <span class="c1"># TODO: better name?</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clear the commands declared either globally or for a specific guild.</span>

<span class="sd">        .. note::</span>
<span class="sd">            The endpoint this uses has a strict ratelimit which, as of writing,</span>
<span class="sd">            only allows for 2 requests per minute (with that ratelimit either</span>
<span class="sd">            being per-guild if targeting a specific guild otherwise globally).</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        application : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]</span>
<span class="sd">            The application to clear commands for.</span>

<span class="sd">            If left as `None` then this will be inferred from the authorization</span>
<span class="sd">            being used by `Client.rest`.</span>
<span class="sd">        guild : hikari.UndefinedOr[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]</span>
<span class="sd">            Object or ID of the guild to clear commands for.</span>

<span class="sd">            If left as `None` global commands will be cleared.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">application</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">()</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">set_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="p">(),</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">set_global_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Alias of `Client.declare_global_commands`.</span>

<span class="sd">        .. deprecated:: v2.1.1a1</span>
<span class="sd">            Use `Client.declare_global_commands` instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">declare_global_commands</span><span class="p">(</span><span class="n">application</span><span class="o">=</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_global_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Set the global application commands for a bot based on the loaded components.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            This will overwrite any previously set application commands and</span>
<span class="sd">            only targets commands marked as global.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * The endpoint this uses has a strict ratelimit which, as of writing,</span>
<span class="sd">          only allows for 2 requests per minute (with that ratelimit either</span>
<span class="sd">          being per-guild if targeting a specific guild otherwise globally).</span>
<span class="sd">        * Setting a specific `guild` can be useful for testing/debug purposes</span>
<span class="sd">          as slash commands may take up to an hour to propagate globally but</span>
<span class="sd">          will immediately propagate when set on a specific guild.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">            If provided, a mapping of top level command names to IDs of the existing commands to update.</span>
<span class="sd">        application : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]</span>
<span class="sd">            Object or ID of the application to set the global commands for.</span>

<span class="sd">            If left as `None` then this will be inferred from the authorization</span>
<span class="sd">            being used by `Client.rest`.</span>
<span class="sd">        guild : hikari.UndefinedOr[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]</span>
<span class="sd">            Object or ID of the guild to set the global commands to.</span>

<span class="sd">            If left as `None` global commands will be set.</span>
<span class="sd">        force : bool</span>
<span class="sd">            Force this to declare the commands regardless of whether or not</span>
<span class="sd">            they match the current state of the declared commands.</span>

<span class="sd">            Defaults to `False`. This default behaviour helps avoid issues with the</span>
<span class="sd">            2 request per minute (per-guild or globally) ratelimit and the other limit</span>
<span class="sd">            of only 200 application command creates per day (per guild or globally).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Sequence[hikari..Command]</span>
<span class="sd">            API representations of the set commands.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">commands</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">command</span>
            <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
                <span class="n">component</span><span class="o">.</span><span class="n">slash_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">is_global</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">declare_slash_commands</span><span class="p">(</span>
            <span class="n">commands</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">application</span><span class="o">=</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a generic check to this client.</span>

<span class="sd">        This will be applied to both message and slash command execution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to add. This may be either synchronous or asynchronous</span>
<span class="sd">            and must take one positional argument of type `tanjun.abc.Context`</span>
<span class="sd">            with dependency injection being supported for its keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">check</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span>  <span class="c1"># type: ignore[arg-type]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checks</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">(</span><span class="n">check</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a check from the client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the check was not previously added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a check to this client through a decorator call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to add. This may be either synchronous or asynchronous</span>
<span class="sd">            and must take one positional argument of type `tanjun.abc.Context`</span>
<span class="sd">            with dependency injection being supported for its keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun_abc.CheckSig</span>
<span class="sd">            The added check.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">check</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">gather_checks</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">add_injector</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a component to this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        component: Component</span>
<span class="sd">            The component to move to this client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to allow chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the component&#39;s name is already registered.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">component</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A component named </span><span class="si">{</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="si">!r}</span><span class="s2"> is already registered.&quot;</span><span class="p">)</span>

        <span class="n">component</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">component</span>

        <span class="k">if</span> <span class="n">add_injector</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">component</span><span class="p">),</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">component</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">COMPONENT_ADDED</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">get_component_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">stored_component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">stored_component</span> <span class="ow">or</span> <span class="n">stored_component</span> <span class="o">!=</span> <span class="n">component</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The component </span><span class="si">{</span><span class="n">component</span><span class="si">!r}</span><span class="s2"> is not registered.&quot;</span><span class="p">)</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="n">stored_component</span><span class="o">.</span><span class="n">unbind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">COMPONENT_REMOVED</span><span class="p">,</span> <span class="n">stored_component</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_component_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">add_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">descriptor</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">descriptor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">descriptor</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">descriptor</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">dispatch_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Dispatch a client callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The name of the callback to dispatch.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        *args : typing.Any</span>
<span class="sd">            Positional arguments to pass to the callback(s).</span>
<span class="sd">        **kwargs : typing.Any</span>
<span class="sd">            Keyword arguments to pass to the callback(s).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        KeyError</span>
<span class="sd">            If no callbacks are registered for the given name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">callbacks</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="n">calls</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">_wrap_client_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">injecting</span><span class="o">.</span><span class="n">BasicInjectionContext</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">calls</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_client_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">callback</span><span class="o">.</span><span class="n">callback</span> <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">()</span>

    <span class="k">def</span> <span class="nf">remove_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_client_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">],</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="k">def</span> <span class="nf">add_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">injected</span> <span class="o">=</span> <span class="n">_InjectableListener</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injected</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">injected</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">injected</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">registered_callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">registered_callback</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">],</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_listener</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="k">def</span> <span class="nf">add_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">prefixes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a prefix used to filter message command calls.</span>

<span class="sd">        This will be matched against the first character(s) in a message&#39;s</span>
<span class="sd">        content to determine whether the message command search stage of</span>
<span class="sd">        execution should be initiated.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        prefixes : typing.Union[collections.abc.Iterable[str], str]</span>
<span class="sd">            Either a single string or an iterable of strings to be used as</span>
<span class="sd">            prefixes.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prefixes</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">prefixes</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefixes</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">prefix</span> <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">prefixes</span> <span class="k">if</span> <span class="n">prefix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a message content prefix from the client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        prefix : str</span>
<span class="sd">            The prefix to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the prefix is not registered with the client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_prefix_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">getter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">PrefixGetterSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the callback used to retrieve message prefixes set for the relevant guild.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        getter : typing.Optional[PrefixGetterSig]</span>
<span class="sd">            The callback which&#39;ll be  to retrieve prefixes for the guild a</span>
<span class="sd">            message event is from. If `None` is passed here then the callback</span>
<span class="sd">            will be unset.</span>

<span class="sd">            This should be an async callback which one argument of type</span>
<span class="sd">            `tanjun.abc.MessageContext` and returns an iterable of string prefixes.</span>
<span class="sd">            Dependency injection is supported for this callback&#39;s keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span> <span class="o">=</span> <span class="n">_InjectablePrefixGetter</span><span class="p">(</span><span class="n">getter</span><span class="p">)</span> <span class="k">if</span> <span class="n">getter</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">with_prefix_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">getter</span><span class="p">:</span> <span class="n">PrefixGetterSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PrefixGetterSigT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the prefix getter callback for this client through decorator call.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ```py</span>
<span class="sd">        client = tanjun.Client.from_rest_bot(bot)</span>

<span class="sd">        @client.with_prefix_getter</span>
<span class="sd">        async def prefix_getter(ctx: tanjun.abc.MessageContext) -&gt; collections.abc.Iterable[str]:</span>
<span class="sd">            raise NotImplementedError</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        getter : PrefixGetterSig</span>
<span class="sd">            The callback which&#39;ll be  to retrieve prefixes for the guild a</span>
<span class="sd">            message event is from.</span>

<span class="sd">            This should be an async callback which one argument of type</span>
<span class="sd">            `tanjun.abc.MessageContext` and returns an iterable of string prefixes.</span>
<span class="sd">            Dependency injection is supported for this callback&#39;s keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PrefixGetterSigT</span>
<span class="sd">            The registered callback.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_prefix_getter</span><span class="p">(</span><span class="n">getter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">getter</span>

    <span class="k">def</span> <span class="nf">iter_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">]]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">slash_commands</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_slash_commands</span><span class="p">(</span><span class="n">global_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_message_commands</span><span class="p">()</span>
        <span class="k">yield from</span> <span class="n">slash_commands</span>

    <span class="k">def</span> <span class="nf">iter_message_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">message_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">iter_slash_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">global_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">if</span> <span class="n">global_only</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">is_global</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_slash_commands</span><span class="p">(</span><span class="n">global_only</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">slash_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_message_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="n">component</span><span class="o">.</span><span class="n">check_message_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_slash_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="n">component</span><span class="o">.</span><span class="n">check_slash_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">_check_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">prefix</span>

        <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">prefix</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_try_unsubscribe</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event_manager</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">,</span>
        <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">event_manager</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">LookupError</span><span class="p">):</span>
            <span class="c1"># TODO: add logging here</span>
            <span class="k">pass</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">deregister_listeners</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close the client.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the client isn&#39;t running.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Client isn&#39;t active&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span><span class="p">:</span>
            <span class="n">event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSING</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deregister_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event_type</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">event_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_message_create_event</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_event</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listener</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">deregister_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">register_listeners</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Start the client.</span>

<span class="sd">        If `mention_prefix` was passed to `Client.__init__` or</span>
<span class="sd">        `Client.from_gateway_bot` then this function may make a fetch request</span>
<span class="sd">        to Discord if it cannot get the current user from the cache.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the client is already active.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Client is already alive&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span><span class="p">:</span>
            <span class="n">user</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">:</span>
                <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">get_me</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
                <span class="n">retry</span> <span class="o">=</span> <span class="n">backoff</span><span class="o">.</span><span class="n">Backoff</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

                <span class="k">async</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">retry</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_my_user</span><span class="p">()</span>
                        <span class="k">break</span>

                    <span class="k">except</span> <span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitedError</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitTooLongError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
                            <span class="k">raise</span>

                        <span class="n">retry</span><span class="o">.</span><span class="n">set_next_backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">)</span>

                    <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">:</span>
                        <span class="k">continue</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_my_user</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="sa">f</span><span class="s2">&quot;&lt;@</span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&gt;&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;&lt;@!</span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&gt;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">prefix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">register_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event_type</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_message_create_event</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_event</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">listener</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">register_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_request</span><span class="p">)</span>

        <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTED</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_rest_application_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Fetch the application ID of the application this client is linked to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.Snowflake</span>
<span class="sd">            The application ID of the application this client is linked to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">token_type</span> <span class="o">==</span> <span class="n">hikari</span><span class="o">.</span><span class="n">TokenType</span><span class="o">.</span><span class="n">BOT</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_application</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_authorization</span><span class="p">())</span><span class="o">.</span><span class="n">application</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">application</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span>

    <span class="k">def</span> <span class="nf">set_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the general command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every slash and message</span>
<span class="sd">        command execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.AnyHooks]</span>
<span class="sd">            The general command execution hooks to set for this client.</span>

<span class="sd">            Passing `None` will remove all hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the slash command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every slash command</span>
<span class="sd">        execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.SlashHooks]</span>
<span class="sd">            The slash context specific command execution hooks to set for this</span>
<span class="sd">            client.</span>

<span class="sd">            Passing `None` will remove the hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_message_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the message command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every message command</span>
<span class="sd">        execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.MessageHooks]</span>
<span class="sd">            The message context specific command execution hooks to set for this</span>
<span class="sd">            client.</span>

<span class="sd">            Passing `None` will remove all hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_iter_module_members</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="n">exported</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;__all__&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">exported</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exported</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">):</span>
            <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Scanning </span><span class="si">%s</span><span class="s2"> module based on its declared __all__)&quot;</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">exported</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">))</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Scanning all public members on </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">member</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_load_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iter_module_members</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">_LoaderDescriptor</span><span class="p">):</span>
                <span class="n">member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Didn&#39;t find any loader descriptors in </span><span class="si">{</span><span class="n">module_repr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">_log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load entities into this client from modules based on loader descriptors.</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find loaders.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_loader`</span>
<span class="sd">        decorated top level function which takes one positional argument</span>
<span class="sd">        of type `Client`.</span>

<span class="sd">        ```py</span>
<span class="sd">        @tanjun.as_loader</span>
<span class="sd">        def load_module(client: tanjun.Client) -&gt; None:</span>
<span class="sd">            client.add_component(component.copy())</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules : typing.Union[str, pathlib.Path]</span>
<span class="sd">            Path(s) of the modules to load from.</span>

<span class="sd">            When `str` this will be treated as a normal import path which is</span>
<span class="sd">            absolute (`&quot;foo.bar.baz&quot;`). It&#39;s worth noting that absolute module</span>
<span class="sd">            paths may be imported from the current location if the top level</span>
<span class="sd">            module is a valid module file or module directory in the current</span>
<span class="sd">            working directory.</span>

<span class="sd">            When `pathlib.Path` the module will be imported directly from</span>
<span class="sd">            the given path. In this mode any relative imports in the target</span>
<span class="sd">            module will fail to resolve.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module is already loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no loader descriptors are found in the module.</span>
<span class="sd">        ModuleNotFoundError</span>
<span class="sd">            If the module is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> already loaded&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                    <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">[</span><span class="n">module_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">module_path_abs</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">module_path_abs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module at </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> already loaded&quot;</span><span class="p">)</span>

                <span class="n">module_name</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="n">importlib_util</span><span class="o">.</span><span class="n">spec_from_file_location</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">module_path_abs</span><span class="p">)</span>

                <span class="c1"># https://github.com/python/typeshed/issues/2793</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">spec</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="p">,</span> <span class="n">importlib_abc</span><span class="o">.</span><span class="n">Loader</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ModuleNotFoundError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Module not found at </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">module_name</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                    <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib_util</span><span class="o">.</span><span class="n">module_from_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
                <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">exec_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">[</span><span class="n">module_path_abs</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">_unload_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iter_module_members</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">_UnloaderDescriptor</span><span class="p">):</span>
                <span class="n">member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Didn&#39;t find any unloaders in </span><span class="si">{</span><span class="n">module_repr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">unload_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">_log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Unload entities from this client based on unloader descriptors in one or more modules.</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find unloaders.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_unloader`</span>
<span class="sd">        decorated top level function which takes one positional argument</span>
<span class="sd">        of type `Client`.</span>

<span class="sd">        ```py</span>
<span class="sd">        @tanjun.as_unloader</span>
<span class="sd">        def unload_component(client: tanjun.Client) -&gt; None:</span>
<span class="sd">            client.remove_component_by_name(component.name)</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules: typing.Union[str, pathlib.Path]</span>
<span class="sd">            Path of one or more modules to unload.</span>

<span class="sd">            These should be the same path(s) which were passed to `load_module`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module hasn&#39;t been loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no unloader descriptors are found in the module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">module_path</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module </span><span class="si">{</span><span class="n">module_path</span><span class="si">!s}</span><span class="s2"> not loaded&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Unloading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_unload_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">reload_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Reload entities in this client based on the descriptors in loaded module(s).</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find descriptors.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_loader` and</span>
<span class="sd">        one `as_unloader` decorated top level function which each take one</span>
<span class="sd">        positional argument of type `Client`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules: typing.Union[str, pathlib.Path]</span>
<span class="sd">            Paths of one or more module to unload.</span>

<span class="sd">            These  should be the same paths which were passed to `load_module`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module hasn&#39;t been loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no unloader descriptors are found in the current state of the module.</span>
<span class="sd">            If no loader descriptors are found in the new state of the module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> not loaded&quot;</span><span class="p">)</span>

                <span class="n">module_repr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Reloading </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unload_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">[</span><span class="n">module_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Reloading </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unload_modules</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="n">_log</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">load_modules</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="n">_log</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_message_create_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a message command based on a gateway event.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hikari.events.message_events.MessageCreateEvent</span>
<span class="sd">            The event to handle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">message</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">prefix</span> <span class="o">:=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_prefix</span><span class="p">(</span><span class="n">ctx</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">ctx</span><span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="p">:]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span><span class="o">.</span><span class="n">set_triggering_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_message</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">return</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">MESSAGE_COMMAND_NOT_FOUND</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]:</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">}</span>

        <span class="k">return</span> <span class="n">hooks</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_interaction_create_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a slash command based on Gateway events.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Any event where `event.interaction` is not</span>
<span class="sd">            `hikari.CommandInteraction` will be ignored.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : hikari.events.interaction_events.InteractionCreateEvent</span>
<span class="sd">            The event to execute commands based on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">interaction</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">,</span>
            <span class="n">not_found_message</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slash_hooks</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">start_defer_timer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">future</span> <span class="o">:=</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_interaction</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">await</span> <span class="n">future</span>
                        <span class="k">return</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">SLASH_COMMAND_NOT_FOUND</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">()</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">cancel_defer</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_interaction_create_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">ResponseTypeT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a slash command based on received REST requests.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        interaction : hikari.CommandInteraction</span>
<span class="sd">            The interaction to execute a command based on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun.context.ResponseType</span>
<span class="sd">            The initial response to send back to Discord.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="o">=</span><span class="n">interaction</span><span class="p">,</span> <span class="n">not_found_message</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">start_defer_timer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">)</span>

        <span class="n">hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slash_hooks</span><span class="p">()</span>
        <span class="n">future</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_response_future</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_interaction</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="c1"># Under very specific timing there may be another future which could set a result while we await</span>
            <span class="c1"># ctx.respond therefore we create a task to avoid any erroneous behaviour from this trying to create</span>
            <span class="c1"># another response before it&#39;s returned the initial response.</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interaction</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> command error responder&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>

        <span class="k">async</span> <span class="k">def</span> <span class="nf">callback</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">SLASH_COMMAND_NOT_FOUND</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">()</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">cancel_defer</span><span class="p">()</span>

        <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">callback</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interaction</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>
</pre></div>

        </details>

            <div class="docstring"><p>Tanjun's standard <code><a href="abc.html#Client">tanjun.abc.Client</a></code> implementation.</p>

<p>This implementation supports dependency injection for checks, command
callbacks, prefix getters and event listeners. For more information on how
this works see <code><a href="injecting.html">tanjun.injecting</a></code>.</p>

<h6 id="notes">Notes</h6>

<ul>
<li>For a quicker way to initiate this client around a standard bot aware
client, see <code><a href="#Client.from_gateway_bot">Client.from_gateway_bot</a></code> and <code><a href="#Client.from_rest_bot">Client.from_rest_bot</a></code>.</li>
<li>The endpoint used by <code><a href="#Client.declare_global_commands">declare_global_commands</a></code> has a strict ratelimit which,
as of writing, only allows for 2 requests per minute (with that ratelimit
either being per-guild if targeting a specific guild otherwise globally).</li>
<li><code>event_manager</code> is necessary for message command dispatch and will also
be necessary for interaction command dispatch if <code><a href="#Client.server">server</a></code> isn't
provided.</li>
<li><code><a href="#Client.server">server</a></code> is used for interaction command dispatch if interaction
events aren't being received from the event manager.</li>
<li>By default this client includes a parser error handling hook which will
by overwritten if you call <code><a href="#Client.set_hooks">Client.set_hooks</a></code>.</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>rest</strong> (hikari.api.rest.RestClient):
The Hikari REST client this will use.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>cache</strong> (hikari.api.cache.CacheClient):
The Hikari cache client this will use if applicable.</li>
<li><strong>event_manager</strong> (hikari.api.event_manager.EventManagerClient):
The Hikari event manager client this will use if applicable.</li>
<li><strong>server</strong> (hikari.api.interaction_server.InteractionServer):
The Hikari interaction server client this will use if applicable.</li>
<li><strong>shards</strong> (hikari.traits.ShardAware):
The Hikari shard aware client this will use if applicable.</li>
<li><p><strong>event_managed</strong> (bool):
Whether or not this client is managed by the event manager.</p>

<p>An event managed client will be automatically started and closed based
on Hikari's lifetime events.</p>

<p>Defaults to <code>False</code> and can only be passed as <code>True</code> if <code>event_manager</code>
is also provided.</p></li>
<li><p><strong>mention_prefix</strong> (bool):
Whether or not mention prefixes should be automatically set when this
client is first started.</p>

<p>Defaults to <code>False</code> and it should be noted that this only applies to
message commands.</p></li>
<li><p><strong>declare_global_commands</strong> (typing.Union[hikari.SnowflakeishSequenceOr[hikari.PartialGuild], hikari.SnowflakeishOr[hikari.PartialGuild], bool]):
Whether or not to automatically set global slash commands when this
client is first started. Defaults to <code>False</code>.</p>

<p>If a guild object or ID is passed here then the global commands will be
set on this specific guild at startup rather than globally. This
can be useful for testing/debug purposes as slash commands may take
up to an hour to propagate globally but will immediately propagate
when set on a specific guild.</p></li>
<li><strong>set_global_commands</strong> (typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]):
Deprecated as of v2.1.1a1 alias of <code><a href="#Client.declare_global_commands">declare_global_commands</a></code>.</li>
<li><p><strong>command_ids</strong> (typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]):
If provided, a mapping of top level command names to IDs of the commands to update.</p>

<p>This field is complementary to <code><a href="#Client.declare_global_commands">declare_global_commands</a></code> and, while it
isn't necessarily required, this will in some situations help avoid
permissions which were previously set for a command from being lost
after a rename.</p>

<p>This currently isn't supported when multiple guild IDs are passed for
<code><a href="#Client.declare_global_commands">declare_global_commands</a></code>.</p></li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: Raises for the following reasons:
<ul>
<li>If <code>event_managed</code> is <code>True</code> when <code>event_manager</code> is <code>None</code>.</li>
<li>If <code>command_ids</code> is passed when multiple guild ids are provided for <code><a href="#Client.declare_global_commands">declare_global_commands</a></code>.</li>
<li>If <code>command_ids</code> is passed when <code><a href="#Client.declare_global_commands">declare_global_commands</a></code> is <code>False</code>.</li>
</ul></li>
</ul>
</div>


                            <div id="Client.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">Client</span><span class="signature">(
    rest: hikari.api.rest.RESTClient,
    *,
    cache: Optional[hikari.api.cache.Cache] = None,
    events: Optional[hikari.api.event_manager.EventManager] = None,
    server: Optional[hikari.api.interaction_server.InteractionServer] = None,
    shards: Optional[hikari.traits.ShardAware] = None,
    event_managed: bool = False,
    mention_prefix: bool = False,
    set_global_commands: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, bool] = False,
    declare_global_commands: Union[Sequence[Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int]], hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, bool] = False,
    command_ids: Optional[collections.abc.Mapping[str, Union[hikari.commands.Command, hikari.snowflakes.Snowflake, int]]] = None,
    _stack_level: int = 0
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rest</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">cache</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">events</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">server</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">shards</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mention_prefix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishSequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span>
            <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span>
            <span class="nb">bool</span><span class="p">,</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">_stack_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># InjectorClient.__init__</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># TODO: logging or something to indicate this is running statelessly rather than statefully.</span>
        <span class="c1"># TODO: warn if server and dispatch both None but don&#39;t error</span>

        <span class="c1"># TODO: separate slash and gateway checks?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span> <span class="o">=</span> <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">ALL</span> <span class="k">if</span> <span class="n">events</span> <span class="k">else</span> <span class="n">MessageAcceptsEnum</span><span class="o">.</span><span class="n">NONE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="n">cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">checks</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">[</span><span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span><span class="p">:</span> <span class="n">_MessageContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">MessageContext</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">:</span> <span class="n">_SlashContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">SlashContext</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_events</span> <span class="o">=</span> <span class="n">events</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span> <span class="o">=</span> <span class="n">mention_prefix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">]</span> <span class="o">=</span> <span class="n">hooks</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">()</span><span class="o">.</span><span class="n">set_on_parser_error</span><span class="p">(</span><span class="n">on_parser_error</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Command not found&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">_InjectableListener</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">ModuleType</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">_InjectablePrefixGetter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span> <span class="o">=</span> <span class="n">rest</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_server</span> <span class="o">=</span> <span class="n">server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shards</span> <span class="o">=</span> <span class="n">shards</span>

        <span class="k">if</span> <span class="n">event_managed</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Client cannot be event managed without an event manager&quot;</span><span class="p">)</span>

            <span class="n">events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StartingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_starting_event</span><span class="p">)</span>
            <span class="n">events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">StoppingEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_stopping_event</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">set_global_commands</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;The `set_global_commands` argument is deprecated and will be removed in v2.1.1a1. &quot;</span>
                <span class="s2">&quot;Use `declare_global_commands` instead.&quot;</span><span class="p">,</span>
                <span class="ne">DeprecationWarning</span><span class="p">,</span>
                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">_stack_level</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">declare_global_commands</span> <span class="o">=</span> <span class="n">declare_global_commands</span> <span class="ow">or</span> <span class="n">set_global_commands</span>
        <span class="n">command_ids</span> <span class="o">=</span> <span class="n">command_ids</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">declare_global_commands</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">command_ids</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">command_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot declare global guilds in multiple-guilds and pass command IDs&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">guild</span> <span class="ow">in</span> <span class="n">declare_global_commands</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">guild</span><span class="p">))</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">declare_global_commands</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">declare_global_commands</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span>
                    <span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="n">command_ids</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot pass command IDs when not declaring global commands&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span>
                <span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">,</span> <span class="n">_StartDeclarer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">declare_global_commands</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">Client</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">RESTClient</span><span class="p">,</span> <span class="n">rest</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">rest</span><span class="p">),</span> <span class="n">rest</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cache</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">Cache</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">cache</span><span class="p">),</span> <span class="n">cache</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">EventManager</span><span class="p">,</span> <span class="n">events</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">events</span><span class="p">),</span> <span class="n">events</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">InteractionServer</span><span class="p">,</span> <span class="n">server</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">server</span><span class="p">),</span> <span class="n">server</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">shards</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">hikari_traits</span><span class="o">.</span><span class="n">ShardAware</span><span class="p">,</span> <span class="n">shards</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">shards</span><span class="p">),</span> <span class="n">shards</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Client.from_gateway_bot" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.from_gateway_bot">#&nbsp;&nbsp</a>

                <div class="decorator">@classmethod</div>

            <span class="def">def</span>
            <span class="name">from_gateway_bot</span><span class="signature">(
    cls,
    bot: hikari.traits.GatewayBotAware,
    /,
    *,
    event_managed: bool = True,
    mention_prefix: bool = False,
    declare_global_commands: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, bool] = False,
    set_global_commands: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, bool] = False
) -&gt; <a href="#Client">tanjun.clients.Client</a></span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_gateway_bot</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">GatewayBotAware</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">event_managed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">mention_prefix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a `Client` from a `hikari.traits.GatewayBotAware` instance.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This implicitly defaults the client to human only mode.</span>
<span class="sd">        * This sets type dependency injectors for the hikari traits present in</span>
<span class="sd">          `bot` (including `hikari.traits.GatewayBotaWARE`).</span>
<span class="sd">        * The endpoint used by `declare_global_commands` has a strict ratelimit</span>
<span class="sd">          which, as of writing, only allows for 2 requests per minute (with that</span>
<span class="sd">          ratelimit either being per-guild if targeting a specific guild</span>
<span class="sd">          otherwise globally).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.GatewayBotAware</span>
<span class="sd">            The bot client to build from.</span>

<span class="sd">            This will be used to infer the relevant Hikari clients to use.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        event_managed : bool</span>
<span class="sd">            Whether or not this client is managed by the event manager.</span>

<span class="sd">            An event managed client will be automatically started and closed</span>
<span class="sd">            based on Hikari&#39;s lifetime events.</span>

<span class="sd">            Defaults to `True`.</span>
<span class="sd">        mention_prefix : bool</span>
<span class="sd">            Whether or not mention prefixes should be automatically set when this</span>
<span class="sd">            client is first started.</span>

<span class="sd">            Defaults to `False` and it should be noted that this only applies to</span>
<span class="sd">            message commands.</span>
<span class="sd">        declare_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Whether or not to automatically set global slash commands when this</span>
<span class="sd">            client is first started. Defaults to `False`.</span>

<span class="sd">            If a guild object or ID is passed here then the global commands will be</span>
<span class="sd">            set on this specific guild at startup rather than globally. This</span>
<span class="sd">            can be useful for testing/debug purposes as slash commands may take</span>
<span class="sd">            up to an hour to propagate globally but will immediately propagate</span>
<span class="sd">            when set on a specific guild.</span>
<span class="sd">        set_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Deprecated as of v2.1.1a1 alias of `declare_global_commands`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">cls</span><span class="p">(</span>
                <span class="n">rest</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span>
                <span class="n">cache</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span>
                <span class="n">events</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">event_manager</span><span class="p">,</span>
                <span class="n">shards</span><span class="o">=</span><span class="n">bot</span><span class="p">,</span>
                <span class="n">event_managed</span><span class="o">=</span><span class="n">event_managed</span><span class="p">,</span>
                <span class="n">mention_prefix</span><span class="o">=</span><span class="n">mention_prefix</span><span class="p">,</span>
                <span class="n">declare_global_commands</span><span class="o">=</span><span class="n">declare_global_commands</span><span class="p">,</span>
                <span class="n">set_global_commands</span><span class="o">=</span><span class="n">set_global_commands</span><span class="p">,</span>
                <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">set_human_only</span><span class="p">()</span>
            <span class="o">.</span><span class="n">set_hikari_trait_injectors</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>
        <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Build a <code><a href="#Client">Client</a></code> from a <code>hikari.traits.GatewayBotAware</code> instance.</p>

<h6 id="notes">Notes</h6>

<ul>
<li>This implicitly defaults the client to human only mode.</li>
<li>This sets type dependency injectors for the hikari traits present in
<code>bot</code> (including <code>hikari.traits.GatewayBotaWARE</code>).</li>
<li>The endpoint used by <code><a href="#Client.declare_global_commands">declare_global_commands</a></code> has a strict ratelimit
which, as of writing, only allows for 2 requests per minute (with that
ratelimit either being per-guild if targeting a specific guild
otherwise globally).</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>bot</strong> (hikari.traits.GatewayBotAware):
The bot client to build from.</p>

<p>This will be used to infer the relevant Hikari clients to use.</p></li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>event_managed</strong> (bool):
Whether or not this client is managed by the event manager.</p>

<p>An event managed client will be automatically started and closed
based on Hikari's lifetime events.</p>

<p>Defaults to <code>True</code>.</p></li>
<li><p><strong>mention_prefix</strong> (bool):
Whether or not mention prefixes should be automatically set when this
client is first started.</p>

<p>Defaults to <code>False</code> and it should be noted that this only applies to
message commands.</p></li>
<li><p><strong>declare_global_commands</strong> (typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]):
Whether or not to automatically set global slash commands when this
client is first started. Defaults to <code>False</code>.</p>

<p>If a guild object or ID is passed here then the global commands will be
set on this specific guild at startup rather than globally. This
can be useful for testing/debug purposes as slash commands may take
up to an hour to propagate globally but will immediately propagate
when set on a specific guild.</p></li>
<li><strong>set_global_commands</strong> (typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]):
Deprecated as of v2.1.1a1 alias of <code><a href="#Client.declare_global_commands">declare_global_commands</a></code>.</li>
</ul>
</div>


                            </div>
                            <div id="Client.from_rest_bot" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.from_rest_bot">#&nbsp;&nbsp</a>

                <div class="decorator">@classmethod</div>

            <span class="def">def</span>
            <span class="name">from_rest_bot</span><span class="signature">(
    cls,
    bot: hikari.traits.RESTBotAware,
    /,
    declare_global_commands: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, bool] = False,
    set_global_commands: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, bool] = False
) -&gt; <a href="#Client">tanjun.clients.Client</a></span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_rest_bot</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">RESTBotAware</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">declare_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_global_commands</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build a `Client` from a `hikari.traits.RESTBotAware` instance.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * This sets type dependency injectors for the hikari traits present in</span>
<span class="sd">          `bot` (including `hikari.traits.RESTBotAware`).</span>
<span class="sd">        * The endpoint used by `declare_global_commands` has a strict ratelimit</span>
<span class="sd">          which, as of writing, only allows for 2 requests per minute (with that</span>
<span class="sd">          ratelimit either being per-guild if targeting a specific guild</span>
<span class="sd">          otherwise globally).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari.traits.RESTBotAware</span>
<span class="sd">            The bot client to build from.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        declare_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Whether or not to automatically set global slash commands when this</span>
<span class="sd">            client is first started. Defaults to `False`.</span>

<span class="sd">            If a guild object or ID is passed here then the global commands will be</span>
<span class="sd">            set on this specific guild at startup rather than globally. This</span>
<span class="sd">            can be useful for testing/debug purposes as slash commands may take</span>
<span class="sd">            up to an hour to propagate globally but will immediately propagate</span>
<span class="sd">            when set on a specific guild.</span>
<span class="sd">        set_global_commands : typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]</span>
<span class="sd">            Deprecated as of v2.1.1a1 alias of `declare_global_commands`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">rest</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span>
            <span class="n">server</span><span class="o">=</span><span class="n">bot</span><span class="o">.</span><span class="n">interaction_server</span><span class="p">,</span>
            <span class="n">declare_global_commands</span><span class="o">=</span><span class="n">declare_global_commands</span><span class="p">,</span>
            <span class="n">set_global_commands</span><span class="o">=</span><span class="n">set_global_commands</span><span class="p">,</span>
            <span class="n">_stack_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">set_hikari_trait_injectors</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Build a <code><a href="#Client">Client</a></code> from a <code>hikari.traits.RESTBotAware</code> instance.</p>

<h6 id="notes">Notes</h6>

<ul>
<li>This sets type dependency injectors for the hikari traits present in
<code>bot</code> (including <code>hikari.traits.RESTBotAware</code>).</li>
<li>The endpoint used by <code><a href="#Client.declare_global_commands">declare_global_commands</a></code> has a strict ratelimit
which, as of writing, only allows for 2 requests per minute (with that
ratelimit either being per-guild if targeting a specific guild
otherwise globally).</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>bot</strong> (hikari.traits.RESTBotAware):
The bot client to build from.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>declare_global_commands</strong> (typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]):
Whether or not to automatically set global slash commands when this
client is first started. Defaults to <code>False</code>.</p>

<p>If a guild object or ID is passed here then the global commands will be
set on this specific guild at startup rather than globally. This
can be useful for testing/debug purposes as slash commands may take
up to an hour to propagate globally but will immediately propagate
when set on a specific guild.</p></li>
<li><strong>set_global_commands</strong> (typing.Union[hikari.SnowflakeishOr[hikari.PartialGuild], bool]):
Deprecated as of v2.1.1a1 alias of <code><a href="#Client.declare_global_commands">declare_global_commands</a></code>.</li>
</ul>
</div>


                            </div>
                            <div id="Client.message_accepts" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.message_accepts">#&nbsp;&nbsp</a>

        <span class="name">message_accepts</span><span class="annotation">: <a href="#MessageAcceptsEnum">tanjun.clients.MessageAcceptsEnum</a></span>
    </div>

            <div class="docstring"><p>Type of message create events this command client accepts for execution.</p>
</div>


                            </div>
                            <div id="Client.is_human_only" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.is_human_only">#&nbsp;&nbsp</a>

        <span class="name">is_human_only</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether this client is only executing for non-bot/webhook users messages.</p>
</div>


                            </div>
                            <div id="Client.cache" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.cache">#&nbsp;&nbsp</a>

        <span class="name">cache</span><span class="annotation">: Optional[hikari.api.cache.Cache]</span>
    </div>

            <div class="docstring"><p>Hikari cache instance this command client was initialised with.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Optional[hikari.api.Cache]</strong>: Hikari cache instance this command client was initialised
with if provided, else <code>None</code>.</li>
</ul>
</div>


                            </div>
                            <div id="Client.checks" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.checks">#&nbsp;&nbsp</a>

        <span class="name">checks</span><span class="annotation">: collections.abc.Collection[collections.abc.Callable[..., typing.Union[bool, collections.abc.Awaitable[bool]]]]</span>
    </div>

            <div class="docstring"><p>Return a collcetion of the level <code><a href="abc.html#Context">tanjun.abc.Context</a></code> checks registered to this client.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Collection[<a href="abc.html#CheckSig">tanjun.abc.CheckSig</a>]</strong>: Colleciton of the <code><a href="abc.html#Context">tanjun.abc.Context</a></code> based checks registered for
this client.</li>
</ul>

<p>These may be taking advantage of the standard dependency injection.</p>
</div>


                            </div>
                            <div id="Client.components" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.components">#&nbsp;&nbsp</a>

        <span class="name">components</span><span class="annotation">: collections.abc.Collection[<a href="abc.html#Component">tanjun.abc.Component</a>]</span>
    </div>

            <div class="docstring"><p>Get a collection of the components this command client is using.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Collection[<a href="../tanjun.html#traits.Component">tanjun.traits.Component</a>]</strong>: Collection of the components this command client is using.</li>
</ul>
</div>


                            </div>
                            <div id="Client.events" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.events">#&nbsp;&nbsp</a>

        <span class="name">events</span><span class="annotation">: Optional[hikari.api.event_manager.EventManager]</span>
    </div>

            <div class="docstring"><p>Object of the event manager this client was initialised with.</p>

<p>This is used for executing message commands if set.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Optional[hikari.api.EventManager]</strong>: The Hikari event manager this client was initialised with
if provided, else <code>None</code>.</li>
</ul>
</div>


                            </div>
                            <div id="Client.listeners" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.listeners">#&nbsp;&nbsp</a>

        <span class="name">listeners</span><span class="annotation">: collections.abc.Mapping[type[hikari.events.base_events.Event], collections.abc.Collection[collections.abc.Callable[..., collections.abc.Coroutine[typing.Any, typing.Any, None]]]]</span>
    </div>

            <div class="docstring"><p>Get a mapping of event types to the listeners registered in this client.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Mapping[type[hikari.Event], collections.abc.Collection[ListenerCallbackSig]]</strong>: The listeners in this component.</li>
</ul>
</div>


                            </div>
                            <div id="Client.hooks" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.hooks">#&nbsp;&nbsp</a>

        <span class="name">hooks</span><span class="annotation">: Optional[<a href="abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="abc.html#Context">tanjun.abc.Context</a>]]</span>
    </div>

            <div class="docstring"><p>Top level <code><a href="abc.html#AnyHooks">tanjun.abc.AnyHooks</a></code> set for this client.</p>

<p>These are called during both message and interaction command execution.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Optional[<a href="abc.html#AnyHooks">tanjun.abc.AnyHooks</a>]</strong>: The top level <code><a href="abc.html#Context">tanjun.abc.Context</a></code> based hooks set for this
client if applicable, else <code>None</code>.</li>
</ul>
</div>


                            </div>
                            <div id="Client.slash_hooks" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.slash_hooks">#&nbsp;&nbsp</a>

        <span class="name">slash_hooks</span><span class="annotation">: Optional[<a href="abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="abc.html#SlashContext">tanjun.abc.SlashContext</a>]]</span>
    </div>

            <div class="docstring"><p>Top level <code><a href="abc.html#SlashHooks">tanjun.abc.SlashHooks</a></code> set for this client.</p>

<p>These are only called during interaction command execution.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Optional[<a href="abc.html#SlashHooks">tanjun.abc.SlashHooks</a>]</strong>: The top level <code><a href="abc.html#SlashContext">tanjun.abc.SlashContext</a></code> based hooks set
for this client.</li>
</ul>
</div>


                            </div>
                            <div id="Client.is_alive" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.is_alive">#&nbsp;&nbsp</a>

        <span class="name">is_alive</span><span class="annotation">: bool</span>
    </div>

            <div class="docstring"><p>Whether this client is alive.</p>
</div>


                            </div>
                            <div id="Client.message_hooks" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.message_hooks">#&nbsp;&nbsp</a>

        <span class="name">message_hooks</span><span class="annotation">: Optional[<a href="abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="abc.html#MessageContext">tanjun.abc.MessageContext</a>]]</span>
    </div>

            <div class="docstring"><p>Get the top level <code><a href="abc.html#MessageHooks">tanjun.abc.MessageHooks</a></code> set for this client.</p>

<p>These are only called during both message command execution.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Optional[<a href="abc.html#MessageHooks">tanjun.abc.MessageHooks</a>]</strong>: The top level <code><a href="abc.html#MessageContext">tanjun.abc.MessageContext</a></code> based hooks set for
this client.</li>
</ul>
</div>


                            </div>
                            <div id="Client.metadata" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.metadata">#&nbsp;&nbsp</a>

        <span class="name">metadata</span><span class="annotation">: collections.abc.MutableMapping[typing.Any, typing.Any]</span>
    </div>

            <div class="docstring"><p>Get the mutable mapping of the metadata set for this client.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.MutableMapping[typing.Any, typing.Any]</strong>: The metadata set for this client.</li>
</ul>

<p>Any modifications made to this mutable mapping will be preserved by
the client.</p>
</div>


                            </div>
                            <div id="Client.prefix_getter" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.prefix_getter">#&nbsp;&nbsp</a>

        <span class="name">prefix_getter</span><span class="annotation">: Optional[collections.abc.Callable[..., collections.abc.Awaitable[collections.abc.Iterable[str]]]]</span>
    </div>

            <div class="docstring"><p>Get the prefix getter method set for this client.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Optional[PrefixGetterSig]</strong>: The prefix getter method set for this client if applicable,
else <code>None</code>.</li>
</ul>

<p>For more information on this callback's signature see <code>PrefixGetter</code>.</p>
</div>


                            </div>
                            <div id="Client.prefixes" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.prefixes">#&nbsp;&nbsp</a>

        <span class="name">prefixes</span><span class="annotation">: collections.abc.Collection[str]</span>
    </div>

            <div class="docstring"><p>Set of the standard prefixes set for this client.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Collection[str]</strong>: The standard prefixes set for this client.</li>
</ul>
</div>


                            </div>
                            <div id="Client.rest" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.rest">#&nbsp;&nbsp</a>

        <span class="name">rest</span><span class="annotation">: hikari.api.rest.RESTClient</span>
    </div>

            <div class="docstring"><p>Object of the Hikari REST client this client was initialised with.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.api.RESTClient</strong>: The Hikari REST client this client was initialised with.</li>
</ul>
</div>


                            </div>
                            <div id="Client.server" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.server">#&nbsp;&nbsp</a>

        <span class="name">server</span><span class="annotation">: Optional[hikari.api.interaction_server.InteractionServer]</span>
    </div>

            <div class="docstring"><p>Object of the Hikari interaction server provided for this client.</p>

<p>This is used for executing slash commands if set.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Optional[hikari.api.InteractionServer]</strong>: The Hikari interaction server this client was initialised
with if provided, else <code>None</code>.</li>
</ul>
</div>


                            </div>
                            <div id="Client.shards" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Client.shards">#&nbsp;&nbsp</a>

        <span class="name">shards</span><span class="annotation">: Optional[hikari.traits.ShardAware]</span>
    </div>

            <div class="docstring"><p>Object of the Hikari shard manager this client was initialised with.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Optional[hikari.traits.ShardAware]</strong>: The Hikari shard manager this client was initialised with
if provided, else <code>None</code>.</li>
</ul>
</div>


                            </div>
                            <div id="Client.declare_slash_command" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.declare_slash_command">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">declare_slash_command</span><span class="signature">(
    self,
    command: <a href="abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>,
    /,
    command_id: Union[hikari.snowflakes.Snowflake, int, NoneType] = None,
    *,
    application: Union[hikari.guilds.PartialApplication, hikari.snowflakes.Snowflake, int, NoneType] = None,
    guild: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, hikari.undefined.UndefinedType] = UNDEFINED
) -&gt; hikari.commands.Command</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_slash_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">command_id</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflakeish</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Declare a single slash command for a bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : tanjun.abc.BaseSlashCommand</span>
<span class="sd">            The command to register.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        application : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]</span>
<span class="sd">            The application to register the command with.</span>

<span class="sd">            If left as `None` then this will be inferred from the authorization</span>
<span class="sd">            being used by `Client.rest`.</span>
<span class="sd">        command_id : typing.Optional[hikari.snowflakes.Snowflakeish]</span>
<span class="sd">            ID of the command to update.</span>
<span class="sd">        guild : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]</span>
<span class="sd">            Object or ID of the guild to register the command with.</span>

<span class="sd">            If left as `None` then the command will be registered globally.</span>

<span class="sd">        Warnings</span>
<span class="sd">        --------</span>
<span class="sd">        * This ignores any ID that&#39;s been set on `tanjun.abc.BaseSlashCommand`.</span>
<span class="sd">        * Providing `command_id` when updating a command helps avoid any</span>
<span class="sd">          permissions set for the command being lose (e.g. when changing the</span>
<span class="sd">          command&#39;s name).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.Command</span>
<span class="sd">            API representation of the command that was registered.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">builder</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">command_id</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">edit_application_command</span><span class="p">(</span>
                <span class="n">application</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">(),</span>
                <span class="n">command_id</span><span class="p">,</span>
                <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">create_application_command</span><span class="p">(</span>
                <span class="n">application</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">(),</span>
                <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">guild</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">set_tracked_command</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>  <span class="c1"># TODO: is this fine?</span>

        <span class="k">return</span> <span class="n">response</span>
</pre></div>

        </details>

            <div class="docstring"><p>Declare a single slash command for a bot.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command</strong> (<a href="abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>):
The command to register.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>application</strong> (typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]):
The application to register the command with.</p>

<p>If left as <code>None</code> then this will be inferred from the authorization
being used by <code><a href="#Client.rest">Client.rest</a></code>.</p></li>
<li><strong>command_id</strong> (typing.Optional[hikari.snowflakes.Snowflakeish]):
ID of the command to update.</li>
<li><p><strong>guild</strong> (typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]):
Object or ID of the guild to register the command with.</p>

<p>If left as <code>None</code> then the command will be registered globally.</p></li>
</ul>

<h6 id="warnings">Warnings</h6>

<ul>
<li>This ignores any ID that's been set on <code><a href="abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a></code>.</li>
<li>Providing <code>command_id</code> when updating a command helps avoid any
permissions set for the command being lose (e.g. when changing the
command's name).</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.Command</strong>: API representation of the command that was registered.</li>
</ul>
</div>


                            </div>
                            <div id="Client.declare_slash_commands" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.declare_slash_commands">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">declare_slash_commands</span><span class="signature">(
    self,
    commands: collections.abc.Iterable,
    /,
    command_ids: Optional[collections.abc.Mapping[str, Union[hikari.commands.Command, hikari.snowflakes.Snowflake, int]]] = None,
    *,
    application: Union[hikari.guilds.PartialApplication, hikari.snowflakes.Snowflake, int, NoneType] = None,
    guild: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, hikari.undefined.UndefinedType] = UNDEFINED,
    force: bool = False
) -&gt; collections.abc.Sequence[hikari.commands.Command]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_slash_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">commands</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">],</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Declare a collection of slash commands for a bot.</span>

<span class="sd">        .. note::</span>
<span class="sd">            The endpoint this uses has a strict ratelimit which, as of writing,</span>
<span class="sd">            only allows for 2 requests per minute (with that ratelimit either</span>
<span class="sd">            being per-guild if targeting a specific guild otherwise globally).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        commands : collections.abc.Iterable[tanjun.abc.BaseSlashCommand]</span>
<span class="sd">            Iterable of the commands to register.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">            If provided, a mapping of top level command names to IDs of the existing commands to update.</span>

<span class="sd">            While optional, this can be helpful when updating commands as</span>
<span class="sd">            providing the current IDs will prevent changes such as renames from</span>
<span class="sd">            leading to other state set for commands (e.g. permissions) from</span>
<span class="sd">            being lost.</span>
<span class="sd">        application : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]</span>
<span class="sd">            The application to register the commands with.</span>

<span class="sd">            If left as `None` then this will be inferred from the authorization</span>
<span class="sd">            being used by `Client.rest`.</span>
<span class="sd">        guild : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]</span>
<span class="sd">            Object or ID of the guild to register the commands with.</span>

<span class="sd">            If left as `None` then the commands will be registered globally.</span>
<span class="sd">        force : bool</span>
<span class="sd">            Force this to declare the commands regardless of whether or not</span>
<span class="sd">            they match the current state of the declared commands.</span>

<span class="sd">            Defaults to `False`. This default behaviour helps avoid issues with the</span>
<span class="sd">            2 request per minute (per-guild or globally) ratelimit and the other limit</span>
<span class="sd">            of only 200 application command creates per day (per guild or globally).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Sequence[hikari.Command]</span>
<span class="sd">            API representations of the commands which were registered.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raises a value error for any of the following reasons:</span>
<span class="sd">            * If conflicting command names are found (multiple commanbds have the same top-level name).</span>
<span class="sd">            * If more than 100 top-level commands are passed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">command_ids</span> <span class="o">=</span> <span class="n">command_ids</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">names_to_commands</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">conflicts</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">builders</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">CommandBuilder</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">commands</span><span class="p">:</span>
            <span class="n">names_to_commands</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">command</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">builders</span><span class="p">:</span>
                <span class="n">conflicts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

            <span class="n">builder</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">command_id</span> <span class="o">:=</span> <span class="n">command_ids</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                <span class="n">builder</span><span class="o">.</span><span class="n">set_id</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">command_id</span><span class="p">))</span>

            <span class="n">builders</span><span class="p">[</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">builder</span>

        <span class="k">if</span> <span class="n">conflicts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Couldn&#39;t declare commands due to conflicts. The following command names have more than one command &quot;</span>
                <span class="s2">&quot;registered for them &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conflicts</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You can only declare up to 100 top level commands in a guild or globally&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">application</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">()</span>

        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;global&quot;</span> <span class="k">if</span> <span class="n">guild</span> <span class="ow">is</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;guild </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">guild</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
            <span class="n">registered_commands</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">registered_commands</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span>
                <span class="n">_cmp_command</span><span class="p">(</span><span class="n">builders</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">command</span><span class="p">)</span> <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">registered_commands</span>
            <span class="p">):</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Skipping bulk declare for </span><span class="si">%s</span><span class="s2"> slash commands due to them already being set&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">registered_commands</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Bulk declaring </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> slash commands&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">builders</span><span class="p">),</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">responses</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">set_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">builders</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">responses</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">guild</span><span class="p">:</span>
                <span class="n">names_to_commands</span><span class="p">[</span><span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">set_tracked_command</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>  <span class="c1"># TODO: is this fine?</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">expected_id</span> <span class="o">:=</span> <span class="n">command_ids</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="ow">and</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">expected_id</span><span class="p">)</span> <span class="o">!=</span> <span class="n">response</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;ID mismatch found for </span><span class="si">%s</span><span class="s2"> command </span><span class="si">%s</span><span class="s2">, expected </span><span class="si">%s</span><span class="s2"> but got </span><span class="si">%s</span><span class="s2">. &quot;</span>
                    <span class="s2">&quot;This suggests that any previous permissions set for this command will have been lost.&quot;</span><span class="p">,</span>
                    <span class="n">name</span><span class="p">,</span>
                    <span class="n">expected_id</span><span class="p">,</span>
                    <span class="n">response</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Successfully declared </span><span class="si">%s</span><span class="s2"> (top-level) </span><span class="si">%s</span><span class="s2"> commands&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">responses</span><span class="p">),</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">_LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;declared </span><span class="si">%s</span><span class="s2"> command ids: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">response</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">responses</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">responses</span>
</pre></div>

        </details>

            <div class="docstring"><p>Declare a collection of slash commands for a bot.</p>

<p><em>Note:</em>
The endpoint this uses has a strict ratelimit which, as of writing,
only allows for 2 requests per minute (with that ratelimit either
being per-guild if targeting a specific guild otherwise globally).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>commands</strong> (collections.abc.Iterable[<a href="abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>]):
Iterable of the commands to register.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>command_ids</strong> (typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]):
If provided, a mapping of top level command names to IDs of the existing commands to update.</p>

<p>While optional, this can be helpful when updating commands as
providing the current IDs will prevent changes such as renames from
leading to other state set for commands (e.g. permissions) from
being lost.</p></li>
<li><p><strong>application</strong> (typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]):
The application to register the commands with.</p>

<p>If left as <code>None</code> then this will be inferred from the authorization
being used by <code><a href="#Client.rest">Client.rest</a></code>.</p></li>
<li><p><strong>guild</strong> (typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]):
Object or ID of the guild to register the commands with.</p>

<p>If left as <code>None</code> then the commands will be registered globally.</p></li>
<li><p><strong>force</strong> (bool):
Force this to declare the commands regardless of whether or not
they match the current state of the declared commands.</p>

<p>Defaults to <code>False</code>. This default behaviour helps avoid issues with the
2 request per minute (per-guild or globally) ratelimit and the other limit
of only 200 application command creates per day (per guild or globally).</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Sequence[hikari.Command]</strong>: API representations of the commands which were registered.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: Raises a value error for any of the following reasons:
<ul>
<li>If conflicting command names are found (multiple commanbds have the same top-level name).</li>
<li>If more than 100 top-level commands are passed.</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="Client.set_auto_defer_after" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_auto_defer_after">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_auto_defer_after</span><span class="signature">(self: ~_ClientT, time: Optional[float], /) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_auto_defer_after</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set when this client should automatically defer execution of commands.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            If `time` is set to `None` then automatic deferrals will be disabled.</span>
<span class="sd">            This may lead to unexpected behaviour.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        time : typing.Optional[float]</span>
<span class="sd">            The time in seconds to defer interaction command responses after.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="k">if</span> <span class="n">time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set when this client should automatically defer execution of commands.</p>

<p><em>Warning:</em>
If <code>time</code> is set to <code>None</code> then automatic deferrals will be disabled.
This may lead to unexpected behaviour.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>time</strong> (typing.Optional[float]):
The time in seconds to defer interaction command responses after.</li>
</ul>
</div>


                            </div>
                            <div id="Client.set_hikari_trait_injectors" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_hikari_trait_injectors">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_hikari_trait_injectors</span><span class="signature">(self: ~_ClientT, bot: hikari.traits.RESTAware, /) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_hikari_trait_injectors</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">bot</span><span class="p">:</span> <span class="n">hikari_traits</span><span class="o">.</span><span class="n">RESTAware</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set type based dependency injection based on the hikari traits found in `bot`.</span>

<span class="sd">        This is a short hand for calling `Client.add_type_dependency` for all</span>
<span class="sd">        the hikari trait types `bot` is valid for with bot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bot : hikari_traits.RESTAware</span>
<span class="sd">            The hikari client to set dependency injectors for.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">hikari_traits</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">member</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bot</span><span class="p">,</span> <span class="n">member</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">bot</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set type based dependency injection based on the hikari traits found in <code>bot</code>.</p>

<p>This is a short hand for calling <code>Client.add_type_dependency</code> for all
the hikari trait types <code>bot</code> is valid for with bot.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>bot</strong> (hikari_traits.RESTAware):
The hikari client to set dependency injectors for.</li>
</ul>
</div>


                            </div>
                            <div id="Client.set_interaction_not_found" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_interaction_not_found">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_interaction_not_found</span><span class="signature">(self: ~_ClientT, message: Optional[str], /) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_interaction_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the response message for when an interaction command is not found.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            Setting this to `None` may lead to unexpected behaviour (especially</span>
<span class="sd">            when the client is still set to auto-defer interactions) and should</span>
<span class="sd">            only be done if you know what you&#39;re doing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message : typing.Optional[str]</span>
<span class="sd">            The message to respond with when an interaction command isn&#39;t found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span> <span class="o">=</span> <span class="n">message</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the response message for when an interaction command is not found.</p>

<p><em>Warning:</em>
Setting this to <code>None</code> may lead to unexpected behaviour (especially
when the client is still set to auto-defer interactions) and should
only be done if you know what you're doing.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>message</strong> (typing.Optional[str]):
The message to respond with when an interaction command isn't found.</li>
</ul>
</div>


                            </div>
                            <div id="Client.set_message_accepts" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_message_accepts">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_message_accepts</span><span class="signature">(
    self: ~_ClientT,
    accepts: <a href="#MessageAcceptsEnum">tanjun.clients.MessageAcceptsEnum</a>,
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_message_accepts</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">accepts</span><span class="p">:</span> <span class="n">MessageAcceptsEnum</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the kind of messages commands should be executed based on.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        accepts : MessageAcceptsEnum</span>
<span class="sd">            The type of messages commands should be executed based on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot set accepts level on a client with no event manager&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span> <span class="o">=</span> <span class="n">accepts</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the kind of messages commands should be executed based on.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>accepts</strong> (MessageAcceptsEnum):
The type of messages commands should be executed based on.</li>
</ul>
</div>


                            </div>
                            <div id="Client.set_message_ctx_maker" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_message_ctx_maker">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_message_ctx_maker</span><span class="signature">(
    self: ~_ClientT,
    maker: <a href="#_MessageContextMakerProto">tanjun.clients._MessageContextMakerProto</a> = &lt;class &#39;<a href="context.html#MessageContext">tanjun.context.MessageContext</a>&#39;&gt;,
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_message_ctx_maker</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">maker</span><span class="p">:</span> <span class="n">_MessageContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the message context maker to use when creating context for a message.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            The caller must return an instance of `tanjun.context.MessageContext`</span>
<span class="sd">            rather than just any implementation of the MessageContext abc due to</span>
<span class="sd">            this client relying on implementation detail of</span>
<span class="sd">            `tanjun.context.MessageContext`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        maker : _MessageContextMakerProto</span>
<span class="sd">            The message context maker to use.</span>

<span class="sd">            This is a callback which should match the signature of</span>
<span class="sd">            `tanjun.context.MessageContext.__init__` and return an instance</span>
<span class="sd">            of `tanjun.context.MessageContext`.</span>

<span class="sd">            This defaults to `tanjun.context.MessageContext`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span> <span class="o">=</span> <span class="n">maker</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the message context maker to use when creating context for a message.</p>

<p><em>Warning:</em>
The caller must return an instance of <code><a href="context.html#MessageContext">tanjun.context.MessageContext</a></code>
rather than just any implementation of the MessageContext abc due to
this client relying on implementation detail of
<code><a href="context.html#MessageContext">tanjun.context.MessageContext</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>maker</strong> (_MessageContextMakerProto):
The message context maker to use.</p>

<p>This is a callback which should match the signature of
<code><a href="context.html#MessageContext.__init__">tanjun.context.MessageContext.__init__</a></code> and return an instance
of <code><a href="context.html#MessageContext">tanjun.context.MessageContext</a></code>.</p>

<p>This defaults to <code><a href="context.html#MessageContext">tanjun.context.MessageContext</a></code>.</p></li>
</ul>
</div>


                            </div>
                            <div id="Client.set_slash_ctx_maker" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_slash_ctx_maker">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_slash_ctx_maker</span><span class="signature">(
    self: ~_ClientT,
    maker: <a href="#_SlashContextMakerProto">tanjun.clients._SlashContextMakerProto</a> = &lt;class &#39;<a href="context.html#SlashContext">tanjun.context.SlashContext</a>&#39;&gt;,
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_slash_ctx_maker</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">maker</span><span class="p">:</span> <span class="n">_SlashContextMakerProto</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">SlashContext</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the slash context maker to use when creating context for a slash command.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            The caller must return an instance of `tanjun.context.SlashContext`</span>
<span class="sd">            rather than just any implementation of the SlashContext abc due to</span>
<span class="sd">            this client relying on implementation detail of</span>
<span class="sd">            `tanjun.context.SlashContext`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        maker : _SlashContextMakerProto</span>
<span class="sd">            The slash context maker to use.</span>

<span class="sd">            This is a callback which should match the signature of</span>
<span class="sd">            `tanjun.context.SlashContext.__init__` and return an instance</span>
<span class="sd">            of `tanjun.context.SlashContext`.</span>

<span class="sd">            This defaults to `tanjun.context.SlashContext`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span> <span class="o">=</span> <span class="n">maker</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the slash context maker to use when creating context for a slash command.</p>

<p><em>Warning:</em>
The caller must return an instance of <code><a href="context.html#SlashContext">tanjun.context.SlashContext</a></code>
rather than just any implementation of the SlashContext abc due to
this client relying on implementation detail of
<code><a href="context.html#SlashContext">tanjun.context.SlashContext</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>maker</strong> (_SlashContextMakerProto):
The slash context maker to use.</p>

<p>This is a callback which should match the signature of
<code><a href="context.html#SlashContext.__init__">tanjun.context.SlashContext.__init__</a></code> and return an instance
of <code><a href="context.html#SlashContext">tanjun.context.SlashContext</a></code>.</p>

<p>This defaults to <code><a href="context.html#SlashContext">tanjun.context.SlashContext</a></code>.</p></li>
</ul>
</div>


                            </div>
                            <div id="Client.set_human_only" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_human_only">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_human_only</span><span class="signature">(self: ~_ClientT, value: bool = True) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_human_only</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set whether or not message commands execution should be limited to &quot;human&quot; users.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This doesn&#39;t apply to interaction commands as these can only be</span>
<span class="sd">            triggered by a &quot;human&quot; (normal user account).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            Whether or not message commands execution should be limited to &quot;human&quot; users.</span>

<span class="sd">            Passing `True` here will prevent message commands from being executed</span>
<span class="sd">            based on webhook and bot messages.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">checks</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">(</span><span class="n">_check_human</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_check</span><span class="p">(</span><span class="n">_check_human</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set whether or not message commands execution should be limited to "human" users.</p>

<p><em>Note:</em>
This doesn't apply to interaction commands as these can only be
triggered by a "human" (normal user account).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>value</strong> (bool):
Whether or not message commands execution should be limited to "human" users.</p>

<p>Passing <code>True</code> here will prevent message commands from being executed
based on webhook and bot messages.</p></li>
</ul>
</div>


                            </div>
                            <div id="Client.clear_commands" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.clear_commands">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">clear_commands</span><span class="signature">(
    self,
    *,
    application: Union[hikari.guilds.PartialApplication, hikari.snowflakes.Snowflake, int, NoneType] = None,
    guild: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, hikari.undefined.UndefinedType] = UNDEFINED
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">clear_commands</span><span class="p">(</span>  <span class="c1"># TODO: better name?</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clear the commands declared either globally or for a specific guild.</span>

<span class="sd">        .. note::</span>
<span class="sd">            The endpoint this uses has a strict ratelimit which, as of writing,</span>
<span class="sd">            only allows for 2 requests per minute (with that ratelimit either</span>
<span class="sd">            being per-guild if targeting a specific guild otherwise globally).</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        application : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]</span>
<span class="sd">            The application to clear commands for.</span>

<span class="sd">            If left as `None` then this will be inferred from the authorization</span>
<span class="sd">            being used by `Client.rest`.</span>
<span class="sd">        guild : hikari.UndefinedOr[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]</span>
<span class="sd">            Object or ID of the guild to clear commands for.</span>

<span class="sd">            If left as `None` global commands will be cleared.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">application</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="ow">or</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_rest_application_id</span><span class="p">()</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">set_application_commands</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="p">(),</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Clear the commands declared either globally or for a specific guild.</p>

<p><em>Note:</em>
The endpoint this uses has a strict ratelimit which, as of writing,
only allows for 2 requests per minute (with that ratelimit either
being per-guild if targeting a specific guild otherwise globally).</p>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><p><strong>application</strong> (typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]):
The application to clear commands for.</p>

<p>If left as <code>None</code> then this will be inferred from the authorization
being used by <code><a href="#Client.rest">Client.rest</a></code>.</p></li>
<li><p><strong>guild</strong> (hikari.UndefinedOr[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]):
Object or ID of the guild to clear commands for.</p>

<p>If left as <code>None</code> global commands will be cleared.</p></li>
</ul>
</div>


                            </div>
                            <div id="Client.set_global_commands" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_global_commands">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">set_global_commands</span><span class="signature">(
    self,
    *,
    application: Union[hikari.guilds.PartialApplication, hikari.snowflakes.Snowflake, int, NoneType] = None,
    guild: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, hikari.undefined.UndefinedType] = UNDEFINED,
    force: bool = False
) -&gt; collections.abc.Sequence[hikari.commands.Command]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">set_global_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Alias of `Client.declare_global_commands`.</span>

<span class="sd">        .. deprecated:: v2.1.1a1</span>
<span class="sd">            Use `Client.declare_global_commands` instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">declare_global_commands</span><span class="p">(</span><span class="n">application</span><span class="o">=</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Alias of <code><a href="#Client.declare_global_commands">Client.declare_global_commands</a></code>.</p>

<p><em>Deprecated since version v2.1.1a1:</em>
Use <code><a href="#Client.declare_global_commands">Client.declare_global_commands</a></code> instead.</p>
</div>


                            </div>
                            <div id="Client.declare_global_commands" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.declare_global_commands">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">declare_global_commands</span><span class="signature">(
    self,
    command_ids: Optional[collections.abc.Mapping[str, Union[hikari.commands.Command, hikari.snowflakes.Snowflake, int]]] = None,
    *,
    application: Union[hikari.guilds.PartialApplication, hikari.snowflakes.Snowflake, int, NoneType] = None,
    guild: Union[hikari.guilds.PartialGuild, hikari.snowflakes.Snowflake, int, hikari.undefined.UndefinedType] = UNDEFINED,
    force: bool = False
) -&gt; collections.abc.Sequence[hikari.commands.Command]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">declare_global_commands</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">command_ids</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">application</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialApplication</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">guild</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UndefinedOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">SnowflakeishOr</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">PartialGuild</span><span class="p">]]</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">UNDEFINED</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Command</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Set the global application commands for a bot based on the loaded components.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            This will overwrite any previously set application commands and</span>
<span class="sd">            only targets commands marked as global.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        * The endpoint this uses has a strict ratelimit which, as of writing,</span>
<span class="sd">          only allows for 2 requests per minute (with that ratelimit either</span>
<span class="sd">          being per-guild if targeting a specific guild otherwise globally).</span>
<span class="sd">        * Setting a specific `guild` can be useful for testing/debug purposes</span>
<span class="sd">          as slash commands may take up to an hour to propagate globally but</span>
<span class="sd">          will immediately propagate when set on a specific guild.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        command_ids : typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]</span>
<span class="sd">            If provided, a mapping of top level command names to IDs of the existing commands to update.</span>
<span class="sd">        application : typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]</span>
<span class="sd">            Object or ID of the application to set the global commands for.</span>

<span class="sd">            If left as `None` then this will be inferred from the authorization</span>
<span class="sd">            being used by `Client.rest`.</span>
<span class="sd">        guild : hikari.UndefinedOr[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]</span>
<span class="sd">            Object or ID of the guild to set the global commands to.</span>

<span class="sd">            If left as `None` global commands will be set.</span>
<span class="sd">        force : bool</span>
<span class="sd">            Force this to declare the commands regardless of whether or not</span>
<span class="sd">            they match the current state of the declared commands.</span>

<span class="sd">            Defaults to `False`. This default behaviour helps avoid issues with the</span>
<span class="sd">            2 request per minute (per-guild or globally) ratelimit and the other limit</span>
<span class="sd">            of only 200 application command creates per day (per guild or globally).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.abc.Sequence[hikari..Command]</span>
<span class="sd">            API representations of the set commands.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">commands</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">command</span>
            <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
                <span class="n">component</span><span class="o">.</span><span class="n">slash_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">is_global</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">declare_slash_commands</span><span class="p">(</span>
            <span class="n">commands</span><span class="p">,</span> <span class="n">command_ids</span><span class="p">,</span> <span class="n">application</span><span class="o">=</span><span class="n">application</span><span class="p">,</span> <span class="n">guild</span><span class="o">=</span><span class="n">guild</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span>
        <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the global application commands for a bot based on the loaded components.</p>

<p><em>Warning:</em>
This will overwrite any previously set application commands and
only targets commands marked as global.</p>

<h6 id="notes">Notes</h6>

<ul>
<li>The endpoint this uses has a strict ratelimit which, as of writing,
only allows for 2 requests per minute (with that ratelimit either
being per-guild if targeting a specific guild otherwise globally).</li>
<li>Setting a specific <code>guild</code> can be useful for testing/debug purposes
as slash commands may take up to an hour to propagate globally but
will immediately propagate when set on a specific guild.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>command_ids</strong> (typing.Optional[collections.abc.Mapping[str, hikari.SnowflakeishOr[hikari.Command]]]):
If provided, a mapping of top level command names to IDs of the existing commands to update.</li>
<li><p><strong>application</strong> (typing.Optional[hikari.snowflakes.SnowflakeishOr[hikari.PartialApplication]]):
Object or ID of the application to set the global commands for.</p>

<p>If left as <code>None</code> then this will be inferred from the authorization
being used by <code><a href="#Client.rest">Client.rest</a></code>.</p></li>
<li><p><strong>guild</strong> (hikari.UndefinedOr[hikari.snowflakes.SnowflakeishOr[hikari.PartialGuild]]):
Object or ID of the guild to set the global commands to.</p>

<p>If left as <code>None</code> global commands will be set.</p></li>
<li><p><strong>force</strong> (bool):
Force this to declare the commands regardless of whether or not
they match the current state of the declared commands.</p>

<p>Defaults to <code>False</code>. This default behaviour helps avoid issues with the
2 request per minute (per-guild or globally) ratelimit and the other limit
of only 200 application command creates per day (per guild or globally).</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Sequence[hikari..Command]</strong>: API representations of the set commands.</li>
</ul>
</div>


                            </div>
                            <div id="Client.add_check" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.add_check">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_check</span><span class="signature">(self: ~_ClientT, check: collections.abc.Callable, /) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a generic check to this client.</span>

<span class="sd">        This will be applied to both message and slash command execution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to add. This may be either synchronous or asynchronous</span>
<span class="sd">            and must take one positional argument of type `tanjun.abc.Context`</span>
<span class="sd">            with dependency injection being supported for its keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">check</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">:</span>  <span class="c1"># type: ignore[arg-type]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">checks</span><span class="o">.</span><span class="n">InjectableCheck</span><span class="p">(</span><span class="n">check</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a generic check to this client.</p>

<p>This will be applied to both message and slash command execution.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>check</strong> (tanjun_abc.CheckSig):
The check to add. This may be either synchronous or asynchronous
and must take one positional argument of type <code><a href="abc.html#Context">tanjun.abc.Context</a></code>
with dependency injection being supported for its keyword arguments.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.remove_check" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.remove_check">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_check</span><span class="signature">(self: ~_ClientT, check: collections.abc.Callable, /) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_check</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a check from the client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the check was not previously added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a check from the client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>check</strong> (tanjun_abc.CheckSig):
The check to remove.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the check was not previously added.</li>
</ul>
</div>


                            </div>
                            <div id="Client.with_check" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.with_check">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_check</span><span class="signature">(self, check: ~CheckSigT, /) -&gt; ~CheckSigT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">CheckSigT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a check to this client through a decorator call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        check : tanjun_abc.CheckSig</span>
<span class="sd">            The check to add. This may be either synchronous or asynchronous</span>
<span class="sd">            and must take one positional argument of type `tanjun.abc.Context`</span>
<span class="sd">            with dependency injection being supported for its keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun_abc.CheckSig</span>
<span class="sd">            The added check.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_check</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">check</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a check to this client through a decorator call.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>check</strong> (tanjun_abc.CheckSig):
The check to add. This may be either synchronous or asynchronous
and must take one positional argument of type <code><a href="abc.html#Context">tanjun.abc.Context</a></code>
with dependency injection being supported for its keyword arguments.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>tanjun_abc.CheckSig</strong>: The added check.</li>
</ul>
</div>


                            </div>
                            <div id="Client.check" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.check">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">check</span><span class="signature">(self, ctx: <a href="abc.html#Context">tanjun.abc.Context</a>, /) -&gt; bool</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">gather_checks</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checks</span><span class="p">)</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Client.add_component" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.add_component">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_component</span><span class="signature">(
    self: ~_ClientT,
    component: <a href="abc.html#Component">tanjun.abc.Component</a>,
    /,
    *,
    add_injector: bool = False
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">add_injector</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a component to this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        component: Component</span>
<span class="sd">            The component to move to this client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to allow chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the component&#39;s name is already registered.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">component</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A component named </span><span class="si">{</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="si">!r}</span><span class="s2"> is already registered.&quot;</span><span class="p">)</span>

        <span class="n">component</span><span class="o">.</span><span class="n">bind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">component</span>

        <span class="k">if</span> <span class="n">add_injector</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_type_dependency</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">component</span><span class="p">),</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">component</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">COMPONENT_ADDED</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a component to this client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>component</strong> (Component):
The component to move to this client.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to allow chained calls.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the component's name is already registered.</li>
</ul>
</div>


                            </div>
                            <div id="Client.get_component_by_name" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.get_component_by_name">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_component_by_name</span><span class="signature">(self, name: str, /) -&gt; Optional[<a href="abc.html#Component">tanjun.abc.Component</a>]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">get_component_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Get a component from this client by name.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
Name to get a component by.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Optional[Component]</strong>: The component instance if found, else <code>None</code>.</li>
</ul>
</div>


                            </div>
                            <div id="Client.remove_component" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.remove_component">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_component</span><span class="signature">(self: ~_ClientT, component: <a href="abc.html#Component">tanjun.abc.Component</a>, /) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_component</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Component</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">stored_component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">stored_component</span> <span class="ow">or</span> <span class="n">stored_component</span> <span class="o">!=</span> <span class="n">component</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The component </span><span class="si">{</span><span class="n">component</span><span class="si">!r}</span><span class="s2"> is not registered.&quot;</span><span class="p">)</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="n">stored_component</span><span class="o">.</span><span class="n">unbind_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">COMPONENT_REMOVED</span><span class="p">,</span> <span class="n">stored_component</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a component from this client.</p>

<p>This will unsubscribe any client callbacks, commands and listeners
registered in the provided component.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>component</strong> (Component):
The component to remove from this client.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the provided component isn't found.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to allow chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.remove_component_by_name" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.remove_component_by_name">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_component_by_name</span><span class="signature">(self: ~_ClientT, name: str, /) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_component_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a component from this client by name.</p>

<p>This will unsubscribe any client callbacks, commands and listeners
registered in the provided component.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
Name of the component to remove from this client.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>KeyError</strong>: If the provided component name isn't found.</li>
</ul>
</div>


                            </div>
                            <div id="Client.add_client_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.add_client_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_client_callback</span><span class="signature">(
    self: ~_ClientT,
    name: str,
    callback: collections.abc.Callable,
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">descriptor</span> <span class="o">=</span> <span class="n">injecting</span><span class="o">.</span><span class="n">CallbackDescriptor</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">descriptor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">descriptor</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">descriptor</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a client callback.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>_name</strong> (str):
The name this callback is being registered to.</p>

<p>This is case-insensitive.</p></li>
<li><p><strong>callback</strong> (MetaEventSigT):
The callback to register.</p>

<p>This may be sync or async and must return None. The positional and
keyword arguments a callback should expect depend on implementation
detail around the <code>name</code> being subscribed to.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.dispatch_client_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.dispatch_client_callback">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">dispatch_client_callback</span><span class="signature">(self, name: str, /, *args: Any, **kwargs: Any) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">dispatch_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Dispatch a client callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The name of the callback to dispatch.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        *args : typing.Any</span>
<span class="sd">            Positional arguments to pass to the callback(s).</span>
<span class="sd">        **kwargs : typing.Any</span>
<span class="sd">            Keyword arguments to pass to the callback(s).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        KeyError</span>
<span class="sd">            If no callbacks are registered for the given name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">callbacks</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="n">calls</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">_wrap_client_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">injecting</span><span class="o">.</span><span class="n">BasicInjectionContext</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">calls</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Dispatch a client callback.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the callback to dispatch.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>*args</strong> (typing.Any):
Positional arguments to pass to the callback(s).</li>
<li><strong>**kwargs</strong> (typing.Any):
Keyword arguments to pass to the callback(s).</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>KeyError</strong>: If no callbacks are registered for the given name.</li>
</ul>
</div>


                            </div>
                            <div id="Client.get_client_callbacks" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.get_client_callbacks">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_client_callbacks</span><span class="signature">(
    self,
    name: str,
    /
) -&gt; collections.abc.Collection[collections.abc.Callable[..., typing.Optional[collections.abc.Awaitable[NoneType]]]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">get_client_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Collection</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">callback</span><span class="o">.</span><span class="n">callback</span> <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Get a collection of the callbacks registered for a specific name.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>name</strong> (str):
The name to get the callbacks registered for.</p>

<p>This is case-insensitive.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Collection[MetaEventSig]</strong>: Collection of the callbacks for the provided name.</li>
</ul>
</div>


                            </div>
                            <div id="Client.remove_client_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.remove_client_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_client_callback</span><span class="signature">(
    self: ~_ClientT,
    name: str,
    callback: collections.abc.Callable,
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_client_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSig</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a client callback.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>name</strong> (str):
The name this callback is being registered to.</p>

<p>This is case-insensitive.</p></li>
<li><strong>callback</strong> (MetaEventSigT):
The callback to remove from the client's callbacks.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>KeyError</strong>: If the provided name isn't found.</li>
<li><strong>ValueError</strong>: If the provided callback isn't found.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.with_client_callback" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.with_client_callback">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_client_callback</span><span class="signature">(
    self,
    name: str,
    /
) -&gt; collections.abc.Callable[[~MetaEventSigT], ~MetaEventSigT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_client_callback</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">],</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MetaEventSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a client callback through a decorator call.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="n">client</span> <span class="o">=</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">from_rest_bot</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>

<span class="nd">@client</span><span class="o">.</span><span class="n">with_client_callback</span><span class="p">(</span><span class="s2">&quot;closed&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">on_close</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>name</strong> (str):
The name this callback is being registered to.</p>

<p>This is case-insensitive.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[MetaEventSigT], MetaEventSigT]</strong>: Decorator callback used to register the client callback.</li>
</ul>

<p>This may be sync or async and must return None. The positional and
keyword arguments a callback should expect depend on implementation
detail around the <code>name</code> being subscribed to.</p>
</div>


                            </div>
                            <div id="Client.add_listener" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.add_listener">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_listener</span><span class="signature">(
    self: ~_ClientT,
    event_type: type,
    callback: collections.abc.Callable,
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">injected</span> <span class="o">=</span> <span class="n">_InjectableListener</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">callback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">self</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">injected</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">injected</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">injected</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a listener to the client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>event_type</strong> (type[hikari.Event]):
The event type to add a listener for.</li>
<li><p><strong>callback</strong> (ListenerCallbackSig):
The callback to register as a listener.</p>

<p>This callback must be a coroutine function which returns <code>None</code> and
always takes at least one positional arg of type <code>hikari.Event</code>
regardless of client implementation detail.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.remove_listener" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.remove_listener">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_listener</span><span class="signature">(
    self: ~_ClientT,
    event_type: type,
    callback: collections.abc.Callable,
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSig</span><span class="p">,</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">registered_callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="p">[</span><span class="n">event_type</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">registered_callback</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a listener from the client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>event_type</strong> (type[hikari.Event]):
The event type to remove a listener for.</li>
<li><strong>callback</strong> (ListenerCallbackSig):
The callback to remove.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>KeyError</strong>: If the provided event type isn't found.</li>
<li><strong>ValueError</strong>: If the provided callback isn't found.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.with_listener" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.with_listener">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_listener</span><span class="signature">(
    self,
    event_type: type,
    /
) -&gt; collections.abc.Callable[[~ListenerCallbackSigT], ~ListenerCallbackSigT]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_listener</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">Event</span><span class="p">],</span> <span class="o">/</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">],</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ListenerCallbackSigT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_listener</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">callback</span>

        <span class="k">return</span> <span class="n">decorator</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add an event listener to this client through a decorator call.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="n">client</span> <span class="o">=</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">from_gateway_bot</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>

<span class="nd">@client</span><span class="o">.</span><span class="n">with_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">on_message_create</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>event_type</strong> (type[hikari.Event]):
The event type to listener for.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Callable[[ListenerCallbackSigT], ListenerCallbackSigT]</strong>: Decorator callback used to register the event callback.</li>
</ul>

<p>The callback must be a coroutine function which returns <code>None</code> and
always takes at least one positional arg of type <code>hikari.Event</code>
regardless of client implementation detail.</p>
</div>


                            </div>
                            <div id="Client.add_prefix" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.add_prefix">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">add_prefix</span><span class="signature">(
    self: ~_ClientT,
    prefixes: Union[collections.abc.Iterable[str], str],
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">add_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">prefixes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a prefix used to filter message command calls.</span>

<span class="sd">        This will be matched against the first character(s) in a message&#39;s</span>
<span class="sd">        content to determine whether the message command search stage of</span>
<span class="sd">        execution should be initiated.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        prefixes : typing.Union[collections.abc.Iterable[str], str]</span>
<span class="sd">            Either a single string or an iterable of strings to be used as</span>
<span class="sd">            prefixes.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prefixes</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">prefixes</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefixes</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">prefix</span> <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">prefixes</span> <span class="k">if</span> <span class="n">prefix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a prefix used to filter message command calls.</p>

<p>This will be matched against the first character(s) in a message's
content to determine whether the message command search stage of
execution should be initiated.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>prefixes</strong> (typing.Union[collections.abc.Iterable[str], str]):
Either a single string or an iterable of strings to be used as
prefixes.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.remove_prefix" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.remove_prefix">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">remove_prefix</span><span class="signature">(self: ~_ClientT, prefix: str, /) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">remove_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove a message content prefix from the client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        prefix : str</span>
<span class="sd">            The prefix to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the prefix is not registered with the client.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove a message content prefix from the client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>prefix</strong> (str):
The prefix to remove.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the prefix is not registered with the client.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.set_prefix_getter" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_prefix_getter">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_prefix_getter</span><span class="signature">(
    self: ~_ClientT,
    getter: Optional[collections.abc.Callable[..., collections.abc.Awaitable[collections.abc.Iterable[str]]]],
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_prefix_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">getter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">PrefixGetterSig</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the callback used to retrieve message prefixes set for the relevant guild.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        getter : typing.Optional[PrefixGetterSig]</span>
<span class="sd">            The callback which&#39;ll be  to retrieve prefixes for the guild a</span>
<span class="sd">            message event is from. If `None` is passed here then the callback</span>
<span class="sd">            will be unset.</span>

<span class="sd">            This should be an async callback which one argument of type</span>
<span class="sd">            `tanjun.abc.MessageContext` and returns an iterable of string prefixes.</span>
<span class="sd">            Dependency injection is supported for this callback&#39;s keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefix_getter</span> <span class="o">=</span> <span class="n">_InjectablePrefixGetter</span><span class="p">(</span><span class="n">getter</span><span class="p">)</span> <span class="k">if</span> <span class="n">getter</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the callback used to retrieve message prefixes set for the relevant guild.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>getter</strong> (typing.Optional[PrefixGetterSig]):
The callback which'll be  to retrieve prefixes for the guild a
message event is from. If <code>None</code> is passed here then the callback
will be unset.</p>

<p>This should be an async callback which one argument of type
<code><a href="abc.html#MessageContext">tanjun.abc.MessageContext</a></code> and returns an iterable of string prefixes.
Dependency injection is supported for this callback's keyword arguments.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.with_prefix_getter" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.with_prefix_getter">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">with_prefix_getter</span><span class="signature">(self, getter: ~PrefixGetterSigT, /) -&gt; ~PrefixGetterSigT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">with_prefix_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">getter</span><span class="p">:</span> <span class="n">PrefixGetterSigT</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PrefixGetterSigT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the prefix getter callback for this client through decorator call.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ```py</span>
<span class="sd">        client = tanjun.Client.from_rest_bot(bot)</span>

<span class="sd">        @client.with_prefix_getter</span>
<span class="sd">        async def prefix_getter(ctx: tanjun.abc.MessageContext) -&gt; collections.abc.Iterable[str]:</span>
<span class="sd">            raise NotImplementedError</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        getter : PrefixGetterSig</span>
<span class="sd">            The callback which&#39;ll be  to retrieve prefixes for the guild a</span>
<span class="sd">            message event is from.</span>

<span class="sd">            This should be an async callback which one argument of type</span>
<span class="sd">            `tanjun.abc.MessageContext` and returns an iterable of string prefixes.</span>
<span class="sd">            Dependency injection is supported for this callback&#39;s keyword arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PrefixGetterSigT</span>
<span class="sd">            The registered callback.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_prefix_getter</span><span class="p">(</span><span class="n">getter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">getter</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the prefix getter callback for this client through decorator call.</p>

<h6 id="examples">Examples</h6>

<div class="codehilite"><pre><span></span><code><span class="n">client</span> <span class="o">=</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">from_rest_bot</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>

<span class="nd">@client</span><span class="o">.</span><span class="n">with_prefix_getter</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">prefix_getter</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">MessageContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>getter</strong> (PrefixGetterSig):
The callback which'll be  to retrieve prefixes for the guild a
message event is from.</p>

<p>This should be an async callback which one argument of type
<code><a href="abc.html#MessageContext">tanjun.abc.MessageContext</a></code> and returns an iterable of string prefixes.
Dependency injection is supported for this callback's keyword arguments.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>PrefixGetterSigT</strong>: The registered callback.</li>
</ul>
</div>


                            </div>
                            <div id="Client.iter_commands" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.iter_commands">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">iter_commands</span><span class="signature">(
    self
) -&gt; collections.abc.Iterator[<a href="abc.html#ExecutableCommand">tanjun.abc.ExecutableCommand</a>[<a href="abc.html#Context">tanjun.abc.Context</a>]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">iter_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">ExecutableCommand</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">Context</span><span class="p">]]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="n">slash_commands</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_slash_commands</span><span class="p">(</span><span class="n">global_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_message_commands</span><span class="p">()</span>
        <span class="k">yield from</span> <span class="n">slash_commands</span>
</pre></div>

        </details>

            <div class="docstring"><p>Iterate over all the commands (both message and slash) registered to this client.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Iterator[ExecutableCommand[Context]]</strong>: Iterator of all the commands registered to this client.</li>
</ul>
</div>


                            </div>
                            <div id="Client.iter_message_commands" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.iter_message_commands">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">iter_message_commands</span><span class="signature">(self) -&gt; collections.abc.Iterator[<a href="abc.html#MessageCommand">tanjun.abc.MessageCommand</a>]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">iter_message_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">message_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Iterate over all the message commands registered to this client.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Iterator[MessageCommand]</strong>: Iterator of all the message commands registered to this client.</li>
</ul>
</div>


                            </div>
                            <div id="Client.iter_slash_commands" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.iter_slash_commands">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">iter_slash_commands</span><span class="signature">(
    self,
    *,
    global_only: bool = False
) -&gt; collections.abc.Iterator[<a href="abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">iter_slash_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">global_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">if</span> <span class="n">global_only</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">is_global</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_slash_commands</span><span class="p">(</span><span class="n">global_only</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">slash_commands</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Iterate over all the slash commands registered to this client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>global_only</strong> (bool):
Whether to only iterate over global slash commands.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Iterator[BaseSlashCommand]</strong>: Iterator of all the slash commands registered to this client.</li>
</ul>
</div>


                            </div>
                            <div id="Client.check_message_name" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.check_message_name">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">check_message_name</span><span class="signature">(
    self,
    name: str,
    /
) -&gt; collections.abc.Iterator[tuple[str, <a href="abc.html#MessageCommand">tanjun.abc.MessageCommand</a>]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">check_message_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageCommand</span><span class="p">]]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="n">component</span><span class="o">.</span><span class="n">check_message_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Check whether a message command name is present in the current client.</p>

<p><em>Note:</em>
Dependent on implementation this may partial check name against the
message command's name based on command_name.startswith(name).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name to match commands against.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Iterator[tuple[str, MessageCommand]]</strong>: Iterator of the matched command names to the matched message command objects.</li>
</ul>
</div>


                            </div>
                            <div id="Client.check_slash_name" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.check_slash_name">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">check_slash_name</span><span class="signature">(
    self,
    name: str,
    /
) -&gt; collections.abc.Iterator[<a href="abc.html#BaseSlashCommand">tanjun.abc.BaseSlashCommand</a>]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">check_slash_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">BaseSlashCommand</span><span class="p">]:</span>
        <span class="c1"># &lt;&lt;inherited docstring from tanjun.abc.Client&gt;&gt;.</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="n">component</span><span class="o">.</span><span class="n">check_slash_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Check whether a slash command name is present in the current client.</p>

<p><em>Note:</em>
This won't check the commands within command groups.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
Name to check against.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>collections.abc.Iterator[BaseSlashCommand]</strong>: Iterator of the matched slash command objects.</li>
</ul>
</div>


                            </div>
                            <div id="Client.close" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.close">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">close</span><span class="signature">(self, *, deregister_listeners: bool = True) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">deregister_listeners</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Close the client.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the client isn&#39;t running.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Client isn&#39;t active&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span><span class="p">:</span>
            <span class="n">event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSING</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deregister_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event_type</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">event_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_message_create_event</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_event</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_try_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">,</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listener</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">deregister_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">CLOSED</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

        </details>

            <div class="docstring"><p>Close the client.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>RuntimeError</strong>: If the client isn't running.</li>
</ul>
</div>


                            </div>
                            <div id="Client.open" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.open">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">open</span><span class="signature">(self, *, register_listeners: bool = True) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">register_listeners</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Start the client.</span>

<span class="sd">        If `mention_prefix` was passed to `Client.__init__` or</span>
<span class="sd">        `Client.from_gateway_bot` then this function may make a fetch request</span>
<span class="sd">        to Discord if it cannot get the current user from the cache.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the client is already active.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Client is already alive&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_alive</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_closing</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTING</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span><span class="p">:</span>
            <span class="n">user</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">User</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">:</span>
                <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">get_me</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
                <span class="n">retry</span> <span class="o">=</span> <span class="n">backoff</span><span class="o">.</span><span class="n">Backoff</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

                <span class="k">async</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">retry</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_my_user</span><span class="p">()</span>
                        <span class="k">break</span>

                    <span class="k">except</span> <span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitedError</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">RateLimitTooLongError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
                            <span class="k">raise</span>

                        <span class="n">retry</span><span class="o">.</span><span class="n">set_next_backoff</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">retry_after</span><span class="p">)</span>

                    <span class="k">except</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InternalServerError</span><span class="p">:</span>
                        <span class="k">continue</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_my_user</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="sa">f</span><span class="s2">&quot;&lt;@</span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&gt;&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;&lt;@!</span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&gt;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">prefix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_prefixes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_grab_mention_prefix</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">register_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event_type</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepts</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_message_create_event</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_event</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">listeners</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_listeners</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">listener</span> <span class="ow">in</span> <span class="n">listeners</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">listener</span><span class="o">.</span><span class="fm">__call__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">register_listeners</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span><span class="o">.</span><span class="n">set_listener</span><span class="p">(</span><span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_interaction_create_request</span><span class="p">)</span>

        <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">STARTED</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Start the client.</p>

<p>If <code>mention_prefix</code> was passed to <code><a href="#Client.__init__">Client.__init__</a></code> or
<code><a href="#Client.from_gateway_bot">Client.from_gateway_bot</a></code> then this function may make a fetch request
to Discord if it cannot get the current user from the cache.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>RuntimeError</strong>: If the client is already active.</li>
</ul>
</div>


                            </div>
                            <div id="Client.fetch_rest_application_id" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.fetch_rest_application_id">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">fetch_rest_application_id</span><span class="signature">(self) -&gt; hikari.snowflakes.Snowflake</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_rest_application_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Fetch the application ID of the application this client is linked to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        hikari.Snowflake</span>
<span class="sd">            The application ID of the application this client is linked to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">token_type</span> <span class="o">==</span> <span class="n">hikari</span><span class="o">.</span><span class="n">TokenType</span><span class="o">.</span><span class="n">BOT</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_application</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">application</span> <span class="o">=</span> <span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest</span><span class="o">.</span><span class="n">fetch_authorization</span><span class="p">())</span><span class="o">.</span><span class="n">application</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span> <span class="o">=</span> <span class="n">hikari</span><span class="o">.</span><span class="n">Snowflake</span><span class="p">(</span><span class="n">application</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_application_id</span>
</pre></div>

        </details>

            <div class="docstring"><p>Fetch the application ID of the application this client is linked to.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hikari.Snowflake</strong>: The application ID of the application this client is linked to.</li>
</ul>
</div>


                            </div>
                            <div id="Client.set_hooks" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_hooks">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_hooks</span><span class="signature">(
    self: ~_ClientT,
    hooks: Optional[<a href="abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="abc.html#Context">tanjun.abc.Context</a>]],
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">AnyHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the general command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every slash and message</span>
<span class="sd">        command execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.AnyHooks]</span>
<span class="sd">            The general command execution hooks to set for this client.</span>

<span class="sd">            Passing `None` will remove all hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the general command execution hooks for this client.</p>

<p>The callbacks within this hook will be added to every slash and message
command execution started by this client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>hooks</strong> (typing.Optional[tanjun_abc.AnyHooks]):
The general command execution hooks to set for this client.</p>

<p>Passing <code>None</code> will remove all hooks.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.set_slash_hooks" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_slash_hooks">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_slash_hooks</span><span class="signature">(
    self: ~_ClientT,
    hooks: Optional[<a href="abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="abc.html#SlashContext">tanjun.abc.SlashContext</a>]],
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_slash_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">SlashHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the slash command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every slash command</span>
<span class="sd">        execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.SlashHooks]</span>
<span class="sd">            The slash context specific command execution hooks to set for this</span>
<span class="sd">            client.</span>

<span class="sd">            Passing `None` will remove the hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_slash_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the slash command execution hooks for this client.</p>

<p>The callbacks within this hook will be added to every slash command
execution started by this client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>hooks</strong> (typing.Optional[tanjun_abc.SlashHooks]):
The slash context specific command execution hooks to set for this
client.</p>

<p>Passing <code>None</code> will remove the hooks.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.set_message_hooks" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.set_message_hooks">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_message_hooks</span><span class="signature">(
    self: ~_ClientT,
    hooks: Optional[<a href="abc.html#Hooks">tanjun.abc.Hooks</a>[<a href="abc.html#MessageContext">tanjun.abc.MessageContext</a>]],
    /
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">set_message_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">],</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the message command execution hooks for this client.</span>

<span class="sd">        The callbacks within this hook will be added to every message command</span>
<span class="sd">        execution started by this client.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hooks : typing.Optional[tanjun_abc.MessageHooks]</span>
<span class="sd">            The message context specific command execution hooks to set for this</span>
<span class="sd">            client.</span>

<span class="sd">            Passing `None` will remove all hooks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            The client instance to enable chained calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span> <span class="o">=</span> <span class="n">hooks</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set the message command execution hooks for this client.</p>

<p>The callbacks within this hook will be added to every message command
execution started by this client.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>hooks</strong> (typing.Optional[tanjun_abc.MessageHooks]):
The message context specific command execution hooks to set for this
client.</p>

<p>Passing <code>None</code> will remove all hooks.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: The client instance to enable chained calls.</li>
</ul>
</div>


                            </div>
                            <div id="Client.load_modules" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.load_modules">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">load_modules</span><span class="signature">(
    self: ~_ClientT,
    *modules: Union[str, pathlib.Path],
    _log: bool = True
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">load_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">_log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load entities into this client from modules based on loader descriptors.</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find loaders.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_loader`</span>
<span class="sd">        decorated top level function which takes one positional argument</span>
<span class="sd">        of type `Client`.</span>

<span class="sd">        ```py</span>
<span class="sd">        @tanjun.as_loader</span>
<span class="sd">        def load_module(client: tanjun.Client) -&gt; None:</span>
<span class="sd">            client.add_component(component.copy())</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules : typing.Union[str, pathlib.Path]</span>
<span class="sd">            Path(s) of the modules to load from.</span>

<span class="sd">            When `str` this will be treated as a normal import path which is</span>
<span class="sd">            absolute (`&quot;foo.bar.baz&quot;`). It&#39;s worth noting that absolute module</span>
<span class="sd">            paths may be imported from the current location if the top level</span>
<span class="sd">            module is a valid module file or module directory in the current</span>
<span class="sd">            working directory.</span>

<span class="sd">            When `pathlib.Path` the module will be imported directly from</span>
<span class="sd">            the given path. In this mode any relative imports in the target</span>
<span class="sd">            module will fail to resolve.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module is already loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no loader descriptors are found in the module.</span>
<span class="sd">        ModuleNotFoundError</span>
<span class="sd">            If the module is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> already loaded&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                    <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">[</span><span class="n">module_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">module_path_abs</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">module_path_abs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module at </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> already loaded&quot;</span><span class="p">)</span>

                <span class="n">module_name</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="n">importlib_util</span><span class="o">.</span><span class="n">spec_from_file_location</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">module_path_abs</span><span class="p">)</span>

                <span class="c1"># https://github.com/python/typeshed/issues/2793</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">spec</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="p">,</span> <span class="n">importlib_abc</span><span class="o">.</span><span class="n">Loader</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ModuleNotFoundError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Module not found at </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">module_name</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                    <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib_util</span><span class="o">.</span><span class="n">module_from_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
                <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">exec_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="p">[</span><span class="n">module_path_abs</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Load entities into this client from modules based on loader descriptors.</p>

<p><em>Note:</em>
If an <code>__all__</code> is present in the target module then it will be
used to find loaders.</p>

<h6 id="examples">Examples</h6>

<p>For this to work the module has to have at least one <code><a href="#as_loader">as_loader</a></code>
decorated top level function which takes one positional argument
of type <code><a href="#Client">Client</a></code>.</p>

<div class="codehilite"><pre><span></span><code><span class="nd">@tanjun</span><span class="o">.</span><span class="n">as_loader</span>
<span class="k">def</span> <span class="nf">load_module</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">Client</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">client</span><span class="o">.</span><span class="n">add_component</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>*modules</strong> (typing.Union[str, pathlib.Path]):
Path(s) of the modules to load from.</p>

<p>When <code>str</code> this will be treated as a normal import path which is
absolute (<code>"foo.bar.baz"</code>). It's worth noting that absolute module
paths may be imported from the current location if the top level
module is a valid module file or module directory in the current
working directory.</p>

<p>When <code>pathlib.Path</code> the module will be imported directly from
the given path. In this mode any relative imports in the target
module will fail to resolve.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: This client instance to enable chained calls.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the module is already loaded.</li>
<li><strong>RuntimeError</strong>: If no loader descriptors are found in the module.</li>
<li><strong>ModuleNotFoundError</strong>: If the module is not found.</li>
</ul>
</div>


                            </div>
                            <div id="Client.unload_modules" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.unload_modules">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">unload_modules</span><span class="signature">(
    self: ~_ClientT,
    *modules: Union[str, pathlib.Path],
    _log: bool = True
) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">unload_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">_log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Unload entities from this client based on unloader descriptors in one or more modules.</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find unloaders.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_unloader`</span>
<span class="sd">        decorated top level function which takes one positional argument</span>
<span class="sd">        of type `Client`.</span>

<span class="sd">        ```py</span>
<span class="sd">        @tanjun.as_unloader</span>
<span class="sd">        def unload_component(client: tanjun.Client) -&gt; None:</span>
<span class="sd">            client.remove_component_by_name(component.name)</span>
<span class="sd">        ```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules: typing.Union[str, pathlib.Path]</span>
<span class="sd">            Path of one or more modules to unload.</span>

<span class="sd">            These should be the same path(s) which were passed to `load_module`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module hasn&#39;t been loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no unloader descriptors are found in the module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">module_path</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module </span><span class="si">{</span><span class="n">module_path</span><span class="si">!s}</span><span class="s2"> not loaded&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">_log</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Unloading from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_unload_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Unload entities from this client based on unloader descriptors in one or more modules.</p>

<p><em>Note:</em>
If an <code>__all__</code> is present in the target module then it will be
used to find unloaders.</p>

<h6 id="examples">Examples</h6>

<p>For this to work the module has to have at least one <code><a href="#as_unloader">as_unloader</a></code>
decorated top level function which takes one positional argument
of type <code><a href="#Client">Client</a></code>.</p>

<div class="codehilite"><pre><span></span><code><span class="nd">@tanjun</span><span class="o">.</span><span class="n">as_unloader</span>
<span class="k">def</span> <span class="nf">unload_component</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">tanjun</span><span class="o">.</span><span class="n">Client</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">client</span><span class="o">.</span><span class="n">remove_component_by_name</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>*modules</strong> (typing.Union[str, pathlib.Path]):
Path of one or more modules to unload.</p>

<p>These should be the same path(s) which were passed to <code>load_module</code>.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: This client instance to enable chained calls.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the module hasn't been loaded.</li>
<li><strong>RuntimeError</strong>: If no unloader descriptors are found in the module.</li>
</ul>
</div>


                            </div>
                            <div id="Client.reload_modules" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.reload_modules">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">reload_modules</span><span class="signature">(self: ~_ClientT, *modules: Union[str, pathlib.Path]) -&gt; ~_ClientT</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">reload_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_ClientT</span><span class="p">,</span> <span class="o">*</span><span class="n">modules</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">_ClientT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Reload entities in this client based on the descriptors in loaded module(s).</span>

<span class="sd">        .. note::</span>
<span class="sd">            If an `__all__` is present in the target module then it will be</span>
<span class="sd">            used to find descriptors.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        For this to work the module has to have at least one `as_loader` and</span>
<span class="sd">        one `as_unloader` decorated top level function which each take one</span>
<span class="sd">        positional argument of type `Client`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *modules: typing.Union[str, pathlib.Path]</span>
<span class="sd">            Paths of one or more module to unload.</span>

<span class="sd">            These  should be the same paths which were passed to `load_module`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Self</span>
<span class="sd">            This client instance to enable chained calls.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the module hasn&#39;t been loaded.</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If no unloader descriptors are found in the current state of the module.</span>
<span class="sd">            If no loader descriptors are found in the new state of the module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">module_path</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> not loaded&quot;</span><span class="p">)</span>

                <span class="n">module_repr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Reloading </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_unload_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module_repr</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">[</span><span class="n">module_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">_LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Reloading </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unload_modules</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="n">_log</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">load_modules</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="n">_log</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

            <div class="docstring"><p>Reload entities in this client based on the descriptors in loaded module(s).</p>

<p><em>Note:</em>
If an <code>__all__</code> is present in the target module then it will be
used to find descriptors.</p>

<h6 id="examples">Examples</h6>

<p>For this to work the module has to have at least one <code><a href="#as_loader">as_loader</a></code> and
one <code><a href="#as_unloader">as_unloader</a></code> decorated top level function which each take one
positional argument of type <code><a href="#Client">Client</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>*modules</strong> (typing.Union[str, pathlib.Path]):
Paths of one or more module to unload.</p>

<p>These  should be the same paths which were passed to <code>load_module</code>.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Self</strong>: This client instance to enable chained calls.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If the module hasn't been loaded.</li>
<li><strong>RuntimeError</strong>: If no unloader descriptors are found in the current state of the module.
If no loader descriptors are found in the new state of the module.</li>
</ul>
</div>


                            </div>
                            <div id="Client.on_message_create_event" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.on_message_create_event">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">on_message_create_event</span><span class="signature">(
    self,
    event: hikari.events.message_events.MessageCreateEvent,
    /
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_message_create_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a message command based on a gateway event.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hikari.events.message_events.MessageCreateEvent</span>
<span class="sd">            The event to handle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_message_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">message</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">prefix</span> <span class="o">:=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_prefix</span><span class="p">(</span><span class="n">ctx</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">ctx</span><span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="p">:]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span><span class="o">.</span><span class="n">set_triggering_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="n">hooks</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="n">tanjun_abc</span><span class="o">.</span><span class="n">MessageHooks</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="p">}</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">:</span>
            <span class="n">hooks</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_message_hooks</span><span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_message</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">return</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">MESSAGE_COMMAND_NOT_FOUND</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Execute a message command based on a gateway event.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>hikari.events.message_events.MessageCreateEvent</strong>: The event to handle.</li>
</ul>
</div>


                            </div>
                            <div id="Client.on_interaction_create_event" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.on_interaction_create_event">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">on_interaction_create_event</span><span class="signature">(
    self,
    event: hikari.events.interaction_events.InteractionCreateEvent,
    /
) -&gt; None</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_interaction_create_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">InteractionCreateEvent</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a slash command based on Gateway events.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Any event where `event.interaction` is not</span>
<span class="sd">            `hikari.CommandInteraction` will be ignored.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event : hikari.events.interaction_events.InteractionCreateEvent</span>
<span class="sd">            The event to execute commands based on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">,</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">interaction</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">interaction</span><span class="p">,</span>
            <span class="n">not_found_message</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slash_hooks</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">start_defer_timer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">future</span> <span class="o">:=</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_interaction</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">await</span> <span class="n">future</span>
                        <span class="k">return</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">SLASH_COMMAND_NOT_FOUND</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">()</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">cancel_defer</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Execute a slash command based on Gateway events.</p>

<p><em>Note:</em>
Any event where <code>event.interaction</code> is not
<code>hikari.CommandInteraction</code> will be ignored.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>event</strong> (hikari.events.interaction_events.InteractionCreateEvent):
The event to execute commands based on.</li>
</ul>
</div>


                            </div>
                            <div id="Client.on_interaction_create_request" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Client.on_interaction_create_request">#&nbsp;&nbsp</a>

        
            <span class="def">async def</span>
            <span class="name">on_interaction_create_request</span><span class="signature">(
    self,
    interaction: hikari.interactions.command_interactions.CommandInteraction,
    /
) -&gt; Union[hikari.api.special_endpoints.InteractionMessageBuilder, hikari.api.special_endpoints.InteractionDeferredBuilder]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_interaction_create_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="p">:</span> <span class="n">hikari</span><span class="o">.</span><span class="n">CommandInteraction</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">ResponseTypeT</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Execute a slash command based on received REST requests.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        interaction : hikari.CommandInteraction</span>
<span class="sd">            The interaction to execute a command based on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tanjun.context.ResponseType</span>
<span class="sd">            The initial response to send back to Discord.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_slash_context</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">injection_client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">interaction</span><span class="o">=</span><span class="n">interaction</span><span class="p">,</span> <span class="n">not_found_message</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_interaction_not_found</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">start_defer_timer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_auto_defer_after</span><span class="p">)</span>

        <span class="n">hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_slash_hooks</span><span class="p">()</span>
        <span class="n">future</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_response_future</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="k">await</span> <span class="n">component</span><span class="o">.</span><span class="n">execute_interaction</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">hooks</span><span class="o">=</span><span class="n">hooks</span><span class="p">):</span>
                        <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">HaltExecution</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">except</span> <span class="n">errors</span><span class="o">.</span><span class="n">CommandError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="c1"># Under very specific timing there may be another future which could set a result while we await</span>
            <span class="c1"># ctx.respond therefore we create a task to avoid any erroneous behaviour from this trying to create</span>
            <span class="c1"># another response before it&#39;s returned the initial response.</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interaction</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> command error responder&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>

        <span class="k">async</span> <span class="k">def</span> <span class="nf">callback</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_client_callback</span><span class="p">(</span><span class="n">ClientCallbackNames</span><span class="o">.</span><span class="n">SLASH_COMMAND_NOT_FOUND</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">ctx</span><span class="o">.</span><span class="n">mark_not_found</span><span class="p">()</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">cancel_defer</span><span class="p">()</span>

        <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">callback</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interaction</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>
</pre></div>

        </details>

            <div class="docstring"><p>Execute a slash command based on received REST requests.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>interaction</strong> (hikari.CommandInteraction):
The interaction to execute a command based on.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong><a href="context.html#ResponseType">tanjun.context.ResponseType</a></strong>: The initial response to send back to Discord.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="injecting.html#InjectorClient">tanjun.injecting.InjectorClient</a></dt>
                                <dd id="Client.set_type_dependency" class="function"><a href="injecting.html#InjectorClient.set_type_dependency">set_type_dependency</a></dd>
                <dd id="Client.get_type_dependency" class="function"><a href="injecting.html#InjectorClient.get_type_dependency">get_type_dependency</a></dd>
                <dd id="Client.remove_type_dependency" class="function"><a href="injecting.html#InjectorClient.remove_type_dependency">remove_type_dependency</a></dd>
                <dd id="Client.set_callback_override" class="function"><a href="injecting.html#InjectorClient.set_callback_override">set_callback_override</a></dd>
                <dd id="Client.get_callback_override" class="function"><a href="injecting.html#InjectorClient.get_callback_override">get_callback_override</a></dd>
                <dd id="Client.remove_callback_override" class="function"><a href="injecting.html#InjectorClient.remove_callback_override">remove_callback_override</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ClientCallbackNames">
                                <div class="attr class">
        <a class="headerlink" href="#ClientCallbackNames">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ClientCallbackNames</span><wbr>(<span class="base">builtins.str</span>, <span class="base">enum.Enum</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ClientCallbackNames</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Enum of the client callback names dispatched by the standard `Client`.&quot;&quot;&quot;</span>

    <span class="n">CLOSED</span> <span class="o">=</span> <span class="s2">&quot;closed&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when the client has finished closing.</span>

<span class="sd">    No positional arguments are provided for this event.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CLOSING</span> <span class="o">=</span> <span class="s2">&quot;closing&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when the client is initially instructed to close.</span>

<span class="sd">    No positional arguments are provided for this event.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">COMPONENT_ADDED</span> <span class="o">=</span> <span class="s2">&quot;component_added&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when a component is added to an active client.</span>

<span class="sd">    .. warning::</span>
<span class="sd">        This event isn&#39;t dispatched for components which were registered while</span>
<span class="sd">        the client is inactive.</span>

<span class="sd">    The first positional argument is the `tanjun.abc.Component` being added.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">COMPONENT_REMOVED</span> <span class="o">=</span> <span class="s2">&quot;component_removed&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when a component is added to an active client.</span>

<span class="sd">    .. warning::</span>
<span class="sd">        This event isn&#39;t dispatched for components which were removed while</span>
<span class="sd">        the client is inactive.</span>

<span class="sd">    The first positional argument is the `tanjun.abc.Component` being removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">MESSAGE_COMMAND_NOT_FOUND</span> <span class="o">=</span> <span class="s2">&quot;message_command_not_found&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when a message command is not found.</span>

<span class="sd">    `tanjun.abc.MessageContext` is provided as the first positional argument.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SLASH_COMMAND_NOT_FOUND</span> <span class="o">=</span> <span class="s2">&quot;slash_command_not_found&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when a slash command is not found.</span>

<span class="sd">    `tanjun.abc.MessageContext` is provided as the first positional argument.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">STARTED</span> <span class="o">=</span> <span class="s2">&quot;started&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when the client has finished starting.</span>

<span class="sd">    No positional arguments are provided for this event.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">STARTING</span> <span class="o">=</span> <span class="s2">&quot;starting&quot;</span>
    <span class="sd">&quot;&quot;&quot;Called when the client is initially instructed to start.</span>

<span class="sd">    No positional arguments are provided for this event.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>

        </details>

            <div class="docstring"><p>Enum of the client callback names dispatched by the standard <code><a href="#Client">Client</a></code>.</p>
</div>


                            <div id="ClientCallbackNames.CLOSED" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ClientCallbackNames.CLOSED">#&nbsp;&nbsp</a>

        <span class="name">CLOSED</span><span class="default_value"> = &lt;<a href="#ClientCallbackNames.CLOSED">ClientCallbackNames.CLOSED</a>: &#39;closed&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Called when the client has finished closing.</p>

<p>No positional arguments are provided for this event.</p>
</div>


                            </div>
                            <div id="ClientCallbackNames.CLOSING" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ClientCallbackNames.CLOSING">#&nbsp;&nbsp</a>

        <span class="name">CLOSING</span><span class="default_value"> = &lt;<a href="#ClientCallbackNames.CLOSING">ClientCallbackNames.CLOSING</a>: &#39;closing&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Called when the client is initially instructed to close.</p>

<p>No positional arguments are provided for this event.</p>
</div>


                            </div>
                            <div id="ClientCallbackNames.COMPONENT_ADDED" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ClientCallbackNames.COMPONENT_ADDED">#&nbsp;&nbsp</a>

        <span class="name">COMPONENT_ADDED</span><span class="default_value"> = &lt;<a href="#ClientCallbackNames.COMPONENT_ADDED">ClientCallbackNames.COMPONENT_ADDED</a>: &#39;component_added&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Called when a component is added to an active client.</p>

<p><em>Warning:</em>
This event isn't dispatched for components which were registered while
the client is inactive.</p>

<p>The first positional argument is the <code><a href="abc.html#Component">tanjun.abc.Component</a></code> being added.</p>
</div>


                            </div>
                            <div id="ClientCallbackNames.COMPONENT_REMOVED" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ClientCallbackNames.COMPONENT_REMOVED">#&nbsp;&nbsp</a>

        <span class="name">COMPONENT_REMOVED</span><span class="default_value"> = &lt;<a href="#ClientCallbackNames.COMPONENT_REMOVED">ClientCallbackNames.COMPONENT_REMOVED</a>: &#39;component_removed&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Called when a component is added to an active client.</p>

<p><em>Warning:</em>
This event isn't dispatched for components which were removed while
the client is inactive.</p>

<p>The first positional argument is the <code><a href="abc.html#Component">tanjun.abc.Component</a></code> being removed.</p>
</div>


                            </div>
                            <div id="ClientCallbackNames.MESSAGE_COMMAND_NOT_FOUND" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ClientCallbackNames.MESSAGE_COMMAND_NOT_FOUND">#&nbsp;&nbsp</a>

        <span class="name">MESSAGE_COMMAND_NOT_FOUND</span><span class="default_value"> = &lt;<a href="#ClientCallbackNames.MESSAGE_COMMAND_NOT_FOUND">ClientCallbackNames.MESSAGE_COMMAND_NOT_FOUND</a>: &#39;message_command_not_found&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Called when a message command is not found.</p>

<p><code><a href="abc.html#MessageContext">tanjun.abc.MessageContext</a></code> is provided as the first positional argument.</p>
</div>


                            </div>
                            <div id="ClientCallbackNames.SLASH_COMMAND_NOT_FOUND" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ClientCallbackNames.SLASH_COMMAND_NOT_FOUND">#&nbsp;&nbsp</a>

        <span class="name">SLASH_COMMAND_NOT_FOUND</span><span class="default_value"> = &lt;<a href="#ClientCallbackNames.SLASH_COMMAND_NOT_FOUND">ClientCallbackNames.SLASH_COMMAND_NOT_FOUND</a>: &#39;slash_command_not_found&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Called when a slash command is not found.</p>

<p><code><a href="abc.html#MessageContext">tanjun.abc.MessageContext</a></code> is provided as the first positional argument.</p>
</div>


                            </div>
                            <div id="ClientCallbackNames.STARTED" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ClientCallbackNames.STARTED">#&nbsp;&nbsp</a>

        <span class="name">STARTED</span><span class="default_value"> = &lt;<a href="#ClientCallbackNames.STARTED">ClientCallbackNames.STARTED</a>: &#39;started&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Called when the client has finished starting.</p>

<p>No positional arguments are provided for this event.</p>
</div>


                            </div>
                            <div id="ClientCallbackNames.STARTING" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#ClientCallbackNames.STARTING">#&nbsp;&nbsp</a>

        <span class="name">STARTING</span><span class="default_value"> = &lt;<a href="#ClientCallbackNames.STARTING">ClientCallbackNames.STARTING</a>: &#39;starting&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Called when the client is initially instructed to start.</p>

<p>No positional arguments are provided for this event.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>enum.Enum</dt>
                                <dd id="ClientCallbackNames.name" class="variable">name</dd>
                <dd id="ClientCallbackNames.value" class="variable">value</dd>

            </div>
            <div><dt>builtins.str</dt>
                                <dd id="ClientCallbackNames.encode" class="function">encode</dd>
                <dd id="ClientCallbackNames.replace" class="function">replace</dd>
                <dd id="ClientCallbackNames.split" class="function">split</dd>
                <dd id="ClientCallbackNames.rsplit" class="function">rsplit</dd>
                <dd id="ClientCallbackNames.join" class="function">join</dd>
                <dd id="ClientCallbackNames.capitalize" class="function">capitalize</dd>
                <dd id="ClientCallbackNames.casefold" class="function">casefold</dd>
                <dd id="ClientCallbackNames.title" class="function">title</dd>
                <dd id="ClientCallbackNames.center" class="function">center</dd>
                <dd id="ClientCallbackNames.count" class="function">count</dd>
                <dd id="ClientCallbackNames.expandtabs" class="function">expandtabs</dd>
                <dd id="ClientCallbackNames.find" class="function">find</dd>
                <dd id="ClientCallbackNames.partition" class="function">partition</dd>
                <dd id="ClientCallbackNames.index" class="function">index</dd>
                <dd id="ClientCallbackNames.ljust" class="function">ljust</dd>
                <dd id="ClientCallbackNames.lower" class="function">lower</dd>
                <dd id="ClientCallbackNames.lstrip" class="function">lstrip</dd>
                <dd id="ClientCallbackNames.rfind" class="function">rfind</dd>
                <dd id="ClientCallbackNames.rindex" class="function">rindex</dd>
                <dd id="ClientCallbackNames.rjust" class="function">rjust</dd>
                <dd id="ClientCallbackNames.rstrip" class="function">rstrip</dd>
                <dd id="ClientCallbackNames.rpartition" class="function">rpartition</dd>
                <dd id="ClientCallbackNames.splitlines" class="function">splitlines</dd>
                <dd id="ClientCallbackNames.strip" class="function">strip</dd>
                <dd id="ClientCallbackNames.swapcase" class="function">swapcase</dd>
                <dd id="ClientCallbackNames.translate" class="function">translate</dd>
                <dd id="ClientCallbackNames.upper" class="function">upper</dd>
                <dd id="ClientCallbackNames.startswith" class="function">startswith</dd>
                <dd id="ClientCallbackNames.endswith" class="function">endswith</dd>
                <dd id="ClientCallbackNames.removeprefix" class="function">removeprefix</dd>
                <dd id="ClientCallbackNames.removesuffix" class="function">removesuffix</dd>
                <dd id="ClientCallbackNames.isascii" class="function">isascii</dd>
                <dd id="ClientCallbackNames.islower" class="function">islower</dd>
                <dd id="ClientCallbackNames.isupper" class="function">isupper</dd>
                <dd id="ClientCallbackNames.istitle" class="function">istitle</dd>
                <dd id="ClientCallbackNames.isspace" class="function">isspace</dd>
                <dd id="ClientCallbackNames.isdecimal" class="function">isdecimal</dd>
                <dd id="ClientCallbackNames.isdigit" class="function">isdigit</dd>
                <dd id="ClientCallbackNames.isnumeric" class="function">isnumeric</dd>
                <dd id="ClientCallbackNames.isalpha" class="function">isalpha</dd>
                <dd id="ClientCallbackNames.isalnum" class="function">isalnum</dd>
                <dd id="ClientCallbackNames.isidentifier" class="function">isidentifier</dd>
                <dd id="ClientCallbackNames.isprintable" class="function">isprintable</dd>
                <dd id="ClientCallbackNames.zfill" class="function">zfill</dd>
                <dd id="ClientCallbackNames.format" class="function">format</dd>
                <dd id="ClientCallbackNames.format_map" class="function">format_map</dd>
                <dd id="ClientCallbackNames.maketrans" class="function">maketrans</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="LoaderSig">
                                <div class="attr class">
        <a class="headerlink" href="#LoaderSig">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">LoaderSig</span>:
    </div>

        
    

                </section>
                <section id="MessageAcceptsEnum">
                                <div class="attr class">
        <a class="headerlink" href="#MessageAcceptsEnum">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">MessageAcceptsEnum</span><wbr>(<span class="base">builtins.str</span>, <span class="base">enum.Enum</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MessageAcceptsEnum</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The possible configurations for which events `Client` should execute commands based on.&quot;&quot;&quot;</span>

    <span class="n">ALL</span> <span class="o">=</span> <span class="s2">&quot;ALL&quot;</span>
    <span class="sd">&quot;&quot;&quot;Set the client to execute commands based on both DM and guild message create events.&quot;&quot;&quot;</span>

    <span class="n">DM_ONLY</span> <span class="o">=</span> <span class="s2">&quot;DM_ONLY&quot;</span>
    <span class="sd">&quot;&quot;&quot;Set the client to execute commands based only DM message create events.&quot;&quot;&quot;</span>

    <span class="n">GUILD_ONLY</span> <span class="o">=</span> <span class="s2">&quot;GUILD_ONLY&quot;</span>
    <span class="sd">&quot;&quot;&quot;Set the client to execute commands based only guild message create events.&quot;&quot;&quot;</span>

    <span class="n">NONE</span> <span class="o">=</span> <span class="s2">&quot;NONE&quot;</span>
    <span class="sd">&quot;&quot;&quot;Set the client to not execute commands based on message create events.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_event_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Get the base event type this mode listens to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[type[hikari.message_events.MessageCreateEvent]]</span>
<span class="sd">            The type object of the MessageCreateEvent class this mode will</span>
<span class="sd">            register a listener for.</span>

<span class="sd">            This will be `None` if this mode disables listening to</span>
<span class="sd">            message create events.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_ACCEPTS_EVENT_TYPE_MAPPING</span><span class="p">[</span><span class="bp">self</span><span class="p">]</span>
</pre></div>

        </details>

            <div class="docstring"><p>The possible configurations for which events <code><a href="#Client">Client</a></code> should execute commands based on.</p>
</div>


                            <div id="MessageAcceptsEnum.ALL" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageAcceptsEnum.ALL">#&nbsp;&nbsp</a>

        <span class="name">ALL</span><span class="default_value"> = &lt;<a href="#MessageAcceptsEnum.ALL">MessageAcceptsEnum.ALL</a>: &#39;ALL&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Set the client to execute commands based on both DM and guild message create events.</p>
</div>


                            </div>
                            <div id="MessageAcceptsEnum.DM_ONLY" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageAcceptsEnum.DM_ONLY">#&nbsp;&nbsp</a>

        <span class="name">DM_ONLY</span><span class="default_value"> = &lt;<a href="#MessageAcceptsEnum.DM_ONLY">MessageAcceptsEnum.DM_ONLY</a>: &#39;DM_ONLY&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Set the client to execute commands based only DM message create events.</p>
</div>


                            </div>
                            <div id="MessageAcceptsEnum.GUILD_ONLY" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageAcceptsEnum.GUILD_ONLY">#&nbsp;&nbsp</a>

        <span class="name">GUILD_ONLY</span><span class="default_value"> = &lt;<a href="#MessageAcceptsEnum.GUILD_ONLY">MessageAcceptsEnum.GUILD_ONLY</a>: &#39;GUILD_ONLY&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Set the client to execute commands based only guild message create events.</p>
</div>


                            </div>
                            <div id="MessageAcceptsEnum.NONE" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#MessageAcceptsEnum.NONE">#&nbsp;&nbsp</a>

        <span class="name">NONE</span><span class="default_value"> = &lt;<a href="#MessageAcceptsEnum.NONE">MessageAcceptsEnum.NONE</a>: &#39;NONE&#39;&gt;</span>
    </div>

            <div class="docstring"><p>Set the client to not execute commands based on message create events.</p>
</div>


                            </div>
                            <div id="MessageAcceptsEnum.get_event_type" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#MessageAcceptsEnum.get_event_type">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_event_type</span><span class="signature">(
    self
) -&gt; Optional[type[hikari.events.message_events.MessageCreateEvent]]</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">get_event_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">hikari</span><span class="o">.</span><span class="n">MessageCreateEvent</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Get the base event type this mode listens to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        typing.Optional[type[hikari.message_events.MessageCreateEvent]]</span>
<span class="sd">            The type object of the MessageCreateEvent class this mode will</span>
<span class="sd">            register a listener for.</span>

<span class="sd">            This will be `None` if this mode disables listening to</span>
<span class="sd">            message create events.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_ACCEPTS_EVENT_TYPE_MAPPING</span><span class="p">[</span><span class="bp">self</span><span class="p">]</span>
</pre></div>

        </details>

            <div class="docstring"><p>Get the base event type this mode listens to.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>typing.Optional[type[hikari.message_events.MessageCreateEvent]]</strong>: The type object of the MessageCreateEvent class this mode will
register a listener for.</li>
</ul>

<p>This will be <code>None</code> if this mode disables listening to
message create events.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>enum.Enum</dt>
                                <dd id="MessageAcceptsEnum.name" class="variable">name</dd>
                <dd id="MessageAcceptsEnum.value" class="variable">value</dd>

            </div>
            <div><dt>builtins.str</dt>
                                <dd id="MessageAcceptsEnum.encode" class="function">encode</dd>
                <dd id="MessageAcceptsEnum.replace" class="function">replace</dd>
                <dd id="MessageAcceptsEnum.split" class="function">split</dd>
                <dd id="MessageAcceptsEnum.rsplit" class="function">rsplit</dd>
                <dd id="MessageAcceptsEnum.join" class="function">join</dd>
                <dd id="MessageAcceptsEnum.capitalize" class="function">capitalize</dd>
                <dd id="MessageAcceptsEnum.casefold" class="function">casefold</dd>
                <dd id="MessageAcceptsEnum.title" class="function">title</dd>
                <dd id="MessageAcceptsEnum.center" class="function">center</dd>
                <dd id="MessageAcceptsEnum.count" class="function">count</dd>
                <dd id="MessageAcceptsEnum.expandtabs" class="function">expandtabs</dd>
                <dd id="MessageAcceptsEnum.find" class="function">find</dd>
                <dd id="MessageAcceptsEnum.partition" class="function">partition</dd>
                <dd id="MessageAcceptsEnum.index" class="function">index</dd>
                <dd id="MessageAcceptsEnum.ljust" class="function">ljust</dd>
                <dd id="MessageAcceptsEnum.lower" class="function">lower</dd>
                <dd id="MessageAcceptsEnum.lstrip" class="function">lstrip</dd>
                <dd id="MessageAcceptsEnum.rfind" class="function">rfind</dd>
                <dd id="MessageAcceptsEnum.rindex" class="function">rindex</dd>
                <dd id="MessageAcceptsEnum.rjust" class="function">rjust</dd>
                <dd id="MessageAcceptsEnum.rstrip" class="function">rstrip</dd>
                <dd id="MessageAcceptsEnum.rpartition" class="function">rpartition</dd>
                <dd id="MessageAcceptsEnum.splitlines" class="function">splitlines</dd>
                <dd id="MessageAcceptsEnum.strip" class="function">strip</dd>
                <dd id="MessageAcceptsEnum.swapcase" class="function">swapcase</dd>
                <dd id="MessageAcceptsEnum.translate" class="function">translate</dd>
                <dd id="MessageAcceptsEnum.upper" class="function">upper</dd>
                <dd id="MessageAcceptsEnum.startswith" class="function">startswith</dd>
                <dd id="MessageAcceptsEnum.endswith" class="function">endswith</dd>
                <dd id="MessageAcceptsEnum.removeprefix" class="function">removeprefix</dd>
                <dd id="MessageAcceptsEnum.removesuffix" class="function">removesuffix</dd>
                <dd id="MessageAcceptsEnum.isascii" class="function">isascii</dd>
                <dd id="MessageAcceptsEnum.islower" class="function">islower</dd>
                <dd id="MessageAcceptsEnum.isupper" class="function">isupper</dd>
                <dd id="MessageAcceptsEnum.istitle" class="function">istitle</dd>
                <dd id="MessageAcceptsEnum.isspace" class="function">isspace</dd>
                <dd id="MessageAcceptsEnum.isdecimal" class="function">isdecimal</dd>
                <dd id="MessageAcceptsEnum.isdigit" class="function">isdigit</dd>
                <dd id="MessageAcceptsEnum.isnumeric" class="function">isnumeric</dd>
                <dd id="MessageAcceptsEnum.isalpha" class="function">isalpha</dd>
                <dd id="MessageAcceptsEnum.isalnum" class="function">isalnum</dd>
                <dd id="MessageAcceptsEnum.isidentifier" class="function">isidentifier</dd>
                <dd id="MessageAcceptsEnum.isprintable" class="function">isprintable</dd>
                <dd id="MessageAcceptsEnum.zfill" class="function">zfill</dd>
                <dd id="MessageAcceptsEnum.format" class="function">format</dd>
                <dd id="MessageAcceptsEnum.format_map" class="function">format_map</dd>
                <dd id="MessageAcceptsEnum.maketrans" class="function">maketrans</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="PrefixGetterSig">
                                <div class="attr class">
        <a class="headerlink" href="#PrefixGetterSig">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">PrefixGetterSig</span>:
    </div>

        
    

                </section>
                <section id="PrefixGetterSigT">
                                <div class="attr variable"><a class="headerlink" href="#PrefixGetterSigT">#&nbsp;&nbsp</a>

        <span class="name">PrefixGetterSigT</span><span class="default_value"> = ~PrefixGetterSigT</span>
    </div>

    

                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span><span class="signature">(${doc.parameters.join(", ")})</span>`;
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>